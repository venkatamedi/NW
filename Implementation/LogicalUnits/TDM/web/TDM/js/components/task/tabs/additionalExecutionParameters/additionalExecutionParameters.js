function additionalExecutionParameters(){return{restrict:"E",templateUrl:"js/components/task/tabs/additionalExecutionParameters/additionalExecutionParameters.html",scope:{content:"=",disableChange:"=",form:"=",disabled:"=",sourceEnvOwner:"=",targetEnvOwner:"=",back:"=",getSubTitle:"=",allowedEntityVersioning:"=",allowedRoleData:"=",allowedRoleDataSource:"="},controller:function($scope,TDMService,toastr,$timeout,AuthService,$state,DTOptionsBuilder,DTColumnBuilder,$q,$compile){var additionalExecutionParametersCtrl=this;additionalExecutionParametersCtrl.taskData=$scope.content,additionalExecutionParametersCtrl.subTitle="",TDMService.getRetentionPeriod().then(response=>{if(additionalExecutionParametersCtrl.retentionPeriod=angular.copy(response.result),additionalExecutionParametersCtrl.retentionPeriodReserve=angular.copy(response.result),_.remove(additionalExecutionParametersCtrl.retentionPeriod.retentionPeriodTypes,(function(period){if(period.units>additionalExecutionParametersCtrl.retentionPeriod.maxRetentionPeriodForExtract.value)return!0})),_.remove(additionalExecutionParametersCtrl.retentionPeriodReserve.retentionPeriodTypes,(function(period){if(period.units>additionalExecutionParametersCtrl.retentionPeriodReserve.maxRetentionPeriodForReserve.value)return!0})),"EXTRACT"===additionalExecutionParametersCtrl.taskData.task_type){let firstTime=!0;additionalExecutionParametersCtrl.taskData.retention_period_value&&(firstTime=!1),additionalExecutionParametersCtrl.taskData.retention_period_type&&(additionalExecutionParametersCtrl.retention_period_type=_.find(additionalExecutionParametersCtrl.retentionPeriod.retentionPeriodTypes,{name:additionalExecutionParametersCtrl.taskData.retention_period_type}),additionalExecutionParametersCtrl.taskData.retention_period_value=parseFloat(additionalExecutionParametersCtrl.taskData.retention_period_value)),!additionalExecutionParametersCtrl.taskData.retention_period_type&&additionalExecutionParametersCtrl.retentionPeriod.defaultPeriod&&(additionalExecutionParametersCtrl.retention_period_type=_.find(additionalExecutionParametersCtrl.retentionPeriod.retentionPeriodTypes,{name:additionalExecutionParametersCtrl.retentionPeriod.defaultPeriod.unit}),additionalExecutionParametersCtrl.taskData.retention_period_value=parseFloat(additionalExecutionParametersCtrl.retentionPeriod.defaultPeriod.value),additionalExecutionParametersCtrl.retentionPeriodTypeChanged()),!additionalExecutionParametersCtrl.taskData.version_ind&&firstTime&&(additionalExecutionParametersCtrl.taskData.retention_period_value=0)}("RESERVE"===additionalExecutionParametersCtrl.taskData.task_type||additionalExecutionParametersCtrl.taskData.reserve_ind)&&(additionalExecutionParametersCtrl.taskData.reserve_retention_period_type&&(additionalExecutionParametersCtrl.reserve_retention_period_type=_.find(additionalExecutionParametersCtrl.retentionPeriodReserve.retentionPeriodTypes,{name:additionalExecutionParametersCtrl.taskData.reserve_retention_period_type}),additionalExecutionParametersCtrl.taskData.reserve_retention_period_value=parseFloat(additionalExecutionParametersCtrl.taskData.reserve_retention_period_value)),!additionalExecutionParametersCtrl.taskData.reserve_retention_period_type&&additionalExecutionParametersCtrl.retentionPeriodReserve.defaultPeriod&&(additionalExecutionParametersCtrl.reserve_retention_period_type=_.find(additionalExecutionParametersCtrl.retentionPeriodReserve.retentionPeriodTypes,{name:additionalExecutionParametersCtrl.retentionPeriodReserve.defaultPeriod.unit}),additionalExecutionParametersCtrl.taskData.reserve_retention_period_value=parseFloat(additionalExecutionParametersCtrl.retentionPeriodReserve.defaultPeriod.value),additionalExecutionParametersCtrl.retentionPeriodTypeReserveChanged()))}),additionalExecutionParametersCtrl.taskData.syncModeRadio=null;var userRole=AuthService.getRole();additionalExecutionParametersCtrl.userRoleType=userRole.type,additionalExecutionParametersCtrl.subTitle=$scope.getSubTitle(),additionalExecutionParametersCtrl.retentionPeriodTypeChanged=function(){additionalExecutionParametersCtrl.taskData.retention_period_type=additionalExecutionParametersCtrl.retention_period_type.name},additionalExecutionParametersCtrl.retentionPeriodTypeReserveChanged=function(){additionalExecutionParametersCtrl.taskData.reserve_retention_period_type=additionalExecutionParametersCtrl.reserve_retention_period_type.name},additionalExecutionParametersCtrl.checkDataTypeValidation=()=>{additionalExecutionParametersCtrl.taskData.reserve_ind||!additionalExecutionParametersCtrl.reference&&!additionalExecutionParametersCtrl.entities?additionalExecutionParametersCtrl.taskData.reserve_ind&&additionalExecutionParametersCtrl.entities?additionalExecutionParametersCtrl.valid="true":additionalExecutionParametersCtrl.valid="":additionalExecutionParametersCtrl.valid="true"},additionalExecutionParametersCtrl.versioningChange=()=>{additionalExecutionParametersCtrl.taskData.version_ind?additionalExecutionParametersCtrl.taskData.sync_mode="OFF":additionalExecutionParametersCtrl.taskData.sync_mode=null,additionalExecutionParametersCtrl.taskData.version_ind?"EXTRACT"===additionalExecutionParametersCtrl.taskData.task_type&&(additionalExecutionParametersCtrl.taskData.retention_period_value=parseFloat(additionalExecutionParametersCtrl.retentionPeriod.defaultPeriod.value)):additionalExecutionParametersCtrl.taskData.retention_period_value=0},additionalExecutionParametersCtrl.dataTypeChange=()=>{additionalExecutionParametersCtrl.reference&&additionalExecutionParametersCtrl.entities?additionalExecutionParametersCtrl.taskData.reference="both":additionalExecutionParametersCtrl.reference&&!additionalExecutionParametersCtrl.entities?additionalExecutionParametersCtrl.taskData.reference="refernceOnly":additionalExecutionParametersCtrl.taskData.reference=null,"REF"===additionalExecutionParametersCtrl.taskData.selection_method&&"refernceOnly"!==additionalExecutionParametersCtrl.taskData.reference&&(additionalExecutionParametersCtrl.taskData.selection_method="L"),additionalExecutionParametersCtrl.checkDataTypeValidation()},additionalExecutionParametersCtrl.taskData.task_id?(additionalExecutionParametersCtrl.entities=!0,"refernceOnly"===additionalExecutionParametersCtrl.taskData.reference?(additionalExecutionParametersCtrl.reference=!0,additionalExecutionParametersCtrl.entities=!1):"both"===additionalExecutionParametersCtrl.taskData.reference&&(additionalExecutionParametersCtrl.reference=!0),additionalExecutionParametersCtrl.checkDataTypeValidation()):(additionalExecutionParametersCtrl.entities=!0,"refernceOnly"===additionalExecutionParametersCtrl.taskData.reference?(additionalExecutionParametersCtrl.reference=!0,additionalExecutionParametersCtrl.entities=!1):"both"===additionalExecutionParametersCtrl.taskData.reference&&(additionalExecutionParametersCtrl.reference=!0),additionalExecutionParametersCtrl.checkDataTypeValidation(),additionalExecutionParametersCtrl.taskData.sync_mode||(additionalExecutionParametersCtrl.taskData.sync_mode=null)),TDMService.getBEPostExecutionProcess(additionalExecutionParametersCtrl.taskData.be_id).then((function(response){"SUCCESS"==response.errorCode?(additionalExecutionParametersCtrl.taskData.allPostExecutionProcess=response.result,additionalExecutionParametersCtrl.allPostExecutionProcessIds=_.map(response.result,"process_id")):toastr.error("Business entity # "+additionalExecutionParametersCtrl.taskData.be_id,"Failed to get Post Execution Processes")}))},controllerAs:"additionalExecutionParametersCtrl"}}angular.module("TDM-FE").directive("additionalExecutionParameters",additionalExecutionParameters);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvdGFzay90YWJzL2FkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzL2FkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzLmpzIl0sIm5hbWVzIjpbImFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzIiwicmVzdHJpY3QiLCJ0ZW1wbGF0ZVVybCIsInNjb3BlIiwiY29udGVudCIsImRpc2FibGVDaGFuZ2UiLCJmb3JtIiwiZGlzYWJsZWQiLCJzb3VyY2VFbnZPd25lciIsInRhcmdldEVudk93bmVyIiwiYmFjayIsImdldFN1YlRpdGxlIiwiYWxsb3dlZEVudGl0eVZlcnNpb25pbmciLCJhbGxvd2VkUm9sZURhdGEiLCJhbGxvd2VkUm9sZURhdGFTb3VyY2UiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiVERNU2VydmljZSIsInRvYXN0ciIsIiR0aW1lb3V0IiwiQXV0aFNlcnZpY2UiLCIkc3RhdGUiLCJEVE9wdGlvbnNCdWlsZGVyIiwiRFRDb2x1bW5CdWlsZGVyIiwiJHEiLCIkY29tcGlsZSIsImFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybCIsInRoaXMiLCJ0YXNrRGF0YSIsInN1YlRpdGxlIiwiZ2V0UmV0ZW50aW9uUGVyaW9kIiwidGhlbiIsInJlc3BvbnNlIiwicmV0ZW50aW9uUGVyaW9kIiwiYW5ndWxhciIsImNvcHkiLCJyZXN1bHQiLCJyZXRlbnRpb25QZXJpb2RSZXNlcnZlIiwiXyIsInJlbW92ZSIsInJldGVudGlvblBlcmlvZFR5cGVzIiwicGVyaW9kIiwidW5pdHMiLCJtYXhSZXRlbnRpb25QZXJpb2RGb3JFeHRyYWN0IiwidmFsdWUiLCJtYXhSZXRlbnRpb25QZXJpb2RGb3JSZXNlcnZlIiwidGFza190eXBlIiwiZmlyc3RUaW1lIiwicmV0ZW50aW9uX3BlcmlvZF92YWx1ZSIsInJldGVudGlvbl9wZXJpb2RfdHlwZSIsImZpbmQiLCJuYW1lIiwicGFyc2VGbG9hdCIsImRlZmF1bHRQZXJpb2QiLCJ1bml0IiwicmV0ZW50aW9uUGVyaW9kVHlwZUNoYW5nZWQiLCJ2ZXJzaW9uX2luZCIsInJlc2VydmVfaW5kIiwicmVzZXJ2ZV9yZXRlbnRpb25fcGVyaW9kX3R5cGUiLCJyZXNlcnZlX3JldGVudGlvbl9wZXJpb2RfdmFsdWUiLCJyZXRlbnRpb25QZXJpb2RUeXBlUmVzZXJ2ZUNoYW5nZWQiLCJzeW5jTW9kZVJhZGlvIiwidXNlclJvbGUiLCJnZXRSb2xlIiwidXNlclJvbGVUeXBlIiwidHlwZSIsImNoZWNrRGF0YVR5cGVWYWxpZGF0aW9uIiwicmVmZXJlbmNlIiwiZW50aXRpZXMiLCJ2YWxpZCIsInZlcnNpb25pbmdDaGFuZ2UiLCJzeW5jX21vZGUiLCJkYXRhVHlwZUNoYW5nZSIsInNlbGVjdGlvbl9tZXRob2QiLCJ0YXNrX2lkIiwiZ2V0QkVQb3N0RXhlY3V0aW9uUHJvY2VzcyIsImJlX2lkIiwiZXJyb3JDb2RlIiwiYWxsUG9zdEV4ZWN1dGlvblByb2Nlc3MiLCJhbGxQb3N0RXhlY3V0aW9uUHJvY2Vzc0lkcyIsIm1hcCIsImVycm9yIiwiY29udHJvbGxlckFzIiwibW9kdWxlIiwiZGlyZWN0aXZlIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxnQ0E4SkwsTUFBTyxDQUNIQyxTQUFVLElBQ1ZDLFlBOUpXLDJGQStKWEMsTUFBTyxDQUNIQyxRQUFTLElBQ1RDLGNBQWUsSUFDZkMsS0FBTSxJQUNOQyxTQUFVLElBQ1ZDLGVBQWdCLElBQ2hCQyxlQUFnQixJQUNoQkMsS0FBTSxJQUNOQyxZQUFhLElBQ2JDLHdCQUF5QixJQUN6QkMsZ0JBQWlCLElBQ2pCQyxzQkFBdUIsS0FFM0JDLFdBMUthLFNBQVVDLE9BQVFDLFdBQVlDLE9BQVFDLFNBQVVDLFlBQWFDLE9BQVFDLGlCQUFrQkMsZ0JBQWlCQyxHQUFJQyxVQUN6SCxJQUFJQyxrQ0FBb0NDLEtBRXhDRCxrQ0FBa0NFLFNBQVdaLE9BQU9aLFFBQ3BEc0Isa0NBQWtDRyxTQUFXLEdBRTdDWixXQUFXYSxxQkFBcUJDLEtBQU1DLFdBYWxDLEdBWkFOLGtDQUFr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QyxVQUN4RSxXQUF0QkEsU0FBUzZDLFdBQ1RuRCxrQ0FBa0NFLFNBQVNrRCx3QkFBMEI5QyxTQUFTSSxPQUM5RVYsa0NBQWtDcUQsMkJBQTZCekMsRUFBRTBDLElBQUloRCxTQUFTSSxPQUFPLGVBRXJGbEIsT0FBTytELE1BQU0scUJBQXVCdkQsa0NBQWtDRSxTQUFTZ0QsTUFBTyw4Q0F1QjlGTSxhQUFjLHFDQUt0QmhELFFBQ0tpRCxPQUFPLFVBQ1BDLFVBQVUsZ0NBQWlDcEYiLCJmaWxlIjoiY29tcG9uZW50cy90YXNrL3RhYnMvYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnMvYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVycygpIHtcblxuICAgIHZhciB0ZW1wbGF0ZSA9IFwianMvY29tcG9uZW50cy90YXNrL3RhYnMvYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnMvYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnMuaHRtbFwiO1xuXG4gICAgdmFyIGNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoJHNjb3BlLCBURE1TZXJ2aWNlLCB0b2FzdHIsICR0aW1lb3V0LCBBdXRoU2VydmljZSwgJHN0YXRlLCBEVE9wdGlvbnNCdWlsZGVyLCBEVENvbHVtbkJ1aWxkZXIsICRxLCAkY29tcGlsZSkge1xuICAgICAgICB2YXIgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsID0gdGhpcztcblxuICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEgPSAkc2NvcGUuY29udGVudDtcbiAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnN1YlRpdGxlID0gJyc7XG5cbiAgICAgICAgVERNU2VydmljZS5nZXRSZXRlbnRpb25QZXJpb2QoKS50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJldGVudGlvblBlcmlvZCA9IGFuZ3VsYXIuY29weShyZXNwb25zZS5yZXN1bHQpO1xuICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJldGVudGlvblBlcmlvZFJlc2VydmUgPSBhbmd1bGFyLmNvcHkocmVzcG9uc2UucmVzdWx0KTtcbiAgICAgICAgICAgIF8ucmVtb3ZlKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC5yZXRlbnRpb25QZXJpb2QucmV0ZW50aW9uUGVyaW9kVHlwZXMsIGZ1bmN0aW9uIChwZXJpb2QpIHtcbiAgICAgICAgICAgICAgICBpZiAocGVyaW9kLnVuaXRzID4gYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJldGVudGlvblBlcmlvZC5tYXhSZXRlbnRpb25QZXJpb2RGb3JFeHRyYWN0LnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXy5yZW1vdmUoYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJldGVudGlvblBlcmlvZFJlc2VydmUucmV0ZW50aW9uUGVyaW9kVHlwZXMsIGZ1bmN0aW9uIChwZXJpb2QpIHtcbiAgICAgICAgICAgICAgICBpZiAocGVyaW9kLnVuaXRzID4gYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJldGVudGlvblBlcmlvZFJlc2VydmUubWF4UmV0ZW50aW9uUGVyaW9kRm9yUmVzZXJ2ZS52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEudGFza190eXBlID09PSAnRVhUUkFDVCcpe1xuICAgICAgICAgICAgICAgIGxldCBmaXJzdFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEucmV0ZW50aW9uX3BlcmlvZF92YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBmaXJzdFRpbWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXRlbnRpb25fcGVyaW9kX3R5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJldGVudGlvbl9wZXJpb2RfdHlwZSA9IF8uZmluZChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmV0ZW50aW9uUGVyaW9kLnJldGVudGlvblBlcmlvZFR5cGVzLHtuYW1lOiBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEucmV0ZW50aW9uX3BlcmlvZF90eXBlfSk7XG4gICAgICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXRlbnRpb25fcGVyaW9kX3ZhbHVlID0gcGFyc2VGbG9hdChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEucmV0ZW50aW9uX3BlcmlvZF92YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnRhc2tEYXRhLnJldGVudGlvbl9wZXJpb2RfdHlwZSAmJiBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmV0ZW50aW9uUGVyaW9kLmRlZmF1bHRQZXJpb2Qpe1xuICAgICAgICAgICAgICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmV0ZW50aW9uX3BlcmlvZF90eXBlID0gXy5maW5kKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC5yZXRlbnRpb25QZXJpb2QucmV0ZW50aW9uUGVyaW9kVHlwZXMse25hbWU6IGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC5yZXRlbnRpb25QZXJpb2QuZGVmYXVsdFBlcmlvZC51bml0fSk7XG4gICAgICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXRlbnRpb25fcGVyaW9kX3ZhbHVlID0gcGFyc2VGbG9hdChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmV0ZW50aW9uUGVyaW9kLmRlZmF1bHRQZXJpb2QudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmV0ZW50aW9uUGVyaW9kVHlwZUNoYW5nZWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQgJiYgZmlyc3RUaW1lKXtcbiAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnRhc2tEYXRhLnJldGVudGlvbl9wZXJpb2RfdmFsdWUgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgIGlmIChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEudGFza190eXBlID09PSAnUkVTRVJWRScgfHxcbiAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXNlcnZlX2luZCl7XG4gICAgICAgICAgICAgICAgaWYgKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXNlcnZlX3JldGVudGlvbl9wZXJpb2RfdHlwZSApIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJlc2VydmVfcmV0ZW50aW9uX3BlcmlvZF90eXBlID0gXy5maW5kKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC5yZXRlbnRpb25QZXJpb2RSZXNlcnZlLnJldGVudGlvblBlcmlvZFR5cGVzLHtuYW1lOiBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEucmVzZXJ2ZV9yZXRlbnRpb25fcGVyaW9kX3R5cGV9KTtcbiAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnRhc2tEYXRhLnJlc2VydmVfcmV0ZW50aW9uX3BlcmlvZF92YWx1ZSAgPSBwYXJzZUZsb2F0KGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXNlcnZlX3JldGVudGlvbl9wZXJpb2RfdmFsdWUgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEucmVzZXJ2ZV9yZXRlbnRpb25fcGVyaW9kX3R5cGUgJiYgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJldGVudGlvblBlcmlvZFJlc2VydmUuZGVmYXVsdFBlcmlvZCl7XG4gICAgICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC5yZXNlcnZlX3JldGVudGlvbl9wZXJpb2RfdHlwZSA9IF8uZmluZChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmV0ZW50aW9uUGVyaW9kUmVzZXJ2ZS5yZXRlbnRpb25QZXJpb2RUeXBlcyx7bmFtZTogYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJldGVudGlvblBlcmlvZFJlc2VydmUuZGVmYXVsdFBlcmlvZC51bml0fSk7XG4gICAgICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXNlcnZlX3JldGVudGlvbl9wZXJpb2RfdmFsdWUgID0gcGFyc2VGbG9hdChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmV0ZW50aW9uUGVyaW9kUmVzZXJ2ZS5kZWZhdWx0UGVyaW9kLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJldGVudGlvblBlcmlvZFR5cGVSZXNlcnZlQ2hhbmdlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cblxuICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEuc3luY01vZGVSYWRpbyA9IG51bGw7XG4gICAgICAgIHZhciB1c2VyUm9sZSA9IEF1dGhTZXJ2aWNlLmdldFJvbGUoKTtcbiAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnVzZXJSb2xlVHlwZSA9IHVzZXJSb2xlLnR5cGU7XG4gICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC5zdWJUaXRsZSA9ICRzY29wZS5nZXRTdWJUaXRsZSgpO1xuXG4gICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC5yZXRlbnRpb25QZXJpb2RUeXBlQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXRlbnRpb25fcGVyaW9kX3R5cGUgPSBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmV0ZW50aW9uX3BlcmlvZF90eXBlLm5hbWU7XG4gICAgICAgIH1cblxuICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmV0ZW50aW9uUGVyaW9kVHlwZVJlc2VydmVDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnRhc2tEYXRhLnJlc2VydmVfcmV0ZW50aW9uX3BlcmlvZF90eXBlID0gYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJlc2VydmVfcmV0ZW50aW9uX3BlcmlvZF90eXBlLm5hbWU7XG4gICAgICAgIH1cblxuICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwuY2hlY2tEYXRhVHlwZVZhbGlkYXRpb24gPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXNlcnZlX2luZCAmJiBcbiAgICAgICAgICAgICAgICAoYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJlZmVyZW5jZSB8fCBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwuZW50aXRpZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC52YWxpZCA9ICd0cnVlJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXNlcnZlX2luZCAmJiBcbiAgICAgICAgICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwuZW50aXRpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnZhbGlkID0gJ3RydWUnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnZhbGlkID0gJyc7ICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC52ZXJzaW9uaW5nQ2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCkge1xuICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5zeW5jX21vZGUgPSAnT0ZGJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5zeW5jX21vZGUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQpe1xuICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZXRlbnRpb25fcGVyaW9kX3ZhbHVlID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEudGFza190eXBlID09PSAnRVhUUkFDVCcpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnRhc2tEYXRhLnJldGVudGlvbl9wZXJpb2RfdmFsdWUgPSBwYXJzZUZsb2F0KGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC5yZXRlbnRpb25QZXJpb2QuZGVmYXVsdFBlcmlvZC52YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLmRhdGFUeXBlQ2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC5yZWZlcmVuY2UgJiYgXG4gICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLmVudGl0aWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZWZlcmVuY2UgPSAnYm90aCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmVmZXJlbmNlICYmIFxuICAgICAgICAgICAgICAgICFhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwuZW50aXRpZXMpIHtcbiAgICAgICAgICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEucmVmZXJlbmNlID0gJ3JlZmVybmNlT25seSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEucmVmZXJlbmNlID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX21ldGhvZCA9PT0gJ1JFRicgJiYgXG4gICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnRhc2tEYXRhLnJlZmVyZW5jZSAhPT0gJ3JlZmVybmNlT25seScpe1xuICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID0gJ0wnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLmNoZWNrRGF0YVR5cGVWYWxpZGF0aW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnRhc2tEYXRhLnRhc2tfaWQpe1xuICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLmVudGl0aWVzID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEucmVmZXJlbmNlID09PSAncmVmZXJuY2VPbmx5Jyl7XG4gICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJlZmVyZW5jZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLmVudGl0aWVzID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEucmVmZXJlbmNlID09PSAnYm90aCcpe1xuICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC5yZWZlcmVuY2UgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLmNoZWNrRGF0YVR5cGVWYWxpZGF0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwuZW50aXRpZXMgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZWZlcmVuY2UgPT09ICdyZWZlcm5jZU9ubHknKXtcbiAgICAgICAgICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwucmVmZXJlbmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwuZW50aXRpZXMgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5yZWZlcmVuY2UgPT09ICdib3RoJyl7XG4gICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnJlZmVyZW5jZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwuY2hlY2tEYXRhVHlwZVZhbGlkYXRpb24oKTtcbiAgICAgICAgICAgIGlmICghYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnRhc2tEYXRhLnN5bmNfbW9kZSkge1xuICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5zeW5jX21vZGUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgVERNU2VydmljZS5nZXRCRVBvc3RFeGVjdXRpb25Qcm9jZXNzKGFkZGl0aW9uYWxFeGVjdXRpb25QYXJhbWV0ZXJzQ3RybC50YXNrRGF0YS5iZV9pZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVyc0N0cmwudGFza0RhdGEuYWxsUG9zdEV4ZWN1dGlvblByb2Nlc3MgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLmFsbFBvc3RFeGVjdXRpb25Qcm9jZXNzSWRzID0gXy5tYXAocmVzcG9uc2UucmVzdWx0LCdwcm9jZXNzX2lkJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIkJ1c2luZXNzIGVudGl0eSAjIFwiICsgYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsLnRhc2tEYXRhLmJlX2lkLCBcIkZhaWxlZCB0byBnZXQgUG9zdCBFeGVjdXRpb24gUHJvY2Vzc2VzXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTsgXG4gICAgICAgIFxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogXCJFXCIsXG4gICAgICAgIHRlbXBsYXRlVXJsOiB0ZW1wbGF0ZSxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGNvbnRlbnQ6ICc9JyxcbiAgICAgICAgICAgIGRpc2FibGVDaGFuZ2U6ICc9JyxcbiAgICAgICAgICAgIGZvcm06ICc9JyxcbiAgICAgICAgICAgIGRpc2FibGVkOiAnPScsXG4gICAgICAgICAgICBzb3VyY2VFbnZPd25lcjogJz0nLFxuICAgICAgICAgICAgdGFyZ2V0RW52T3duZXI6ICc9JyxcbiAgICAgICAgICAgIGJhY2s6ICc9JyxcbiAgICAgICAgICAgIGdldFN1YlRpdGxlOiAnPScsXG4gICAgICAgICAgICBhbGxvd2VkRW50aXR5VmVyc2lvbmluZzogJz0nLFxuICAgICAgICAgICAgYWxsb3dlZFJvbGVEYXRhOiAnPScsXG4gICAgICAgICAgICBhbGxvd2VkUm9sZURhdGFTb3VyY2U6ICc9JyxcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlcjogY29udHJvbGxlcixcbiAgICAgICAgY29udHJvbGxlckFzOiAnYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnNDdHJsJ1xuICAgIH07XG59XG5cblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ1RETS1GRScpXG4gICAgLmRpcmVjdGl2ZSgnYWRkaXRpb25hbEV4ZWN1dGlvblBhcmFtZXRlcnMnLCBhZGRpdGlvbmFsRXhlY3V0aW9uUGFyYW1ldGVycyk7Il19
