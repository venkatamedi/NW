function requestedEntities(){return{restrict:"E",templateUrl:"js/components/task/tabs/requestedEntities/requestedEntities.html",scope:{content:"=",disabled:"=",form:"=",sourceEnvOwner:"=",targetEnvOwner:"=",back:"=",getSubTitle:"=",maxToCopy:"=",userRole:"="},controller:function($scope,TDMService,toastr,$timeout,AuthService,$state,DTOptionsBuilder,DTColumnBuilder,$q,$compile){var requestedEntitiesCtrl=this;requestedEntitiesCtrl.taskData=$scope.content,requestedEntitiesCtrl.subTitle=$scope.getSubTitle();var userRole=AuthService.getRole();requestedEntitiesCtrl.userRoleType=userRole.type,requestedEntitiesCtrl.entitiesPattern=new RegExp("^((\\s*.\\s*|-)+(?:,(\\s*.\\s*|-)+){0,"+(($scope.maxToCopy||1e9)-1)+"})?$"),requestedEntitiesCtrl.syntheticPattern="^[a-zA-Z0-9._-]+$",TDMService.getDateTimeFormat().then(data=>{requestedEntitiesCtrl.dateFormats=data}),requestedEntitiesCtrl.versionForLoadTo=new Date,requestedEntitiesCtrl.versionForLoadFrom=new Date,requestedEntitiesCtrl.versionForLoadFrom.setDate(requestedEntitiesCtrl.versionForLoadFrom.getDate()-30),requestedEntitiesCtrl.prepareParametersData=()=>{try{requestedEntitiesCtrl.filter=JSON.parse(requestedEntitiesCtrl.taskData.parameters)}catch(err){console.error(err.message)}finally{requestedEntitiesCtrl.filter?requestedEntitiesCtrl.filter.group||(requestedEntitiesCtrl.filter.group={rules:[]}):requestedEntitiesCtrl.filter={group:{rules:[]}}}};const rootLUs=requestedEntitiesCtrl.taskData.selectedLogicalUnits.filter(lu=>{const luOrig=(requestedEntitiesCtrl.taskData.allLogicalUnits||[]).find(it=>it.lu_name===lu.lu_name);return!(!luOrig||luOrig.lu_parent_name)});function buildSubQuery(rule){var field='"'+rule.field+'"';let condition=rule.condition;var data="'"+rule.data+"'";return"number"==rule.type&&(field+="::numeric[] ",data=rule.data),"Is null"===rule.condition||"Is not null"===rule.condition?"( "+field+" "+condition+" )":"( "+data+" "+condition+" ANY("+field+") )"}function computed(group){if(!group)return"";for(var str="(",i=0;i<group.rules.length;i++)if(group.rules[i].group)i==group.rules.length-1?str+=computed(group.rules[i].group):str+=computed(group.rules[i].group)+" "+group.rules[i].group.operator+" ";else{var data;if(void 0===group.rules[i].data&&"Is null"!=group.rules[i].condition&&"Is not null"!=group.rules[i].condition)return;if("real"==group.rules[i].type)data=group.rules[i].data.toLocaleString().indexOf(".")<=0?group.rules[i].data.toFixed(1):group.rules[i].data;else if("integer"==group.rules[i].type)data=Math.floor(group.rules[i].data);else if("combo"==group.rules[i].type){if(group.rules[i].validValues.indexOf(group.rules[i].data)<0&&"Is null"!=group.rules[i].condition&&"Is not null"!=group.rules[i].condition)return;data=group.rules[i].data}else data=group.rules[i].data;null==data&&(data=""),i==group.rules.length-1?str+=buildSubQuery(group.rules[i]):(str+=buildSubQuery(group.rules[i]),str+=" "+group.rules[i].operator+" ")}return str+")"}TDMService.getCustomLogicFlows(rootLUs.map(it=>it.lu_name)).then(response=>{requestedEntitiesCtrl.customLogicFlows=(response.result||[]).map(flow=>(flow.newFlowName=`${flow.luName}#${flow.flowName}`,flow)),"C"===requestedEntitiesCtrl.taskData.selection_method&&requestedEntitiesCtrl.taskData.selection_param_value&&requestedEntitiesCtrl.customLogicChange()}),requestedEntitiesCtrl.customLogicChange=()=>{if(requestedEntitiesCtrl.taskData.selection_param_value){const chosenFlow=requestedEntitiesCtrl.customLogicFlows.find(it=>it.newFlowName===requestedEntitiesCtrl.taskData.selection_param_value);chosenFlow&&(requestedEntitiesCtrl.flowDesc=chosenFlow.Description,TDMService.getCustomLogicParams(chosenFlow.luName,chosenFlow.flowName).then(response=>{if(requestedEntitiesCtrl.taskData.CustomLogicParams=response.result||[],requestedEntitiesCtrl.taskData.CustomLogicParams=requestedEntitiesCtrl.taskData.CustomLogicParams.map(it=>(it.displayName=it.name.replace("_"," "),it)),requestedEntitiesCtrl.taskData.parameters)try{const params=JSON.parse(requestedEntitiesCtrl.taskData.parameters);params&&params.inputs&&requestedEntitiesCtrl.taskData.CustomLogicParams.forEach(customParam=>{const param=params.inputs.find(it=>it.name===customParam.name);param&&(customParam.value=param.value)})}catch(err){console.log(err)}}))}},requestedEntitiesCtrl.updateParams=()=>{"LOAD"===requestedEntitiesCtrl.taskData.task_type&&requestedEntitiesCtrl.taskData.load_entity&&TDMService.getGenericAPI("businessentity/"+requestedEntitiesCtrl.taskData.be_id+"/sourceEnv/"+requestedEntitiesCtrl.taskData.source_env_name+"/parameters").then((function(response){if("SUCCESS"==response.errorCode){requestedEntitiesCtrl.parameters=response.result;Object.keys(requestedEntitiesCtrl.parameters);_.map(requestedEntitiesCtrl.taskData.selectedLogicalUnits,(function(lu){return lu.lu_name.toLowerCase()}));requestedEntitiesCtrl.parameters=_.map(requestedEntitiesCtrl.parameters,(function(value,key){return{param_name:key,name:value.PARAM_NAME,param_type:value.PARAM_TYPE,COMBO_INDICATOR:value.COMBO_INDICATOR,valid_values:value.VALID_VALUES,min_value:"number"==value.PARAM_TYPE?parseFloat(value.MIN_VALUE):0,max_value:"number"==value.PARAM_TYPE?parseFloat(value.MAX_VALUE):0}}))}else toastr.error("Business entity # "+requestedEntitiesCtrl.taskData.be_id,"Failed to get business entity parameters")}))},requestedEntitiesCtrl.updateParams(),requestedEntitiesCtrl.parametersRandomChange=()=>{requestedEntitiesCtrl.parametersRandom?requestedEntitiesCtrl.taskData.selection_method="PR":requestedEntitiesCtrl.taskData.selection_method="P"},requestedEntitiesCtrl.parametersCount=0,$scope.getEntitesCount=function(force){if("()"!=requestedEntitiesCtrl.taskData.selection_param_value)if(requestedEntitiesCtrl.taskData.selection_param_value){if(force||requestedEntitiesCtrl.taskData.selection_param_value!==requestedEntitiesCtrl.perviousQueryParams){requestedEntitiesCtrl.parametersError=!1;requestedEntitiesCtrl.taskData.selection_param_value,requestedEntitiesCtrl.taskData.environment_id,requestedEntitiesCtrl.taskData.be_id;requestedEntitiesCtrl.taskData.source_env_name&&(requestedEntitiesCtrl.parametersCount="inprogress",TDMService.postGenericAPI("businessentity/"+requestedEntitiesCtrl.taskData.be_id+"/sourceEnv/"+requestedEntitiesCtrl.taskData.source_env_name+"/analysiscount",{where:requestedEntitiesCtrl.taskData.selection_param_value,tar_env_name:requestedEntitiesCtrl.taskData.environment_name,filterout_reserved:requestedEntitiesCtrl.taskData.filterout_reserved}).then((function(response){"SUCCESS"==response.errorCode?requestedEntitiesCtrl.parametersCount=response.result:requestedEntitiesCtrl.parametersCount=0})))}}else requestedEntitiesCtrl.parametersCount=0;else requestedEntitiesCtrl.parametersCount=0},$scope.$watch("requestedEntitiesCtrl.filter",(function(newValue){requestedEntitiesCtrl.analysisCountTimeout&&$timeout.cancel(requestedEntitiesCtrl.analysisCountTimeout),requestedEntitiesCtrl.analysisCountTimeout=$timeout((function(){if(requestedEntitiesCtrl.taskData.be_id){var checkGroup=function(group){if(""==group.operator)return!1;for(var i=0;i<group.rules.length;i++)if(0==((rule=group.rules[i]).group?checkGroup(rule.group):""!==rule.condition&&""!==rule.data&&""!==rule.field))return!1;var rule;return!0};if(newValue&&1==checkGroup(newValue.group)){requestedEntitiesCtrl.taskData.parameters=JSON.stringify(newValue);var query={query:computed(newValue.group)};requestedEntitiesCtrl.taskData.selection_param_value=query.query}$scope.getEntitesCount()}}),500)}),!0),requestedEntitiesCtrl.selectionMethodChange=()=>{"LOAD"!=requestedEntitiesCtrl.taskData.task_type||!requestedEntitiesCtrl.taskData.version_ind||"L"!==requestedEntitiesCtrl.taskData.selection_method&&"ALL"!==requestedEntitiesCtrl.taskData.selection_method||requestedEntitiesCtrl.getVersionsForLoad()},requestedEntitiesCtrl.entitiesListChange=function(){requestedEntitiesCtrl.entitiesListChangeTimeout&&$timeout.cancel(requestedEntitiesCtrl.entitiesListChangeTimeout),"LOAD"==requestedEntitiesCtrl.taskData.task_type&&requestedEntitiesCtrl.taskData.version_ind&&"ALL"!==requestedEntitiesCtrl.taskData.selection_method&&(requestedEntitiesCtrl.entitiesListChangeTimeout=$timeout((function(){requestedEntitiesCtrl.getVersionsForLoad()}),1e3))},requestedEntitiesCtrl.toggleVersion=function(task_execution_id){requestedEntitiesCtrl.versionsToggle[task_execution_id]=!requestedEntitiesCtrl.versionsToggle[task_execution_id],requestedEntitiesCtrl.dtInstanceVersions&&requestedEntitiesCtrl.dtInstanceVersions.reloadData&&requestedEntitiesCtrl.dtInstanceVersions.reloadData((function(){}))},requestedEntitiesCtrl.getVersionsForLoad=function(){var entitiesPassed=!0;"ALL"!==requestedEntitiesCtrl.taskData.selection_method&&requestedEntitiesCtrl.taskData.selection_param_value&&$scope.maxToCopy&&(entitiesPassed=new RegExp("^((.*|-)+(?:,(.*|-)+){0,"+(($scope.maxToCopy||1e9)-1)+"})?$").test(requestedEntitiesCtrl.taskData.selection_param_value),requestedEntitiesCtrl.enititesListFailedPatternTest=!1);if(requestedEntitiesCtrl.versionForLoadFrom&&requestedEntitiesCtrl.versionForLoadTo&&requestedEntitiesCtrl.taskData.selectedLogicalUnits&&requestedEntitiesCtrl.taskData.source_env_name&&("ALL"===requestedEntitiesCtrl.taskData.selection_method||requestedEntitiesCtrl.taskData.selection_param_value&&entitiesPassed)){requestedEntitiesCtrl.loadingTableVersions=!0;var from=new Date(requestedEntitiesCtrl.versionForLoadFrom);from.setHours(0),from.setMinutes(0),from.setSeconds(0);var to=new Date(requestedEntitiesCtrl.versionForLoadTo);to.setHours(23),to.setMinutes(59),to.setSeconds(59),TDMService.postGenericAPI("tasks/versionsForLoad",{fromDate:from,toDate:to,entitiesList:"ALL"===requestedEntitiesCtrl.taskData.selection_method?"":requestedEntitiesCtrl.taskData.selection_param_value.toString(),lu_list:requestedEntitiesCtrl.taskData.selectedLogicalUnits,source_env_name:requestedEntitiesCtrl.taskData.source_env_name,target_env_name:requestedEntitiesCtrl.taskData.environment_name,be_id:requestedEntitiesCtrl.taskData.be_id}).then((function(response){if("SUCCESS"==response.errorCode){(data=>{var executionIdsSet=new Set;for(item of data)executionIdsSet.has(item.task_execution_id)||"Y"!=item.root_indicator||(item.root_indicator="YY",executionIdsSet.add(item.task_execution_id))})(response.result.ListOfVersions),requestedEntitiesCtrl.taskData.versionsForLoad=_.map(response.result.ListOfVersions,version=>(version.execution_note=version.execution_note||"",version)),requestedEntitiesCtrl.taskData.versionsForLoad=_.sortBy(requestedEntitiesCtrl.taskData.versionsForLoad,version=>-1*new Date(version.version_datetime)),$timeout((function(){requestedEntitiesCtrl.dtInstanceVersions&&requestedEntitiesCtrl.dtInstanceVersions.reloadData&&requestedEntitiesCtrl.dtInstanceVersions.reloadData((function(){}))}),100),requestedEntitiesCtrl.loadingTableVersions=!1}else toastr.error("New Task # Failed to get Versions for Load")}))}else requestedEntitiesCtrl.taskData.selection_param_value||"ALL"===requestedEntitiesCtrl.taskData.selection_method?entitiesPassed||(requestedEntitiesCtrl.enititesListFailedPatternTest=!0):(requestedEntitiesCtrl.taskData.versionsForLoad=[],requestedEntitiesCtrl.dtInstanceVersions&&requestedEntitiesCtrl.dtInstanceVersions.reloadData&&requestedEntitiesCtrl.dtInstanceVersions.reloadData((function(){})))},$scope.$watch("requestedEntitiesCtrl.taskData.selection_method",(newValue,oldValue)=>{newValue!==oldValue&&(newValue||"").charAt(0)!==(oldValue||"").charAt(0)&&(requestedEntitiesCtrl.taskData.selection_param_value="")}),requestedEntitiesCtrl.versionsToggle={},requestedEntitiesCtrl.taskData.versionsForLoad=[],requestedEntitiesCtrl.dtInstanceVersions={},requestedEntitiesCtrl.dtColumnsVersions=[],requestedEntitiesCtrl.dtColumnDefsVersions=[],requestedEntitiesCtrl.headersVersions=[{column:"collapse",name:"",clickAble:!1},{column:"actions",name:"",clickAble:!1},{column:"version_name",name:"Version Name",clickAble:!0},{column:"task_id",name:"Task Id",clickAble:!1},{column:"task_execution_id",name:"Task Execution Id",clickAble:!1},{column:"version_no",name:"Version Number",clickAble:!1},{column:"execution_note",name:"Exection Note",clickAble:!1},{column:"task_last_updated_by",name:"Last Updated By",clickAble:!1},{column:"version_type",name:"Version Type",clickAble:!1},{column:"version_datetime",name:"Date Time",type:"date",clickAble:!1},{column:"lu_name",name:"Logical Unit Name",clickAble:!1},{column:"number_of_extracted_entities",name:"Number of Processed Entities",clickAble:!1},{column:"num_of_succeeded_entities",name:"Number of Succeeded Entities",clickAble:!1},{column:"num_of_failed_entities",name:"Number of Failed Entities",clickAble:!1},{column:"rootIndicator",name:"Root LU",clickAble:!1}];for(var changeToLocalDate=function(data,type,full,meta){return moment(data).format("DD MMM YYYY, HH:mm")},renderSelectionColumn=function(data,type,full,meta){return full.isRoot?'<input type="radio" ng-value="\''+full.fabric_execution_id+'\'" name="versionsTableSelection" ng-model="requestedEntitiesCtrl.taskData.selectedVersionToLoad">':""},renderCollapseColumn=function(data,type,full,meta){return full.isRoot?'<a class="toggleVersions '+(requestedEntitiesCtrl.versionsToggle[full.task_execution_id]?"active":"")+'" ng-click="requestedEntitiesCtrl.toggleVersion('+full.task_execution_id+')"><i class="fa arrow"></i> </a>':""},i=0;i<requestedEntitiesCtrl.headersVersions.length;i++)"actions"==requestedEntitiesCtrl.headersVersions[i].column?requestedEntitiesCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(requestedEntitiesCtrl.headersVersions[i].column).withTitle(requestedEntitiesCtrl.headersVersions[i].name).renderWith(renderSelectionColumn).notSortable()):"collapse"==requestedEntitiesCtrl.headersVersions[i].column?requestedEntitiesCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(requestedEntitiesCtrl.headersVersions[i].column).withTitle(requestedEntitiesCtrl.headersVersions[i].name).renderWith(renderCollapseColumn).notSortable()):"date"==requestedEntitiesCtrl.headersVersions[i].type?requestedEntitiesCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(requestedEntitiesCtrl.headersVersions[i].column).withTitle(requestedEntitiesCtrl.headersVersions[i].name).renderWith(changeToLocalDate).notSortable()):"task_id"==requestedEntitiesCtrl.headersVersions[i].column||"version_name"==requestedEntitiesCtrl.headersVersions[i].column?requestedEntitiesCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(requestedEntitiesCtrl.headersVersions[i].column).withTitle(requestedEntitiesCtrl.headersVersions[i].name).notSortable()):"rootIndicator"==requestedEntitiesCtrl.headersVersions[i].column?requestedEntitiesCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(requestedEntitiesCtrl.headersVersions[i].column).withTitle(requestedEntitiesCtrl.headersVersions[i].name).notSortable().notVisible()):requestedEntitiesCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(requestedEntitiesCtrl.headersVersions[i].column).withTitle(requestedEntitiesCtrl.headersVersions[i].name).notSortable());requestedEntitiesCtrl.dtOptionsVersions=DTOptionsBuilder.fromFnPromise((function(){return function(){var deferred=$q.defer(),versionsForLoad=[];requestedEntitiesCtrl.groupedSelections=new Set,requestedEntitiesCtrl.taskData.selectedLogicalUnits.forEach(lu=>{const luTemp=_.find(requestedEntitiesCtrl.taskData.allLogicalUnits,{lu_name:lu.lu_name});lu.lu_parent_name=luTemp.lu_parent_name});var selectedVersion,rootLUs=_.filter(requestedEntitiesCtrl.taskData.selectedLogicalUnits,{lu_parent_name:null});(requestedEntitiesCtrl.taskData.versionsForLoad.forEach((function(versionForLoad){if(_.find(rootLUs,{lu_name:versionForLoad.lu_name})?versionForLoad.rootIndicator=!0:versionForLoad.rootIndicator=!1,versionForLoad.rootIndicator&&_.findIndex(versionsForLoad,{task_execution_id:versionForLoad.task_execution_id,isRoot:!0})<0)return versionForLoad.isRoot=!0,versionForLoad.rootIndicator=!0,void versionsForLoad.push(versionForLoad);requestedEntitiesCtrl.versionsToggle[versionForLoad.task_execution_id]&&(versionForLoad.isRoot=!1,versionsForLoad.push(versionForLoad))})),!requestedEntitiesCtrl.selectedVersionToLoad&&requestedEntitiesCtrl.taskData.selected_version_task_exe_id)&&((selectedVersion=_.find(requestedEntitiesCtrl.taskData.versionsForLoad,{rootIndicator:!0,task_execution_id:requestedEntitiesCtrl.taskData.selected_version_task_exe_id}))&&(requestedEntitiesCtrl.selectedVersionToLoad=selectedVersion.fabric_execution_id));(console.log(versionsForLoad),deferred.resolve(versionsForLoad),!requestedEntitiesCtrl.taskData.selectedVersionToLoad&&requestedEntitiesCtrl.taskData.selected_version_task_exe_id)&&((selectedVersion=_.find(requestedEntitiesCtrl.taskData.versionsForLoad,{rootIndicator:!0,task_execution_id:requestedEntitiesCtrl.taskData.selected_version_task_exe_id}))&&(requestedEntitiesCtrl.taskData.selectedVersionToLoad=selectedVersion.fabric_execution_id));return deferred.promise}()})).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("scrollX",!1).withOption("lengthChange",!1).withOption("paging",!1).withButtons([]).withOption("caseInsensitive",!0).withOption("order",[[9,"desc"],[14,"desc"]]).withOption("search",{caseInsensitive:!1}),requestedEntitiesCtrl.dtOptionsVersions.withLightColumnFilter({2:{type:"text"},3:{type:"text"},4:{type:"text"},5:{type:"text"},6:{type:"text"},7:{type:"text"},8:{type:"text"},9:{type:"text"},10:{type:"text"},11:{type:"text"},12:{type:"text"},13:{type:"text"}}),requestedEntitiesCtrl.parametersRandom=!1,requestedEntitiesCtrl.taskData.task_id?"P"===requestedEntitiesCtrl.taskData.selection_method||"PR"===requestedEntitiesCtrl.taskData.selection_method&&(requestedEntitiesCtrl.parametersRandom=!0):requestedEntitiesCtrl.taskData.selection_method||(requestedEntitiesCtrl.taskData.selection_method="L")},controllerAs:"requestedEntitiesCtrl"}}angular.module("TDM-FE").directive("requestedEntities",requestedEntities);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvdGFzay90YWJzL3JlcXVlc3RlZEVudGl0aWVzL3JlcXVlc3RlZEVudGl0aWVzLmpzIl0sIm5hbWVzIjpbInJlcXVlc3RlZEVudGl0aWVzIiwicmVzdHJpY3QiLCJ0ZW1wbGF0ZVVybCIsInNjb3BlIiwiY29udGVudCIsImRpc2FibGVkIiwiZm9ybSIsInNvdXJjZUVudk93bmVyIiwidGFyZ2V0RW52T3duZXIiLCJiYWNrIiwiZ2V0U3ViVGl0bGUiLCJtYXhUb0NvcHkiLCJ1c2VyUm9sZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJURE1TZXJ2aWNlIiwidG9hc3RyIiwiJHRpbWVvdXQiLCJBdXRoU2VydmljZSIsIiRzdGF0ZSIsIkRUT3B0aW9uc0J1aWxkZXIiLCJEVENvbHVtbkJ1aWxkZXIiLCIkcSIsIiRjb21waWxlIiwicmVxdWVzdGVkRW50aXRpZXNDdHJsIiwidGhpcyIsInRhc2tEYXRhIiwic3ViVGl0bGUiLCJnZXRSb2xlIiwidXNlclJvbGVUeXBlIiwidHlwZSIsImVudGl0aWVzUGF0dGVybiIsIlJlZ0V4cCIsInN5bnRoZXRpY1BhdHRlcm4iLCJnZXREYXRlVGltZUZvcm1hdCIsInRoZW4iLCJkYXRhIiwiZGF0ZUZvcm1hdHMiLCJ2ZXJzaW9uRm9yTG9hZFRvIiwiRGF0ZSIsInZlcnNpb25Gb3JMb2FkRnJvbSIsInNldERhdGUiLCJnZXREYXRlIiwicHJlcGFyZVBhcmFtZXRlcnNEYXRhIiwiZmlsdGVyIiwiSlNPTiIsInBhcnNlIiwicGFyYW1ldGVycyIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJncm91cCIsInJ1bGVzIiwicm9vdExVcyIsInNlbGVjdGVkTG9naWNhbFVuaXRzIiwibHUiLCJsdU9yaWciLCJhbGxMb2dpY2FsVW5pdHMiLCJmaW5kIiwiaXQiLCJsdV9uYW1lIiwibHVfcGFyZW50X25hbWUiLCJidWlsZFN1YlF1ZXJ5IiwicnVsZSIsImZpZWxkIiwiY29uZGl0aW9uIiwiY29tcHV0ZWQiLCJzdHIiLCJpIiwibGVuZ3RoIiwib3BlcmF0b3IiLCJ1bmRlZmluZWQiLCJ0b0xvY2FsZVN0cmluZyIsImluZGV4T2YiLCJ0b0ZpeGVkIiwiTWF0aCIsImZsb29yIiwidmFsaWRWYWx1ZXMiLCJnZXRDdXN0b21Mb2dpY0Zsb3dzIiwibWFwIiwicmVzcG9uc2UiLCJjdXN0b21Mb2dpY0Zsb3dzIiwicmVzdWx0IiwiZmxvdyIsIm5ld0Zsb3dOYW1lIiwibHVOYW1lIiwiZmxvd05hbWUiLCJzZWxlY3Rpb25fbWV0aG9kIiwic2VsZWN0aW9uX3BhcmFtX3ZhbHVlIiwiY3VzdG9tTG9naWNDaGFuZ2UiLCJjaG9zZW5GbG93IiwiZmxvd0Rlc2MiLCJEZXNjcmlwdGlvbiIsImdldEN1c3RvbUxvZ2ljUGFyYW1zIiwiQ3VzdG9tTG9naWNQYXJhbXMiLCJkaXNwbGF5TmFtZSIsIm5hbWUiLCJyZXBsYWNlIiwicGFyYW1zIiwiaW5wdXRzIiwiZm9yRWFjaCIsImN1c3RvbVBhcmFtIiwicGFyYW0iLCJ2YWx1ZSIsImxvZyIsInVwZGF0ZVBhcmFtcyIsInRhc2tfdHlwZSIsImxvYWRfZW50aXR5IiwiZ2V0R2VuZXJpY0FQSSIsImJlX2lkIiwic291cmNlX2Vudl9uYW1lIiwiZXJyb3JDb2RlIiwiT2JqZWN0Iiwia2V5cyIsIl8iLCJ0b0xvd2VyQ2FzZSIsImtleSIsInBhcmFtX25hbWUiLCJQQVJBTV9OQU1FIiwicGFyYW1fdHlwZSIsIlBBUkFNX1RZUEUiLCJDT01CT19JTkRJQ0FUT1IiLCJ2YWxpZF92YWx1ZXMiLCJtaW5fdmFsdWUiLCJwYXJzZUZsb2F0IiwibWF4X3ZhbHVlIiwicGFyYW1ldGVyc1JhbmRvbUNoYW5nZSIsInBhcmFtZXRlcnNSYW5kb20iLCJwYXJhbWV0ZXJzQ291bnQiLCJnZXRFbnRpdGVzQ291bnQiLCJmb3JjZSIsInBlcnZpb3VzUXVlcnlQYXJhbXMiLCJwYXJhbWV0ZXJzRXJyb3IiLCJlbnZpcm9ubWVudF9pZCIsInBvc3RHZW5lcmljQVBJIiwid2hlcmUiLCJ0YXJfZW52X25hbWUiLCJlbnZpcm9ubWVudF9uYW1lIiwiZmlsdGVyb3V0X3Jlc2VydmVkIiwiJHdhdGNoIiwibmV3VmFsdWUiLCJhbmFseXNpc0NvdW50VGltZW91dCIsImNhbmNlbCIsImNoZWNrR3JvdXAiLCJzdHJpbmdpZnkiLCJxdWVyeSIsInNlbGVjdGlvbk1ldGhvZENoYW5nZSIsInZlcnNpb25faW5kIiwiZ2V0VmVyc2lvbnNGb3JMb2FkIiwiZW50aXRpZXNMaXN0Q2hhbmdlIiwiZW50aXRpZXNMaXN0Q2hhbmdlVGltZW91dCIsInRvZ2dsZVZlcnNpb24iLCJ0YXNrX2V4ZWN1dGlvbl9pZCIsInZlcnNpb25zVG9nZ2xlIiwiZHRJbnN0YW5jZVZlcnNpb25zIiwicmVsb2FkRGF0YSIsImVudGl0aWVzUGFzc2VkIiwidGVzdCIsImVuaXRpdGVzTGlzdEZhaWxlZFBhdHRlcm5UZXN0IiwibG9hZGluZ1RhYmxlVmVyc2lvbnMiLCJmcm9tIiwic2V0SG91cnMiLCJzZXRNaW51dGVzIiwic2V0U2Vjb25kcyIsInRvIiwiZnJvbURhdGUiLCJ0b0RhdGUiLCJlbnRpdGllc0xpc3QiLCJ0b1N0cmluZyIsImx1X2xpc3QiLCJ0YXJnZXRfZW52X25hbWUiLCJleGVjdXRpb25JZHNTZXQiLCJTZXQiLCJpdGVtIiwiaGFzIiwicm9vdF9pbmRpY2F0b3IiLCJhZGQiLCJvdmVycmlkZVJvb3RJbmRpY2F0b3JzIiwiTGlzdE9mVmVyc2lvbnMiLCJ2ZXJzaW9uc0ZvckxvYWQiLCJ2ZXJzaW9uIiwiZXhlY3V0aW9uX25vdGUiLCJzb3J0QnkiLCJ2ZXJzaW9uX2RhdGV0aW1lIiwib2xkVmFsdWUiLCJjaGFyQXQiLCJkdENvbHVtbnNWZXJzaW9ucyIsImR0Q29sdW1uRGVmc1ZlcnNpb25zIiwiaGVhZGVyc1ZlcnNpb25zIiwiY29sdW1uIiwiY2xpY2tBYmxlIiwiY2hhbmdlVG9Mb2NhbERhdGUiLCJmdWxsIiwibWV0YSIsIm1vbWVudCIsImZvcm1hdCIsInJlbmRlclNlbGVjdGlvbkNvbHVtbiIsImlzUm9vdCIsImZhYnJpY19leGVjdXRpb25faWQiLCJyZW5kZXJDb2xsYXBzZUNvbHVtbiIsInB1c2giLCJuZXdDb2x1bW4iLCJ3aXRoVGl0bGUiLCJyZW5kZXJXaXRoIiwibm90U29ydGFibGUiLCJub3RWaXNpYmxlIiwiZHRPcHRpb25zVmVyc2lvbnMiLCJmcm9tRm5Qcm9taXNlIiwiZGVmZXJyZWQiLCJkZWZlciIsImdyb3VwZWRTZWxlY3Rpb25zIiwibHVUZW1wIiwic2VsZWN0ZWRWZXJzaW9uIiwidmVyc2lvbkZvckxvYWQiLCJyb290SW5kaWNhdG9yIiwiZmluZEluZGV4Iiwic2VsZWN0ZWRWZXJzaW9uVG9Mb2FkIiwic2VsZWN0ZWRfdmVyc2lvbl90YXNrX2V4ZV9pZCIsInJlc29sdmUiLCJwcm9taXNlIiwiZ2V0VGFibGVEYXRhVmVyc2lvbnMiLCJ3aXRoRE9NIiwid2l0aE9wdGlvbiIsInJvdyIsImFuZ3VsYXIiLCJlbGVtZW50IiwiY29udGVudHMiLCJ3aXRoQnV0dG9ucyIsImNhc2VJbnNlbnNpdGl2ZSIsIndpdGhMaWdodENvbHVtbkZpbHRlciIsIjIiLCIzIiwiNCIsIjUiLCI2IiwiNyIsIjgiLCI5IiwiMTAiLCIxMSIsIjEyIiwiMTMiLCJ0YXNrX2lkIiwiY29udHJvbGxlckFzIiwibW9kdWxlIiwiZGlyZWN0aXZlIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxvQkFxbkJMLE1BQU8sQ0FDSEMsU0FBVSxJQUNWQyxZQXJuQlcsbUVBc25CWEMsTUFBTyxDQUNIQyxRQUFTLElBQ1RDLFNBQVUsSUFDVkMsS0FBTSxJQUNOQyxlQUFnQixJQUNoQkMsZUFBZ0IsSUFDaEJDLEtBQU0sSUFDTkMsWUFBYSxJQUNiQyxVQUFXLElBQ1hDLFNBQVUsS0FFZEMsV0EvbkJhLFNBQVVDLE9BQVFDLFdBQVlDLE9BQVFDLFNBQVVDLFlBQWFDLE9BQVFDLGlCQUFrQkMsZ0JBQWlCQyxHQUFJQyxVQUN6SCxJQUFJQyxzQkFBd0JDLEtBQzVCRCxzQkFBc0JFLFNBQVdaLE9BQU9WLFFBQ3hDb0Isc0JBQXNCRyxTQUFXYixPQUFPSixjQUV4QyxJQUFJRSxT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S0FBTSxRQUVWME0sRUFBRyxDQUNDMU0sS0FBTSxRQUVWMk0sRUFBRyxDQUNDM00sS0FBTSxRQUVWNE0sRUFBRyxDQUNDNU0sS0FBTSxRQUVWNk0sRUFBRyxDQUNDN00sS0FBTSxRQUVWOE0sRUFBRyxDQUNDOU0sS0FBTSxRQUVWK00sRUFBRyxDQUNDL00sS0FBTSxRQUVWZ04sRUFBRyxDQUNDaE4sS0FBTSxRQUVWaU4sR0FBSSxDQUNBak4sS0FBTSxRQUVWa04sR0FBSSxDQUNBbE4sS0FBTSxRQUVWbU4sR0FBSSxDQUNBbk4sS0FBTSxRQUVWb04sR0FBSSxDQUNBcE4sS0FBTSxVQUlkTixzQkFBc0J3RyxrQkFBbUIsRUFDckN4RyxzQkFBc0JFLFNBQVN5TixRQUN5QixNQUFwRDNOLHNCQUFzQkUsU0FBUzhELGtCQUUwQixPQUFwRGhFLHNCQUFzQkUsU0FBUzhELG1CQUNwQ2hFLHNCQUFzQndHLGtCQUFtQixHQUl4Q3hHLHNCQUFzQkUsU0FBUzhELG1CQUNoQ2hFLHNCQUFzQkUsU0FBUzhELGlCQUFtQixNQW9CMUQ0SixhQUFjLHlCQUt0Qm5CLFFBQ0tvQixPQUFPLFVBQ1BDLFVBQVUsb0JBQXFCdFAiLCJmaWxlIjoiY29tcG9uZW50cy90YXNrL3RhYnMvcmVxdWVzdGVkRW50aXRpZXMvcmVxdWVzdGVkRW50aXRpZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiByZXF1ZXN0ZWRFbnRpdGllcygpIHtcblxuICAgIHZhciB0ZW1wbGF0ZSA9IFwianMvY29tcG9uZW50cy90YXNrL3RhYnMvcmVxdWVzdGVkRW50aXRpZXMvcmVxdWVzdGVkRW50aXRpZXMuaHRtbFwiO1xuXG4gICAgdmFyIGNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoJHNjb3BlLCBURE1TZXJ2aWNlLCB0b2FzdHIsICR0aW1lb3V0LCBBdXRoU2VydmljZSwgJHN0YXRlLCBEVE9wdGlvbnNCdWlsZGVyLCBEVENvbHVtbkJ1aWxkZXIsICRxLCAkY29tcGlsZSkge1xuICAgICAgICB2YXIgcmVxdWVzdGVkRW50aXRpZXNDdHJsID0gdGhpcztcbiAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhID0gJHNjb3BlLmNvbnRlbnQ7XG4gICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5zdWJUaXRsZSA9ICRzY29wZS5nZXRTdWJUaXRsZSgpO1xuXG4gICAgICAgIHZhciB1c2VyUm9sZSA9IEF1dGhTZXJ2aWNlLmdldFJvbGUoKTtcbiAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnVzZXJSb2xlVHlwZSA9IHVzZXJSb2xlLnR5cGU7XG4gICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5lbnRpdGllc1BhdHRlcm4gPSBuZXcgUmVnRXhwKFwiXigoXFxcXHMqLlxcXFxzKnwtKSsoPzosKFxcXFxzKi5cXFxccyp8LSkrKXswLFwiICsgKCgkc2NvcGUubWF4VG9Db3B5IHx8IDEwMDAwMDAwMDApIC0gMSkgKyBcIn0pPyRcIik7XG4gICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5zeW50aGV0aWNQYXR0ZXJuID0gXCJeW2EtekEtWjAtOS5fLV0rJFwiO1xuXG4gICAgICAgIFRETVNlcnZpY2UuZ2V0RGF0ZVRpbWVGb3JtYXQoKS50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmRhdGVGb3JtYXRzID0gZGF0YTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnZlcnNpb25Gb3JMb2FkVG8gPSBuZXcgRGF0ZSgpO1xuICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudmVyc2lvbkZvckxvYWRGcm9tID0gbmV3IERhdGUoKTtcbiAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnZlcnNpb25Gb3JMb2FkRnJvbS5zZXREYXRlKHJlcXVlc3RlZEVudGl0aWVzQ3RybC52ZXJzaW9uRm9yTG9hZEZyb20uZ2V0RGF0ZSgpIC0gMzApO1xuICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwucHJlcGFyZVBhcmFtZXRlcnNEYXRhID0gKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZmlsdGVyID0gSlNPTi5wYXJzZShyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEucGFyYW1ldGVycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICBpZiAoIXJlcXVlc3RlZEVudGl0aWVzQ3RybC5maWx0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmZpbHRlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGVzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFyZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZmlsdGVyLmdyb3VwKXtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmZpbHRlci5ncm91cCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGVzIDogW11cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByb290TFVzID0gcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGVkTG9naWNhbFVuaXRzLmZpbHRlcihsdSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsdU9yaWcgPSAocmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLmFsbExvZ2ljYWxVbml0cyB8fCBbXSkuZmluZChpdCA9PiBpdC5sdV9uYW1lID09PSBsdS5sdV9uYW1lKTtcbiAgICAgICAgICAgIGlmIChsdU9yaWcgJiYgIWx1T3JpZy5sdV9wYXJlbnRfbmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIFRETVNlcnZpY2UuZ2V0Q3VzdG9tTG9naWNGbG93cyhcbiAgICAgICAgICAgIHJvb3RMVXMubWFwKGl0ID0+IGl0Lmx1X25hbWUpKS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuY3VzdG9tTG9naWNGbG93cyA9IChyZXNwb25zZS5yZXN1bHQgfHwgW10pLm1hcChmbG93ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZmxvdy5uZXdGbG93TmFtZSA9IGAke2Zsb3cubHVOYW1lfSMke2Zsb3cuZmxvd05hbWV9YDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZsb3c7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID09PSAnQycgJiYgXG4gICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9wYXJhbV92YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuY3VzdG9tTG9naWNDaGFuZ2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5jdXN0b21Mb2dpY0NoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX3BhcmFtX3ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hvc2VuRmxvdyA9IHJlcXVlc3RlZEVudGl0aWVzQ3RybC5jdXN0b21Mb2dpY0Zsb3dzLmZpbmQoaXQgPT4gaXQubmV3Rmxvd05hbWUgPT09IHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fcGFyYW1fdmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChjaG9zZW5GbG93KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5mbG93RGVzYyA9IGNob3NlbkZsb3cuRGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgICAgIFRETVNlcnZpY2UuZ2V0Q3VzdG9tTG9naWNQYXJhbXMoXG4gICAgICAgICAgICAgICAgICAgICAgICBjaG9zZW5GbG93Lmx1TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNob3NlbkZsb3cuZmxvd05hbWUpLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5DdXN0b21Mb2dpY1BhcmFtcyA9IHJlc3BvbnNlLnJlc3VsdCB8fCBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuQ3VzdG9tTG9naWNQYXJhbXMgPSByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuQ3VzdG9tTG9naWNQYXJhbXMubWFwKCBpdCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0LmRpc3BsYXlOYW1lID0gaXQubmFtZS5yZXBsYWNlKFwiX1wiLCBcIiBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IEpTT04ucGFyc2UocmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnBhcmFtZXRlcnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcyAmJiBwYXJhbXMuaW5wdXRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLkN1c3RvbUxvZ2ljUGFyYW1zLmZvckVhY2goY3VzdG9tUGFyYW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJhbSA9IHBhcmFtcy5pbnB1dHMuZmluZChpdCA9PiBpdC5uYW1lID09PSBjdXN0b21QYXJhbS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21QYXJhbS52YWx1ZSA9IHBhcmFtLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudXBkYXRlUGFyYW1zID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS50YXNrX3R5cGUgIT09ICdMT0FEJyB8fCAhcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLmxvYWRfZW50aXR5KXtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBURE1TZXJ2aWNlLmdldEdlbmVyaWNBUEkoJ2J1c2luZXNzZW50aXR5LycgKyByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuYmVfaWQgKyAnL3NvdXJjZUVudi8nICsgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNvdXJjZV9lbnZfbmFtZSArICcvcGFyYW1ldGVycycpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwucGFyYW1ldGVycyA9IHJlc3BvbnNlLnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFtZXRlcnNLZXlzID0gT2JqZWN0LmtleXMocmVxdWVzdGVkRW50aXRpZXNDdHJsLnBhcmFtZXRlcnMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hvc2VuTFVzID0gXy5tYXAocmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGVkTG9naWNhbFVuaXRzLGZ1bmN0aW9uKGx1KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsdS5sdV9uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnBhcmFtZXRlcnMgPSBfLm1hcChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwucGFyYW1ldGVycywgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1fbmFtZToga2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHZhbHVlLlBBUkFNX05BTUUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1fdHlwZTogdmFsdWUuUEFSQU1fVFlQRSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDT01CT19JTkRJQ0FUT1I6IHZhbHVlLkNPTUJPX0lORElDQVRPUixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZF92YWx1ZXM6IHZhbHVlWydWQUxJRF9WQUxVRVMnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5fdmFsdWU6IHZhbHVlLlBBUkFNX1RZUEUgPT0gJ251bWJlcicgPyBwYXJzZUZsb2F0KHZhbHVlWydNSU5fVkFMVUUnXSkgOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heF92YWx1ZTogdmFsdWUuUEFSQU1fVFlQRSA9PSAnbnVtYmVyJyA/IHBhcnNlRmxvYXQodmFsdWVbJ01BWF9WQUxVRSddKSA6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiQnVzaW5lc3MgZW50aXR5ICMgXCIgKyByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuYmVfaWQsIFwiRmFpbGVkIHRvIGdldCBidXNpbmVzcyBlbnRpdHkgcGFyYW1ldGVyc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudXBkYXRlUGFyYW1zKCk7XG5cblxuICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwucGFyYW1ldGVyc1JhbmRvbUNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwucGFyYW1ldGVyc1JhbmRvbSkge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID0gJ1BSJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID0gJ1AnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmdW5jdGlvbiBidWlsZFN1YlF1ZXJ5KHJ1bGUpIHtcbiAgICAgICAgICAgIHZhciBmaWVsZCA9IFwiXFxcIlwiICsgcnVsZS5maWVsZCArIFwiXFxcIlwiO1xuICAgICAgICAgICAgbGV0IGNvbmRpdGlvbiA9IHJ1bGUuY29uZGl0aW9uO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBcIidcIiArIHJ1bGUuZGF0YSArIFwiJ1wiO1xuICAgICAgICAgICAgaWYgKHJ1bGUudHlwZSA9PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgZmllbGQgPSBmaWVsZCArIFwiOjpudW1lcmljW10gXCI7XG4gICAgICAgICAgICAgICAgZGF0YSA9IHJ1bGUuZGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChydWxlLmNvbmRpdGlvbiA9PT0gJ0lzIG51bGwnIHx8IHJ1bGUuY29uZGl0aW9uID09PSAnSXMgbm90IG51bGwnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiKCBcIiArIGZpZWxkICsgXCIgXCIgKyBjb25kaXRpb24gKyBcIiApXCI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIiggXCIgKyBkYXRhICsgXCIgXCIgKyBjb25kaXRpb24gKyBcIiBBTlkoXCIgKyBmaWVsZCArIFwiKSApXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjb21wdXRlZChncm91cCkge1xuICAgICAgICAgICAgaWYgKCFncm91cCkgcmV0dXJuIFwiXCI7XG4gICAgICAgICAgICBmb3IgKHZhciBzdHIgPSBcIihcIiwgaSA9IDA7IGkgPCBncm91cC5ydWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChncm91cC5ydWxlc1tpXS5ncm91cCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSBncm91cC5ydWxlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gY29tcHV0ZWQoZ3JvdXAucnVsZXNbaV0uZ3JvdXApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IGNvbXB1dGVkKGdyb3VwLnJ1bGVzW2ldLmdyb3VwKSArIFwiIFwiICsgZ3JvdXAucnVsZXNbaV0uZ3JvdXAub3BlcmF0b3IgKyBcIiBcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXAucnVsZXNbaV0uZGF0YSA9PT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBncm91cC5ydWxlc1tpXS5jb25kaXRpb24gIT0gXCJJcyBudWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIGdyb3VwLnJ1bGVzW2ldLmNvbmRpdGlvbiAhPSBcIklzIG5vdCBudWxsXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXAucnVsZXNbaV0udHlwZSA9PSAncmVhbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncm91cC5ydWxlc1tpXS5kYXRhLnRvTG9jYWxlU3RyaW5nKCkuaW5kZXhPZignLicpIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gZ3JvdXAucnVsZXNbaV0uZGF0YS50b0ZpeGVkKDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gZ3JvdXAucnVsZXNbaV0uZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChncm91cC5ydWxlc1tpXS50eXBlID09ICdpbnRlZ2VyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IE1hdGguZmxvb3IoZ3JvdXAucnVsZXNbaV0uZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3JvdXAucnVsZXNbaV0udHlwZSA9PSAnY29tYm8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXAucnVsZXNbaV0udmFsaWRWYWx1ZXMuaW5kZXhPZihncm91cC5ydWxlc1tpXS5kYXRhKSA8IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBncm91cC5ydWxlc1tpXS5jb25kaXRpb24gIT0gXCJJcyBudWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBncm91cC5ydWxlc1tpXS5jb25kaXRpb24gIT0gXCJJcyBub3QgbnVsbFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGdyb3VwLnJ1bGVzW2ldLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gZ3JvdXAucnVsZXNbaV0uZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSBncm91cC5ydWxlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gYnVpbGRTdWJRdWVyeShncm91cC5ydWxlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gYnVpbGRTdWJRdWVyeShncm91cC5ydWxlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gXCIgXCIgKyBncm91cC5ydWxlc1tpXS5vcGVyYXRvciArIFwiIFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHN0ciArIFwiKVwiO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnBhcmFtZXRlcnNDb3VudCA9IDA7XG4gICAgICAgICRzY29wZS5nZXRFbnRpdGVzQ291bnQgPSBmdW5jdGlvbiAoZm9yY2UpIHtcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX3BhcmFtX3ZhbHVlID09IFwiKClcIikge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5wYXJhbWV0ZXJzQ291bnQgPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9wYXJhbV92YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5wYXJhbWV0ZXJzQ291bnQgPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZm9yY2UgJiYgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9wYXJhbV92YWx1ZSA9PT0gcmVxdWVzdGVkRW50aXRpZXNDdHJsLnBlcnZpb3VzUXVlcnlQYXJhbXMpe1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5wYXJhbWV0ZXJzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgIHF1ZXJ5OiByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX3BhcmFtX3ZhbHVlLFxuICAgICAgICAgICAgICAgIGVudklkOiByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuZW52aXJvbm1lbnRfaWQsXG4gICAgICAgICAgICAgICAgYmVJZDogcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLmJlX2lkXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zb3VyY2VfZW52X25hbWUpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwucGFyYW1ldGVyc0NvdW50ID0gXCJpbnByb2dyZXNzXCI7XG4gICAgICAgICAgICAgICAgVERNU2VydmljZS5wb3N0R2VuZXJpY0FQSSgnYnVzaW5lc3NlbnRpdHkvJyArIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5iZV9pZCArICcvc291cmNlRW52LycgKyByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc291cmNlX2Vudl9uYW1lICsgJy9hbmFseXNpc2NvdW50Jywge1xuICAgICAgICAgICAgICAgICAgICB3aGVyZTogcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9wYXJhbV92YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdGFyX2Vudl9uYW1lOiByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuZW52aXJvbm1lbnRfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyb3V0X3Jlc2VydmVkOiByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuZmlsdGVyb3V0X3Jlc2VydmVkLFxuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5wYXJhbWV0ZXJzQ291bnQgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwucGFyYW1ldGVyc0NvdW50ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICRzY29wZS4kd2F0Y2goJ3JlcXVlc3RlZEVudGl0aWVzQ3RybC5maWx0ZXInLCBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwuYW5hbHlzaXNDb3VudFRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICAkdGltZW91dC5jYW5jZWwocmVxdWVzdGVkRW50aXRpZXNDdHJsLmFuYWx5c2lzQ291bnRUaW1lb3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5hbmFseXNpc0NvdW50VGltZW91dCA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLmJlX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGVja1J1bGUgPSBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bGUuZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hlY2tHcm91cChydWxlLmdyb3VwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bGUuY29uZGl0aW9uID09PSBcIlwiIHx8IHJ1bGUuZGF0YSA9PT0gXCJcIiB8fCBydWxlLmZpZWxkID09PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGVja0dyb3VwID0gZnVuY3Rpb24gKGdyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXAub3BlcmF0b3IgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ3JvdXAucnVsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2tSdWxlKGdyb3VwLnJ1bGVzW2ldKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAmJiBjaGVja0dyb3VwKG5ld1ZhbHVlLmdyb3VwKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEucGFyYW1ldGVycyA9IEpTT04uc3RyaW5naWZ5KG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeTogY29tcHV0ZWQobmV3VmFsdWUuZ3JvdXApXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9wYXJhbV92YWx1ZSA9IHF1ZXJ5LnF1ZXJ5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRFbnRpdGVzQ291bnQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICB9LCB0cnVlKTtcblxuXG5cblxuICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuc2VsZWN0aW9uTWV0aG9kQ2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS50YXNrX3R5cGUgPT0gJ0xPQUQnICYmIFxuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCAmJiBcbiAgICAgICAgICAgICAgICAgICAgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID09PSAnTCcgfHwgXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID09PSAnQUxMJykpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZ2V0VmVyc2lvbnNGb3JMb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZW50aXRpZXNMaXN0Q2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5lbnRpdGllc0xpc3RDaGFuZ2VUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5lbnRpdGllc0xpc3RDaGFuZ2VUaW1lb3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEudGFza190eXBlID09ICdMT0FEJyAmJiByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQgJiYgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9tZXRob2QgIT09ICdBTEwnKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmVudGl0aWVzTGlzdENoYW5nZVRpbWVvdXQgPSAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5nZXRWZXJzaW9uc0ZvckxvYWQoKTtcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudG9nZ2xlVmVyc2lvbiA9IGZ1bmN0aW9uKHRhc2tfZXhlY3V0aW9uX2lkKSB7XG4gICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudmVyc2lvbnNUb2dnbGVbdGFza19leGVjdXRpb25faWRdID0gIXJlcXVlc3RlZEVudGl0aWVzQ3RybC52ZXJzaW9uc1RvZ2dsZVt0YXNrX2V4ZWN1dGlvbl9pZF07XG4gICAgICAgICAgICBpZiAocmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0SW5zdGFuY2VWZXJzaW9ucyAmJiByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5nZXRWZXJzaW9uc0ZvckxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZW50aXRpZXNQYXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kICE9PSAnQUxMJyAmJlxuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fcGFyYW1fdmFsdWUgJiYgJHNjb3BlLm1heFRvQ29weSkge1xuICAgICAgICAgICAgICAgIHZhciBlbnRpdGllc1BhdHRlcm4gPSBuZXcgUmVnRXhwKFwiXigoLip8LSkrKD86LCguKnwtKSspezAsXCIgKyAoKCRzY29wZS5tYXhUb0NvcHkgfHwgMTAwMDAwMDAwMCkgLSAxKSArIFwifSk/JFwiKTtcbiAgICAgICAgICAgICAgICBlbnRpdGllc1Bhc3NlZCA9IGVudGl0aWVzUGF0dGVybi50ZXN0KHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fcGFyYW1fdmFsdWUpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5lbml0aXRlc0xpc3RGYWlsZWRQYXR0ZXJuVGVzdCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC52ZXJzaW9uRm9yTG9hZEZyb20gJiYgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnZlcnNpb25Gb3JMb2FkVG8gJiZcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0ZWRMb2dpY2FsVW5pdHMgJiYgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNvdXJjZV9lbnZfbmFtZVxuICAgICAgICAgICAgICAgICYmIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX21ldGhvZCA9PT0gJ0FMTCcgIHx8XG4gICAgICAgICAgICAgICAgICAgIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX3BhcmFtX3ZhbHVlICYmIGVudGl0aWVzUGFzc2VkKSkpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwubG9hZGluZ1RhYmxlVmVyc2lvbnMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBmcm9tID0gbmV3IERhdGUocmVxdWVzdGVkRW50aXRpZXNDdHJsLnZlcnNpb25Gb3JMb2FkRnJvbSk7XG4gICAgICAgICAgICAgICAgZnJvbS5zZXRIb3VycygwKTtcbiAgICAgICAgICAgICAgICBmcm9tLnNldE1pbnV0ZXMoMCk7XG4gICAgICAgICAgICAgICAgZnJvbS5zZXRTZWNvbmRzKDApO1xuICAgICAgICAgICAgICAgIHZhciB0byA9IG5ldyBEYXRlKHJlcXVlc3RlZEVudGl0aWVzQ3RybC52ZXJzaW9uRm9yTG9hZFRvKTtcbiAgICAgICAgICAgICAgICB0by5zZXRIb3VycygyMyk7XG4gICAgICAgICAgICAgICAgdG8uc2V0TWludXRlcyg1OSk7XG4gICAgICAgICAgICAgICAgdG8uc2V0U2Vjb25kcyg1OSk7XG4gICAgICAgICAgICAgICAgVERNU2VydmljZS5wb3N0R2VuZXJpY0FQSSgndGFza3MvdmVyc2lvbnNGb3JMb2FkJywge1xuICAgICAgICAgICAgICAgICAgICBmcm9tRGF0ZTogZnJvbSxcbiAgICAgICAgICAgICAgICAgICAgdG9EYXRlOiB0byxcbiAgICAgICAgICAgICAgICAgICAgZW50aXRpZXNMaXN0OiByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX21ldGhvZCA9PT0gJ0FMTCcgPyAnJyA6IHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fcGFyYW1fdmFsdWUudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgbHVfbGlzdDogcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGVkTG9naWNhbFVuaXRzLFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VfZW52X25hbWU6IHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zb3VyY2VfZW52X25hbWUsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldF9lbnZfbmFtZTogcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLmVudmlyb25tZW50X25hbWUsXG4gICAgICAgICAgICAgICAgICAgIGJlX2lkIDogcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLmJlX2lkLFxuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG92ZXJyaWRlUm9vdEluZGljYXRvcnMgPSBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0aW9uSWRzU2V0ID0gbmV3IFNldCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIG9mIGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFleGVjdXRpb25JZHNTZXQuaGFzKGl0ZW0udGFza19leGVjdXRpb25faWQpICYmIGl0ZW0ucm9vdF9pbmRpY2F0b3IgPT0gJ1knKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnJvb3RfaW5kaWNhdG9yID0gJ1lZJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWN1dGlvbklkc1NldC5hZGQoaXRlbS50YXNrX2V4ZWN1dGlvbl9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpbiBvcmRlciB0byBhbGxvdyBvbmx5IG9uZSBzZWxlY3Rpb24gaWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcnJpZGVSb290SW5kaWNhdG9ycyhyZXNwb25zZS5yZXN1bHQuTGlzdE9mVmVyc2lvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnZlcnNpb25zRm9yTG9hZCA9IF8ubWFwKHJlc3BvbnNlLnJlc3VsdC5MaXN0T2ZWZXJzaW9ucyx2ZXJzaW9uID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uLmV4ZWN1dGlvbl9ub3RlID0gdmVyc2lvbi5leGVjdXRpb25fbm90ZSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnZlcnNpb25zRm9yTG9hZCA9IF8uc29ydEJ5KHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS52ZXJzaW9uc0ZvckxvYWQsIHZlcnNpb24gPT4gIC0xICogbmV3IERhdGUodmVyc2lvbi52ZXJzaW9uX2RhdGV0aW1lKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0SW5zdGFuY2VWZXJzaW9ucyAmJiByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0SW5zdGFuY2VWZXJzaW9ucy5yZWxvYWREYXRhKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwubG9hZGluZ1RhYmxlVmVyc2lvbnMgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiTmV3IFRhc2sgIyBGYWlsZWQgdG8gZ2V0IFZlcnNpb25zIGZvciBMb2FkXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX3BhcmFtX3ZhbHVlICYmIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kICE9PSAnQUxMJykge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS52ZXJzaW9uc0ZvckxvYWQgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAocmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0SW5zdGFuY2VWZXJzaW9ucyAmJiByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0SW5zdGFuY2VWZXJzaW9ucy5yZWxvYWREYXRhKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFlbnRpdGllc1Bhc3NlZCkge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5lbml0aXRlc0xpc3RGYWlsZWRQYXR0ZXJuVGVzdCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgncmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9tZXRob2QnLCAobmV3VmFsdWUsIG9sZFZhbHVlKSA9PiB7XG4gICAgICAgICAgICBpZiAobmV3VmFsdWUgIT09IG9sZFZhbHVlICYmIChuZXdWYWx1ZSB8fCAnJykuY2hhckF0KDApICE9PSAob2xkVmFsdWUgfHwgJycpLmNoYXJBdCgwKSkge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fcGFyYW1fdmFsdWUgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnZlcnNpb25zVG9nZ2xlID0ge307XG4gICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS52ZXJzaW9uc0ZvckxvYWQgPSBbXTtcbiAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0SW5zdGFuY2VWZXJzaW9ucyA9IHt9O1xuICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZHRDb2x1bW5zVmVyc2lvbnMgPSBbXTtcbiAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0Q29sdW1uRGVmc1ZlcnNpb25zID0gW107XG4gICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnMgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1uOiAnY29sbGFwc2UnLFxuICAgICAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1uOiAnYWN0aW9ucycsXG4gICAgICAgICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICd2ZXJzaW9uX25hbWUnLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdWZXJzaW9uIE5hbWUnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICd0YXNrX2lkJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnVGFzayBJZCcsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICd0YXNrX2V4ZWN1dGlvbl9pZCcsXG4gICAgICAgICAgICAgICAgbmFtZTogJ1Rhc2sgRXhlY3V0aW9uIElkJyxcbiAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbHVtbjogJ3ZlcnNpb25fbm8nLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdWZXJzaW9uIE51bWJlcicsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICdleGVjdXRpb25fbm90ZScsXG4gICAgICAgICAgICAgICAgbmFtZTogJ0V4ZWN0aW9uIE5vdGUnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1uOiAndGFza19sYXN0X3VwZGF0ZWRfYnknLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdMYXN0IFVwZGF0ZWQgQnknLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1uOiAndmVyc2lvbl90eXBlJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnVmVyc2lvbiBUeXBlJyxcbiAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbHVtbjogJ3ZlcnNpb25fZGF0ZXRpbWUnLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdEYXRlIFRpbWUnLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdkYXRlJyxcbiAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbHVtbjogJ2x1X25hbWUnLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdMb2dpY2FsIFVuaXQgTmFtZScsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICdudW1iZXJfb2ZfZXh0cmFjdGVkX2VudGl0aWVzJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnTnVtYmVyIG9mIFByb2Nlc3NlZCBFbnRpdGllcycsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICdudW1fb2Zfc3VjY2VlZGVkX2VudGl0aWVzJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnTnVtYmVyIG9mIFN1Y2NlZWRlZCBFbnRpdGllcycsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICdudW1fb2ZfZmFpbGVkX2VudGl0aWVzJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnTnVtYmVyIG9mIEZhaWxlZCBFbnRpdGllcycsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICdyb290SW5kaWNhdG9yJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnUm9vdCBMVScsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgXTtcblxuICAgICAgICB2YXIgY2hhbmdlVG9Mb2NhbERhdGUgPSBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgZnVsbCwgbWV0YSkge1xuICAgICAgICAgICAgcmV0dXJuIG1vbWVudChkYXRhKS5mb3JtYXQoJ0REIE1NTSBZWVlZLCBISDptbScpXG4gICAgICAgIH07XG5cblxuICAgICAgICB2YXIgcmVuZGVyU2VsZWN0aW9uQ29sdW1uID0gZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwsIG1ldGEpIHtcbiAgICAgICAgICAgIGlmIChmdWxsLmlzUm9vdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5nLXZhbHVlPVwiXFwnJyArIGZ1bGwuZmFicmljX2V4ZWN1dGlvbl9pZCArICdcXCdcIiBuYW1lPVwidmVyc2lvbnNUYWJsZVNlbGVjdGlvblwiIG5nLW1vZGVsPVwicmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGVkVmVyc2lvblRvTG9hZFwiPic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH07XG4gICAgICAgIHZhciByZW5kZXJDb2xsYXBzZUNvbHVtbiA9IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCBmdWxsLCBtZXRhKSB7XG4gICAgICAgICAgICBpZiAoZnVsbC5pc1Jvb3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxhIGNsYXNzPVwidG9nZ2xlVmVyc2lvbnMgJyArIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudmVyc2lvbnNUb2dnbGVbZnVsbC50YXNrX2V4ZWN1dGlvbl9pZF0gPyAnYWN0aXZlJyA6ICcnKSAgKyAnXCIgbmctY2xpY2s9XCJyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudG9nZ2xlVmVyc2lvbignICsgZnVsbC50YXNrX2V4ZWN1dGlvbl9pZCArICcpXCI+PGkgY2xhc3M9XCJmYSBhcnJvd1wiPjwvaT4gPC9hPic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuaGVhZGVyc1ZlcnNpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocmVxdWVzdGVkRW50aXRpZXNDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5jb2x1bW4gPT0gJ2FjdGlvbnMnKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0Q29sdW1uc1ZlcnNpb25zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihyZXF1ZXN0ZWRFbnRpdGllc0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbikud2l0aFRpdGxlKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0ubmFtZSkucmVuZGVyV2l0aChyZW5kZXJTZWxlY3Rpb25Db2x1bW4pLm5vdFNvcnRhYmxlKCkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbiA9PSAnY29sbGFwc2UnKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0Q29sdW1uc1ZlcnNpb25zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihyZXF1ZXN0ZWRFbnRpdGllc0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbikud2l0aFRpdGxlKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0ubmFtZSkucmVuZGVyV2l0aChyZW5kZXJDb2xsYXBzZUNvbHVtbikubm90U29ydGFibGUoKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0udHlwZSA9PSAnZGF0ZScpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZHRDb2x1bW5zVmVyc2lvbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uKS53aXRoVGl0bGUocmVxdWVzdGVkRW50aXRpZXNDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5uYW1lKS5yZW5kZXJXaXRoKGNoYW5nZVRvTG9jYWxEYXRlKS5ub3RTb3J0YWJsZSgpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVxdWVzdGVkRW50aXRpZXNDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5jb2x1bW4gPT0gJ3Rhc2tfaWQnKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0Q29sdW1uc1ZlcnNpb25zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihyZXF1ZXN0ZWRFbnRpdGllc0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbikud2l0aFRpdGxlKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0ubmFtZSkubm90U29ydGFibGUoKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uID09ICd2ZXJzaW9uX25hbWUnKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLmR0Q29sdW1uc1ZlcnNpb25zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihyZXF1ZXN0ZWRFbnRpdGllc0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbikud2l0aFRpdGxlKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0ubmFtZSkubm90U29ydGFibGUoKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uID09ICdyb290SW5kaWNhdG9yJyApIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZHRDb2x1bW5zVmVyc2lvbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uKS53aXRoVGl0bGUocmVxdWVzdGVkRW50aXRpZXNDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5uYW1lKS5ub3RTb3J0YWJsZSgpLm5vdFZpc2libGUoKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZHRDb2x1bW5zVmVyc2lvbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHJlcXVlc3RlZEVudGl0aWVzQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uKS53aXRoVGl0bGUocmVxdWVzdGVkRW50aXRpZXNDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5uYW1lKS5ub3RTb3J0YWJsZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdmFyIGdldFRhYmxlRGF0YVZlcnNpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB2ZXJzaW9uc0ZvckxvYWQgPSBbXTsgICBcbiAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5ncm91cGVkU2VsZWN0aW9ucyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3RlZExvZ2ljYWxVbml0cy5mb3JFYWNoKGx1ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBsdVRlbXAgPSBfLmZpbmQocmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLmFsbExvZ2ljYWxVbml0cyx7bHVfbmFtZSA6IGx1Lmx1X25hbWV9KTtcbiAgICAgICAgICAgICAgICBsdS5sdV9wYXJlbnRfbmFtZSA9IGx1VGVtcC5sdV9wYXJlbnRfbmFtZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHJvb3RMVXMgPSBfLmZpbHRlcihyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0ZWRMb2dpY2FsVW5pdHMse2x1X3BhcmVudF9uYW1lIDogbnVsbH0pO1xuICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnZlcnNpb25zRm9yTG9hZC5mb3JFYWNoKGZ1bmN0aW9uKHZlcnNpb25Gb3JMb2FkKSB7XG4gICAgICAgICAgICAgICAgaWYgKF8uZmluZChyb290TFVzLHtsdV9uYW1lOiB2ZXJzaW9uRm9yTG9hZC5sdV9uYW1lfSkpe1xuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uRm9yTG9hZC5yb290SW5kaWNhdG9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb25Gb3JMb2FkLnJvb3RJbmRpY2F0b3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHZlcnNpb25Gb3JMb2FkLnJvb3RJbmRpY2F0b3IgJiYgXy5maW5kSW5kZXgodmVyc2lvbnNGb3JMb2FkLHt0YXNrX2V4ZWN1dGlvbl9pZCA6IHZlcnNpb25Gb3JMb2FkLnRhc2tfZXhlY3V0aW9uX2lkLGlzUm9vdDogdHJ1ZX0pIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uRm9yTG9hZC5pc1Jvb3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uRm9yTG9hZC5yb290SW5kaWNhdG9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbnNGb3JMb2FkLnB1c2godmVyc2lvbkZvckxvYWQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudmVyc2lvbnNUb2dnbGVbdmVyc2lvbkZvckxvYWQudGFza19leGVjdXRpb25faWRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb25Gb3JMb2FkLmlzUm9vdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uc0ZvckxvYWQucHVzaCh2ZXJzaW9uRm9yTG9hZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7IFxuXG4gICAgICAgICAgICBpZiAoIXJlcXVlc3RlZEVudGl0aWVzQ3RybC5zZWxlY3RlZFZlcnNpb25Ub0xvYWQgJiYgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGVkX3ZlcnNpb25fdGFza19leGVfaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRWZXJzaW9uID0gXy5maW5kKHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS52ZXJzaW9uc0ZvckxvYWQsIHtyb290SW5kaWNhdG9yIDogdHJ1ZSwgdGFza19leGVjdXRpb25faWQ6IHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3RlZF92ZXJzaW9uX3Rhc2tfZXhlX2lkfSk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkVmVyc2lvbikge1xuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkID0gc2VsZWN0ZWRWZXJzaW9uLmZhYnJpY19leGVjdXRpb25faWQ7XG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHZlcnNpb25zRm9yTG9hZCk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHZlcnNpb25zRm9yTG9hZCk7XG4gICAgICAgICAgICBpZiAoIXJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3RlZFZlcnNpb25Ub0xvYWQgJiYgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGVkX3ZlcnNpb25fdGFza19leGVfaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRWZXJzaW9uID0gXy5maW5kKHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS52ZXJzaW9uc0ZvckxvYWQsIHtyb290SW5kaWNhdG9yIDogdHJ1ZSwgdGFza19leGVjdXRpb25faWQ6IHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3RlZF92ZXJzaW9uX3Rhc2tfZXhlX2lkfSk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkVmVyc2lvbikge1xuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkID0gc2VsZWN0ZWRWZXJzaW9uLmZhYnJpY19leGVjdXRpb25faWQ7XG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5kdE9wdGlvbnNWZXJzaW9ucyA9IERUT3B0aW9uc0J1aWxkZXIuZnJvbUZuUHJvbWlzZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0VGFibGVEYXRhVmVyc2lvbnMoKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC53aXRoRE9NKCc8XCJodG1sNWJ1dHRvbnNcIkI+bFRmZ2l0cCcpXG4gICAgICAgICAgICAud2l0aE9wdGlvbignY3JlYXRlZFJvdycsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAvLyBSZWNvbXBpbGluZyBzbyB3ZSBjYW4gYmluZCBBbmd1bGFyIGRpcmVjdGl2ZSB0byB0aGUgRFRcbiAgICAgICAgICAgICAgICAkY29tcGlsZShhbmd1bGFyLmVsZW1lbnQocm93KS5jb250ZW50cygpKSgkc2NvcGUpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aXRoT3B0aW9uKCdzY3JvbGxYJywgZmFsc2UpXG4gICAgICAgICAgICAud2l0aE9wdGlvbignbGVuZ3RoQ2hhbmdlJywgZmFsc2UpXG4gICAgICAgICAgICAud2l0aE9wdGlvbigncGFnaW5nJywgZmFsc2UpXG4gICAgICAgICAgICAud2l0aEJ1dHRvbnMoW10pXG4gICAgICAgICAgICAud2l0aE9wdGlvbihcImNhc2VJbnNlbnNpdGl2ZVwiLCB0cnVlKVxuICAgICAgICAgICAgLndpdGhPcHRpb24oXCJvcmRlclwiLCAgW1sgOSwgXCJkZXNjXCIgXSxbMTQsIFwiZGVzY1wiXV0pXG4gICAgICAgICAgICAud2l0aE9wdGlvbignc2VhcmNoJywge1xuICAgICAgICAgICAgICAgIFwiY2FzZUluc2Vuc2l0aXZlXCI6IGZhbHNlXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICByZXF1ZXN0ZWRFbnRpdGllc0N0cmwuZHRPcHRpb25zVmVyc2lvbnMud2l0aExpZ2h0Q29sdW1uRmlsdGVyKHtcbiAgICAgICAgICAgIDI6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAzOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgNDoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDU6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICA2OiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgNzoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDg6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICA5OiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgMTA6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAxMToge1xuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDEyOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgMTM6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJlcXVlc3RlZEVudGl0aWVzQ3RybC5wYXJhbWV0ZXJzUmFuZG9tID0gZmFsc2U7XG4gICAgICAgIGlmIChyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEudGFza19pZCkge1xuICAgICAgICAgICAgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID09PSAnUCcpIHtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHJlcXVlc3RlZEVudGl0aWVzQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID09PSAnUFInKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnBhcmFtZXRlcnNSYW5kb20gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKCFyZXF1ZXN0ZWRFbnRpdGllc0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX21ldGhvZCl7XG4gICAgICAgICAgICAgICAgcmVxdWVzdGVkRW50aXRpZXNDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9tZXRob2QgPSAnTCc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6IFwiRVwiLFxuICAgICAgICB0ZW1wbGF0ZVVybDogdGVtcGxhdGUsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBjb250ZW50OiAnPScsXG4gICAgICAgICAgICBkaXNhYmxlZDogJz0nLFxuICAgICAgICAgICAgZm9ybTogJz0nLFxuICAgICAgICAgICAgc291cmNlRW52T3duZXI6ICc9JyxcbiAgICAgICAgICAgIHRhcmdldEVudk93bmVyOiAnPScsXG4gICAgICAgICAgICBiYWNrOiAnPScsXG4gICAgICAgICAgICBnZXRTdWJUaXRsZTogJz0nLFxuICAgICAgICAgICAgbWF4VG9Db3B5OiAnPScsXG4gICAgICAgICAgICB1c2VyUm9sZTogJz0nLFxuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBjb250cm9sbGVyLFxuICAgICAgICBjb250cm9sbGVyQXM6ICdyZXF1ZXN0ZWRFbnRpdGllc0N0cmwnXG4gICAgfTtcbn1cblxuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnVERNLUZFJylcbiAgICAuZGlyZWN0aXZlKCdyZXF1ZXN0ZWRFbnRpdGllcycsIHJlcXVlc3RlZEVudGl0aWVzKTtcbiJdfQ==
