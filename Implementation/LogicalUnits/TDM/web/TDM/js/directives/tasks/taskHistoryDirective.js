function taskHistoryDirective($interval){return{restrict:"EA",templateUrl:"views/tasks/tasksHistoryTable.html",scope:{content:"="},link:function(scope,element,attr){scope.updateRunningExecutions&&scope.updateRunningExecutions();var updateData=$interval((function(){scope.updateRunningExecutions&&scope.updateRunningExecutions()}),2e3);element.on("$destroy",(function(){$interval.cancel(updateData)}))},controller:function($scope,$rootScope,$window,$compile,$timeout,TDMService,AuthService,DTColumnBuilder,DTOptionsBuilder,DTColumnDefBuilder,$q,$sessionStorage,$http,toastr,$interval,$uibModal,ExcelService){var taskHistoryTableCtrl=this;taskHistoryTableCtrl.taskData=$scope.content.task,taskHistoryTableCtrl.loadingTable=!0,$rootScope.inter_flag=!1,taskHistoryTableCtrl.userRole=AuthService.getRole(),taskHistoryTableCtrl.username=AuthService.getUsername(),taskHistoryTableCtrl.TDMReports=AuthService.getTDMReports(),taskHistoryTableCtrl.enableStopExecution=!1,"Active"==taskHistoryTableCtrl.taskData.task_status&&("admin"==taskHistoryTableCtrl.userRole.type||taskHistoryTableCtrl.taskData.owners.indexOf(taskHistoryTableCtrl.username)>=0||taskHistoryTableCtrl.username==taskHistoryTableCtrl.taskData.task_created_by)&&(taskHistoryTableCtrl.enableStopExecution=!0),taskHistoryTableCtrl.disableAccessingStatistics=!!(taskHistoryTableCtrl.taskData.disabled||taskHistoryTableCtrl.taskData.onHold||taskHistoryTableCtrl.taskData.executioncount),TDMService.getTaskHistory($scope.content.exec_id).then((function(response){if("SUCCESS"==response.errorCode){taskHistoryTableCtrl.taskType="LOAD",response.result&&response.result.length>0&&(taskHistoryTableCtrl.taskType=response.result[0].task_type||"LOAD"),taskHistoryTableCtrl.runningExecutions=[];var pendingTasks=!1;taskHistoryTableCtrl.taskHistoryData=_.filter(response.result,(function(execution){return!execution.execution_status||("RUNNING"==execution.execution_status.toUpperCase()||"EXECUTING"==execution.execution_status.toUpperCase()||"STARTED"==execution.execution_status.toUpperCase()||"STARTEXECUTIONREQUESTED"==execution.execution_status.toUpperCase()?(taskHistoryTableCtrl.runningExecutions.push(execution),taskHistoryTableCtrl.runningExecution=execution.task_execution_id,!1):("PENDING"!=execution.execution_status.toUpperCase()&&"PAUSED"!=execution.execution_status.toUpperCase()||(taskHistoryTableCtrl.runningExecution=execution.task_execution_id),"PENDING"==execution.execution_status.toUpperCase()&&(pendingTasks=!0),!0))})),0==taskHistoryTableCtrl.runningExecutions.length&&taskHistoryTableCtrl.ExtractRefStatsStarted&&($timeout.cancel(taskHistoryTableCtrl.ExtractRefStatsStarted),taskHistoryTableCtrl.ExtractRefStatsStarted=null),pendingTasks&&0==taskHistoryTableCtrl.runningExecutions.length&&$timeout((function(){$rootScope.$broadcast("refreshPage",!0)}),1e4),taskHistoryTableCtrl.taskHistoryData=_.sortBy(taskHistoryTableCtrl.taskHistoryData,(function(value){return-1*value.task_execution_id})),taskHistoryTableCtrl.executionIds=_.map(taskHistoryTableCtrl.runningExecutions,(function(execution){return{name:execution.lu_name||execution.process_name,etl_execution_id:execution.etl_execution_id,etl_ip_address:execution.etl_ip_address,fabric_execution_id:execution.fabric_execution_id,task_execution_id:execution.task_execution_id}})),taskHistoryTableCtrl.disableAccessingStatistics=!!taskHistoryTableCtrl.executionIds.length,taskHistoryTableCtrl.reloadData=function(){taskHistoryTableCtrl.runningExecution=null,taskHistoryTableCtrl.runningExecutions=[],TDMService.getTaskHistory($scope.content.exec_id).then((function(response){if("SUCCESS"!=response.errorCode)return;let pendingTasks=!1;taskHistoryTableCtrl.taskHistoryData=_.filter(response.result,(function(execution){return"RUNNING"==execution.execution_status.toUpperCase()||"EXECUTING"==execution.execution_status.toUpperCase()||"STARTED"==execution.execution_status.toUpperCase()||"STARTEXECUTIONREQUESTED"==execution.execution_status.toUpperCase()?(taskHistoryTableCtrl.runningExecution=execution.task_execution_id,taskHistoryTableCtrl.runningExecutions.push(execution),!1):("PENDING"!=execution.execution_status.toUpperCase()&&"PAUSED"!=execution.execution_status.toUpperCase()||(taskHistoryTableCtrl.runningExecution=execution.task_execution_id),"PENDING"==execution.execution_status.toUpperCase()&&(pendingTasks=!0),!0)})),pendingTasks&&0==taskHistoryTableCtrl.runningExecutions.length&&$timeout((function(){$rootScope.$broadcast("refreshPage",!0)}),1e4),taskHistoryTableCtrl.executionIds=_.map(taskHistoryTableCtrl.runningExecutions,(function(execution){return{name:execution.lu_name||execution.process_name,etl_execution_id:execution.etl_execution_id,etl_ip_address:execution.etl_ip_address,fabric_execution_id:execution.fabric_execution_id,task_execution_id:execution.task_execution_id}})),taskHistoryTableCtrl.taskHistoryData=_.sortBy(taskHistoryTableCtrl.taskHistoryData,(function(value){return-1*value.task_execution_id})),taskHistoryTableCtrl.dtInstance.reloadData((function(data){}),!1)}))},taskHistoryTableCtrl.stopExecution=function(executionId){0!=taskHistoryTableCtrl.executionIds.length&&TDMService.postGenericAPI("cancelMigratWS",{taskExecutionId:taskHistoryTableCtrl.executionIds[0].task_execution_id}).then((function(response){taskHistoryTableCtrl.executionIds=[],$timeout((function(){getTableData(),taskHistoryTableCtrl.reloadData()}),5e3)}))},taskHistoryTableCtrl.startExtractRefStatsDetailed=function(type,lu_name){if(!taskHistoryTableCtrl.executionIds||0==taskHistoryTableCtrl.executionIds.length)return;let stopInterval;var task_execution_id=taskHistoryTableCtrl.executionIds[0].task_execution_id;$uibModal.open({templateUrl:"views/tasks/taskHistoryRefModal.html",windowTopClass:"taskHistoryRef",controller:function($scope,$uibModalInstance,TDMService){var taskHistoryRefCtrl=this;taskHistoryRefCtrl.getExtractRefStats=function(){TDMService.postGenericAPI("extractrefstats",{taskExecutionId:task_execution_id,type:"D"}).then((function(response){taskHistoryRefCtrl.refDetailedData=_.map(response.result||[],(function(refData){return refData.number_of_records_to_process>0&&(refData.percentageOfCompleted=refData.number_of_processed_records/refData.number_of_records_to_process*100),isNaN(refData.number_of_records_to_process)||(refData.number_of_records_to_process=refData.number_of_records_to_process.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),isNaN(refData.number_of_processed_records)||(refData.number_of_processed_records=refData.number_of_processed_records.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),refData})),taskHistoryRefCtrl.refDetailedData=_.filter(taskHistoryRefCtrl.refDetailedData,(function(data){return!(!data||data.lu_name!==lu_name)&&("failed"==type?"failed"==data.execution_status:"failed"!=type?"failed"!=data.execution_status:void 0)}))}))},stopInterval=$interval((function(){taskHistoryRefCtrl.getExtractRefStats()}),1e4),taskHistoryRefCtrl.getExtractRefStats(),taskHistoryRefCtrl.close=function(){$uibModalInstance.close()}},controllerAs:"taskHistoryRefCtrl"}).result.then((function(){stopInterval&&$interval.cancel(stopInterval)}),(function(){stopInterval&&$interval.cancel(stopInterval)}))},taskHistoryTableCtrl.resumeExecution=function(migrateId,task_execution_id){task_execution_id&&TDMService.postGenericAPI("resumeMigratWS",{taskExecutionId:task_execution_id}).then((function(response){toastr.success("Task Execution # "+task_execution_id," Successfully Resumed"),$timeout((function(){$rootScope.$broadcast("refreshPage",!0)}),5e3)}))},taskHistoryTableCtrl.setReloadInterval=function(reloadInterval){var time=1e3*reloadInterval;console.log("setting new reload interval: ",time),$rootScope.reload_interval=time,taskHistoryTableCtrl.reload_interval=time};$rootScope.reload_interval;taskHistoryTableCtrl.taskData.task_id;taskHistoryTableCtrl.reload_interval=$rootScope.reload_interval,taskHistoryTableCtrl.getExtractTaskRefData=function(task_execution_id,type,lu_name){return new Promise((function(resolve,reject){TDMService.postGenericAPI("extractrefstats",{taskExecutionId:task_execution_id,type:type}).then((function(response){"D"===type?response.result&&response.result&&response.result&&(response.result=_.filter(response.result,(function(row){return row["start_time(UTC)"]=row.start_time,row["end_time(UTC)"]=row.end_time,delete row.start_time,delete row.end_time,delete row.estimated_remaining_duration,!(!row||row.lu_name!==lu_name)}))):"S"===type&&(response.result=response.result[lu_name]),resolve(response)})).catch((function(err){reject(err)}))}))},taskHistoryTableCtrl.downloadExtractReport=function(type,migrateId,logicalUnit,taskExecutionId){var types=[type,"H"];if("D"==type&&types.push("S"),"null"!=migrateId)TDMService.postGenericAPI("migrateStatusWs",{migrateIds:migrateId,runModes:types}).then((function(response){if("S"==type){var data=$scope.buildSummaryData(response.result,migrateId,logicalUnit);if((taskExecution=_.find(taskHistoryTableCtrl.taskHistoryData,{task_execution_id:taskExecutionId,lu_name:logicalUnit}))&&("REF"==taskExecution.selection_method||taskExecution.refcount>0))return taskHistoryTableCtrl.getExtractTaskRefData(taskExecution.task_execution_id,type,logicalUnit).then((function(response){(data=Object.assign(data,response.result)).reference=!0,$scope.buildHtml("summary",data)}));$scope.buildHtml("summary",data)}else if("D"==type){var taskExecution;data=$scope.buildDetailedData(response.result,migrateId,logicalUnit);if((taskExecution=_.find(taskHistoryTableCtrl.taskHistoryData,{task_execution_id:taskExecutionId,lu_name:logicalUnit}))&&("REF"==taskExecution.selection_method||taskExecution.refcount>0))return taskHistoryTableCtrl.getExtractTaskRefData(taskExecution.task_execution_id,type,logicalUnit).then((function(response){(data=Object.assign(data,{refData:response.result})).reference=!0,$scope.buildHtml("detailed",data)}));$scope.buildHtml("detailed",data)}}));else{var taskExecution=_.find(taskHistoryTableCtrl.taskHistoryData,{task_execution_id:taskExecutionId,lu_name:logicalUnit});if(taskExecution&&("REF"==taskExecution.selection_method||taskExecution.refcount>0))return taskHistoryTableCtrl.getExtractTaskRefData(taskExecution.task_execution_id,type,logicalUnit).then((function(response){"S"===type&&(response.result.reference=!0),$scope.buildHtml("S"==type?"summary":"detailed","S"==type?response.result:{refData:response.result,reference:!0})}))}},$scope.buildDetailedData=function(detailedData,migrateId,logicalUnit){var data={migrateId:migrateId,logicalUnit:logicalUnit,userName:taskHistoryTableCtrl.username,rows:[],columns:[],nodeList:[]};if(detailedData&&detailedData.S)for(var i=0;i<detailedData.S.results.length;i++)"Cluster"==detailedData.S.results[i].columns.Level&&(data.status=detailedData.S.results[i].columns.Status),"Node"==detailedData.S.results[i].columns.Level&&data.nodeList.push(detailedData.S.results[i].columns.Name);return detailedData&&detailedData.H&&(data.migrateCommand=detailedData.H["Migration Command"]),detailedData&&detailedData.D&&(data.columns=["Entity ID","Error","Node id","Results","Status"],data.rows=_.map(detailedData.D,(function(row){var results=JSON.parse(row.Results);return results&&results.Added?row.Results="Added":results&&results.Updated?row.Results="Updated":results&&results.Unchanged&&(row.Results="Unchanged"),row}))),data},$scope.buildHtml=function(title,data){$http({method:"GET",url:"views/staticHtmls/"+title+".html"}).then((function(response){var htmlData=response.data;htmlData=(htmlData=(htmlData=(htmlData=(htmlData=(htmlData=(htmlData=(htmlData=(htmlData=(htmlData=(htmlData=(htmlData=(htmlData=htmlData.replaceAll("{{migration}}",data.migrateId?"block":"none")).replaceAll("{{reference}}",data.reference?"block":"none")).replaceAll("{{migrateId}}",data.migrateId)).replaceAll("{{migrateCommand}}",data.migrateCommand)).replaceAll("{{status}}",data.status)).replaceAll("{{userName}}",data.userName)).replaceAll("{{logicalUnit}}",data.logicalUnit)).replaceAll("{{nodeList}}",data.nodeList)).replaceAll("{{numOfProcessedRefTables}}",data.numOfProcessedRefTables)).replaceAll("{{numOfFailedRefTables}}",data.numOfFailedRefTables)).replaceAll("{{numOfCopiedRefTables}}",data.numOfCopiedRefTables)).replaceAll("{{minStartExecutiobnDate}}",data.minStartExecutionDate)).replaceAll("{{maxEndExecutiobnDate}}",data.maxEndExecutionDate);var rowData="<tr>";if(data.columns){for(var i=0;i<data.columns.length;i++)rowData=rowData+"<th>"+data.columns[i]+"</th>";rowData+="</tr>";for(i=0;i<data.rows.length;i++){rowData+="<tr>";for(var j=0;j<data.columns.length;j++)rowData=rowData+"<th>"+data.rows[i][data.columns[j]]+"</th>";rowData+="</tr>"}}else rowData="<tr></tr>";var rowDataRef="<tr>";if(data.refData&&data.refData.length>0){var columns=[];for(var key in data.refData[0])columns.push(key);const errMsgIndex=columns.indexOf("error_msg");errMsgIndex>=0&&columns.push(columns.splice(errMsgIndex,1)[0]),columns.forEach(column=>{rowDataRef=rowDataRef+"<th>"+column+"</th>"}),rowDataRef+="</tr>";for(i=0;i<data.refData.length;i++){rowDataRef+="<tr>";for(j=0;j<columns.length;j++)rowDataRef=rowDataRef+"<th>"+data.refData[i][columns[j]]+"</th>";rowDataRef+="</tr>"}}else rowDataRef="<tr></tr>";htmlData=(htmlData=htmlData.replaceAll("{{dataRows}}",rowData)).replaceAll("{{dataRowsReference}}",rowDataRef),$scope.downloadHtml(htmlData,title+".html")}))},$scope.buildSummaryData=function(summaryData,migrateId,logicalUnit){var data={migrateId:"null"==migrateId?null:migrateId,logicalUnit:logicalUnit,userName:taskHistoryTableCtrl.username,rows:[],columns:[],nodeList:[]};if(summaryData&&summaryData.S){data.columns=summaryData.S.columnsNames;for(var i=0;i<summaryData.S.results.length;i++)"Cluster"==summaryData.S.results[i].columns.Level&&(data.status=summaryData.S.results[i].columns.Status),"Node"==summaryData.S.results[i].columns.Level&&data.nodeList.push(summaryData.S.results[i].columns.Name),data.rows.push(summaryData.S.results[i].columns)}return summaryData&&summaryData.H&&(data.migrateCommand=summaryData.H["Migration Command"]),data},String.prototype.replaceAll=function(search,replacement){return this.replace(new RegExp(search,"g"),replacement)},$scope.downloadHtml=function(htmlData,fileName){var element=document.createElement("a");element.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(htmlData)),element.setAttribute("download",fileName),element.style.display="none",document.body.appendChild(element),element.click(),document.body.removeChild(element)},$scope.buildSummaryHtml=function(data){$http({method:"GET",url:"views/staticHtmls/summary.html"}).then((function(response){var htmlData=response.data;htmlData=(htmlData=(htmlData=(htmlData=(htmlData=(htmlData=htmlData.replaceAll("{{migrateId}}",data.migrateId)).replaceAll("{{migrateCommand}}",data.migrateCommand)).replaceAll("{{status}}",data.status)).replaceAll("{{userName}}",data.userName)).replaceAll("{{logicalUnit}}",data.logicalUnit)).replaceAll("{{nodeList}}",data.nodeList);for(var rowData="<tr>",i=0;i<data.columns.length;i++)rowData=rowData+"<th>"+data.columns[i]+"</th>";rowData+="</tr>";for(i=0;i<data.rows.length;i++){rowData+="<tr>";for(var j=0;j<data.columns.length;j++)rowData=rowData+"<th>"+data.rows[i][data.columns[j]]+"</th>";rowData+="</tr>"}htmlData=htmlData.replaceAll("{{dataRows}}",rowData),$scope.downloadHtml(htmlData,"summary_"+data.migrateId+".html")}))},$scope.getMigrateStatusWs=function(){TDMService.postGenericAPI("migrateStatusWs",{migrateIds:_.map(taskHistoryTableCtrl.executionIds,"fabric_execution_id"),runModes:["H","S"]}).then((function(response){taskHistoryTableCtrl.executionData=[];let i=0;for(res of response.result){if(taskHistoryTableCtrl.migrationCommand="",res&&res.H&&res.H["Migration Command"]&&(taskHistoryTableCtrl.migrationCommand=res.H["Migration Command"]),taskHistoryTableCtrl.clusterLevel={},!(res&&res.S&&res.S.results))return void $timeout((function(){getTableData(),taskHistoryTableCtrl.reloadData()}),5e3);var clusterLevel=_.find(res.S.results,{columns:{Level:"Cluster"}});if(clusterLevel&&(taskHistoryTableCtrl.clusterLevel=clusterLevel.columns,"DONE"==taskHistoryTableCtrl.clusterLevel.Status))return void $timeout((function(){getTableData(),taskHistoryTableCtrl.reloadData()}),5e3);var added=("LOAD"===taskHistoryTableCtrl.taskType?taskHistoryTableCtrl.clusterLevel.Succeeded:taskHistoryTableCtrl.clusterLevel.Added)||0;taskHistoryTableCtrl.executionData.push({name:taskHistoryTableCtrl.executionIds&&taskHistoryTableCtrl.executionIds[i]&&taskHistoryTableCtrl.executionIds[i].name,migrateID:taskHistoryTableCtrl.executionIds&&taskHistoryTableCtrl.executionIds[i]&&taskHistoryTableCtrl.executionIds[i].fabric_execution_id,migrationCommand:taskHistoryTableCtrl.migrationCommand,remainingDuration:taskHistoryTableCtrl.clusterLevel["Remaining dur."]||"00:00:00",percentageOfCompleted:taskHistoryTableCtrl.clusterLevel["% Completed"],added:added||0,failed:taskHistoryTableCtrl.clusterLevel.Failed||0,Updated:taskHistoryTableCtrl.clusterLevel.Updated||0,Unchanged:taskHistoryTableCtrl.clusterLevel.Unchanged||0,processed:parseInt(added||0)+parseInt(taskHistoryTableCtrl.clusterLevel.Failed||0)+parseInt(taskHistoryTableCtrl.clusterLevel.Updated||0)+parseInt(taskHistoryTableCtrl.clusterLevel.Unchanged||0)}),i++}}))},$scope.updateRunningExecutions=function(){taskHistoryTableCtrl.executionIds.length>0?(taskHistoryTableCtrl.disableAccessingStatistics=!0,"REF"!==taskHistoryTableCtrl.taskData.selection_method&&$scope.getMigrateStatusWs(),("REF"==taskHistoryTableCtrl.taskData.selection_method||taskHistoryTableCtrl.taskData.refcount>0)&&TDMService.postGenericAPI("extractrefstats",{taskExecutionId:taskHistoryTableCtrl.executionIds[0].task_execution_id,type:"S"}).then((function(response){taskHistoryTableCtrl.executionRefData=[];var executionsFinished=!1;for(key in response.result){let refExecution=response.result[key];refExecution.lu_name=key,refExecution.percentageOfCompleted=0,refExecution.totNumOfTablesToProcess>0&&(refExecution.percentageOfCompleted=refExecution.numOfProcessedRefTables/refExecution.totNumOfTablesToProcess*100),100==refExecution.percentageOfCompleted&&(executionsFinished=!0),refExecution.percentageOfCompleted=refExecution.percentageOfCompleted.toFixed(2),taskHistoryTableCtrl.executionRefData.push(refExecution)}1==executionsFinished&&$timeout((function(){getTableData(),taskHistoryTableCtrl.reloadData()}),5e3)}))):taskHistoryTableCtrl.disableAccessingStatistics=!1},taskHistoryTableCtrl.dtInstance={},taskHistoryTableCtrl.dtColumns=[],taskHistoryTableCtrl.dtColumnDefs=[],taskHistoryTableCtrl.headers=[{column:"lu_name",name:"Logical Unit Name",clickAble:!1},{column:"lu_parent_name",name:"Parent Logical Unit",clickAble:!1},{column:"process_name",name:"Post Execution Process Name",clickAble:!1},{column:"execution_status",name:"Execution Status",clickAble:!1},{column:"num_of_processed_entities",name:"Total Number Of Processed Entities",clickAble:!1},{column:"num_of_copied_entities",name:"Number Of Succeeded Entities",clickAble:!1},{column:"num_of_failed_entities",name:"Number Of Failed Entities",clickAble:!1},{column:"num_of_processed_ref_tables",name:"Total Number Of Processed Reference Tables",clickAble:!1},{column:"num_of_copied_ref_tables",name:"Number Of Copied Reference Tables",clickAble:!1},{column:"num_of_failed_ref_tables",name:"Number Of Failed Reference Tables",clickAble:!1},{column:"start_execution_time",name:"Start Execution Date",clickAble:!1,date:!0},{column:"end_execution_time",name:"End Execution Date",clickAble:!1,date:!0},{column:"source_env_name",name:"Source Environment Name",clickAble:!1},{column:"environment_name",name:"Target Environment Name",clickAble:!1},{column:"task_executed_by",name:"Task Executed By",clickAble:!0},{column:"be_name",name:"Business Entity Name",clickAble:!1},{column:"product_name",name:"System Name",clickAble:!1},{column:"product_version",name:"System Version",clickAble:!1},{column:"fabric_execution_id",name:"Fabric Execution Id",clickAble:!1,visible:!1},{column:"version_expiration_date",name:"Version Expiration Date",clickAble:!1,date:!0},{column:"execution_note",name:"Execution Note",clickAble:!1,date:!1}],taskHistoryTableCtrl.dtColumnDefs=[],$sessionStorage.taskHistoryTableHideColumns?taskHistoryTableCtrl.hideColumns=$sessionStorage.taskHistoryTableHideColumns:taskHistoryTableCtrl.hideColumns=[19];for(var i=0;i<taskHistoryTableCtrl.hideColumns.length;i++){var hideColumn=DTColumnDefBuilder.newColumnDef(taskHistoryTableCtrl.hideColumns[i]).withOption("visible",!1);taskHistoryTableCtrl.dtColumnDefs.push(hideColumn)}var changeToLocalDate=function(data,type,full,meta){return data?moment(data).format("DD MMM YYYY, HH:mm:ss"):""};taskHistoryTableCtrl.openEntitiesExecStats=function(taskExecId,type,fabricExecutionId,selectionMethod,refcount){taskHistoryTableCtrl.disableAccessingStatistics||$scope.$parent.$parent.$parent.tasks.openEntitiesExecStats(taskExecId,type,fabricExecutionId,selectionMethod,refcount)},taskHistoryTableCtrl.downloadSequenceReport=function(task_execution_id){TDMService.getGenericAPI("sequencereport/"+task_execution_id).then((function(response){}))},taskHistoryTableCtrl.downloadErrorReport=function(lu_name,taskExecutionId){TDMService.getSummaryReport(taskExecutionId,lu_name).then((function(response){"FAILED"!=response.errorCode&&ExcelService.buildSummaryExcel(response.result).xlsx.writeBuffer().then((function(data){var fileName=`Summary_Report_EXECID_${taskExecutionId}_${lu_name}.xlsx`,a=document.createElement("a");document.body.appendChild(a),a.style="display: none";var file=new Blob([data],{type:"application/vnd.ms-excel"}),fileURL=(window.URL||window.webkitURL).createObjectURL(file);a.href=fileURL,a.download=fileName,a.click(),(window.URL||window.webkitURL).revokeObjectURL(file)}))}))};for(i=0;i<taskHistoryTableCtrl.headers.length;i++)1==taskHistoryTableCtrl.headers[i].date?taskHistoryTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(taskHistoryTableCtrl.headers[i].column).withTitle(taskHistoryTableCtrl.headers[i].name).renderWith(changeToLocalDate)):taskHistoryTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(taskHistoryTableCtrl.headers[i].column).withTitle(taskHistoryTableCtrl.headers[i].name));taskHistoryTableCtrl.dtColumns.unshift(DTColumnBuilder.newColumn("taskHistoryActions").withTitle("").renderWith((function(data,type,full,meta){if(full.process_id)return"";var pathfile=taskHistoryTableCtrl.TDMReports.replace("[etlIpAddress]",full.etl_ip_address);full.etl_execution_id;var fileName=full.lu_name+"_Stats_Report_EXEID_"+full.etl_execution_id+".csv",seqName=full.lu_name+"_Sequences_Report_EXEID_"+full.etl_execution_id+".csv";taskHistoryTableCtrl.statsFile=pathfile+fileName,taskHistoryTableCtrl.seqFile=pathfile+seqName;var taskHistoryActions="";return!full.execution_status||"stopped"!=full.execution_status.toLowerCase()||taskHistoryTableCtrl.executionIds&&0!=taskHistoryTableCtrl.executionIds.length||(taskHistoryActions=taskHistoryActions+"<a ng-click=\"taskHistoryTableCtrl.resumeExecution('"+full.fabric_execution_id+"','"+full.task_execution_id+'\')" style="margin-left: 5px;border-color: transparent;background-color: transparent; color: black;" type="button" title="Resume Execution"><i class="fa fa-play"></i> </a>'),taskHistoryActions=taskHistoryTableCtrl.runningExecution==full.task_execution_id?taskHistoryActions='<a  style="margin-left: 3px;border-color: transparent;background-color: transparent; color: grey;cursor: not-allowed;"  type="button" title="Download Statistics File"><img src="icons/summary-report.svg"></img> </a>':taskHistoryActions+"<a ng-click=\"taskHistoryTableCtrl.downloadErrorReport('"+full.lu_name+"',"+full.task_execution_id+')"  style="margin-left: 3px;border-color: transparent;background-color: transparent; color: black;" title="Download Summary Report"><img src="icons/summary-report.svg"></img> </a>',full.fabric_execution_id,taskHistoryActions})).withOption("width","100"));var getTableData=function(){var deferred=$q.defer();const data=_.map(taskHistoryTableCtrl.taskHistoryData,row=>("EXTRACT"===taskHistoryTableCtrl.taskType&&(row.environment_name=""),row));return deferred.resolve(data),deferred.promise};if(taskHistoryTableCtrl.dtOptions=DTOptionsBuilder.fromFnPromise((function(){return getTableData()})).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("paging",!0).withOption("scrollX",!1).withButtons([{extend:"colvis",text:"Show/Hide columns",columns:[5,6,7,8,9,10,16,17,18,19],callback:function(columnIdx,visible){var index;1==visible?(index=taskHistoryTableCtrl.hideColumns.indexOf(columnIdx))>=0&&taskHistoryTableCtrl.hideColumns.splice(index,1):(index=taskHistoryTableCtrl.hideColumns.indexOf(columnIdx))<0&&taskHistoryTableCtrl.hideColumns.push(columnIdx);$sessionStorage.taskHistoryTableHideColumns=taskHistoryTableCtrl.hideColumns}}]),taskHistoryTableCtrl.taskHistoryData&&taskHistoryTableCtrl.taskHistoryData.length>0){const columns=[{type:"select",values:_.map(_.unique(_.map(taskHistoryTableCtrl.taskHistoryData,"lu_name")),(function(el){return{value:el,label:el}}))},{type:"select",values:_.map(_.unique(_.map(taskHistoryTableCtrl.taskHistoryData,"lu_parent_name")),(function(el){return{value:el,label:el}}))},{type:"select",values:_.map(_.unique(_.map(taskHistoryTableCtrl.taskHistoryData,"process_name")),(function(el){return{value:el,label:el}}))},{type:"select",values:_.map(_.unique(_.map(taskHistoryTableCtrl.taskHistoryData,"execution_status")),(function(el){return{value:el,label:el}}))},{type:"text"},{type:"text"},{type:"text"},{type:"text"},{type:"text"},{type:"text"},{type:"text"},{type:"text"},{type:"select",values:_.map(_.unique(_.map(taskHistoryTableCtrl.taskHistoryData,"source_env_name")),(function(el){return{value:el,label:el}}))},{type:"select",values:_.map(_.unique(_.map(taskHistoryTableCtrl.taskHistoryData,"environment_name")),(function(el){return{value:el,label:el}}))},{type:"select",values:_.map(_.unique(_.map(taskHistoryTableCtrl.taskHistoryData,"task_executed_by")),(function(el){return{value:el,label:el}}))},{type:"select",values:_.map(_.unique(_.map(taskHistoryTableCtrl.taskHistoryData,"be_name")),(function(el){return{value:el,label:el}}))},{type:"select",values:_.map(_.unique(_.map(taskHistoryTableCtrl.taskHistoryData,"product_name")),(function(el){return{value:el,label:el}}))},{type:"text"},{type:"text"},{type:"text"},{type:"text"}],lightColumnFilter={};columns.forEach((column,index)=>{let temp=angular.copy(column);temp.hidden=taskHistoryTableCtrl.hideColumns.indexOf(index+1)>=0,lightColumnFilter[index+1]=temp}),taskHistoryTableCtrl.dtOptions.withLightColumnFilter(lightColumnFilter)}taskHistoryTableCtrl.dtInstanceCallback=function(dtInstance){angular.isFunction(taskHistoryTableCtrl.dtInstance)?taskHistoryTableCtrl.dtInstance(dtInstance):angular.isDefined(taskHistoryTableCtrl.dtInstance)&&(taskHistoryTableCtrl.dtInstance=dtInstance)},null!=taskHistoryTableCtrl.dtInstance.changeData&&taskHistoryTableCtrl.dtInstance.changeData(getTableData()),$timeout(()=>{taskHistoryTableCtrl.loadingTable=!1})}})),taskHistoryTableCtrl.openBatchMonitor=batchId=>{$window.open(`${location.origin}/app/admin/batches/batch-monitor/${batchId}`,"_blank")}},controllerAs:"taskHistoryTableCtrl"}}angular.module("TDM-FE").directive("taskHistoryDirective",taskHistoryDirective);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvdGFza3MvdGFza0hpc3RvcnlEaXJlY3RpdmUuanMiXSwibmFtZXMiOlsidGFza0hpc3RvcnlEaXJlY3RpdmUiLCIkaW50ZXJ2YWwiLCJyZXN0cmljdCIsInRlbXBsYXRlVXJsIiwic2NvcGUiLCJjb250ZW50IiwibGluayIsImVsZW1lbnQiLCJhdHRyIiwidXBkYXRlUnVubmluZ0V4ZWN1dGlvbnMiLCJ1cGRhdGVEYXRhIiwib24iLCJjYW5jZWwiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJHJvb3RTY29wZSIsIiR3aW5kb3ciLCIkY29tcGlsZSIsIiR0aW1lb3V0IiwiVERNU2VydmljZSIsIkF1dGhTZXJ2aWNlIiwiRFRDb2x1bW5CdWlsZGVyIiwiRFRPcHRpb25zQnVpbGRlciIsIkRUQ29sdW1uRGVmQnVpbGRlciIsIiRxIiwiJHNlc3Npb25TdG9yYWdlIiwiJGh0dHAiLCJ0b2FzdHIiLCIkdWliTW9kYWwiLCJFeGNlbFNlcnZpY2UiLCJ0YXNrSGlzdG9yeVRhYmxlQ3RybCIsInRoaXMiLCJ0YXNrRGF0YSIsInRhc2siLCJsb2FkaW5nVGFibGUiLCJpbnRlcl9mbGFnIiwidXNlclJvbGUiLCJnZXRSb2xlIiwidXNlcm5hbWUiLCJnZXRVc2VybmFtZSIsIlRETVJlcG9ydHMiLCJnZXRURE1SZXBvcnRzIiwiZW5hYmxlU3RvcEV4ZWN1dGlvbiIsInRhc2tfc3RhdHVzIiwidHlwZSIsIm93bmVycyIsImluZGV4T2YiLCJ0YXNrX2NyZWF0ZWRfYnkiLCJkaXNhYmxlQWNjZXNzaW5nU3RhdGlzdGljcyIsImRpc2FibGVkIiwib25Ib2xkIiwiZXhlY3V0aW9uY291bnQiLCJnZXRUYXNrSGlzdG9yeSIsImV4ZWNfaWQiLCJ0aGVuIiwicmVzcG9uc2UiLCJlcnJvckNvZGUiLCJ0YXNrVHlwZSIsInJlc3VsdCIsImxlbmd0aCIsInRhc2tfdHlwZSIsInJ1bm5pbmdFeGVjdXRpb25zIiwicGVuZGluZ1Rhc2tzIiwidGFza0hpc3RvcnlEYXRhIiwiXyIsImZpbHRlciIsImV4ZWN1dGlvbiIsImV4ZWN1dGlvbl9zdGF0dXMiLCJ0b1VwcGVyQ2FzZSIsInB1c2giLCJydW5uaW5nRXhlY3V0aW9uIiwidGFza19leGVjdXRpb25faWQiLCJFeHRyYWN0UmVmU3RhdHNTdGFydGVkIiwiJGJyb2FkY2FzdCIsInNvcnRCeSIsInZhbHVlIiwiZXhlY3V0aW9uSWRzIiwibWFwIiwibmFtZSIsImx1X25hbWUiLCJwcm9jZXNzX25hbWUiLCJldGxfZXhlY3V0aW9uX2lkIiwiZXRsX2lwX2FkZHJlc3MiLCJmYWJyaWNfZXhlY3V0aW9uX2lkIiwicmVsb2FkRGF0YSIsImR0SW5zdGFuY2UiLCJkYXRhIiwic3RvcEV4ZWN1dGlvbiIsImV4ZWN1dGlvbklkIiwicG9zdEdlbmVyaWNBUEkiLCJ0YXNrRXhlY3V0aW9uSWQiLCJnZXRUYWJsZURhdGEiLCJzdGFydEV4dHJhY3RSZWZTdGF0c0RldGFpbGVkIiwic3RvcEludGVydmFsIiwib3BlbiIsIndpbmRvd1RvcENsYXNzIiwiJHVpYk1vZGFsSW5zdGFuY2UiLCJ0YXNrSGlzdG9yeVJlZkN0cmwiLCJnZXRFeHRyYWN0UmVmU3RhdHMiLCJyZWZEZXRhaWxlZERhdGEiLCJyZWZEYXRhIiwibnVtYmVyX29mX3JlY29yZHNfdG9fcHJvY2VzcyIsInBlcmNlbnRhZ2VPZkNvbXBsZXRlZCIsIm51bWJlcl9vZl9wcm9jZXNzZWRfcmVjb3JkcyIsImlzTmFOIiwidG9TdHJpbmciLCJyZXBsYWNlIiwiY2xvc2UiLCJjb250cm9sbGVyQXMiLCJyZXN1bWVFeGVjdXRpb24iLCJtaWdyYXRlSWQiLCJzdWNjZXNzIiwic2V0UmVsb2FkSW50ZXJ2YWwiLCJyZWxvYWRJbnRlcnZhbCIsInRpbWUiLCJjb25zb2xlIiwibG9nIiwicmVsb2FkX2ludGVydmFsIiwidGFza19pZCIsImdldEV4dHJhY3RUYXNrUmVmRGF0YSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwicm93Iiwic3RhcnRfdGltZSIsImVuZF90aW1lIiwiZXN0aW1hdGVkX3JlbWFpbmluZ19kdXJhdGlvbiIsImNhdGNoIiwiZXJyIiwiZG93bmxvYWRFeHRyYWN0UmVwb3J0IiwibG9naWNhbFVuaXQiLCJ0eXBlcyIsIm1pZ3JhdGVJZHMiLCJydW5Nb2RlcyIsImJ1aWxkU3VtbWFyeURhdGEiLCJ0YXNrRXhlY3V0aW9uIiwiZmluZCIsInNlbGVjdGlvbl9tZXRob2QiLCJyZWZjb3VudCIsIk9iamVjdCIsImFzc2lnbiIsInJlZmVyZW5jZSIsImJ1aWxkSHRtbCIsImJ1aWxkRGV0YWlsZWREYXRhIiwiZGV0YWlsZWREYXRhIiwidXNlck5hbWUiLCJyb3dzIiwiY29sdW1ucyIsIm5vZGVMaXN0IiwiUyIsImkiLCJyZXN1bHRzIiwiTGV2ZWwiLCJzdGF0dXMiLCJTdGF0dXMiLCJOYW1lIiwiSCIsIm1pZ3JhdGVDb21tYW5kIiwiRCIsIkpTT04iLCJwYXJzZSIsIlJlc3VsdHMiLCJBZGRlZCIsIlVwZGF0ZWQiLCJVbmNoYW5nZWQiLCJ0aXRsZSIsIm1ldGhvZCIsInVybCIsImh0bWxEYXRhIiwicmVwbGFjZUFsbCIsIm51bU9mUHJvY2Vzc2VkUmVmVGFibGVzIiwibnVtT2ZGYWlsZWRSZWZUYWJsZXMiLCJudW1PZkNvcGllZFJlZlRhYmxlcyIsIm1pblN0YXJ0RXhlY3V0aW9uRGF0ZSIsIm1heEVuZEV4ZWN1dGlvbkRhdGUiLCJyb3dEYXRhIiwiaiIsInJvd0RhdGFSZWYiLCJrZXkiLCJlcnJNc2dJbmRleCIsInNwbGljZSIsImZvckVhY2giLCJjb2x1bW4iLCJkb3dubG9hZEh0bWwiLCJzdW1tYXJ5RGF0YSIsImNvbHVtbnNOYW1lcyIsIlN0cmluZyIsInByb3RvdHlwZSIsInNlYXJjaCIsInJlcGxhY2VtZW50IiwiUmVnRXhwIiwiZmlsZU5hbWUiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJzdHlsZSIsImRpc3BsYXkiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJjbGljayIsInJlbW92ZUNoaWxkIiwiYnVpbGRTdW1tYXJ5SHRtbCIsImdldE1pZ3JhdGVTdGF0dXNXcyIsImV4ZWN1dGlvbkRhdGEiLCJyZXMiLCJtaWdyYXRpb25Db21tYW5kIiwiY2x1c3RlckxldmVsIiwiYWRkZWQiLCJTdWNjZWVkZWQiLCJtaWdyYXRlSUQiLCJyZW1haW5pbmdEdXJhdGlvbiIsImZhaWxlZCIsIkZhaWxlZCIsInByb2Nlc3NlZCIsInBhcnNlSW50IiwiZXhlY3V0aW9uUmVmRGF0YSIsImV4ZWN1dGlvbnNGaW5pc2hlZCIsInJlZkV4ZWN1dGlvbiIsInRvdE51bU9mVGFibGVzVG9Qcm9jZXNzIiwidG9GaXhlZCIsImR0Q29sdW1ucyIsImR0Q29sdW1uRGVmcyIsImhlYWRlcnMiLCJjbGlja0FibGUiLCJkYXRlIiwidmlzaWJsZSIsInRhc2tIaXN0b3J5VGFibGVIaWRlQ29sdW1ucyIsImhpZGVDb2x1bW5zIiwiaGlkZUNvbHVtbiIsIm5ld0NvbHVtbkRlZiIsIndpdGhPcHRpb24iLCJjaGFuZ2VUb0xvY2FsRGF0ZSIsImZ1bGwiLCJtZXRhIiwibW9tZW50IiwiZm9ybWF0Iiwib3BlbkVudGl0aWVzRXhlY1N0YXRzIiwidGFza0V4ZWNJZCIsImZhYnJpY0V4ZWN1dGlvbklkIiwic2VsZWN0aW9uTWV0aG9kIiwiJHBhcmVudCIsInRhc2tzIiwiZG93bmxvYWRTZXF1ZW5jZVJlcG9ydCIsImdldEdlbmVyaWNBUEkiLCJkb3dubG9hZEVycm9yUmVwb3J0IiwiZ2V0U3VtbWFyeVJlcG9ydCIsImJ1aWxkU3VtbWFyeUV4Y2VsIiwieGxzeCIsIndyaXRlQnVmZmVyIiwiYSIsImZpbGUiLCJCbG9iIiwiZmlsZVVSTCIsIndpbmRvdyIsIlVSTCIsIndlYmtpdFVSTCIsImNyZWF0ZU9iamVjdFVSTCIsImhyZWYiLCJkb3dubG9hZCIsInJldm9rZU9iamVjdFVSTCIsIm5ld0NvbHVtbiIsIndpdGhUaXRsZSIsInJlbmRlcldpdGgiLCJ1bnNoaWZ0IiwicHJvY2Vzc19pZCIsInBhdGhmaWxlIiwic2VxTmFtZSIsInN0YXRzRmlsZSIsInNlcUZpbGUiLCJ0YXNrSGlzdG9yeUFjdGlvbnMiLCJ0b0xvd2VyQ2FzZSIsImRlZmVycmVkIiwiZGVmZXIiLCJlbnZpcm9ubWVudF9uYW1lIiwicHJvbWlzZSIsImR0T3B0aW9ucyIsImZyb21GblByb21pc2UiLCJ3aXRoRE9NIiwiYW5ndWxhciIsImNvbnRlbnRzIiwid2l0aEJ1dHRvbnMiLCJleHRlbmQiLCJ0ZXh0IiwiY2FsbGJhY2siLCJjb2x1bW5JZHgiLCJpbmRleCIsInZhbHVlcyIsInVuaXF1ZSIsImVsIiwibGFiZWwiLCJsaWdodENvbHVtbkZpbHRlciIsInRlbXAiLCJjb3B5IiwiaGlkZGVuIiwid2l0aExpZ2h0Q29sdW1uRmlsdGVyIiwiZHRJbnN0YW5jZUNhbGxiYWNrIiwiaXNGdW5jdGlvbiIsImlzRGVmaW5lZCIsImNoYW5nZURhdGEiLCJvcGVuQmF0Y2hNb25pdG9yIiwiYmF0Y2hJZCIsImxvY2F0aW9uIiwib3JpZ2luIiwibW9kdWxlIiwiZGlyZWN0aXZlIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxxQkFBcUJDLFdBeWlDMUIsTUFBTyxDQUNIQyxTQUFVLEtBQ1ZDLFlBemlDYSxxQ0EwaUNiQyxNQUFPLENBQ0hDLFFBQVMsS0FFYkMsS0FBTSxTQUFVRixNQUFPRyxRQUFTQyxNQUN4QkosTUFBTUsseUJBQ05MLE1BQU1LLDBCQUVWLElBQUlDLFdBQWFULFdBQVUsV0FDbkJHLE1BQU1LLHlCQUNOTCxNQUFNSyw0QkFFWCxLQUVIRixRQUFRSSxHQUFHLFlBQVksV0FDbkJWLFVBQVVXLE9BQU9GLGdCQUd6QkcsV0F0akNhLFNBQVVDLE9BQVFDLFdBQVlDLFFBQVNDLFNBQVVDLFNBQVVDLFdBQVlDLFlBQ3BGQyxnQkFBaUJDLGlCQUFrQkMsbUJBQW9CQyxHQUFJQyxnQkFBaUJDLE1BQU9DLE9BQVExQixVQUFXMkIsVUFBV0MsY0FDakgsSUFBSUMscUJBQXVCQyxLQUMzQkQscUJBQXFCRSxTQUFXbEIsT0FBT1QsUUFBUTRCLEtBQy9DSCxxQkFBcUJJLGNBQWUsRUFDcENuQixXQUFXb0Is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QVMsSUFBTSxFQUNwRUssa0JBQWtCTCxNQUFRLEdBQUtNLE9BRW5DdFEscUJBQXFCc1AsVUFBVW1CLHNCQUFzQkosbUJBRzdEclEscUJBQXFCMFEsbUJBQXFCLFNBQVVuTixZQUM1Q2tNLFFBQVFrQixXQUFXM1EscUJBQXFCdUQsWUFDeEN2RCxxQkFBcUJ1RCxXQUFXQSxZQUN6QmtNLFFBQVFtQixVQUFVNVEscUJBQXFCdUQsY0FDOUN2RCxxQkFBcUJ1RCxXQUFhQSxhQUdRLE1BQTlDdkQscUJBQXFCdUQsV0FBV3NOLFlBQ2hDN1EscUJBQXFCdUQsV0FBV3NOLFdBQVdoTixnQkFHM0N6RSxTQUFTLEtBQ0xZLHFCQUFxQkksY0FBZSxRQUtoREoscUJBQXFCOFEsaUJBQW9CQyxVQUNyQzdSLFFBQVE4RSxLQUFLLEdBQUdnTixTQUFTQywwQ0FBMENGLFVBQVcsWUEwQmxGak0sYUFBYyx3QkFLdEIySyxRQUNLeUIsT0FBTyxVQUNQQyxVQUFVLHVCQUF3QmpUIiwiZmlsZSI6ImRpcmVjdGl2ZXMvdGFza3MvdGFza0hpc3RvcnlEaXJlY3RpdmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiB0YXNrSGlzdG9yeURpcmVjdGl2ZSgkaW50ZXJ2YWwpIHtcblxuICAgIGNvbnN0IHRlbXBsYXRlID0gXCJ2aWV3cy90YXNrcy90YXNrc0hpc3RvcnlUYWJsZS5odG1sXCI7XG4gICAgLy92YXIgaW50ZXJ2YWxfcnVubm5pbmdfZmxhZyA9IGZhbHNlO1xuICAgIHZhciB0YXNrSWQ7XG4gICAgdmFyIGN1cnJlbnRUYXNrSWQ7XG5cbiAgICB2YXIgY29udHJvbGxlciA9IGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsICR3aW5kb3csICRjb21waWxlLCAkdGltZW91dCwgVERNU2VydmljZSwgQXV0aFNlcnZpY2UsXG4gICAgICAgIERUQ29sdW1uQnVpbGRlciwgRFRPcHRpb25zQnVpbGRlciwgRFRDb2x1bW5EZWZCdWlsZGVyLCAkcSwgJHNlc3Npb25TdG9yYWdlLCAkaHR0cCwgdG9hc3RyLCAkaW50ZXJ2YWwsICR1aWJNb2RhbCwgRXhjZWxTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB0YXNrSGlzdG9yeVRhYmxlQ3RybCA9IHRoaXM7XG4gICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tEYXRhID0gJHNjb3BlLmNvbnRlbnQudGFzaztcbiAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwubG9hZGluZ1RhYmxlID0gdHJ1ZTtcbiAgICAgICAgJHJvb3RTY29wZS5pbnRlcl9mbGFnID0gZmFsc2U7XG4gICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLnVzZXJSb2xlID0gQXV0aFNlcnZpY2UuZ2V0Um9sZSgpO1xuICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC51c2VybmFtZSA9IEF1dGhTZXJ2aWNlLmdldFVzZXJuYW1lKCk7XG4gICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLlRETVJlcG9ydHMgPSBBdXRoU2VydmljZS5nZXRURE1SZXBvcnRzKCk7XG4gICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmVuYWJsZVN0b3BFeGVjdXRpb24gPSBmYWxzZTtcblxuICAgICAgICBpZiAodGFza0hpc3RvcnlUYWJsZUN0cmwudGFza0RhdGEudGFza19zdGF0dXMgPT0gXCJBY3RpdmVcIiAmJlxuICAgICAgICAgICAgKHRhc2tIaXN0b3J5VGFibGVDdHJsLnVzZXJSb2xlLnR5cGUgPT0gJ2FkbWluJyB8fCB0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrRGF0YS5vd25lcnMuaW5kZXhPZih0YXNrSGlzdG9yeVRhYmxlQ3RybC51c2VybmFtZSkgPj0gMCB8fCB0YXNrSGlzdG9yeVRhYmxlQ3RybC51c2VybmFtZSA9PSB0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrRGF0YS50YXNrX2NyZWF0ZWRfYnkgKSkge1xuICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuZW5hYmxlU3RvcEV4ZWN1dGlvbiA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kaXNhYmxlQWNjZXNzaW5nU3RhdGlzdGljcyA9IHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tEYXRhLmRpc2FibGVkIHx8IHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tEYXRhLm9uSG9sZCB8fCB0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrRGF0YS5leGVjdXRpb25jb3VudCA/IHRydWUgOiBmYWxzZTtcblxuICAgICAgICBURE1TZXJ2aWNlLmdldFRhc2tIaXN0b3J5KCRzY29wZS5jb250ZW50LmV4ZWNfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlICE9ICdTVUNDRVNTJykge1xuICAgICAgICAgICAgICAgIC8vVE9ETyBzaG93IEVycm9yXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrVHlwZSA9IFwiTE9BRFwiO1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdCAmJiByZXNwb25zZS5yZXN1bHQubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwudGFza1R5cGUgPSByZXNwb25zZS5yZXN1bHRbMF0udGFza190eXBlIHx8IFwiTE9BRFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5ydW5uaW5nRXhlY3V0aW9ucyA9IFtdO1xuXG4gICAgICAgICAgICB2YXIgcGVuZGluZ1Rhc2tzID0gZmFsc2U7XG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrSGlzdG9yeURhdGEgPSBfLmZpbHRlcihyZXNwb25zZS5yZXN1bHQsIGZ1bmN0aW9uIChleGVjdXRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoIWV4ZWN1dGlvbi5leGVjdXRpb25fc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZXhlY3V0aW9uLmV4ZWN1dGlvbl9zdGF0dXMudG9VcHBlckNhc2UoKSA9PSAnUlVOTklORycgfHwgZXhlY3V0aW9uLmV4ZWN1dGlvbl9zdGF0dXMudG9VcHBlckNhc2UoKSA9PSBcIkVYRUNVVElOR1wiXG4gICAgICAgICAgICAgICAgICAgIHx8IGV4ZWN1dGlvbi5leGVjdXRpb25fc3RhdHVzLnRvVXBwZXJDYXNlKCkgPT0gXCJTVEFSVEVEXCIgfHwgZXhlY3V0aW9uLmV4ZWN1dGlvbl9zdGF0dXMudG9VcHBlckNhc2UoKSA9PSBcIlNUQVJURVhFQ1VUSU9OUkVRVUVTVEVEXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwucnVubmluZ0V4ZWN1dGlvbnMucHVzaChleGVjdXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5ydW5uaW5nRXhlY3V0aW9uID0gZXhlY3V0aW9uLnRhc2tfZXhlY3V0aW9uX2lkO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV4ZWN1dGlvbi5leGVjdXRpb25fc3RhdHVzLnRvVXBwZXJDYXNlKCkgPT0gJ1BFTkRJTkcnIHx8IGV4ZWN1dGlvbi5leGVjdXRpb25fc3RhdHVzLnRvVXBwZXJDYXNlKCkgPT0gJ1BBVVNFRCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwucnVubmluZ0V4ZWN1dGlvbiA9IGV4ZWN1dGlvbi50YXNrX2V4ZWN1dGlvbl9pZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGV4ZWN1dGlvbi5leGVjdXRpb25fc3RhdHVzLnRvVXBwZXJDYXNlKCkgPT0gJ1BFTkRJTkcnKXtcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1Rhc2tzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKHRhc2tIaXN0b3J5VGFibGVDdHJsLnJ1bm5pbmdFeGVjdXRpb25zLmxlbmd0aCA9PSAwKXtcbiAgICAgICAgICAgICAgICBpZiAodGFza0hpc3RvcnlUYWJsZUN0cmwuRXh0cmFjdFJlZlN0YXRzU3RhcnRlZCl7XG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0YXNrSGlzdG9yeVRhYmxlQ3RybC5FeHRyYWN0UmVmU3RhdHNTdGFydGVkKTtcbiAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuRXh0cmFjdFJlZlN0YXRzU3RhcnRlZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocGVuZGluZ1Rhc2tzICYmIHRhc2tIaXN0b3J5VGFibGVDdHJsLnJ1bm5pbmdFeGVjdXRpb25zLmxlbmd0aCA9PSAwKXtcbiAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgncmVmcmVzaFBhZ2UnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9LCAxMDAwMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tIaXN0b3J5RGF0YSA9IF8uc29ydEJ5KHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tIaXN0b3J5RGF0YSwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICh2YWx1ZS50YXNrX2V4ZWN1dGlvbl9pZCAqIC0xKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuZXhlY3V0aW9uSWRzID0gXy5tYXAodGFza0hpc3RvcnlUYWJsZUN0cmwucnVubmluZ0V4ZWN1dGlvbnMsIGZ1bmN0aW9uIChleGVjdXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBleGVjdXRpb24ubHVfbmFtZSB8fCBleGVjdXRpb24ucHJvY2Vzc19uYW1lLFxuICAgICAgICAgICAgICAgICAgICBldGxfZXhlY3V0aW9uX2lkOiBleGVjdXRpb24uZXRsX2V4ZWN1dGlvbl9pZCxcbiAgICAgICAgICAgICAgICAgICAgZXRsX2lwX2FkZHJlc3M6IGV4ZWN1dGlvbi5ldGxfaXBfYWRkcmVzcyxcbiAgICAgICAgICAgICAgICAgICAgZmFicmljX2V4ZWN1dGlvbl9pZCA6IGV4ZWN1dGlvbi5mYWJyaWNfZXhlY3V0aW9uX2lkLFxuICAgICAgICAgICAgICAgICAgICB0YXNrX2V4ZWN1dGlvbl9pZCA6IGV4ZWN1dGlvbi50YXNrX2V4ZWN1dGlvbl9pZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kaXNhYmxlQWNjZXNzaW5nU3RhdGlzdGljcyA9IHRhc2tIaXN0b3J5VGFibGVDdHJsLmV4ZWN1dGlvbklkcy5sZW5ndGggPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLnJlbG9hZERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwucnVubmluZ0V4ZWN1dGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwucnVubmluZ0V4ZWN1dGlvbnMgPSBbXTtcbiAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLmdldFRhc2tIaXN0b3J5KCRzY29wZS5jb250ZW50LmV4ZWNfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgIT0gJ1NVQ0NFU1MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1RPRE8gc2hvdyBFcnJvclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBwZW5kaW5nVGFza3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwudGFza0hpc3RvcnlEYXRhID0gXy5maWx0ZXIocmVzcG9uc2UucmVzdWx0LCBmdW5jdGlvbiAoZXhlY3V0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhlY3V0aW9uLmV4ZWN1dGlvbl9zdGF0dXMudG9VcHBlckNhc2UoKSA9PSAnUlVOTklORycgfHwgZXhlY3V0aW9uLmV4ZWN1dGlvbl9zdGF0dXMudG9VcHBlckNhc2UoKSA9PSBcIkVYRUNVVElOR1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgZXhlY3V0aW9uLmV4ZWN1dGlvbl9zdGF0dXMudG9VcHBlckNhc2UoKSA9PSBcIlNUQVJURURcIiB8fCBleGVjdXRpb24uZXhlY3V0aW9uX3N0YXR1cy50b1VwcGVyQ2FzZSgpID09IFwiU1RBUlRFWEVDVVRJT05SRVFVRVNURURcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLnJ1bm5pbmdFeGVjdXRpb24gPSBleGVjdXRpb24udGFza19leGVjdXRpb25faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwucnVubmluZ0V4ZWN1dGlvbnMucHVzaChleGVjdXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV4ZWN1dGlvbi5leGVjdXRpb25fc3RhdHVzLnRvVXBwZXJDYXNlKCkgPT0gJ1BFTkRJTkcnIHx8IGV4ZWN1dGlvbi5leGVjdXRpb25fc3RhdHVzLnRvVXBwZXJDYXNlKCkgPT0gJ1BBVVNFRCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5ydW5uaW5nRXhlY3V0aW9uID0gZXhlY3V0aW9uLnRhc2tfZXhlY3V0aW9uX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRhc2tIaXN0b3J5VGFibGVDdHJsLnJ1bm5pbmdFeGVjdXRpb25zLnB1c2goZXhlY3V0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleGVjdXRpb24uZXhlY3V0aW9uX3N0YXR1cy50b1VwcGVyQ2FzZSgpID09ICdQRU5ESU5HJyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1Rhc2tzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1Rhc2tzICYmIHRhc2tIaXN0b3J5VGFibGVDdHJsLnJ1bm5pbmdFeGVjdXRpb25zLmxlbmd0aCA9PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3JlZnJlc2hQYWdlJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuZXhlY3V0aW9uSWRzID0gXy5tYXAodGFza0hpc3RvcnlUYWJsZUN0cmwucnVubmluZ0V4ZWN1dGlvbnMsIGZ1bmN0aW9uIChleGVjdXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZXhlY3V0aW9uLmx1X25hbWUgfHwgZXhlY3V0aW9uLnByb2Nlc3NfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldGxfZXhlY3V0aW9uX2lkOiBleGVjdXRpb24uZXRsX2V4ZWN1dGlvbl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldGxfaXBfYWRkcmVzczogZXhlY3V0aW9uLmV0bF9pcF9hZGRyZXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhYnJpY19leGVjdXRpb25faWQgOiBleGVjdXRpb24uZmFicmljX2V4ZWN1dGlvbl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrX2V4ZWN1dGlvbl9pZCA6IGV4ZWN1dGlvbi50YXNrX2V4ZWN1dGlvbl9pZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwudGFza0hpc3RvcnlEYXRhID0gXy5zb3J0QnkodGFza0hpc3RvcnlUYWJsZUN0cmwudGFza0hpc3RvcnlEYXRhLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAodmFsdWUudGFza19leGVjdXRpb25faWQgKiAtMSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kdEluc3RhbmNlLnJlbG9hZERhdGEoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgfSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuc3RvcEV4ZWN1dGlvbiA9IGZ1bmN0aW9uIChleGVjdXRpb25JZCkge1xuICAgICAgICAgICAgICAgIGlmICh0YXNrSGlzdG9yeVRhYmxlQ3RybC5leGVjdXRpb25JZHMubGVuZ3RoID09IDApe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFRETVNlcnZpY2UucG9zdEdlbmVyaWNBUEkoJ2NhbmNlbE1pZ3JhdFdTJyx7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tFeGVjdXRpb25JZCA6IHRhc2tIaXN0b3J5VGFibGVDdHJsLmV4ZWN1dGlvbklkc1swXS50YXNrX2V4ZWN1dGlvbl9pZFxuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5leGVjdXRpb25JZHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0VGFibGVEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5yZWxvYWREYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuc3RhcnRFeHRyYWN0UmVmU3RhdHNEZXRhaWxlZCA9IGZ1bmN0aW9uKHR5cGUsIGx1X25hbWUpe1xuICAgICAgICAgICAgICAgIGlmICghdGFza0hpc3RvcnlUYWJsZUN0cmwuZXhlY3V0aW9uSWRzIHx8IHRhc2tIaXN0b3J5VGFibGVDdHJsLmV4ZWN1dGlvbklkcy5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IHN0b3BJbnRlcnZhbDtcbiAgICAgICAgICAgICAgICB2YXIgdGFza19leGVjdXRpb25faWQgPSB0YXNrSGlzdG9yeVRhYmxlQ3RybC5leGVjdXRpb25JZHNbMF0udGFza19leGVjdXRpb25faWQ7XG4gICAgICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3Rhc2tzL3Rhc2tIaXN0b3J5UmVmTW9kYWwuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd1RvcENsYXNzIDogXCJ0YXNrSGlzdG9yeVJlZlwiLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWxJbnN0YW5jZSwgVERNU2VydmljZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhc2tIaXN0b3J5UmVmQ3RybCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVJlZkN0cmwuZ2V0RXh0cmFjdFJlZlN0YXRzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLnBvc3RHZW5lcmljQVBJKCdleHRyYWN0cmVmc3RhdHMnLHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0V4ZWN1dGlvbklkIDogdGFza19leGVjdXRpb25faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgOiAnRCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlSZWZDdHJsLnJlZkRldGFpbGVkRGF0YSA9IF8ubWFwKHJlc3BvbnNlLnJlc3VsdCB8fCBbXSxmdW5jdGlvbihyZWZEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWZEYXRhLm51bWJlcl9vZl9yZWNvcmRzX3RvX3Byb2Nlc3MgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZEYXRhLnBlcmNlbnRhZ2VPZkNvbXBsZXRlZCA9IHJlZkRhdGEubnVtYmVyX29mX3Byb2Nlc3NlZF9yZWNvcmRzIC8gKHJlZkRhdGEubnVtYmVyX29mX3JlY29yZHNfdG9fcHJvY2VzcykgKiAxMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKHJlZkRhdGEubnVtYmVyX29mX3JlY29yZHNfdG9fcHJvY2Vzcykpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZkRhdGEubnVtYmVyX29mX3JlY29yZHNfdG9fcHJvY2VzcyA9IHJlZkRhdGEubnVtYmVyX29mX3JlY29yZHNfdG9fcHJvY2Vzcy50b1N0cmluZygpLnJlcGxhY2UoL1xcQig/PShcXGR7M30pKyg/IVxcZCkpL2csIFwiLFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4ocmVmRGF0YS5udW1iZXJfb2ZfcHJvY2Vzc2VkX3JlY29yZHMpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZEYXRhLm51bWJlcl9vZl9wcm9jZXNzZWRfcmVjb3JkcyA9IHJlZkRhdGEubnVtYmVyX29mX3Byb2Nlc3NlZF9yZWNvcmRzLnRvU3RyaW5nKCkucmVwbGFjZSgvXFxCKD89KFxcZHszfSkrKD8hXFxkKSkvZywgXCIsXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZkRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlSZWZDdHJsLnJlZkRldGFpbGVkRGF0YSA9IF8uZmlsdGVyKHRhc2tIaXN0b3J5UmVmQ3RybC5yZWZEZXRhaWxlZERhdGEsZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShkYXRhICYmIGRhdGEubHVfbmFtZSA9PT0gbHVfbmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSBcImZhaWxlZFwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5leGVjdXRpb25fc3RhdHVzID09IFwiZmFpbGVkXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgIT0gXCJmYWlsZWRcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZXhlY3V0aW9uX3N0YXR1cyA9PSBcImZhaWxlZFwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7ICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BJbnRlcnZhbCA9ICRpbnRlcnZhbChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5UmVmQ3RybC5nZXRFeHRyYWN0UmVmU3RhdHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sMTAwMDApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVJlZkN0cmwuZ2V0RXh0cmFjdFJlZlN0YXRzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5UmVmQ3RybC5jbG9zZSA9IGZ1bmN0aW9uICgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR1aWJNb2RhbEluc3RhbmNlLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd0YXNrSGlzdG9yeVJlZkN0cmwnXG4gICAgICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RvcEludGVydmFsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwoc3RvcEludGVydmFsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0b3BJbnRlcnZhbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHN0b3BJbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5yZXN1bWVFeGVjdXRpb24gPSBmdW5jdGlvbihtaWdyYXRlSWQsdGFza19leGVjdXRpb25faWQpe1xuICAgICAgICAgICAgICAgIGlmICh0YXNrX2V4ZWN1dGlvbl9pZCl7XG4gICAgICAgICAgICAgICAgICAgIFRETVNlcnZpY2UucG9zdEdlbmVyaWNBUEkoJ3Jlc3VtZU1pZ3JhdFdTJyx7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrRXhlY3V0aW9uSWQgOiB0YXNrX2V4ZWN1dGlvbl9pZCxcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhcIlRhc2sgRXhlY3V0aW9uICMgXCIgKyB0YXNrX2V4ZWN1dGlvbl9pZCwgXCIgU3VjY2Vzc2Z1bGx5IFJlc3VtZWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdyZWZyZXNoUGFnZScsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuc2V0UmVsb2FkSW50ZXJ2YWwgPSBmdW5jdGlvbiAocmVsb2FkSW50ZXJ2YWwpIHtcblxuICAgICAgICAgICAgICAgIHZhciB0aW1lID0gKHJlbG9hZEludGVydmFsICogMTAwMCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzZXR0aW5nIG5ldyByZWxvYWQgaW50ZXJ2YWw6IFwiLCB0aW1lKTtcbiAgICAgICAgICAgICAgICAvLyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShBdXRoU2VydmljZS5nZXRVc2VybmFtZSgpLCB0aW1lKTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnJlbG9hZF9pbnRlcnZhbCA9IHRpbWU7XG4gICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwucmVsb2FkX2ludGVydmFsID0gdGltZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gICAgICAgICAgICB2YXIgcmVsb2FkX2ludGVydmFsID0gJHJvb3RTY29wZS5yZWxvYWRfaW50ZXJ2YWw7XG4gICAgICAgICAgICBjdXJyZW50VGFza0lkID0gdGFza0hpc3RvcnlUYWJsZUN0cmwudGFza0RhdGEudGFza19pZDtcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVsb2FkX2Z1bmMoKSB7XG4gICAgICAgICAgICAgICAgVERNU2VydmljZS5nZXRUYXNrSGlzdG9yeSgkc2NvcGUuY29udGVudC5leGVjX2lkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlICE9ICdTVUNDRVNTJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9UT0RPIHNob3cgRXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrSGlzdG9yeURhdGEgPSBfLmZpbHRlcihyZXNwb25zZS5yZXN1bHQsIGZ1bmN0aW9uIChleGVjdXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleGVjdXRpb24uZXhlY3V0aW9uX3N0YXR1cy50b1VwcGVyQ2FzZSgpID09ICdSVU5OSU5HJyB8fCBleGVjdXRpb24uZXhlY3V0aW9uX3N0YXR1cy50b1VwcGVyQ2FzZSgpID09IFwiRVhFQ1VUSU5HXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBleGVjdXRpb24uZXhlY3V0aW9uX3N0YXR1cy50b1VwcGVyQ2FzZSgpID09IFwiU1RBUlRFRFwiIHx8IGV4ZWN1dGlvbi5leGVjdXRpb25fc3RhdHVzLnRvVXBwZXJDYXNlKCkgPT0gXCJTVEFSVEVYRUNVVElPTlJFUVVFU1RFRFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrSGlzdG9yeURhdGEgPSBfLnNvcnRCeSh0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrSGlzdG9yeURhdGEsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICh2YWx1ZS50YXNrX2V4ZWN1dGlvbl9pZCAqIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmR0SW5zdGFuY2UucmVsb2FkRGF0YShmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB9LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3JlZnJlc2hQYWdlJywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpbnRlcnZhbEZ1bmMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG5cbiAgICAgICAgICAgICAgICByZWxvYWRfaW50ZXJ2YWwgPSAkcm9vdFNjb3BlLnJlbG9hZF9pbnRlcnZhbDtcbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pbnRlcl9mbGFnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChpbnRlcnZhbEZ1bmMsIHJlbG9hZF9pbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWxvYWRfZnVuYygpO1xuICAgICAgICAgICAgICAgICAgICBpbnRlcnZhbCA9IHNldEludGVydmFsKGludGVydmFsRnVuYywgcmVsb2FkX2ludGVydmFsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBpZiAoIWludGVydmFsX3J1bm5uaW5nX2ZsYWcpIHtcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyAgICAgIHZhciBpbnRlcnZhbCA9IHNldEludGVydmFsKGludGVydmFsRnVuYywgcmVsb2FkX2ludGVydmFsKTtcbiAgICAgICAgICAgIC8vICAgICAgaW50ZXJ2YWxfcnVubm5pbmdfZmxhZyA9IHRydWU7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5yZWxvYWRfaW50ZXJ2YWwgPSAkcm9vdFNjb3BlLnJlbG9hZF9pbnRlcnZhbDtcblxuICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuZ2V0RXh0cmFjdFRhc2tSZWZEYXRhID0gZnVuY3Rpb24odGFza19leGVjdXRpb25faWQsdHlwZSxsdV9uYW1lKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIFRETVNlcnZpY2UucG9zdEdlbmVyaWNBUEkoJ2V4dHJhY3RyZWZzdGF0cycse1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0V4ZWN1dGlvbklkIDogdGFza19leGVjdXRpb25faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlIDogdHlwZVxuICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnRCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0ICYmIHJlc3BvbnNlLnJlc3VsdCAmJiByZXNwb25zZS5yZXN1bHQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5yZXN1bHQgPSBfLmZpbHRlciAocmVzcG9uc2UucmVzdWx0LGZ1bmN0aW9uKHJvdykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93WydzdGFydF90aW1lKFVUQyknXSA9IHJvdy5zdGFydF90aW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93WydlbmRfdGltZShVVEMpJ10gPSByb3cuZW5kX3RpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgcm93LnN0YXJ0X3RpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgcm93LmVuZF90aW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHJvdy5lc3RpbWF0ZWRfcmVtYWluaW5nX2R1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvdyAmJiByb3cubHVfbmFtZSA9PT0gbHVfbmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlID09PSAnUycpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnJlc3VsdCA9IHJlc3BvbnNlLnJlc3VsdFtsdV9uYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmRvd25sb2FkRXh0cmFjdFJlcG9ydCA9IGZ1bmN0aW9uKHR5cGUsbWlncmF0ZUlkLGxvZ2ljYWxVbml0LHRhc2tFeGVjdXRpb25JZCl7XG4gICAgICAgICAgICAgICAgdmFyIHR5cGVzID0gW3R5cGUsJ0gnXTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSAnRCcpe1xuICAgICAgICAgICAgICAgICAgICB0eXBlcy5wdXNoKCdTJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChtaWdyYXRlSWQgIT0gXCJudWxsXCIpe1xuICAgICAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLnBvc3RHZW5lcmljQVBJKCdtaWdyYXRlU3RhdHVzV3MnLHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pZ3JhdGVJZHMgOiBtaWdyYXRlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBydW5Nb2RlcyA6IHR5cGVzXG4gICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gJ1MnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9ICRzY29wZS5idWlsZFN1bW1hcnlEYXRhKHJlc3BvbnNlLnJlc3VsdCxtaWdyYXRlSWQsbG9naWNhbFVuaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXNrRXhlY3V0aW9uID0gXy5maW5kKHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tIaXN0b3J5RGF0YSx7IHRhc2tfZXhlY3V0aW9uX2lkOnRhc2tFeGVjdXRpb25JZCwgbHVfbmFtZTogbG9naWNhbFVuaXR9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFza0V4ZWN1dGlvbiAmJiAodGFza0V4ZWN1dGlvbi5zZWxlY3Rpb25fbWV0aG9kID09IFwiUkVGXCIgfHwgdGFza0V4ZWN1dGlvbi5yZWZjb3VudCA+IDApKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhc2tIaXN0b3J5VGFibGVDdHJsLmdldEV4dHJhY3RUYXNrUmVmRGF0YSh0YXNrRXhlY3V0aW9uLnRhc2tfZXhlY3V0aW9uX2lkLCB0eXBlLCBsb2dpY2FsVW5pdCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gT2JqZWN0LmFzc2lnbihkYXRhLHJlc3BvbnNlLnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnJlZmVyZW5jZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRIdG1sKCdzdW1tYXJ5JyxkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5idWlsZEh0bWwoJ3N1bW1hcnknLGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT0gJ0QnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9ICRzY29wZS5idWlsZERldGFpbGVkRGF0YShyZXNwb25zZS5yZXN1bHQsbWlncmF0ZUlkLGxvZ2ljYWxVbml0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFza0V4ZWN1dGlvbiA9IF8uZmluZCh0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrSGlzdG9yeURhdGEseyB0YXNrX2V4ZWN1dGlvbl9pZDp0YXNrRXhlY3V0aW9uSWQsIGx1X25hbWU6IGxvZ2ljYWxVbml0fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tFeGVjdXRpb24gJiYgKHRhc2tFeGVjdXRpb24uc2VsZWN0aW9uX21ldGhvZCA9PSBcIlJFRlwiIHx8IHRhc2tFeGVjdXRpb24ucmVmY291bnQgPiAwKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXNrSGlzdG9yeVRhYmxlQ3RybC5nZXRFeHRyYWN0VGFza1JlZkRhdGEodGFza0V4ZWN1dGlvbi50YXNrX2V4ZWN1dGlvbl9pZCwgdHlwZSwgbG9naWNhbFVuaXQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IE9iamVjdC5hc3NpZ24oZGF0YSx7cmVmRGF0YSA6IHJlc3BvbnNlLnJlc3VsdH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5yZWZlcmVuY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSHRtbCgnZGV0YWlsZWQnLGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSHRtbCgnZGV0YWlsZWQnLGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFza0V4ZWN1dGlvbiA9IF8uZmluZCh0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrSGlzdG9yeURhdGEseyB0YXNrX2V4ZWN1dGlvbl9pZDp0YXNrRXhlY3V0aW9uSWQsIGx1X25hbWU6IGxvZ2ljYWxVbml0fSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tFeGVjdXRpb24gJiYgKHRhc2tFeGVjdXRpb24uc2VsZWN0aW9uX21ldGhvZCA9PSBcIlJFRlwiIHx8IHRhc2tFeGVjdXRpb24ucmVmY291bnQgPiAwKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFza0hpc3RvcnlUYWJsZUN0cmwuZ2V0RXh0cmFjdFRhc2tSZWZEYXRhKHRhc2tFeGVjdXRpb24udGFza19leGVjdXRpb25faWQsIHR5cGUsIGxvZ2ljYWxVbml0KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ1MnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UucmVzdWx0LnJlZmVyZW5jZSA9IHRydWU7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRIdG1sKHR5cGUgPT0gJ1MnID8gJ3N1bW1hcnknIDogJ2RldGFpbGVkJyx0eXBlID09ICdTJyA/IHJlc3BvbnNlLnJlc3VsdCA6IHtyZWZEYXRhIDogcmVzcG9uc2UucmVzdWx0LCByZWZlcmVuY2U6IHRydWV9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSAgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5idWlsZERldGFpbGVkRGF0YSA9IGZ1bmN0aW9uKGRldGFpbGVkRGF0YSxtaWdyYXRlSWQsbG9naWNhbFVuaXQpe1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBtaWdyYXRlSWQgOiBtaWdyYXRlSWQsXG4gICAgICAgICAgICAgICAgICAgIGxvZ2ljYWxVbml0IDogbG9naWNhbFVuaXQsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJOYW1lIDogdGFza0hpc3RvcnlUYWJsZUN0cmwudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHJvd3MgOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgY29sdW1ucyA6IFtdLFxuICAgICAgICAgICAgICAgICAgICBub2RlTGlzdCA6IFtdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoZGV0YWlsZWREYXRhICYmIGRldGFpbGVkRGF0YS5TKXtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7aSA8IGRldGFpbGVkRGF0YS5TLnJlc3VsdHMubGVuZ3RoIDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZXRhaWxlZERhdGEuUy5yZXN1bHRzW2ldLmNvbHVtbnMuTGV2ZWwgPT0gXCJDbHVzdGVyXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gZGV0YWlsZWREYXRhLlMucmVzdWx0c1tpXS5jb2x1bW5zLlN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZXRhaWxlZERhdGEuUy5yZXN1bHRzW2ldLmNvbHVtbnMuTGV2ZWwgPT0gXCJOb2RlXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubm9kZUxpc3QucHVzaChkZXRhaWxlZERhdGEuUy5yZXN1bHRzW2ldLmNvbHVtbnMuTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGRldGFpbGVkRGF0YSAmJiBkZXRhaWxlZERhdGEuSCl7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEubWlncmF0ZUNvbW1hbmQgPSBkZXRhaWxlZERhdGEuSFtcIk1pZ3JhdGlvbiBDb21tYW5kXCJdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZGV0YWlsZWREYXRhICYmIGRldGFpbGVkRGF0YS5EKXtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5jb2x1bW5zID0gW1wiRW50aXR5IElEXCIsIFwiRXJyb3JcIiwgXCJOb2RlIGlkXCIsIFwiUmVzdWx0c1wiLCBcIlN0YXR1c1wiXTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yb3dzID0gXy5tYXAoZGV0YWlsZWREYXRhLkQsZnVuY3Rpb24ocm93KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gSlNPTi5wYXJzZShyb3cuUmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0cyAmJiByZXN1bHRzLkFkZGVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5SZXN1bHRzID0gJ0FkZGVkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlc3VsdHMgJiYgcmVzdWx0cy5VcGRhdGVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5SZXN1bHRzID0gJ1VwZGF0ZWQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlc3VsdHMgJiYgcmVzdWx0cy5VbmNoYW5nZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93LlJlc3VsdHMgPSAnVW5jaGFuZ2VkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm93O1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSHRtbCA9IGZ1bmN0aW9uKHRpdGxlLGRhdGEpe1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAndmlld3Mvc3RhdGljSHRtbHMvJysgdGl0bGUgKycuaHRtbCdcbiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbERhdGEgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbERhdGEgPSBodG1sRGF0YS5yZXBsYWNlQWxsKFwie3ttaWdyYXRpb259fVwiLGRhdGEubWlncmF0ZUlkID8gJ2Jsb2NrJyA6ICdub25lJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRGF0YSA9IGh0bWxEYXRhLnJlcGxhY2VBbGwoXCJ7e3JlZmVyZW5jZX19XCIsZGF0YS5yZWZlcmVuY2UgPyAnYmxvY2snIDogJ25vbmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxEYXRhID0gaHRtbERhdGEucmVwbGFjZUFsbChcInt7bWlncmF0ZUlkfX1cIixkYXRhLm1pZ3JhdGVJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRGF0YSA9IGh0bWxEYXRhLnJlcGxhY2VBbGwoXCJ7e21pZ3JhdGVDb21tYW5kfX1cIixkYXRhLm1pZ3JhdGVDb21tYW5kKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxEYXRhID0gaHRtbERhdGEucmVwbGFjZUFsbChcInt7c3RhdHVzfX1cIixkYXRhLnN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRGF0YSA9IGh0bWxEYXRhLnJlcGxhY2VBbGwoXCJ7e3VzZXJOYW1lfX1cIixkYXRhLnVzZXJOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxEYXRhID0gaHRtbERhdGEucmVwbGFjZUFsbChcInt7bG9naWNhbFVuaXR9fVwiLGRhdGEubG9naWNhbFVuaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbERhdGEgPSBodG1sRGF0YS5yZXBsYWNlQWxsKFwie3tub2RlTGlzdH19XCIsZGF0YS5ub2RlTGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRGF0YSA9IGh0bWxEYXRhLnJlcGxhY2VBbGwoXCJ7e251bU9mUHJvY2Vzc2VkUmVmVGFibGVzfX1cIixkYXRhLm51bU9mUHJvY2Vzc2VkUmVmVGFibGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxEYXRhID0gaHRtbERhdGEucmVwbGFjZUFsbChcInt7bnVtT2ZGYWlsZWRSZWZUYWJsZXN9fVwiLGRhdGEubnVtT2ZGYWlsZWRSZWZUYWJsZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbERhdGEgPSBodG1sRGF0YS5yZXBsYWNlQWxsKFwie3tudW1PZkNvcGllZFJlZlRhYmxlc319XCIsZGF0YS5udW1PZkNvcGllZFJlZlRhYmxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRGF0YSA9IGh0bWxEYXRhLnJlcGxhY2VBbGwoXCJ7e21pblN0YXJ0RXhlY3V0aW9ibkRhdGV9fVwiLGRhdGEubWluU3RhcnRFeGVjdXRpb25EYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxEYXRhID0gaHRtbERhdGEucmVwbGFjZUFsbChcInt7bWF4RW5kRXhlY3V0aW9ibkRhdGV9fVwiLGRhdGEubWF4RW5kRXhlY3V0aW9uRGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93RGF0YSA9ICc8dHI+JztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmNvbHVtbnMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwO2kgPCBkYXRhLmNvbHVtbnMubGVuZ3RoIDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93RGF0YSA9IHJvd0RhdGEgICsgJzx0aD4nICsgZGF0YS5jb2x1bW5zW2ldICsgJzwvdGg+JzsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0RhdGEgPSByb3dEYXRhICsgJzwvdHI+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDtpIDwgZGF0YS5yb3dzLmxlbmd0aCA7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0RhdGEgPSByb3dEYXRhICsgJzx0cj4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDtqIDwgZGF0YS5jb2x1bW5zLmxlbmd0aCA7IGorKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dEYXRhID0gcm93RGF0YSArICc8dGg+JyArIGRhdGEucm93c1tpXVtkYXRhLmNvbHVtbnNbal1dICsgJzwvdGg+JzsgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dEYXRhID0gcm93RGF0YSArICc8L3RyPic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dEYXRhID0gJzx0cj48L3RyPidcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByb3dEYXRhUmVmID0gJzx0cj4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucmVmRGF0YSAmJiBkYXRhLnJlZkRhdGEubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbHVtbnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YS5yZWZEYXRhWzBdKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcm93RGF0YVJlZiA9IHJvd0RhdGFSZWYgICsgJzx0aD4nICsga2V5ICsgJzwvdGg+JzsgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbnMucHVzaChrZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnJNc2dJbmRleCA9IGNvbHVtbnMuaW5kZXhPZignZXJyb3JfbXNnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVyck1zZ0luZGV4ID49IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5zLnB1c2goY29sdW1ucy5zcGxpY2UoZXJyTXNnSW5kZXgsIDEpWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1ucy5mb3JFYWNoKGNvbHVtbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0RhdGFSZWYgPSByb3dEYXRhUmVmICArICc8dGg+JyArIGNvbHVtbiArICc8L3RoPic7ICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0RhdGFSZWYgPSByb3dEYXRhUmVmICsgJzwvdHI+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDtpIDwgZGF0YS5yZWZEYXRhLmxlbmd0aCA7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0RhdGFSZWYgPSByb3dEYXRhUmVmICsgJzx0cj4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDtqIDwgY29sdW1ucy5sZW5ndGggOyBqKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93RGF0YVJlZiA9IHJvd0RhdGFSZWYgKyAnPHRoPicgKyBkYXRhLnJlZkRhdGFbaV1bY29sdW1uc1tqXV0gKyAnPC90aD4nOyAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0RhdGFSZWYgPSByb3dEYXRhUmVmICsgJzwvdHI+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0RhdGFSZWYgPSAnPHRyPjwvdHI+J1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRGF0YSA9IGh0bWxEYXRhLnJlcGxhY2VBbGwoXCJ7e2RhdGFSb3dzfX1cIixyb3dEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxEYXRhID0gaHRtbERhdGEucmVwbGFjZUFsbChcInt7ZGF0YVJvd3NSZWZlcmVuY2V9fVwiLHJvd0RhdGFSZWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRvd25sb2FkSHRtbChodG1sRGF0YSwgdGl0bGUgKyBcIi5odG1sXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkU3VtbWFyeURhdGEgPSBmdW5jdGlvbihzdW1tYXJ5RGF0YSxtaWdyYXRlSWQsbG9naWNhbFVuaXQpe1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBtaWdyYXRlSWQgOiBtaWdyYXRlSWQgPT0gXCJudWxsXCIgPyBudWxsIDogbWlncmF0ZUlkLFxuICAgICAgICAgICAgICAgICAgICBsb2dpY2FsVW5pdCA6IGxvZ2ljYWxVbml0LFxuICAgICAgICAgICAgICAgICAgICB1c2VyTmFtZSA6IHRhc2tIaXN0b3J5VGFibGVDdHJsLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICAgICByb3dzIDogW10sXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnMgOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgbm9kZUxpc3QgOiBbXVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHN1bW1hcnlEYXRhICYmIHN1bW1hcnlEYXRhLlMpe1xuICAgICAgICAgICAgICAgICAgICBkYXRhLmNvbHVtbnMgPSBzdW1tYXJ5RGF0YS5TLmNvbHVtbnNOYW1lcztcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7aSA8IHN1bW1hcnlEYXRhLlMucmVzdWx0cy5sZW5ndGggOyBpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1bW1hcnlEYXRhLlMucmVzdWx0c1tpXS5jb2x1bW5zLkxldmVsID09IFwiQ2x1c3RlclwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnN0YXR1cyA9IHN1bW1hcnlEYXRhLlMucmVzdWx0c1tpXS5jb2x1bW5zLlN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdW1tYXJ5RGF0YS5TLnJlc3VsdHNbaV0uY29sdW1ucy5MZXZlbCA9PSBcIk5vZGVcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2RlTGlzdC5wdXNoKHN1bW1hcnlEYXRhLlMucmVzdWx0c1tpXS5jb2x1bW5zLk5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5yb3dzLnB1c2goc3VtbWFyeURhdGEuUy5yZXN1bHRzW2ldLmNvbHVtbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzdW1tYXJ5RGF0YSAmJiBzdW1tYXJ5RGF0YS5IKXtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5taWdyYXRlQ29tbWFuZCA9IHN1bW1hcnlEYXRhLkhbXCJNaWdyYXRpb24gQ29tbWFuZFwiXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFN0cmluZy5wcm90b3R5cGUucmVwbGFjZUFsbCA9IGZ1bmN0aW9uKHNlYXJjaCwgcmVwbGFjZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LnJlcGxhY2UobmV3IFJlZ0V4cChzZWFyY2gsICdnJyksIHJlcGxhY2VtZW50KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5kb3dubG9hZEh0bWwgPSBmdW5jdGlvbihodG1sRGF0YSxmaWxlTmFtZSl7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnZGF0YTp0ZXh0L3BsYWluO2NoYXJzZXQ9dXRmLTgsJyArIGVuY29kZVVSSUNvbXBvbmVudChodG1sRGF0YSkpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkb3dubG9hZCcsIGZpbGVOYW1lKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsaWNrKCk7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5idWlsZFN1bW1hcnlIdG1sID0gZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICd2aWV3cy9zdGF0aWNIdG1scy9zdW1tYXJ5Lmh0bWwnXG4gICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxEYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxEYXRhID0gaHRtbERhdGEucmVwbGFjZUFsbChcInt7bWlncmF0ZUlkfX1cIixkYXRhLm1pZ3JhdGVJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRGF0YSA9IGh0bWxEYXRhLnJlcGxhY2VBbGwoXCJ7e21pZ3JhdGVDb21tYW5kfX1cIixkYXRhLm1pZ3JhdGVDb21tYW5kKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxEYXRhID0gaHRtbERhdGEucmVwbGFjZUFsbChcInt7c3RhdHVzfX1cIixkYXRhLnN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRGF0YSA9IGh0bWxEYXRhLnJlcGxhY2VBbGwoXCJ7e3VzZXJOYW1lfX1cIixkYXRhLnVzZXJOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxEYXRhID0gaHRtbERhdGEucmVwbGFjZUFsbChcInt7bG9naWNhbFVuaXR9fVwiLGRhdGEubG9naWNhbFVuaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbERhdGEgPSBodG1sRGF0YS5yZXBsYWNlQWxsKFwie3tub2RlTGlzdH19XCIsZGF0YS5ub2RlTGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93RGF0YSA9ICc8dHI+JztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwO2kgPCBkYXRhLmNvbHVtbnMubGVuZ3RoIDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dEYXRhID0gcm93RGF0YSAgKyAnPHRoPicgKyBkYXRhLmNvbHVtbnNbaV0gKyAnPC90aD4nOyAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd0RhdGEgPSByb3dEYXRhICsgJzwvdHI+JztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwO2kgPCBkYXRhLnJvd3MubGVuZ3RoIDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dEYXRhID0gcm93RGF0YSArICc8dHI+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDtqIDwgZGF0YS5jb2x1bW5zLmxlbmd0aCA7IGorKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0RhdGEgPSByb3dEYXRhICsgJzx0aD4nICsgZGF0YS5yb3dzW2ldW2RhdGEuY29sdW1uc1tqXV0gKyAnPC90aD4nOyAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dEYXRhID0gcm93RGF0YSArICc8L3RyPic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRGF0YSA9IGh0bWxEYXRhLnJlcGxhY2VBbGwoXCJ7e2RhdGFSb3dzfX1cIixyb3dEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kb3dubG9hZEh0bWwoaHRtbERhdGEsXCJzdW1tYXJ5X1wiICsgZGF0YS5taWdyYXRlSWQgKyBcIi5odG1sXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5nZXRNaWdyYXRlU3RhdHVzV3MgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFRETVNlcnZpY2UucG9zdEdlbmVyaWNBUEkoJ21pZ3JhdGVTdGF0dXNXcycse1xuICAgICAgICAgICAgICAgICAgICBtaWdyYXRlSWRzIDogXy5tYXAodGFza0hpc3RvcnlUYWJsZUN0cmwuZXhlY3V0aW9uSWRzLCAnZmFicmljX2V4ZWN1dGlvbl9pZCcpLFxuICAgICAgICAgICAgICAgICAgICBydW5Nb2RlcyA6IFsnSCcsJ1MnXVxuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5leGVjdXRpb25EYXRhID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHJlcyBvZiByZXNwb25zZS5yZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLm1pZ3JhdGlvbkNvbW1hbmQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyAmJiByZXMuSCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5IW1wiTWlncmF0aW9uIENvbW1hbmRcIl0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLm1pZ3JhdGlvbkNvbW1hbmQgPSByZXMuSFtcIk1pZ3JhdGlvbiBDb21tYW5kXCJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuY2x1c3RlckxldmVsID0ge307XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgcmVzLlMgJiYgcmVzLlMucmVzdWx0cyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsdXN0ZXJMZXZlbCA9IF8uZmluZChyZXMuUy5yZXN1bHRzLHtjb2x1bW5zIDoge0xldmVsIDogXCJDbHVzdGVyXCJ9fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsdXN0ZXJMZXZlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5jbHVzdGVyTGV2ZWwgPSBjbHVzdGVyTGV2ZWwuY29sdW1ucztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tIaXN0b3J5VGFibGVDdHJsLmNsdXN0ZXJMZXZlbC5TdGF0dXMgPT0gXCJET05FXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGFza0hpc3RvcnlUYWJsZUN0cmwuZXhlY3V0aW9uSWRzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0VGFibGVEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwucmVsb2FkRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0VGFibGVEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLnJlbG9hZERhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWRkZWQgPSAodGFza0hpc3RvcnlUYWJsZUN0cmwudGFza1R5cGUgPT09ICdMT0FEJyA/IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmNsdXN0ZXJMZXZlbC5TdWNjZWVkZWQgOiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5jbHVzdGVyTGV2ZWwuQWRkZWQpIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5leGVjdXRpb25EYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgOiB0YXNrSGlzdG9yeVRhYmxlQ3RybC5leGVjdXRpb25JZHMgJiYgdGFza0hpc3RvcnlUYWJsZUN0cmwuZXhlY3V0aW9uSWRzW2ldICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuZXhlY3V0aW9uSWRzW2ldLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlncmF0ZUlEIDogdGFza0hpc3RvcnlUYWJsZUN0cmwuZXhlY3V0aW9uSWRzICYmIHRhc2tIaXN0b3J5VGFibGVDdHJsLmV4ZWN1dGlvbklkc1tpXSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmV4ZWN1dGlvbklkc1tpXS5mYWJyaWNfZXhlY3V0aW9uX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pZ3JhdGlvbkNvbW1hbmQgOiB0YXNrSGlzdG9yeVRhYmxlQ3RybC5taWdyYXRpb25Db21tYW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWFpbmluZ0R1cmF0aW9uIDogdGFza0hpc3RvcnlUYWJsZUN0cmwuY2x1c3RlckxldmVsW1wiUmVtYWluaW5nIGR1ci5cIl0gfHwgXCIwMDowMDowMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcmNlbnRhZ2VPZkNvbXBsZXRlZCA6IHRhc2tIaXN0b3J5VGFibGVDdHJsLmNsdXN0ZXJMZXZlbFtcIiUgQ29tcGxldGVkXCJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZGVkIDogYWRkZWQgfHwgMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWlsZWQgOiB0YXNrSGlzdG9yeVRhYmxlQ3RybC5jbHVzdGVyTGV2ZWwuRmFpbGVkIHx8IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVXBkYXRlZCA6IHRhc2tIaXN0b3J5VGFibGVDdHJsLmNsdXN0ZXJMZXZlbC5VcGRhdGVkIHx8IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVW5jaGFuZ2VkIDogdGFza0hpc3RvcnlUYWJsZUN0cmwuY2x1c3RlckxldmVsLlVuY2hhbmdlZCB8fCAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZDogKHBhcnNlSW50KGFkZGVkIHx8IDApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFza0hpc3RvcnlUYWJsZUN0cmwuY2x1c3RlckxldmVsLkZhaWxlZCB8fCAwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhc2tIaXN0b3J5VGFibGVDdHJsLmNsdXN0ZXJMZXZlbC5VcGRhdGVkIHx8IDApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFza0hpc3RvcnlUYWJsZUN0cmwuY2x1c3RlckxldmVsLlVuY2hhbmdlZCB8fCAwKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS51cGRhdGVSdW5uaW5nRXhlY3V0aW9ucyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIGlmICh0YXNrSGlzdG9yeVRhYmxlQ3RybC5leGVjdXRpb25JZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kaXNhYmxlQWNjZXNzaW5nU3RhdGlzdGljcyA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9tZXRob2QgIT09IFwiUkVGXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldE1pZ3JhdGVTdGF0dXNXcygpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9tZXRob2QgPT0gXCJSRUZcIiB8fCB0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrRGF0YS5yZWZjb3VudCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgVERNU2VydmljZS5wb3N0R2VuZXJpY0FQSSgnZXh0cmFjdHJlZnN0YXRzJyx7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0V4ZWN1dGlvbklkIDogdGFza0hpc3RvcnlUYWJsZUN0cmwuZXhlY3V0aW9uSWRzWzBdLnRhc2tfZXhlY3V0aW9uX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgOiAnUycsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5leGVjdXRpb25SZWZEYXRhID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4ZWN1dGlvbnNGaW5pc2hlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoa2V5IGluIHJlc3BvbnNlLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVmRXhlY3V0aW9uID0gcmVzcG9uc2UucmVzdWx0W2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZkV4ZWN1dGlvbi5sdV9uYW1lID0ga2V5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZFeGVjdXRpb24ucGVyY2VudGFnZU9mQ29tcGxldGVkID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlZkV4ZWN1dGlvbi50b3ROdW1PZlRhYmxlc1RvUHJvY2VzcyA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmRXhlY3V0aW9uLnBlcmNlbnRhZ2VPZkNvbXBsZXRlZCAgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZkV4ZWN1dGlvbi5udW1PZlByb2Nlc3NlZFJlZlRhYmxlcyAvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmRXhlY3V0aW9uLnRvdE51bU9mVGFibGVzVG9Qcm9jZXNzICogMTAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlZkV4ZWN1dGlvbi5wZXJjZW50YWdlT2ZDb21wbGV0ZWQgPT0gMTAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGVjdXRpb25zRmluaXNoZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZkV4ZWN1dGlvbi5wZXJjZW50YWdlT2ZDb21wbGV0ZWQgPSByZWZFeGVjdXRpb24ucGVyY2VudGFnZU9mQ29tcGxldGVkLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmV4ZWN1dGlvblJlZkRhdGEucHVzaChyZWZFeGVjdXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleGVjdXRpb25zRmluaXNoZWQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRUYWJsZURhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLnJlbG9hZERhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuZGlzYWJsZUFjY2Vzc2luZ1N0YXRpc3RpY3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kdEluc3RhbmNlID0ge307XG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kdENvbHVtbnMgPSBbXTtcbiAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmR0Q29sdW1uRGVmcyA9IFtdO1xuICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuaGVhZGVycyA9IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ2x1X25hbWUnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnTG9naWNhbCBVbml0IE5hbWUnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ2x1X3BhcmVudF9uYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1BhcmVudCBMb2dpY2FsIFVuaXQnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ3Byb2Nlc3NfbmFtZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdQb3N0IEV4ZWN1dGlvbiBQcm9jZXNzIE5hbWUnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ2V4ZWN1dGlvbl9zdGF0dXMnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnRXhlY3V0aW9uIFN0YXR1cycsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnbnVtX29mX3Byb2Nlc3NlZF9lbnRpdGllcycsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdUb3RhbCBOdW1iZXIgT2YgUHJvY2Vzc2VkIEVudGl0aWVzJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW46ICdudW1fb2ZfY29waWVkX2VudGl0aWVzJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ051bWJlciBPZiBTdWNjZWVkZWQgRW50aXRpZXMnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ251bV9vZl9mYWlsZWRfZW50aXRpZXMnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnTnVtYmVyIE9mIEZhaWxlZCBFbnRpdGllcycsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnbnVtX29mX3Byb2Nlc3NlZF9yZWZfdGFibGVzJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1RvdGFsIE51bWJlciBPZiBQcm9jZXNzZWQgUmVmZXJlbmNlIFRhYmxlcycsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnbnVtX29mX2NvcGllZF9yZWZfdGFibGVzJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ051bWJlciBPZiBDb3BpZWQgUmVmZXJlbmNlIFRhYmxlcycsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnbnVtX29mX2ZhaWxlZF9yZWZfdGFibGVzJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ051bWJlciBPZiBGYWlsZWQgUmVmZXJlbmNlIFRhYmxlcycsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnc3RhcnRfZXhlY3V0aW9uX3RpbWUnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnU3RhcnQgRXhlY3V0aW9uIERhdGUnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ2VuZF9leGVjdXRpb25fdGltZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdFbmQgRXhlY3V0aW9uIERhdGUnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ3NvdXJjZV9lbnZfbmFtZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdTb3VyY2UgRW52aXJvbm1lbnQgTmFtZScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnZW52aXJvbm1lbnRfbmFtZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdUYXJnZXQgRW52aXJvbm1lbnQgTmFtZScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAndGFza19leGVjdXRlZF9ieScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdUYXNrIEV4ZWN1dGVkIEJ5JyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ2JlX25hbWUnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnQnVzaW5lc3MgRW50aXR5IE5hbWUnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ3Byb2R1Y3RfbmFtZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdTeXN0ZW0gTmFtZScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAncHJvZHVjdF92ZXJzaW9uJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1N5c3RlbSBWZXJzaW9uJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW46ICdmYWJyaWNfZXhlY3V0aW9uX2lkJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ0ZhYnJpYyBFeGVjdXRpb24gSWQnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW46ICd2ZXJzaW9uX2V4cGlyYXRpb25fZGF0ZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdWZXJzaW9uIEV4cGlyYXRpb24gRGF0ZScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IHRydWVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnZXhlY3V0aW9uX25vdGUnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnRXhlY3V0aW9uIE5vdGUnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBkYXRlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmR0Q29sdW1uRGVmcyA9IFtdO1xuICAgICAgICAgICAgaWYgKCRzZXNzaW9uU3RvcmFnZS50YXNrSGlzdG9yeVRhYmxlSGlkZUNvbHVtbnMpIHtcbiAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5oaWRlQ29sdW1ucyA9ICRzZXNzaW9uU3RvcmFnZS50YXNrSGlzdG9yeVRhYmxlSGlkZUNvbHVtbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5oaWRlQ29sdW1ucyA9IFsxOV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhc2tIaXN0b3J5VGFibGVDdHJsLmhpZGVDb2x1bW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhpZGVDb2x1bW4gPSBEVENvbHVtbkRlZkJ1aWxkZXIubmV3Q29sdW1uRGVmKHRhc2tIaXN0b3J5VGFibGVDdHJsLmhpZGVDb2x1bW5zW2ldKVxuICAgICAgICAgICAgICAgICAgICAud2l0aE9wdGlvbigndmlzaWJsZScsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAvL3RyeSB0byBjb21tZW50IG91dCB0aGUgbGluZSBiZWxvd1xuICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmR0Q29sdW1uRGVmcy5wdXNoKGhpZGVDb2x1bW4pO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIHZhciBjaGFuZ2VUb0xvY2FsRGF0ZSA9IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCBmdWxsLCBtZXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vbWVudChkYXRhKS5mb3JtYXQoJ0REIE1NTSBZWVlZLCBISDptbTpzcycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5vcGVuRW50aXRpZXNFeGVjU3RhdHMgPSBmdW5jdGlvbiAodGFza0V4ZWNJZCx0eXBlLGZhYnJpY0V4ZWN1dGlvbklkLHNlbGVjdGlvbk1ldGhvZCxyZWZjb3VudCkge1xuICAgICAgICAgICAgICAgIGlmICh0YXNrSGlzdG9yeVRhYmxlQ3RybC5kaXNhYmxlQWNjZXNzaW5nU3RhdGlzdGljcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS4kcGFyZW50LiRwYXJlbnQuJHBhcmVudC50YXNrcy5vcGVuRW50aXRpZXNFeGVjU3RhdHModGFza0V4ZWNJZCx0eXBlLGZhYnJpY0V4ZWN1dGlvbklkLHNlbGVjdGlvbk1ldGhvZCxyZWZjb3VudCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmRvd25sb2FkU2VxdWVuY2VSZXBvcnQgPSBmdW5jdGlvbih0YXNrX2V4ZWN1dGlvbl9pZCl7XG4gICAgICAgICAgICAgICAgVERNU2VydmljZS5nZXRHZW5lcmljQVBJKCdzZXF1ZW5jZXJlcG9ydC8nICsgdGFza19leGVjdXRpb25faWQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kb3dubG9hZEVycm9yUmVwb3J0ID0gZnVuY3Rpb24obHVfbmFtZSwgdGFza0V4ZWN1dGlvbklkKXtcbiAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLmdldFN1bW1hcnlSZXBvcnQodGFza0V4ZWN1dGlvbklkLGx1X25hbWUpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJGQUlMRURcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHdvcmtib29rID0gRXhjZWxTZXJ2aWNlLmJ1aWxkU3VtbWFyeUV4Y2VsKHJlc3BvbnNlLnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtib29rLnhsc3gud3JpdGVCdWZmZXIoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZU5hbWUgPSBgU3VtbWFyeV9SZXBvcnRfRVhFQ0lEXyR7dGFza0V4ZWN1dGlvbklkfV8ke2x1X25hbWV9Lnhsc3hgO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYS5zdHlsZSA9ICdkaXNwbGF5OiBub25lJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxlID0gbmV3IEJsb2IoW2RhdGFdLCB7dHlwZTogJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCd9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxlVVJMID0gKHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTCkuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYS5ocmVmID0gZmlsZVVSTDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuZG93bmxvYWQgPSBmaWxlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuY2xpY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICh3aW5kb3cuVVJMIHx8IHdpbmRvdy53ZWJraXRVUkwpLnJldm9rZU9iamVjdFVSTChmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB0YXNrSGlzdG9yeUFjdGlvbnMgPSBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgZnVsbCwgbWV0YSkge1xuICAgICAgICAgICAgICAgIGlmIChmdWxsLnByb2Nlc3NfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcGF0aGZpbGUgPSB0YXNrSGlzdG9yeVRhYmxlQ3RybC5URE1SZXBvcnRzLnJlcGxhY2UoXCJbZXRsSXBBZGRyZXNzXVwiLGZ1bGwuZXRsX2lwX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgIHZhciBldGxFeGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICghZnVsbC5ldGxfZXhlY3V0aW9uX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIGV0bEV4aXN0cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZmlsZU5hbWUgPSBmdWxsLmx1X25hbWUgKyAnX1N0YXRzX1JlcG9ydF9FWEVJRF8nICsgZnVsbC5ldGxfZXhlY3V0aW9uX2lkICsgJy5jc3YnO1xuICAgICAgICAgICAgICAgIHZhciBzZXFOYW1lID0gZnVsbC5sdV9uYW1lICsgJ19TZXF1ZW5jZXNfUmVwb3J0X0VYRUlEXycrIGZ1bGwuZXRsX2V4ZWN1dGlvbl9pZCArICcuY3N2JztcbiAgICAgICAgICAgICAgICAvLyB2YXIgZXJyb3JOYW1lID0gZnVsbC5sdV9uYW1lICsgJ19FcnJvcl9SZXBvcnRfRVhFSURfJysgZnVsbC5ldGxfZXhlY3V0aW9uX2lkICsgJy54bHMnO1xuICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLnN0YXRzRmlsZSA9IHBhdGhmaWxlICsgZmlsZU5hbWU7XG4gICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuc2VxRmlsZSA9IHBhdGhmaWxlICsgc2VxTmFtZTtcbiAgICAgICAgICAgICAgICAvLyB0YXNrSGlzdG9yeVRhYmxlQ3RybC5lcnJvckZpbGUgPSBwYXRoZmlsZSArIGVycm9yTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgdGFza0hpc3RvcnlBY3Rpb25zID0gXCJcIjtcblxuICAgICAgICAgICAgICAgIGlmIChmdWxsLmV4ZWN1dGlvbl9zdGF0dXMgJiYgZnVsbC5leGVjdXRpb25fc3RhdHVzLnRvTG93ZXJDYXNlKCkgPT0gXCJzdG9wcGVkXCIgJiYgKCF0YXNrSGlzdG9yeVRhYmxlQ3RybC5leGVjdXRpb25JZHMgfHwgdGFza0hpc3RvcnlUYWJsZUN0cmwuZXhlY3V0aW9uSWRzLmxlbmd0aCA9PSAwKSl7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5QWN0aW9ucyA9IHRhc2tIaXN0b3J5QWN0aW9ucyArICc8YSBuZy1jbGljaz1cInRhc2tIaXN0b3J5VGFibGVDdHJsLnJlc3VtZUV4ZWN1dGlvbihcXCcnICsgZnVsbC5mYWJyaWNfZXhlY3V0aW9uX2lkICsgJ1xcJyxcXCcnICsgZnVsbC50YXNrX2V4ZWN1dGlvbl9pZCArICdcXCcpXCIgc3R5bGU9XCJtYXJnaW4tbGVmdDogNXB4O2JvcmRlci1jb2xvcjogdHJhbnNwYXJlbnQ7YmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IGNvbG9yOiBibGFjaztcIiB0eXBlPVwiYnV0dG9uXCIgdGl0bGU9XCJSZXN1bWUgRXhlY3V0aW9uXCI+PGkgY2xhc3M9XCJmYSBmYS1wbGF5XCI+PC9pPiA8L2E+JztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGFza0hpc3RvcnlUYWJsZUN0cmwucnVubmluZ0V4ZWN1dGlvbiA9PSBmdWxsLnRhc2tfZXhlY3V0aW9uX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5QWN0aW9ucyA9IHRhc2tIaXN0b3J5QWN0aW9ucyA9ICc8YSAgc3R5bGU9XCJtYXJnaW4tbGVmdDogM3B4O2JvcmRlci1jb2xvcjogdHJhbnNwYXJlbnQ7YmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IGNvbG9yOiBncmV5O2N1cnNvcjogbm90LWFsbG93ZWQ7XCIgIHR5cGU9XCJidXR0b25cIiB0aXRsZT1cIkRvd25sb2FkIFN0YXRpc3RpY3MgRmlsZVwiPjxpbWcgc3JjPVwiaWNvbnMvc3VtbWFyeS1yZXBvcnQuc3ZnXCI+PC9pbWc+IDwvYT4nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGFza0hpc3RvcnlBY3Rpb25zID0gdGFza0hpc3RvcnlBY3Rpb25zICsgJzxhIG5nLWNsaWNrPVwidGFza0hpc3RvcnlUYWJsZUN0cmwuZG93bmxvYWRFeHRyYWN0UmVwb3J0KFxcJ1NcXCcsXFwnJyArIGZ1bGwuZmFicmljX2V4ZWN1dGlvbl9pZCsnXFwnLFxcJycgKyBmdWxsLmx1X25hbWUgKyAnXFwnLCcgKyBmdWxsLnRhc2tfZXhlY3V0aW9uX2lkICsgJylcIiAgdGFyZ2V0PVwiX2JsYW5rXCIgIHN0eWxlPVwibWFyZ2luLWxlZnQ6IDNweDtib3JkZXItY29sb3I6IHRyYW5zcGFyZW50O2JhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyBjb2xvcjogYmxhY2s7XCIgdHlwZT1cImJ1dHRvblwiIHRpdGxlPVwiRG93bmxvYWQgU3RhdGlzdGljcyBGaWxlXCI+PGkgY2xhc3M9XCJmYSBmYS1kb3dubG9hZFwiPjwvaT4gPC9hPic7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRhc2tIaXN0b3J5QWN0aW9ucyA9IHRhc2tIaXN0b3J5QWN0aW9ucyArICc8YSBocmVmPVwiJyArIHRhc2tIaXN0b3J5VGFibGVDdHJsLnNlcUZpbGUgKyAnXCIgIHRhcmdldD1cIl9ibGFua1wiIHN0eWxlPVwibWFyZ2luLWxlZnQ6IDNweDtib3JkZXItY29sb3I6IHRyYW5zcGFyZW50O2JhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyBjb2xvcjogYmxhY2s7XCIgdGl0bGU9XCJEb3dubG9hZCBTZXF1ZW5jZSBSZXBvcnRcIj48aW1nIHN0eWxlPVwid2lkdGg6IDEzcHg7XCIgc3JjPVwiaW1nL2Rvd25sb2FkX3NlcS5qcGdcIj4gPC9hPic7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5QWN0aW9ucyA9IHRhc2tIaXN0b3J5QWN0aW9ucyArICc8YSBuZy1jbGljaz1cInRhc2tIaXN0b3J5VGFibGVDdHJsLmRvd25sb2FkRXJyb3JSZXBvcnQoXFwnJyArIGZ1bGwubHVfbmFtZSArICdcXCcsJyArIGZ1bGwudGFza19leGVjdXRpb25faWQgKyAnKVwiICBzdHlsZT1cIm1hcmdpbi1sZWZ0OiAzcHg7Ym9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudDtiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgY29sb3I6IGJsYWNrO1wiIHRpdGxlPVwiRG93bmxvYWQgU3VtbWFyeSBSZXBvcnRcIj48aW1nIHNyYz1cImljb25zL3N1bW1hcnktcmVwb3J0LnN2Z1wiPjwvaW1nPiA8L2E+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZ1bGwuZmFicmljX2V4ZWN1dGlvbl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyB0YXNrSGlzdG9yeUFjdGlvbnMgPSB0YXNrSGlzdG9yeUFjdGlvbnMgICsgJzxhIG5nLWNsaWNrPVwidGFza0hpc3RvcnlUYWJsZUN0cmwub3BlbkJhdGNoTW9uaXRvcihcXCcnICsgZnVsbC5mYWJyaWNfZXhlY3V0aW9uX2lkICsgJ1xcJylcIiAgc3R5bGU9XCJtYXJnaW4tbGVmdDogM3B4O2JvcmRlci1jb2xvcjogdHJhbnNwYXJlbnQ7YmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IGNvbG9yOiBibGFjayAhaW1wb3J0YW50O2ZvbnQtc2l6ZTogMjJweDtcIiB0aXRsZT1cIk9wZW4gQmF0Y2ggTW9uaXRvclwiPjxpIGNsYXNzPVwiZmEgZmEtaW5mby1jaXJjbGVcIj48L2k+IDwvYT4nO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0YXNrSGlzdG9yeUFjdGlvbnM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFza0hpc3RvcnlUYWJsZUN0cmwuaGVhZGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh0YXNrSGlzdG9yeVRhYmxlQ3RybC5oZWFkZXJzW2ldLmRhdGUgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kdENvbHVtbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHRhc2tIaXN0b3J5VGFibGVDdHJsLmhlYWRlcnNbaV0uY29sdW1uKS53aXRoVGl0bGUodGFza0hpc3RvcnlUYWJsZUN0cmwuaGVhZGVyc1tpXS5uYW1lKS5yZW5kZXJXaXRoKGNoYW5nZVRvTG9jYWxEYXRlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kdENvbHVtbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHRhc2tIaXN0b3J5VGFibGVDdHJsLmhlYWRlcnNbaV0uY29sdW1uKS53aXRoVGl0bGUodGFza0hpc3RvcnlUYWJsZUN0cmwuaGVhZGVyc1tpXS5uYW1lKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kdENvbHVtbnMudW5zaGlmdChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKCd0YXNrSGlzdG9yeUFjdGlvbnMnKS53aXRoVGl0bGUoJycpLnJlbmRlcldpdGgodGFza0hpc3RvcnlBY3Rpb25zKS53aXRoT3B0aW9uKCd3aWR0aCcsICcxMDAnKSk7XG5cbiAgICAgICAgICAgIHZhciBnZXRUYWJsZURhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gXy5tYXAodGFza0hpc3RvcnlUYWJsZUN0cmwudGFza0hpc3RvcnlEYXRhLCByb3cgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFza0hpc3RvcnlUYWJsZUN0cmwudGFza1R5cGUgPT09ICdFWFRSQUNUJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93LmVudmlyb25tZW50X25hbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm93O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kdE9wdGlvbnMgPSBEVE9wdGlvbnNCdWlsZGVyLmZyb21GblByb21pc2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRUYWJsZURhdGEoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLndpdGhET00oJzxcImh0bWw1YnV0dG9uc1wiQj5sVGZnaXRwJylcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignY3JlYXRlZFJvdycsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVjb21waWxpbmcgc28gd2UgY2FuIGJpbmQgQW5ndWxhciBkaXJlY3RpdmUgdG8gdGhlIERUXG4gICAgICAgICAgICAgICAgICAgICRjb21waWxlKGFuZ3VsYXIuZWxlbWVudChyb3cpLmNvbnRlbnRzKCkpKCRzY29wZSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbigncGFnaW5nJywgdHJ1ZSlcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignc2Nyb2xsWCcsIGZhbHNlKVxuICAgICAgICAgICAgICAgIC53aXRoQnV0dG9ucyhbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVuZDogJ2NvbHZpcycsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnU2hvdy9IaWRlIGNvbHVtbnMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uczogWyA1LDYsNyw4LDksMTAsMTYsMTcsMTgsMTldLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIChjb2x1bW5JZHgsIHZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlzaWJsZSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRhc2tIaXN0b3J5VGFibGVDdHJsLmhpZGVDb2x1bW5zLmluZGV4T2YoY29sdW1uSWR4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmhpZGVDb2x1bW5zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRhc2tIaXN0b3J5VGFibGVDdHJsLmhpZGVDb2x1bW5zLmluZGV4T2YoY29sdW1uSWR4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuaGlkZUNvbHVtbnMucHVzaChjb2x1bW5JZHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXNzaW9uU3RvcmFnZS50YXNrSGlzdG9yeVRhYmxlSGlkZUNvbHVtbnMgPSB0YXNrSGlzdG9yeVRhYmxlQ3RybC5oaWRlQ29sdW1uc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGFza0hpc3RvcnlUYWJsZUN0cmwudGFza0hpc3RvcnlEYXRhICYmIHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tIaXN0b3J5RGF0YS5sZW5ndGggPiAwKXtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2x1bW5zID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogXy5tYXAoXy51bmlxdWUoXy5tYXAodGFza0hpc3RvcnlUYWJsZUN0cmwudGFza0hpc3RvcnlEYXRhLCAnbHVfbmFtZScpKSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7dmFsdWU6IGVsLCBsYWJlbDogZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBfLm1hcChfLnVuaXF1ZShfLm1hcCh0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrSGlzdG9yeURhdGEsICdsdV9wYXJlbnRfbmFtZScpKSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7dmFsdWU6IGVsLCBsYWJlbDogZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBfLm1hcChfLnVuaXF1ZShfLm1hcCh0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrSGlzdG9yeURhdGEsICdwcm9jZXNzX25hbWUnKSksIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3ZhbHVlOiBlbCwgbGFiZWw6IGVsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogXy5tYXAoXy51bmlxdWUoXy5tYXAodGFza0hpc3RvcnlUYWJsZUN0cmwudGFza0hpc3RvcnlEYXRhLCAnZXhlY3V0aW9uX3N0YXR1cycpKSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7dmFsdWU6IGVsLCBsYWJlbDogZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IF8ubWFwKF8udW5pcXVlKF8ubWFwKHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tIaXN0b3J5RGF0YSwgJ3NvdXJjZV9lbnZfbmFtZScpKSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7dmFsdWU6IGVsLCBsYWJlbDogZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBfLm1hcChfLnVuaXF1ZShfLm1hcCh0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrSGlzdG9yeURhdGEsICdlbnZpcm9ubWVudF9uYW1lJykpLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt2YWx1ZTogZWwsIGxhYmVsOiBlbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IF8ubWFwKF8udW5pcXVlKF8ubWFwKHRhc2tIaXN0b3J5VGFibGVDdHJsLnRhc2tIaXN0b3J5RGF0YSwgJ3Rhc2tfZXhlY3V0ZWRfYnknKSksIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3ZhbHVlOiBlbCwgbGFiZWw6IGVsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogXy5tYXAoXy51bmlxdWUoXy5tYXAodGFza0hpc3RvcnlUYWJsZUN0cmwudGFza0hpc3RvcnlEYXRhLCAnYmVfbmFtZScpKSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7dmFsdWU6IGVsLCBsYWJlbDogZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBfLm1hcChfLnVuaXF1ZShfLm1hcCh0YXNrSGlzdG9yeVRhYmxlQ3RybC50YXNrSGlzdG9yeURhdGEsICdwcm9kdWN0X25hbWUnKSksIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3ZhbHVlOiBlbCwgbGFiZWw6IGVsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpZ2h0Q29sdW1uRmlsdGVyID0ge307XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRlbXA9YW5ndWxhci5jb3B5KGNvbHVtbilcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAuaGlkZGVuPXRhc2tIaXN0b3J5VGFibGVDdHJsLmhpZGVDb2x1bW5zLmluZGV4T2YoaW5kZXggKyAgMSkgPj0gMCA/IHRydWUgOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgbGlnaHRDb2x1bW5GaWx0ZXJbaW5kZXggKyAxXSA9IHRlbXBcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmR0T3B0aW9ucy53aXRoTGlnaHRDb2x1bW5GaWx0ZXIobGlnaHRDb2x1bW5GaWx0ZXIpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5kdEluc3RhbmNlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZHRJbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24odGFza0hpc3RvcnlUYWJsZUN0cmwuZHRJbnN0YW5jZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuZHRJbnN0YW5jZShkdEluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHRhc2tIaXN0b3J5VGFibGVDdHJsLmR0SW5zdGFuY2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLmR0SW5zdGFuY2UgPSBkdEluc3RhbmNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodGFza0hpc3RvcnlUYWJsZUN0cmwuZHRJbnN0YW5jZS5jaGFuZ2VEYXRhICE9IG51bGwpXG4gICAgICAgICAgICAgICAgdGFza0hpc3RvcnlUYWJsZUN0cmwuZHRJbnN0YW5jZS5jaGFuZ2VEYXRhKGdldFRhYmxlRGF0YSgpKTtcblxuXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0YXNrSGlzdG9yeVRhYmxlQ3RybC5sb2FkaW5nVGFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRhc2tIaXN0b3J5VGFibGVDdHJsLm9wZW5CYXRjaE1vbml0b3IgPSAoYmF0Y2hJZCkgPT4ge1xuICAgICAgICAgICAgJHdpbmRvdy5vcGVuKGAke2xvY2F0aW9uLm9yaWdpbn0vYXBwL2FkbWluL2JhdGNoZXMvYmF0Y2gtbW9uaXRvci8ke2JhdGNoSWR9YCwgJ19ibGFuaycpO1xuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6IFwiRUFcIixcbiAgICAgICAgdGVtcGxhdGVVcmw6IHRlbXBsYXRlLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgY29udGVudDogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cikge1xuICAgICAgICAgICAgaWYgKHNjb3BlLnVwZGF0ZVJ1bm5pbmdFeGVjdXRpb25zKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUudXBkYXRlUnVubmluZ0V4ZWN1dGlvbnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB1cGRhdGVEYXRhID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUudXBkYXRlUnVubmluZ0V4ZWN1dGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudXBkYXRlUnVubmluZ0V4ZWN1dGlvbnMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAyMDAwKTtcblxuICAgICAgICAgICAgZWxlbWVudC5vbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbCh1cGRhdGVEYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBjb250cm9sbGVyLFxuICAgICAgICBjb250cm9sbGVyQXM6ICd0YXNrSGlzdG9yeVRhYmxlQ3RybCdcbiAgICB9O1xufVxuXG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdURE0tRkUnKVxuICAgIC5kaXJlY3RpdmUoJ3Rhc2tIaXN0b3J5RGlyZWN0aXZlJywgdGFza0hpc3RvcnlEaXJlY3RpdmUpO1xuIl19
