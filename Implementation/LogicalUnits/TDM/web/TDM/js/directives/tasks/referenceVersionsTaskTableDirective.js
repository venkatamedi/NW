function referenceVersionsTaskTable(){return{restrict:"E",templateUrl:"views/tasks/referenceVersionsTaskTable.html",scope:{versionsList:"=",loading:"=",timeRange:"=",getVersions:"=",selectedVersion:"=",reloadVersionsTable:"="},controller:function($scope,TDMService,$timeout,DTOptionsBuilder,DTColumnBuilder,$q,$uibModal,$compile){var referenceVersionsTaskTableCtrl=this;referenceVersionsTaskTableCtrl.dtColumnsVersions=[],referenceVersionsTaskTableCtrl.dtColumnDefsVersions=[],$scope.reloadVersionsTable.dtInstanceVersions={},referenceVersionsTaskTableCtrl.groupedSelections=new Set,referenceVersionsTaskTableCtrl.headersVersions=[{column:"actions",name:"",clickAble:!1},{column:"lu_name",name:"LU Name",clickAble:!0},{column:"version_name",name:"Version Name",clickAble:!0},{column:"task_id",name:"Task Id",clickAble:!1},{column:"task_last_updated_by",name:"Last Updated By",clickAble:!1},{column:"version_type",name:"Version Type",clickAble:!1},{column:"version_datetime",name:"Date Time",type:"date",clickAble:!1}];for(var changeToLocalDate=function(data,type,full,meta){return moment(data).format("DD MMM YYYY, HH:mm")},renderSelectionColumn=function(data,type,full,meta){var selectionIcon='<input type="radio" ng-value="'+full.task_execution_id+'" name="referenceVersionsTableSelection" ng-model="selectedVersion.selectedRefVersionToLoad">';return referenceVersionsTaskTableCtrl.groupedSelections||referenceVersionsTaskTableCtrl.groupedSelections.add(full.task_execution_id),full.task_execution_id?referenceVersionsTaskTableCtrl.groupedSelections.has(full.task_execution_id)?"":(referenceVersionsTaskTableCtrl.groupedSelections.add(full.task_execution_id),selectionIcon):selectionIcon},i=0;i<referenceVersionsTaskTableCtrl.headersVersions.length;i++)"actions"==referenceVersionsTaskTableCtrl.headersVersions[i].column?referenceVersionsTaskTableCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(referenceVersionsTaskTableCtrl.headersVersions[i].column).withTitle(referenceVersionsTaskTableCtrl.headersVersions[i].name).renderWith(renderSelectionColumn)):"date"==referenceVersionsTaskTableCtrl.headersVersions[i].type?referenceVersionsTaskTableCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(referenceVersionsTaskTableCtrl.headersVersions[i].column).withTitle(referenceVersionsTaskTableCtrl.headersVersions[i].name).renderWith(changeToLocalDate)):referenceVersionsTaskTableCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(referenceVersionsTaskTableCtrl.headersVersions[i].column).withTitle(referenceVersionsTaskTableCtrl.headersVersions[i].name));referenceVersionsTaskTableCtrl.dtOptionsVersions=DTOptionsBuilder.fromFnPromise((function(){return deferred=$q.defer(),referenceVersionsTaskTableCtrl.groupedSelections=new Set,deferred.resolve($scope.versionsList||[]),deferred.promise;var deferred})).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("scrollX",!1).withOption("lengthChange",!1).withOption("paging",!1).withButtons([]).withOption("caseInsensitive",!0).withOption("search",{caseInsensitive:!1}),referenceVersionsTaskTableCtrl.dtOptionsVersions.withLightColumnFilter({1:{type:"text"},2:{type:"text"},3:{type:"text"},4:{type:"text"},5:{type:"text"},6:{type:"text"}})},controllerAs:"referenceVersionsTaskTableCtrl"}}angular.module("TDM-FE").directive("referenceVersionsTaskTable",referenceVersionsTaskTable);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvdGFza3MvcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVEaXJlY3RpdmUuanMiXSwibmFtZXMiOlsicmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGUiLCJyZXN0cmljdCIsInRlbXBsYXRlVXJsIiwic2NvcGUiLCJ2ZXJzaW9uc0xpc3QiLCJsb2FkaW5nIiwidGltZVJhbmdlIiwiZ2V0VmVyc2lvbnMiLCJzZWxlY3RlZFZlcnNpb24iLCJyZWxvYWRWZXJzaW9uc1RhYmxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIlRETVNlcnZpY2UiLCIkdGltZW91dCIsIkRUT3B0aW9uc0J1aWxkZXIiLCJEVENvbHVtbkJ1aWxkZXIiLCIkcSIsIiR1aWJNb2RhbCIsIiRjb21waWxlIiwicmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsIiwidGhpcyIsImR0Q29sdW1uc1ZlcnNpb25zIiwiZHRDb2x1bW5EZWZzVmVyc2lvbnMiLCJkdEluc3RhbmNlVmVyc2lvbnMiLCJncm91cGVkU2VsZWN0aW9ucyIsIlNldCIsImhlYWRlcnNWZXJzaW9ucyIsImNvbHVtbiIsIm5hbWUiLCJjbGlja0FibGUiLCJ0eXBlIiwiY2hhbmdlVG9Mb2NhbERhdGUiLCJkYXRhIiwiZnVsbCIsIm1ldGEiLCJtb21lbnQiLCJmb3JtYXQiLCJyZW5kZXJTZWxlY3Rpb25Db2x1bW4iLCJzZWxlY3Rpb25JY29uIiwidGFza19leGVjdXRpb25faWQiLCJhZGQiLCJoYXMiLCJpIiwibGVuZ3RoIiwicHVzaCIsIm5ld0NvbHVtbiIsIndpdGhUaXRsZSIsInJlbmRlcldpdGgiLCJkdE9wdGlvbnNWZXJzaW9ucyIsImZyb21GblByb21pc2UiLCJkZWZlcnJlZCIsImRlZmVyIiwicmVzb2x2ZSIsInByb21pc2UiLCJ3aXRoRE9NIiwid2l0aE9wdGlvbiIsInJvdyIsImFuZ3VsYXIiLCJlbGVtZW50IiwiY29udGVudHMiLCJ3aXRoQnV0dG9ucyIsImNhc2VJbnNlbnNpdGl2ZSIsIndpdGhMaWdodENvbHVtbkZpbHRlciIsIjEiLCIyIiwiMyIsIjQiLCI1IiwiNiIsImNvbnRyb2xsZXJBcyIsIm1vZHVsZSIsImRpcmVjdGl2ZSJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsNkJBeUxMLE1BQU8sQ0FDSEMsU0FBVSxJQUNWQyxZQXpMYyw4Q0EwTGRDLE1BQU8sQ0FDSEMsYUFBYyxJQUNkQyxRQUFVLElBQ1ZDLFVBQVksSUFDWkMsWUFBYyxJQUNkQyxnQkFBa0IsSUFDbEJDLG9CQUFzQixLQUUxQkMsV0FoTWEsU0FBVUMsT0FBUUMsV0FBWUMsU0FBU0MsaUJBQW1CQyxnQkFBaUJDLEdBQUlDLFVBQVdDLFVBQ3ZHLElBQUlDLCtCQUFpQ0MsS0FDckNELCtCQUErQkUsa0JBQW9CLEdBQ25ERiwrQkFBK0JHLHFCQUF1QixHQUN0RFgsT0FBT0Ysb0JBQW9CYyxtQkFBcUIsR0FDaERKLCtCQUErQkssa0JBQW9CLElBQUlDLElBRXZETiwrQkFBK0JPLGdCQUFrQixDQUM3QyxDQUNJQyxPQUFTLFVBQ1RDLEtBQU8sR0FDUEMsV0FBWSxHQUVoQixDQUNJRixPQUFTLFVBQ1RDLEtBQU8sVUFDUEMsV0FBWSxHQUVoQixDQUNJRixPQUFTLGVBQ1RDLEtBQU8sZUFDUEMsV0FBWSxHQUVoQixDQUNJRixPQUFTLFVBQ1RDLEtBQU8sVUFDUEMsV0FBWSxHQUVoQixDQUNJRixPQUFTLHVCQUNUQyxLQUFPLGtCQUNQQyxXQUFZLEdBRWhCLENBQ0lGLE9BQVMsZUFDVEMsS0FBTyxlQUNQQyxXQUFZLEdBRWhCLENBQ0lGLE9BQVMsbUJBQ1RDLEtBQU8sWUFDUEUsS0FBTSxPQUNORCxXQUFZLElBMEJwQixJQXRCQSxJQUFJRSxrQkFBb0IsU0FBVUMsS0FBTUYsS0FBTUcsS0FBTUMsTUFDaEQsT0FBT0MsT0FBT0gsTUFBTUksT0FBTyx1QkFJM0JDLHNCQUF3QixTQUFTTCxLQUFNRixLQUFNRyxLQUFNQyxNQUNuRCxJQUFJSSxjQUFnQixpQ0FBa0NMLEtBQUtNLGtCQUFvQixnR0FJL0UsT0FIYXBCLCtCQUErQkssbUJBQ2hDTCwrQkFBK0JLLGtCQUFrQmdCLElBQUlQLEtBQUtNLG1CQUVsRU4sS0FBS00sa0JBR0pwQiwrQkFBK0JLLGtCQUFrQmlCLElBQUlSLEtBQUtNLG1CQUtwRCxJQUhQcEIsK0JBQStCSyxrQkFBa0JnQixJQUFJUCxLQUFLTSxtQkFDbkRELGVBTEFBLGVBV05JLEVBQUksRUFBR0EsRUFBS3ZCLCtCQUErQk8sZ0JBQWdCaUIsT0FBU0QsSUFDVCxXQUE1RHZCLCtCQUErQk8sZ0JBQWdCZ0IsR0FBR2YsT0FDbERSLCtCQUErQkUsa0JBQWtCdUIsS0FBSzdCLGdCQUFnQjhCLFVBQVUxQiwrQkFBK0JPLGdCQUFnQmdCLEdBQUdmLFFBQVFtQixVQUFVM0IsK0JBQStCTyxnQkFBZ0JnQixHQUFHZCxNQUFNbUIsV0FBV1Ysd0JBRXhKLFFBQTFEbEIsK0JBQStCTyxnQkFBZ0JnQixHQUFHWixLQUN2RFgsK0JBQStCRSxrQkFBa0J1QixLQUFLN0IsZ0JBQWdCOEIsVUFBVTFCLCtCQUErQk8sZ0JBQWdCZ0IsR0FBR2YsUUFBUW1CLFVBQVUzQiwrQkFBK0JPLGdCQUFnQmdCLEdBQUdkLE1BQU1tQixXQUFXaEIsb0JBR3ZOWiwrQkFBK0JFLGtCQUFrQnVCLEtBQUs3QixnQkFBZ0I4QixVQUFVMUIsK0JBQStCTyxnQkFBZ0JnQixHQUFHZixRQUFRbUIsVUFBVTNCLCtCQUErQk8sZ0JBQWdCZ0IsR0FBR2QsT0FXOU1ULCtCQUErQjZCLGtCQUFvQmxDLGlCQUFpQm1DLGVBQWMsV0FDMUUsT0FQQUMsU0FBV2xDLEdBQUdtQyxRQUNsQmhDLCtCQUErQkssa0JBQW9CLElBQUlDLElBQ3ZEeUIsU0FBU0UsUUFBUXpDLE9BQU9QLGNBQWdCLElBQ2pDOEMsU0FBU0csUUFKTyxJQUNuQkgsWUFTSEksUUFBUSw0QkFDUkMsV0FBVyxjQUFjLFNBQVVDLEtBRWhDdEMsU0FBU3VDLFFBQVFDLFFBQVFGLEtBQUtHLFdBQTlCekMsQ0FBMENQLFdBRTdDNEMsV0FBVyxXQUFXLEdBQ3RCQSxXQUFXLGdCQUFnQixHQUMzQkEsV0FBVyxVQUFVLEdBQ3JCSyxZQUFZLElBQ1pMLFdBQVcsbUJBQW1CLEdBQzlCQSxXQUFXLFNBQVMsQ0FDakJNLGlCQUFtQixJQUd2QjFDLCtCQUErQjZCLGtCQUFrQmMsc0JBQXNCLENBQ25FQyxFQUFHLENBQ0NqQyxLQUFNLFFBRVZrQyxFQUFHLENBQ0NsQyxLQUFNLFFBRVZtQyxFQUFHLENBQ0NuQyxLQUFNLFFBRVZvQyxFQUFHLENBQ0NwQyxLQUFNLFFBRVZxQyxFQUFHLENBQ0NyQyxLQUFNLFFBRVZzQyxFQUFHLENBQ0N0QyxLQUFNLFdBd0VsQnVDLGFBQWMsa0NBS3RCWixRQUNLYSxPQUFPLFVBQ1BDLFVBQVUsNkJBQThCdkUiLCJmaWxlIjoiZGlyZWN0aXZlcy90YXNrcy9yZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZURpcmVjdGl2ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlKCkge1xuXG4gICAgdmFyIHRlbXBsYXRlVXJsID0gXCJ2aWV3cy90YXNrcy9yZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZS5odG1sXCI7XG5cbiAgICB2YXIgY29udHJvbGxlciA9IGZ1bmN0aW9uICgkc2NvcGUsIFRETVNlcnZpY2UsICR0aW1lb3V0LERUT3B0aW9uc0J1aWxkZXIgLCBEVENvbHVtbkJ1aWxkZXIsICRxLCAkdWliTW9kYWwsICRjb21waWxlKSB7XG4gICAgICAgIHZhciByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwgPSB0aGlzO1xuICAgICAgICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuZHRDb2x1bW5zVmVyc2lvbnMgPSBbXTtcbiAgICAgICAgcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmR0Q29sdW1uRGVmc1ZlcnNpb25zID0gW107XG4gICAgICAgICRzY29wZS5yZWxvYWRWZXJzaW9uc1RhYmxlLmR0SW5zdGFuY2VWZXJzaW9ucyA9IHt9O1xuICAgICAgICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuZ3JvdXBlZFNlbGVjdGlvbnMgPSBuZXcgU2V0KCk7XG5cbiAgICAgICAgcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmhlYWRlcnNWZXJzaW9ucyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW4gOiAnYWN0aW9ucycsXG4gICAgICAgICAgICAgICAgbmFtZSA6ICcnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdsdV9uYW1lJyxcbiAgICAgICAgICAgICAgICBuYW1lIDogJ0xVIE5hbWUnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1uIDogJ3ZlcnNpb25fbmFtZScsXG4gICAgICAgICAgICAgICAgbmFtZSA6ICdWZXJzaW9uIE5hbWUnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1uIDogJ3Rhc2tfaWQnLFxuICAgICAgICAgICAgICAgIG5hbWUgOiAnVGFzayBJZCcsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1uIDogJ3Rhc2tfbGFzdF91cGRhdGVkX2J5JyxcbiAgICAgICAgICAgICAgICBuYW1lIDogJ0xhc3QgVXBkYXRlZCBCeScsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1uIDogJ3ZlcnNpb25fdHlwZScsXG4gICAgICAgICAgICAgICAgbmFtZSA6ICdWZXJzaW9uIFR5cGUnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbHVtbiA6ICd2ZXJzaW9uX2RhdGV0aW1lJyxcbiAgICAgICAgICAgICAgICBuYW1lIDogJ0RhdGUgVGltZScsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2RhdGUnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgdmFyIGNoYW5nZVRvTG9jYWxEYXRlID0gZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwsIG1ldGEpIHtcbiAgICAgICAgICAgIHJldHVybiBtb21lbnQoZGF0YSkuZm9ybWF0KCdERCBNTU0gWVlZWSwgSEg6bW0nKVxuICAgICAgICB9O1xuXG5cbiAgICAgICAgdmFyIHJlbmRlclNlbGVjdGlvbkNvbHVtbiA9IGZ1bmN0aW9uKGRhdGEsIHR5cGUsIGZ1bGwsIG1ldGEpe1xuICAgICAgICAgICAgdmFyIHNlbGVjdGlvbkljb24gPSAnPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5nLXZhbHVlPVwiJysgZnVsbC50YXNrX2V4ZWN1dGlvbl9pZCArICdcIiBuYW1lPVwicmVmZXJlbmNlVmVyc2lvbnNUYWJsZVNlbGVjdGlvblwiIG5nLW1vZGVsPVwic2VsZWN0ZWRWZXJzaW9uLnNlbGVjdGVkUmVmVmVyc2lvblRvTG9hZFwiPidcbiAgICAgICAgICAgICAgICAgICAgIGlmKCFyZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuZ3JvdXBlZFNlbGVjdGlvbnMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmdyb3VwZWRTZWxlY3Rpb25zLmFkZChmdWxsLnRhc2tfZXhlY3V0aW9uX2lkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKCFmdWxsLnRhc2tfZXhlY3V0aW9uX2lkKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0aW9uSWNvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmdyb3VwZWRTZWxlY3Rpb25zLmhhcyhmdWxsLnRhc2tfZXhlY3V0aW9uX2lkKSkge1xuXG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmdyb3VwZWRTZWxlY3Rpb25zLmFkZChmdWxsLnRhc2tfZXhlY3V0aW9uX2lkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0aW9uSWNvbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfSBcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuaGVhZGVyc1ZlcnNpb25zLmxlbmd0aCA7IGkrKykge1xuICAgICAgICAgICAgaWYgKHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uID09ICdhY3Rpb25zJyl7XG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmR0Q29sdW1uc1ZlcnNpb25zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihyZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbikud2l0aFRpdGxlKHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0ubmFtZSkucmVuZGVyV2l0aChyZW5kZXJTZWxlY3Rpb25Db2x1bW4pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0udHlwZSA9PSAnZGF0ZScpIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuZHRDb2x1bW5zVmVyc2lvbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uKS53aXRoVGl0bGUocmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5uYW1lKS5yZW5kZXJXaXRoKGNoYW5nZVRvTG9jYWxEYXRlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuZHRDb2x1bW5zVmVyc2lvbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uKS53aXRoVGl0bGUocmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5uYW1lKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZ2V0VGFibGVEYXRhVmVyc2lvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmdyb3VwZWRTZWxlY3Rpb25zID0gbmV3IFNldCgpO1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgkc2NvcGUudmVyc2lvbnNMaXN0IHx8IFtdKTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC5kdE9wdGlvbnNWZXJzaW9ucyA9IERUT3B0aW9uc0J1aWxkZXIuZnJvbUZuUHJvbWlzZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFRhYmxlRGF0YVZlcnNpb25zKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLndpdGhET00oJzxcImh0bWw1YnV0dG9uc1wiQj5sVGZnaXRwJylcbiAgICAgICAgICAgIC53aXRoT3B0aW9uKCdjcmVhdGVkUm93JywgZnVuY3Rpb24gKHJvdykge1xuICAgICAgICAgICAgICAgIC8vIFJlY29tcGlsaW5nIHNvIHdlIGNhbiBiaW5kIEFuZ3VsYXIgZGlyZWN0aXZlIHRvIHRoZSBEVFxuICAgICAgICAgICAgICAgICRjb21waWxlKGFuZ3VsYXIuZWxlbWVudChyb3cpLmNvbnRlbnRzKCkpKCRzY29wZSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLndpdGhPcHRpb24oJ3Njcm9sbFgnLCBmYWxzZSlcbiAgICAgICAgICAgIC53aXRoT3B0aW9uKCdsZW5ndGhDaGFuZ2UnLCBmYWxzZSlcbiAgICAgICAgICAgIC53aXRoT3B0aW9uKCdwYWdpbmcnLCBmYWxzZSlcbiAgICAgICAgICAgIC53aXRoQnV0dG9ucyhbXSlcbiAgICAgICAgICAgIC53aXRoT3B0aW9uKFwiY2FzZUluc2Vuc2l0aXZlXCIsIHRydWUpXG4gICAgICAgICAgICAud2l0aE9wdGlvbignc2VhcmNoJyx7XG4gICAgICAgICAgICAgICAgXCJjYXNlSW5zZW5zaXRpdmVcIjogZmFsc2VcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuZHRPcHRpb25zVmVyc2lvbnMud2l0aExpZ2h0Q29sdW1uRmlsdGVyKHtcbiAgICAgICAgICAgICAgICAxOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgMjoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIDM6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICA0OiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgNToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIDY6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAvLyByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuZ2V0VmVyc2lvbnNGb3JMb2FkID0gZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gICAgIGlmIChyZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwudmVyc2lvbkZvckxvYWRGcm9tICYmIHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC52ZXJzaW9uRm9yTG9hZFRvICYmIFxuICAgICAgICAvLyAgICAgICAgIHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC5sb2dpY2FsVW5pdC5sdV9uYW1lICYmIHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC50YXNrRGF0YS5zb3VyY2VfZW52X25hbWUgXG4gICAgICAgIC8vICAgICAgICAgJiYgKHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC50YXNrRGF0YS5zZWxlY3RBbGxFbnRpdGVzIHx8IFxuICAgICAgICAvLyAgICAgICAgICAgICAocmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QgJiYgZW50aXRpZXNQYXNzZWQpKSl7XG4gICAgICAgIC8vICAgICAgICAgcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmxvYWRpbmdUYWJsZVZlcnNpb25zID0gdHJ1ZTtcbiAgICAgICAgLy8gICAgICAgICB2YXIgZnJvbSA9IG5ldyBEYXRlKHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC52ZXJzaW9uRm9yTG9hZEZyb20pO1xuICAgICAgICAvLyAgICAgICAgIGZyb20uc2V0SG91cnMoMCk7XG4gICAgICAgIC8vICAgICAgICAgZnJvbS5zZXRNaW51dGVzKDApO1xuICAgICAgICAvLyAgICAgICAgIGZyb20uc2V0U2Vjb25kcygwKTtcbiAgICAgICAgLy8gICAgICAgICB2YXIgdG8gPSBuZXcgRGF0ZShyZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwudmVyc2lvbkZvckxvYWRUbyk7XG4gICAgICAgIC8vICAgICAgICAgdG8uc2V0SG91cnMoMjMpO1xuICAgICAgICAvLyAgICAgICAgIHRvLnNldE1pbnV0ZXMoNTkpO1xuICAgICAgICAvLyAgICAgICAgIHRvLnNldFNlY29uZHMoNTkpO1xuICAgICAgICAvLyAgICAgICAgIFRETVNlcnZpY2UucG9zdEdlbmVyaWNBUEkoJ3Rhc2tzL2dldFZlcnNpb25SZWZlcmVuY2VUYXNrVGFibGUnLHtcbiAgICAgICAgLy8gICAgICAgICAgICAgZnJvbURhdGUgOiBmcm9tLFxuICAgICAgICAvLyAgICAgICAgICAgICB0b0RhdGUgOiB0byxcbiAgICAgICAgLy8gICAgICAgICAgICAgcmVmTGlzdCA6IF8ubWFwKF8uZmlsdGVyKCRzY29wZS5yZWZMaXN0LHtzZWxlY3RlZCA6IHRydWV9KSwncmVmZXJlbmNlX3RhYmxlX25hbWUnKSxcbiAgICAgICAgLy8gICAgICAgICAgICAgc291cmNlX2Vudl9uYW1lIDogcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLnRhc2tEYXRhLnNvdXJjZV9lbnZfbmFtZVxuICAgICAgICAvLyAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIC8vICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC52ZXJzaW9uc0ZvckxvYWQgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwudmVyc2lvbnNGb3JMb2FkID0gXy5zb3J0QnkocmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLnZlcnNpb25zRm9yTG9hZCwgZnVuY3Rpb24odmVyc2lvbil7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xICogbmV3IERhdGUodmVyc2lvbi52ZXJzaW9uX2RhdGV0aW1lKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICBpZiAocmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmR0SW5zdGFuY2VWZXJzaW9ucyAmJiByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEpe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEoZnVuY3Rpb24oKXtcbiAgICBcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgfSwxMDApO1xuXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwubG9hZGluZ1RhYmxlVmVyc2lvbnMgPSBmYWxzZTtcblxuICAgICAgICAvLyAgICAgICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiTmV3IFRhc2sgIyBGYWlsZWQgdG8gZ2V0IFZlcnNpb25zIGZvciBMb2FkXCIpO1xuICAgICAgICAvLyAgICAgICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAgfSk7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vICAgICBlbHNlIGlmICghcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QgJiYgIXJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC50YXNrRGF0YS5zZWxlY3RBbGxFbnRpdGVzKXtcbiAgICAgICAgLy8gICAgICAgICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwudmVyc2lvbnNGb3JMb2FkID0gW107XG4gICAgICAgIC8vICAgICAgICAgaWYgKHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlQ3RybC5kdEluc3RhbmNlVmVyc2lvbnMgJiYgcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmR0SW5zdGFuY2VWZXJzaW9ucy5yZWxvYWREYXRhKXtcbiAgICAgICAgLy8gICAgICAgICAgICAgcmVmZXJlbmNlVmVyc2lvbnNUYXNrVGFibGVDdHJsLmR0SW5zdGFuY2VWZXJzaW9ucy5yZWxvYWREYXRhKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgLy8gICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vICAgICAgICAgfVxuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyAgICAgZWxzZSBpZiAoIWVudGl0aWVzUGFzc2VkKXtcbiAgICAgICAgLy8gICAgICAgICByZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwuZW5pdGl0ZXNMaXN0RmFpbGVkUGF0dGVyblRlc3QgPSB0cnVlO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyB9O1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogXCJFXCIsXG4gICAgICAgIHRlbXBsYXRlVXJsOiB0ZW1wbGF0ZVVybCxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHZlcnNpb25zTGlzdDogJz0nLFxuICAgICAgICAgICAgbG9hZGluZyA6IFwiPVwiLFxuICAgICAgICAgICAgdGltZVJhbmdlIDogJz0nLFxuICAgICAgICAgICAgZ2V0VmVyc2lvbnMgOiAnPScsXG4gICAgICAgICAgICBzZWxlY3RlZFZlcnNpb24gOiBcIj1cIixcbiAgICAgICAgICAgIHJlbG9hZFZlcnNpb25zVGFibGUgOiBcIj1cIlxuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBjb250cm9sbGVyLFxuICAgICAgICBjb250cm9sbGVyQXM6ICdyZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZUN0cmwnXG4gICAgfTtcbn1cblxuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnVERNLUZFJylcbiAgICAuZGlyZWN0aXZlKCdyZWZlcmVuY2VWZXJzaW9uc1Rhc2tUYWJsZScsIHJlZmVyZW5jZVZlcnNpb25zVGFza1RhYmxlKSJdfQ==
