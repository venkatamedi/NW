function taskDirective(){return{restrict:"E",templateUrl:"views/tasks/task.html",scope:{content:"="},controller:function($scope,TDMService,BreadCrumbsService,SweetAlert,$uibModal,toastr,$timeout,AuthService,$state,DTOptionsBuilder,DTColumnBuilder,$q,$compile){var taskCtrl=this;if(taskCtrl.minDate=new Date,taskCtrl.minDate=moment(taskCtrl.minDate),taskCtrl.minDate.milliseconds(0),taskCtrl.minDate.seconds(0),taskCtrl.minDate.minutes(0),taskCtrl.minDate.hours(0),taskCtrl.minDate.add(1,"days"),taskCtrl.schedulerOptions={formInputClass:"form-control1 cron-gen-input",formSelectClass:"form-control1 cron-gen-select",formRadioClass:"cron-gen-radio",formCheckboxClass:"cron-gen-checkbox",hideMinutesTab:!1,hideHourlyTab:!1,hideDailyTab:!1,hideWeeklyTab:!1,hideMonthlyTab:!1,hideYearlyTab:!1,hideAdvancedTab:!1,use24HourTime:!0,hideSeconds:!1},taskCtrl.taskData=angular.copy($scope.content.task),taskCtrl.copyTask=$scope.content.copy,taskCtrl.copyTask&&(taskCtrl.taskData.task_title=taskCtrl.taskData.task_title+" Copy"),taskCtrl.isFluxMode=AuthService.isFluxMode(),taskCtrl.retentionPeriod=AuthService.getRetentionPeriod(),taskCtrl.taskData.reference=null,taskCtrl.taskData.sync_mode&&(taskCtrl.taskData.request_of_fresh_data=!0),"EXTRACT"!==taskCtrl.taskData.task_type||taskCtrl.taskData.version_ind||taskCtrl.taskData.retention_period_value||(taskCtrl.taskData.retention_period_value=0),"REF"==taskCtrl.taskData.selection_method?taskCtrl.taskData.reference="refernceOnly":taskCtrl.taskData.refcount>0&&(taskCtrl.taskData.reference="both"),taskCtrl.taskData.reference&&TDMService.getGenericAPI("task/refsTable/"+taskCtrl.taskData.task_id).then((function(response){taskCtrl.taskData.refList=_.map(response.result,(function(ref){return ref.selected=!0,ref}))})),taskCtrl.referenceDropDown=[{text:"None",value:null},{text:"Reference Only",value:"refernceOnly"},{text:"Both - reference and entities",value:"both"}],taskCtrl.timeZoneOffset=AuthService.getTimeZone(),_.remove(taskCtrl.retentionPeriod.availableOptions,(function(period){if(period.units>taskCtrl.retentionPeriod.maxRetentionPeriod)return!0})),TDMService.getGenericAPI("task/"+taskCtrl.taskData.task_id+"/globals").then((function(response){taskCtrl.taskData.globals=response.result})),taskCtrl.referenceChange=function(){"refernceOnly"==taskCtrl.taskData.reference&&(taskCtrl.taskData.selectAllEntites=!1)},taskCtrl.taskData.scheduling_end_date?(taskCtrl.taskData.scheduling_end_date=moment(new Date(taskCtrl.taskData.scheduling_end_date)),taskCtrl.scheduleEndBy="endBy"):taskCtrl.scheduleEndBy="noEndBy",taskCtrl.versionForLoadTo=new Date,taskCtrl.versionForLoadFrom=new Date,taskCtrl.versionForLoadFrom.setDate(taskCtrl.versionForLoadFrom.getDate()-30),taskCtrl.taskData.retention_period_value)taskCtrl.retention_period_type=_.find(taskCtrl.retentionPeriod.availableOptions,{name:taskCtrl.taskData.retention_period_type}),taskCtrl.taskData.retention_period_value=parseFloat(taskCtrl.taskData.retention_period_value);else if(taskCtrl.retentionPeriod&&taskCtrl.retentionPeriod.defaultPeriod&&taskCtrl.retentionPeriod.defaultPeriod.unit){var defaultRetintion=_.find(taskCtrl.retentionPeriod.availableOptions,{name:taskCtrl.retentionPeriod.defaultPeriod.unit});defaultRetintion&&(taskCtrl.retention_period_type=defaultRetintion,taskCtrl.taskData.retention_period_type=taskCtrl.retention_period_type.name,"EXTRACT"==taskCtrl.taskData.task_type&&taskCtrl.taskData.version_ind&&(taskCtrl.taskData.retention_period_value=taskCtrl.retentionPeriod.defaultPeriod.value))}taskCtrl.retentionPeriodTypeChanged=function(){taskCtrl.taskData.retention_period_type=taskCtrl.retention_period_type.name},taskCtrl.taskData.delete_before_load&&taskCtrl.taskData.load_entity?taskCtrl.taskData.operationMode="delete_and_load_entity":!taskCtrl.taskData.delete_before_load&&taskCtrl.taskData.load_entity?taskCtrl.taskData.operationMode="insert_entity_without_delete":taskCtrl.taskData.delete_before_load&&!taskCtrl.taskData.load_entity?taskCtrl.taskData.operationMode="delete_without_load_entity":taskCtrl.taskData.operationMode="insert_entity_without_delete",taskCtrl.taskTitlePattern="^((?!_).)*$",taskCtrl.step=1;var userRole=AuthService.getRole(),username=AuthService.getUsername();if(TDMService.getFabricRolesforUser(AuthService.getUserId()).then(response=>{taskCtrl.userFabricRoles=response.result||[]}),taskCtrl.userRoleType=userRole.type,taskCtrl.entitiesPattern=new RegExp("^((\\w|-)+(?:,(\\w|-)+){"+(taskCtrl.taskData.number_of_entities_to_copy-1)+"})?$"),taskCtrl.excultionPattern=new RegExp("^((\\w|-)+(?:,(\\w|-)+){0,})?$"),taskCtrl.syntheticPattern="^[a-zA-Z0-9._-]+$",taskCtrl.updateEntitiesPattern=function(){taskCtrl.taskData.number_of_entities_to_copy&&(taskCtrl.entitiesPattern=new RegExp("^((\\w|-)+(?:,(\\w|-)+){"+(taskCtrl.taskData.number_of_entities_to_copy-1)+"})?$"))},TDMService.getTimeZone().then((function(response){"SUCCESS"==response.errorCode?taskCtrl.timeZoneMessage="Task execution time will be based on "+response.result.current_setting+" time zone":taskCtrl.timeZoneMessage="Task execution time will be based on DB time zone"})),taskCtrl.disableChange="Inactive"==taskCtrl.taskData.task_status||username!=taskCtrl.taskData.task_created_by,"Active"==taskCtrl.taskData.task_status&&(taskCtrl.taskData.owners.indexOf(username)>=0||"admin"==userRole.type)&&(taskCtrl.disableChange=!1),taskCtrl.copyTask&&(taskCtrl.disableChange=!1),"admin"==userRole.type||taskCtrl.disableChange?TDMService.getEnvironments().then((function(response){"SUCCESS"==response.errorCode?(taskCtrl.allEnvironments=_.filter(angular.copy(response.result),(function(env){return!(!env.allow_write||"Active"!==env.environment_status)})),taskCtrl.allSourceEnvironments=_.filter(angular.copy(response.result),(function(env){return!(!env.allow_read||"Active"!==env.environment_status)})),taskCtrl.allSourceEnvironments=_.unique(taskCtrl.allSourceEnvironments,"environment_name")):toastr.error("Task # "+taskCtrl.taskData.task_id,"Faild to get Environments for user")})):TDMService.getEnvironmentsForUser().then((function(response){"SUCCESS"==response.errorCode?(taskCtrl.allEnvironments=_.filter(angular.copy(response.result),(function(env){return!(!env.allow_write||"Active"!==env.environment_status)})),taskCtrl.allSourceEnvironments=_.filter(angular.copy(response.result),(function(env){return!(!env.allow_read||"Active"!==env.environment_status)})),taskCtrl.allSourceEnvironments=_.unique(taskCtrl.allSourceEnvironments,"environment_name")):toastr.error("Task # "+taskCtrl.taskData.task_id,"Faild to get Environments for user")})),taskCtrl.entitiesListChange=function(){taskCtrl.entitiesListChangeTimeout&&$timeout.cancel(taskCtrl.entitiesListChangeTimeout),"LOAD"==taskCtrl.taskData.task_type&&taskCtrl.taskData.version_ind&&!taskCtrl.taskData.selectAllEntites&&(taskCtrl.entitiesListChangeTimeout=$timeout((function(){taskCtrl.getVersionsForLoad()}),1e3))},taskCtrl.taskModeChange=function(init,task_type){if(taskCtrl.taskData.version_ind&&(taskCtrl.taskData.number_of_entities_to_copy=void 0),task_type&&(taskCtrl.taskData.source_environment_id=null,taskCtrl.taskData.environment_id=null,taskCtrl.taskData.source_env_name=null,taskCtrl.maxToCopy=null),taskCtrl.taskData.version_ind&&"LOAD"==taskCtrl.taskData.task_type)taskCtrl.logicalUnits=[],taskCtrl.logicalUnit=null,init||(taskCtrl.taskData.be_id=null);else if("EXTRACT"==taskCtrl.taskData.task_type){if(taskCtrl.logicalUnits=[],taskCtrl.logicalUnit=null,init||(taskCtrl.taskData.be_id=null),task_type&&!taskCtrl.taskData.version_ind)taskCtrl.taskData.retention_period_value=0;else if(taskCtrl.taskData.version_ind&&!taskCtrl.taskData.retention_period_value&&taskCtrl.retentionPeriod&&taskCtrl.retentionPeriod.defaultPeriod&&taskCtrl.retentionPeriod.defaultPeriod.unit){var defaultRetintion=_.find(taskCtrl.retentionPeriod.availableOptions,{name:taskCtrl.retentionPeriod.defaultPeriod.unit});defaultRetintion&&(taskCtrl.retention_period_type=defaultRetintion,taskCtrl.taskData.retention_period_type=taskCtrl.retention_period_type.name,"EXTRACT"==taskCtrl.taskData.task_type&&taskCtrl.taskData.version_ind&&(taskCtrl.taskData.retention_period_value=taskCtrl.retentionPeriod.defaultPeriod.value))}}else taskCtrl.taskData.selectAllEntites=!1,taskCtrl.logicalUnit=null;taskCtrl.taskData.selectAllEntites||(taskCtrl.selectFieldType="given")},taskCtrl.getAllLogicalUnitsForEnv=function(source_environment_id,environment_id,init){source_environment_id&&environment_id&&(taskCtrl.allSingleLogicalUnits=[],TDMService.getGenericAPI("sourceenvid/"+source_environment_id+"/targetendid/"+environment_id+"/logicalUnits").then((function(response){"SUCCESS"==response.errorCode?(taskCtrl.allSingleLogicalUnits=response.result,init&&taskCtrl.logicalUnits&&taskCtrl.logicalUnits[0]&&(taskCtrl.logicalUnit=_.find(taskCtrl.allSingleLogicalUnits,{lu_id:taskCtrl.logicalUnits[0].lu_id}))):toastr.error("Faild to get Logical units")})))},taskCtrl.sourceEnvironmentChange=function(getRoles,init){var sourceEnv=_.find(taskCtrl.allSourceEnvironments,{environment_id:taskCtrl.taskData.source_environment_id});sourceEnv&&(taskCtrl.taskData.source_env_name=sourceEnv.environment_name),getRoles&&taskCtrl.environmentChange(init,taskCtrl.taskData.source_environment_id,!0)},taskCtrl.checkReferenceIfAllowed=function(){taskCtrl.userRole&&taskCtrl.userRole.allowed_refresh_reference_data||taskCtrl.sourceUserRole&&taskCtrl.sourceUserRole.allowed_refresh_reference_data||(taskCtrl.taskData.reference=null)},taskCtrl.environmentChange=function(init,environment_id,source){"admin"==userRole.type?(taskCtrl.userRole={},taskCtrl.userRole.allowed_random_entity_selection=!0,taskCtrl.userRole.allowed_creation_of_synthetic_data=!0,taskCtrl.userRole.allowed_refresh_reference_data=!0,taskCtrl.userRole.allowed_request_of_fresh_data=!0,taskCtrl.userRole.allowed_delete_before_load=!0,taskCtrl.userRole.allowed_task_scheduling=!0,taskCtrl.userRole.allowed_replace_sequences=!0,taskCtrl.maxToCopy=null,taskCtrl.taskData.number_of_entities_to_copy=parseInt(taskCtrl.taskData.number_of_entities_to_copy)):TDMService.getEnvironmentOwners(environment_id||taskCtrl.taskData.environment_id).then((function(response){if("SUCCESS"==response.errorCode){var ownerFound=_.find(response.result,{user_id:AuthService.getUserId()});if(!ownerFound)for(let i=0;i<taskCtrl.userFabricRoles.length&&!(ownerFound=_.find(response.result,{user_type:"GROUP",user_id:taskCtrl.userFabricRoles[i]}));i++);ownerFound?(taskCtrl.userRole={},taskCtrl.userRole.allowed_random_entity_selection=!0,taskCtrl.userRole.allowed_creation_of_synthetic_data=!0,taskCtrl.userRole.allowed_refresh_reference_data=!0,taskCtrl.userRole.allowed_request_of_fresh_data=!0,taskCtrl.userRole.allowed_delete_before_load=!0,taskCtrl.userRole.allowed_task_scheduling=!0,taskCtrl.userRole.allowed_replace_sequences=!0,taskCtrl.taskData.number_of_entities_to_copy=parseInt(taskCtrl.taskData.number_of_entities_to_copy),environment_id?taskCtrl.sourceEnvOwner=!0:taskCtrl.targetEnvOwner=!0):(environment_id?taskCtrl.sourceEnvOwner=!1:taskCtrl.targetEnvOwner=!1,TDMService.getRoleForUserInEnv(environment_id||taskCtrl.taskData.environment_id).then((function(response){if("SUCCESS"==response.errorCode){environment_id?taskCtrl.sourceUserRole=response.result.userRole:taskCtrl.userRole=response.result.userRole,"LOAD"==taskCtrl.taskData.task_type&&taskCtrl.userRole.allowed_entity_versioning&&taskCtrl.sourceUserRole.allowed_entity_versioning||"EXTRACT"==taskCtrl.taskData.task_type&&taskCtrl.sourceUserRole.allowed_entity_versioning?taskCtrl.allowed_entity_versioning=!0:(taskCtrl.allowed_entity_versioning=!1,taskCtrl.taskData.version_ind=!1),taskCtrl.checkReferenceIfAllowed();var minRead=response.result.minRead,minWrite=response.result.minWrite;(minRead>-1||minWrite>-1)&&(minWrite=parseInt(minWrite||"0"),minRead=parseInt(minRead||"0"),environment_id?(taskCtrl.sourceMaxToCopy=minRead,taskCtrl.maxToCopy>minRead?taskCtrl.maxToCopy=minRead:taskCtrl.maxToCopy||(taskCtrl.maxToCopy=minRead)):(taskCtrl.targetMaxToCopy=minWrite,taskCtrl.maxToCopy>minWrite?taskCtrl.maxToCopy=minWrite:taskCtrl.maxToCopy||(taskCtrl.maxToCopy=minWrite)))}else toastr.error("Task # "+taskCtrl.taskData.task_id,"Faild to get Role for user ")})))}else toastr.error("Environment # "+environment_id||taskCtrl.taskData.environment_id,"failed to get owners : "+response.message)})),source&&"EXTRACT"!==taskCtrl.taskData.task_type&&(!init||source)||!environment_id&&!taskCtrl.taskData.environment_id||TDMService.getBusinessEntitiesForEnvProducts(environment_id||taskCtrl.taskData.environment_id).then((function(response){"SUCCESS"==response.errorCode?taskCtrl.businessEntities=response.result:toastr.error("Task # "+taskCtrl.taskData.task_id,"Faild to get Business Entities")})),init||(taskCtrl.taskData.be_id=void 0,taskCtrl.taskData.logicalUnits=[],taskCtrl.allLogicalUnits=[],taskCtrl.products=[])},taskCtrl.updateParams=cb=>{TDMService.getGenericAPI("businessentity/"+taskCtrl.taskData.be_id+"/sourceEnv/"+taskCtrl.taskData.source_env_name+"/parameters").then((function(response){if("SUCCESS"==response.errorCode){taskCtrl.parameters=response.result;let parametersKeys=Object.keys(taskCtrl.parameters);var chosenLUs=_.map(taskCtrl.logicalUnits,(function(lu){return lu.lu_name.toLowerCase()}));for(let i=0;i<parametersKeys.length;i++)chosenLUs.indexOf(parametersKeys[i].split(".")[0].toLowerCase())<0&&delete taskCtrl.parameters[parametersKeys[i]];taskCtrl.parameters=_.map(taskCtrl.parameters,(function(value,key){return{param_name:key,name:value.PARAM_NAME,param_type:value.PARAM_TYPE,valid_values:value.VALID_VALUES,min_value:"number"==value.PARAM_TYPE?parseFloat(value.MIN_VALUE):0,max_value:"number"==value.PARAM_TYPE?parseFloat(value.MAX_VALUE):0}})),cb&&cb.apply()}else toastr.error("Business entity # "+taskCtrl.taskData.be_id,"Failed to get business entity parameters")}))},taskCtrl.businessEntityChange=function(init){init||(taskCtrl.filter&&taskCtrl.filter.group&&(taskCtrl.filter.group.rules=[]),taskCtrl.taskData.selection_param_value=null,taskCtrl.taskData.parameters=null);var be=_.find(taskCtrl.businessEntities,{be_id:taskCtrl.taskData.be_id});be&&(taskCtrl.taskData.be_name=be.be_name);var environment_id="EXTRACT"===taskCtrl.taskData.task_type?taskCtrl.taskData.source_environment_id:taskCtrl.taskData.environment_id;environment_id&&taskCtrl.taskData.be_id&&TDMService.getLogicalUnitsForBusinessEntityAndEnv(taskCtrl.taskData.be_id,environment_id).then((function(response){if("SUCCESS"==response.errorCode)if(taskCtrl.allLogicalUnits=response.result,init){var tempLus=[];for(i=0;i<taskCtrl.logicalUnits.length;i++){var lu=_.find(taskCtrl.allLogicalUnits,{lu_name:taskCtrl.logicalUnits[i].lu_name});lu&&tempLus.push(lu)}taskCtrl.logicalUnits=tempLus}else{taskCtrl.logicalUnits=[];for(var i=0;i<taskCtrl.allLogicalUnits.length;i++)taskCtrl.logicalUnits.push(taskCtrl.allLogicalUnits[i])}else toastr.error("Business entity # "+taskCtrl.taskData.be_id,"Failed to get Logical units")})),taskCtrl.taskData.be_id&&TDMService.getBEPostExecutionProcess(taskCtrl.taskData.be_id).then((function(response){"SUCCESS"==response.errorCode?(taskCtrl.allPostExecutionProcess=response.result,taskCtrl.allPostExecutionProcessIds=_.map(response.result,"process_id"),init||(taskCtrl.postExecutionProcesses=taskCtrl.allPostExecutionProcessIds)):toastr.error("Business entity # "+taskCtrl.taskData.be_id,"Failed to get Post Execution Processes")}))},TDMService.getTaskLogicalUnits(taskCtrl.taskData.task_id).then((function(response){taskCtrl.businessEntityChange(!0),"SUCCESS"==response.errorCode?(taskCtrl.logicalUnits=response.result,taskCtrl.allSingleLogicalUnits=response.result,taskCtrl.allSingleLogicalUnits&&("LOAD"!=taskCtrl.taskData.task_type||taskCtrl.taskData.version_ind)&&taskCtrl.logicalUnits[0]&&(taskCtrl.logicalUnit=_.find(taskCtrl.allSingleLogicalUnits,{lu_id:taskCtrl.logicalUnits[0].lu_id}))):toastr.error("Systems # "+taskCtrl.taskData.task_id,"Failed to get Task Systems")})),TDMService.getTaskPostExecutionProcesses(taskCtrl.taskData.task_id).then((function(response){"SUCCESS"==response.errorCode?taskCtrl.postExecutionProcesses=_.map(response.result,v=>parseInt(v.process_id)):toastr.error("Task # "+taskCtrl.taskData.task_id,"Failed to get Task Post Execution Processes")})),taskCtrl.environmentChange(!0),taskCtrl.requestedEntities={},"ALL"!=taskCtrl.taskData.selection_method?"L"==taskCtrl.taskData.selection_method?(taskCtrl.selectFieldType="given",taskCtrl.requestedEntities.entities_list=taskCtrl.taskData.selection_param_value):"R"==taskCtrl.taskData.selection_method?taskCtrl.selectFieldType="random":"S"==taskCtrl.taskData.selection_method?(taskCtrl.selectFieldType="synthetic",taskCtrl.requestedEntities.synthetic=taskCtrl.taskData.selection_param_value):"P"!=taskCtrl.taskData.selection_method&&"PR"!=taskCtrl.taskData.selection_method||(taskCtrl.selectFieldType="parameters",taskCtrl.filter=JSON.parse(taskCtrl.taskData.parameters),taskCtrl.requestedEntities.query_parameters=taskCtrl.taskData.selection_param_value,taskCtrl.requestedEntities.parameters=taskCtrl.taskData.parameters,"PR"==taskCtrl.taskData.selection_method?taskCtrl.parametersRandom=!0:taskCtrl.parametersRandom=!1):(taskCtrl.taskData.selectAllEntites=!0,taskCtrl.selectFieldType="given"),!taskCtrl.filter){taskCtrl.filter=JSON.parse('{"group": {"operator": "AND","rules": []}}')}function buildSubQuery(rule){var field='"'+rule.field+'"';let condition=rule.condition;var data="'"+rule.data+"'";return"number"==rule.type&&(field+="::numeric[] ",data=rule.data),"Is null"===rule.condition||"Is not null"===rule.condition?"( "+field+" "+condition+" )":"( "+data+" "+condition+" ANY("+field+") )"}function computed(group){if(!group)return"";for(var str="(",i=0;i<group.rules.length;i++)if(group.rules[i].group)i==group.rules.length-1?str+=computed(group.rules[i].group):str+=computed(group.rules[i].group)+" "+group.rules[i].group.operator+" ";else{var data;if(void 0===group.rules[i].data&&"Is null"!=group.rules[i].condition&&"Is not null"!=group.rules[i].condition)return;if("real"==group.rules[i].type)data=group.rules[i].data.toLocaleString().indexOf(".")<=0?group.rules[i].data.toFixed(1):group.rules[i].data;else if("integer"==group.rules[i].type)data=Math.floor(group.rules[i].data);else if("combo"==group.rules[i].type){if(group.rules[i].validValues.indexOf(group.rules[i].data)<0&&"Is null"!=group.rules[i].condition&&"Is not null"!=group.rules[i].condition)return;data=group.rules[i].data}else data=group.rules[i].data;null==data&&(data=""),i==group.rules.length-1?str+=buildSubQuery(group.rules[i]):(str+=buildSubQuery(group.rules[i]),str+=" "+group.rules[i].operator+" ")}return str+")"}"immediate"==taskCtrl.taskData.scheduler?taskCtrl.selectSchedule="immediate":(taskCtrl.selectSchedule="schedule",taskCtrl.scheduleData=taskCtrl.taskData.scheduler),taskCtrl.saveTask=function(){if(!taskCtrl.taskData.selectAllEntites&&"refernceOnly"!==taskCtrl.taskData.reference)if("given"==taskCtrl.selectFieldType){if(taskCtrl.requestedEntities&&taskCtrl.taskData.entity_exclusion_list==taskCtrl.requestedEntities.entities_list)return taskCtrl.errorList=!0,taskCtrl.step=2,void(taskCtrl.createTaskInProgress=!1);taskCtrl.taskData.selection_method="L",taskCtrl.taskData.selection_param_value=taskCtrl.requestedEntities.entities_list}else if("random"==taskCtrl.selectFieldType)taskCtrl.taskData.selection_method="R",taskCtrl.taskData.selection_param_value=null;else if("synthetic"==taskCtrl.selectFieldType)taskCtrl.taskData.selection_method="S",taskCtrl.taskData.selection_param_value=taskCtrl.requestedEntities.synthetic;else{if(!taskCtrl.requestedEntities.query_parameters||"()"==taskCtrl.requestedEntities.query_parameters)return taskCtrl.parametersError=!0,void(taskCtrl.step=2);1==taskCtrl.parametersRandom?taskCtrl.taskData.selection_method="PR":taskCtrl.taskData.selection_method="P",taskCtrl.taskData.selection_param_value=taskCtrl.requestedEntities.query_parameters,taskCtrl.taskData.parameters=taskCtrl.requestedEntities.parameters}if("immediate"==taskCtrl.selectSchedule?taskCtrl.taskData.scheduler=taskCtrl.selectSchedule:(taskCtrl.taskData.scheduler=taskCtrl.scheduleData,"endBy"!==taskCtrl.scheduleEndBy?taskCtrl.taskData.scheduling_end_date=null:taskCtrl.taskData.scheduling_end_date.hours(12)),"LOAD"==taskCtrl.taskData.task_type&&taskCtrl.taskData.version_ind&&(taskCtrl.taskData.operationMode="delete_and_load_entity"),"delete_and_load_entity"==taskCtrl.taskData.operationMode?(taskCtrl.taskData.replace_sequences=!1,taskCtrl.taskData.load_entity=!0,taskCtrl.taskData.delete_before_load=!0):"insert_entity_without_delete"==taskCtrl.taskData.operationMode?(taskCtrl.taskData.load_entity=!0,taskCtrl.taskData.delete_before_load=!1):"delete_without_load_entity"==taskCtrl.taskData.operationMode?(taskCtrl.taskData.replace_sequences=!1,taskCtrl.taskData.load_entity=!1,taskCtrl.taskData.delete_before_load=!0):(taskCtrl.taskData.load_entity=!0,taskCtrl.taskData.delete_before_load=!1),"LOAD"==taskCtrl.taskData.task_type&&taskCtrl.taskData.version_ind&&"refernceOnly"!==taskCtrl.taskData.reference&&taskCtrl.selectedVersionToLoad){if(!(selectedVersionToLoad=_.find(taskCtrl.versionsForLoad,{fabric_execution_id:taskCtrl.selectedVersionToLoad})))return taskCtrl.step=2,void(taskCtrl.createTaskInProgress=!1);taskCtrl.taskData.selected_version_task_name=selectedVersionToLoad.version_name;var localTimeZone=(version_datetime=new Date(selectedVersionToLoad.version_datetime)).getTimezoneOffset();version_datetime=version_datetime.getTime(),taskCtrl.taskData.selected_version_datetime=moment(version_datetime).format("YYYYMMDDHHmmss"),taskCtrl.taskData.selected_version_task_exe_id=selectedVersionToLoad.task_execution_id}if("LOAD"==taskCtrl.taskData.task_type&&taskCtrl.taskData.version_ind&&("refernceOnly"==taskCtrl.taskData.reference||"both"==taskCtrl.taskData.reference)){if(!taskCtrl.taskData.refLoadVersions)return taskCtrl.step=6,void(taskCtrl.createTaskInProgress=!1);var selectedVersionToLoad;if(selectedVersionToLoad=_.find(taskCtrl.taskData.refLoadVersions,{task_execution_id:parseInt(taskCtrl.taskData.selectedRefVersionToLoad)})){taskCtrl.taskData.selected_ref_version_task_name=selectedVersionToLoad.version_name;var version_datetime;localTimeZone=(version_datetime=new Date(selectedVersionToLoad.version_datetime)).getTimezoneOffset();version_datetime=version_datetime.getTime()+6e4*localTimeZone,taskCtrl.taskData.selected_ref_version_datetime=moment(version_datetime-6e4*taskCtrl.timeZoneOffset).format("YYYYMMDDHHmmss"),taskCtrl.taskData.selected_ref_version_task_exe_id=selectedVersionToLoad.task_execution_id}}taskCtrl.taskData.request_of_fresh_data||(taskCtrl.taskData.sync_mode=null),"EXTRACT"===taskCtrl.taskData.task_type&&(taskCtrl.taskData.load_entity=!1,taskCtrl.taskData.environment_id=taskCtrl.taskData.source_environment_id,!taskCtrl.taskData.version_ind&&taskCtrl.taskData.request_of_fresh_data?taskCtrl.taskData.sync_mode="FORCE":delete taskCtrl.taskData.sync_mode),"EXTRACT"===taskCtrl.taskData.task_type&&taskCtrl.taskData.version_ind||taskCtrl.taskData.retention_period_value||(delete taskCtrl.taskData.retention_period_type,delete taskCtrl.taskData.retention_period_value),taskCtrl.taskData.selectAllEntites&&(taskCtrl.taskData.selection_param_value=null),taskCtrl.taskData.selectAllEntites||"LOAD"===taskCtrl.taskData.task_type&&!taskCtrl.taskData.version_ind||"refernceOnly"===taskCtrl.taskData.reference||(taskCtrl.taskData.number_of_entities_to_copy=taskCtrl.requestedEntities.entities_list.split(",").length),taskCtrl.taskData.globals&&0==taskCtrl.taskData.globals.length&&(taskCtrl.taskData.task_globals=!1),taskCtrl.taskData.reference||(taskCtrl.taskData.refList=[]),taskCtrl.taskData.refList&&taskCtrl.taskData.refList.length>0&&(taskCtrl.taskData.refresh_reference_data=!1),taskCtrl.copyTask&&(taskCtrl.taskData.copy=!0),taskCtrl.taskData.version_ind||(taskCtrl.taskData.selected_version_task_name=null,taskCtrl.taskData.selected_version_datetime=null,taskCtrl.taskData.selected_version_task_exe_id=null,taskCtrl.taskData.selected_ref_version_task_name=null,taskCtrl.taskData.selected_ref_version_datetime=null,taskCtrl.taskData.selected_ref_version_task_exe_id=null),TDMService.updateTask(taskCtrl.taskData).then((function(response){taskCtrl.taskData.copy=!1,"SUCCESS"==response.errorCode?(TDMService.postTaskLogicalUnits(response.result.id,taskCtrl.taskData.task_title,{logicalUnits:taskCtrl.logicalUnits}).then((function(response){"SUCCESS"==response.errorCode?(toastr.success("Task # "+taskCtrl.taskData.task_title," Is Updated Successfully"),$timeout((function(){$state.go("tasks",{},{reload:!0})}),300)):toastr.error("Task # "+taskCtrl.taskData.task_id," Failed to Update : "+response.message)})),taskCtrl.postExecutionProcesses.length>0&&TDMService.postTaskPostExecutionProcess(response.result.id,taskCtrl.taskData.task_title,{postexecutionprocesses:_.filter(taskCtrl.allPostExecutionProcess,v=>taskCtrl.postExecutionProcesses.indexOf(v.process_id)>=0)}).then((function(response){"SUCCESS"!==response.errorCode&&toastr.error("Task # "+createTaskResult.id," Failed to Update Post Execution Processes: "+response.message)}))):toastr.error("Task # "+taskCtrl.taskData.task_id," Failed to Update : "+response.message)}))},taskCtrl.deleteTask=function(){TDMService.deleteTask(taskCtrl.taskData).then((function(response){"SUCCESS"==response.errorCode?(toastr.success("Task # "+taskCtrl.taskData.task_id,"deleted Successfully"),$timeout((function(){$scope.content.openTasks(!0)}),400)):toastr.error("Task # "+taskCtrl.taskData.task_id,"failed to delete")}))},taskCtrl.parametersCount=0,$scope.getEntitesCount=function(force){if("()"!=taskCtrl.requestedEntities.query_parameters)if(taskCtrl.requestedEntities.query_parameters){if(force||taskCtrl.requestedEntities.query_parameters!==taskCtrl.perviousQueryParams){taskCtrl.parametersError=!1;taskCtrl.requestedEntities.query_parameters,taskCtrl.taskData.environment_id,taskCtrl.taskData.be_id;taskCtrl.taskData.source_env_name&&(taskCtrl.parametersCount="inprogress",TDMService.postGenericAPI("businessentity/"+taskCtrl.taskData.be_id+"/sourceEnv/"+taskCtrl.taskData.source_env_name+"/analysiscount",{where:taskCtrl.requestedEntities.query_parameters}).then((function(response){"SUCCESS"==response.errorCode?taskCtrl.parametersCount=response.result:taskCtrl.parametersCount=0})))}}else taskCtrl.parametersCount=0;else taskCtrl.parametersCount=0},$scope.$watch("taskCtrl.filter",(function(newValue){taskCtrl.analysisCountTimeout&&$timeout.cancel(taskCtrl.analysisCountTimeout),taskCtrl.analysisCountTimeout=$timeout((function(){if(taskCtrl.taskData.be_id){var checkGroup=function(group){if(""==group.operator)return!1;for(var i=0;i<group.rules.length;i++)if(0==((rule=group.rules[i]).group?checkGroup(rule.group):""!==rule.condition&&""!==rule.data&&""!==rule.field))return!1;var rule;return!0};if(newValue&&1==checkGroup(newValue.group)){taskCtrl.requestedEntities.parameters=JSON.stringify(newValue);var query={query:computed(newValue.group)};taskCtrl.requestedEntities.query_parameters=query.query}$scope.getEntitesCount()}}),500)}),!0),taskCtrl.checkMigrateStatus=function(){if(!taskCtrl.requestedEntities.entities_list||!taskCtrl.selectedVersionToLoad)return taskCtrl.requestedEntitiesForm=$scope.requestedEntitiesForm,void($scope.requestedEntitiesForm.submitted=!0);var selectedVersionToLoad=_.find(taskCtrl.versionsForLoad,{fabric_execution_id:taskCtrl.selectedVersionToLoad}),taskExecutionId="",luNames="";selectedVersionToLoad&&(taskExecutionId=selectedVersionToLoad.task_execution_id,luNames=selectedVersionToLoad.lu_name);var version_datetime=new Date(selectedVersionToLoad.version_datetime),localTimeZone=version_datetime.getTimezoneOffset();version_datetime=version_datetime.getTime()+6e4*localTimeZone,TDMService.postGenericAPI("checkMigrateStatusForEntitiesList",{entitlesList:taskCtrl.requestedEntities.entities_list,taskExecutionId:taskExecutionId,luList:luNames}).then((function(response){if("SUCCESS"==response.errorCode){var failedEntities=[];for(var key in response.result)"false"==response.result[key]&&failedEntities.push(key);failedEntities.length>0?toastr.error("Entities "+failedEntities+" were not migrated successfully into the TDM storage by the selected version. Please remove them from the Entities List or select another version "):taskCtrl.requestedEntitiesNext($scope.requestedEntitiesForm,!0)}else toastr.error("Failed to check Migrate Status For Entites List")}))},taskCtrl.getStepsArray=function(){var stepsArray=[];return stepsArray.push(1),null!=taskCtrl.taskData.reference&&stepsArray.push(6),"EXTRACT"==taskCtrl.taskData.task_type&&taskCtrl.taskData.selectAllEntites||"refernceOnly"===taskCtrl.taskData.reference||stepsArray.push(2),taskCtrl.taskData.task_globals&&stepsArray.push(5),("LOAD"==taskCtrl.taskData.task_type&&!taskCtrl.taskData.version_ind||"EXTRACT"==taskCtrl.taskData.task_type&&!taskCtrl.taskData.version_ind&&(taskCtrl.sourceUserRole&&taskCtrl.sourceUserRole.allowed_request_of_fresh_data||taskCtrl.userRole&&taskCtrl.userRole.allowed_request_of_fresh_data))&&"refernceOnly"!==taskCtrl.taskData.reference&&stepsArray.push(3),stepsArray.push(4),stepsArray},taskCtrl.openStep=function(step,type){if("admin"==taskCtrl.userRoleType||taskCtrl.sourceEnvOwner&&taskCtrl.targetEnvOwner||(taskCtrl.taskData.selectAllEntites=!1),2==taskCtrl.step&&"LOAD"==taskCtrl.taskData.task_type&&taskCtrl.taskData.version_ind&&!taskCtrl.taskData.selectAllEntites)return"back"==type&&null!=taskCtrl.taskData.reference?taskCtrl.step=6:1==step?taskCtrl.step=1:void taskCtrl.checkMigrateStatus();var arraySteps=taskCtrl.getStepsArray(),nextStep=step,currentIndex=arraySteps.indexOf(taskCtrl.step),nextIndex=arraySteps.indexOf(step);if(nextIndex<currentIndex&&nextIndex>=0)return nextStep=arraySteps[nextIndex],void(taskCtrl.step=nextStep);if("next"==type){if(currentIndex==arraySteps.length-1)return void console.log("there is no next");nextStep=arraySteps[currentIndex+1]}else if("back"==type)return 0==currentIndex?void console.log("there is no back"):(nextStep=arraySteps[currentIndex-1],void(taskCtrl.step=nextStep));return 1==taskCtrl.step?$scope.generalForm.$valid?void taskCtrl.generalNext($scope.generalForm,nextStep):(taskCtrl.generalForm=$scope.generalForm,void($scope.generalForm.submitted=!0)):2==taskCtrl.step?$scope.requestedEntitiesForm.$valid?(taskCtrl.requestedEntitiesNext($scope.requestedEntitiesForm,!1,nextStep),void($scope.requestedEntitiesForm.submitted=!0)):(taskCtrl.requestedEntitiesForm=$scope.requestedEntitiesForm,void($scope.requestedEntitiesForm.submitted=!0)):3!=taskCtrl.step||$scope.requestParametersForm.$valid?4!=taskCtrl.step||$scope.executionTimingForm.$valid?6!=taskCtrl.step||$scope.ReferenceForm.$valid?void(5!=taskCtrl.step?(taskCtrl.step=nextStep,1==taskCtrl.step?$scope.generalForm.submitted=!0:2==taskCtrl.step?($scope.getEntitesCount(),taskCtrl.updateParams(()=>{console.log("parameters loaded")}),$scope.requestedEntitiesForm.submitted=!0):3==taskCtrl.step?$scope.requestParametersForm.submitted=!0:4==taskCtrl.step&&($scope.executionTimingForm.submitted=!0)):taskCtrl.globalsNext(nextStep)):($scope.ReferenceForm.submitted=!0,void taskCtrl.referenceNext(nextStep)):(taskCtrl.executionTimingForm=$scope.executionTimingForm,void($scope.executionTimingForm.submitted=!0)):(taskCtrl.requestParametersForm=$scope.requestParametersForm,void($scope.requestParametersForm.submitted=!0))},taskCtrl.generalNext=function(form,nextStep){if(taskCtrl.isFluxMode){$scope.generalForm.taskLogicalUnit.$setValidity("gap",!0),$scope.generalForm.taskLogicalUnit.$setValidity("missingParent",!0);let isSelectedLU=lu_name=>_.find(taskCtrl.logicalUnits,{lu_name:lu_name}),checkGap=lu=>{if(lu.lu_parent_name&&!isSelectedLU(lu.lu_parent_name)){const luParent=_.find(taskCtrl.allLogicalUnits,{lu_name:lu.lu_parent_name});luParent&&luParent.lu_parent_name&&isSelectedLU(luParent.lu_parent_name)&&($scope.generalForm.taskLogicalUnit.$setValidity("gap",!1),taskCtrl.missingUnitInGap=luParent.lu_name)}},checkIfRootIsMissing=()=>{for(lu of($scope.generalForm.taskLogicalUnit.$setValidity("missingParent",!0),taskCtrl.missingRootLU=[],taskCtrl.logicalUnits))if(lu.lu_parent_name){const luParent=_.find(taskCtrl.allLogicalUnits,{lu_name:lu.lu_parent_name});luParent&&(luParent.lu_parent_name||isSelectedLU(luParent.lu_name)||($scope.generalForm.taskLogicalUnit.$setValidity("missingParent",!1),taskCtrl.missingRootLU.push(luParent.lu_name)))}};taskCtrl.logicalUnits&&taskCtrl.logicalUnits.length>0&&taskCtrl.logicalUnits.forEach(lu=>{"refernceOnly"!==taskCtrl.taskData.reference&&(checkGap(lu),checkIfRootIsMissing(lu))})}if(form.$valid||1==taskCtrl.disableChange){let cb=()=>{taskCtrl.step=nextStep||2,"admin"==taskCtrl.userRoleType||taskCtrl.sourceEnvOwner&&taskCtrl.targetEnvOwner||(taskCtrl.taskData.selectAllEntites=!1);var sourceEnv=_.find(taskCtrl.allSourceEnvironments,{environment_id:taskCtrl.taskData.source_environment_id});sourceEnv&&(taskCtrl.taskData.source_env_name=sourceEnv.environment_name),taskCtrl.taskData.selectAllEntites&&(taskCtrl.requestedEntities.entities_list=void 0,"EXTRACT"==taskCtrl.taskData.task_type&&(taskCtrl.taskData.task_globals?taskCtrl.step=nextStep||5:!taskCtrl.taskData.version_ind&&(taskCtrl.taskData.version_ind||taskCtrl.userRole&&taskCtrl.userRole.allowed_request_of_fresh_data||taskCtrl.sourceUserRole&&taskCtrl.sourceUserRole.allowed_request_of_fresh_data)?taskCtrl.step=nextStep||3:taskCtrl.step=nextStep||4)),null!=taskCtrl.taskData.reference&&(taskCtrl.step=nextStep||6)};"LOAD"===taskCtrl.taskData.task_type?taskCtrl.updateParams(cb):cb.apply()}else form.submitted=!0;taskCtrl.generalForm=form},taskCtrl.submitForm=function(step,nextStep){const steps=taskCtrl.getStepsArray();if(step!==nextStep)if(steps.indexOf(step)>steps.indexOf(nextStep))taskCtrl.openStep(nextStep,"back");else switch(step){case 1:$scope.generalForm.$setSubmitted(),taskCtrl.generalNext($scope.generalForm,nextStep);break;case 2:$scope.requestedEntitiesForm.$setSubmitted(),taskCtrl.requestedEntitiesNext($scope.requestedEntitiesForm,void 0,nextStep);break;case 3:$scope.requestParametersForm.$setSubmitted(),taskCtrl.requestParametersNext($scope.requestParametersForm);break;case 4:$scope.executionTimingForm.$setSubmitted(),taskCtrl.executionTimingFinish($scope.executionTimingForm);break;case 5:$scope.AddGlobalForm.$setSubmitted(),taskCtrl.globalsNext(nextStep);break;case 6:$scope.ReferenceForm.$setSubmitted(),taskCtrl.referenceNext(nextStep)}},taskCtrl.referenceNext=function(nextStep){if(0!=_.filter(taskCtrl.taskData.refList,{selected:!0}).length)if(taskCtrl.referenceTabError="",taskCtrl.taskData.task_globals)taskCtrl.step=nextStep||5;else{if("refernceOnly"!==taskCtrl.taskData.reference)return"EXTRACT"==taskCtrl.taskData.task_type&&taskCtrl.taskData.selectAllEntites?taskCtrl.step=nextStep||3:taskCtrl.step=nextStep||2;taskCtrl.step=nextStep||4}else taskCtrl.referenceTabError="Please Select Reference Table"},taskCtrl.requestedEntitiesNext=function(form,migrated,nextStep){if("LOAD"!==taskCtrl.taskData.task_type||!taskCtrl.taskData.version_ind||taskCtrl.taskData.selectAllEntites||migrated){if(taskCtrl.isFluxMode&&"LOAD"===taskCtrl.taskData.task_type&&!taskCtrl.taskData.version_ind&&("synthetic"===taskCtrl.selectFieldType||"parameters"===taskCtrl.selectFieldType)){for(lu of($scope.LUsMissingParent=[],taskCtrl.logicalUnits))lu.lu_parent_name&&!_.find(taskCtrl.logicalUnits,{lu_name:lu.lu_parent_name})&&$scope.LUsMissingParent.push(lu.lu_name);if($scope.requestedEntitiesForm.$setValidity("missingParent",!0),$scope.LUsMissingParent.length>0)return void $scope.requestedEntitiesForm.$setValidity("missingParent",!1)}if("given"===taskCtrl.selectFieldType&&taskCtrl.requestedEntities&&"string"==typeof taskCtrl.requestedEntities.entities_list&&taskCtrl.taskData.entity_exclusion_list==taskCtrl.requestedEntities.entities_list)return taskCtrl.errorList=!0,void(form.$valid||(form.submitted=!0,taskCtrl.requestedEntitiesForm=form));if(taskCtrl.enititesListNotPassedExclusionList=!1,taskCtrl.enititesListFailedPatternTest=!1,"LOAD"===taskCtrl.taskData.task_type&&!taskCtrl.taskData.version_ind&&taskCtrl.requestedEntities.entities_list&&"string"==typeof taskCtrl.taskData.entity_exclusion_list&&taskCtrl.requestedEntities.entities_list.length>0&&(taskCtrl.taskData.entity_exclusion_list=taskCtrl.taskData.entity_exclusion_list.replace(/\s/g,""),taskCtrl.taskData.entity_exclusion_list=taskCtrl.taskData.entity_exclusion_list.replace(/\r?\n|\r/g,""),taskCtrl.entitiesPattern.test(taskCtrl.taskData.entity_exclusion_list)||(taskCtrl.enititesExclusionListPatternTest=!0)),"given"==taskCtrl.selectFieldType&&"string"==typeof taskCtrl.requestedEntities.entities_list&&taskCtrl.requestedEntities.entities_list.length>0){taskCtrl.requestedEntities.entities_list=taskCtrl.requestedEntities.entities_list.replace(/\s/g,""),taskCtrl.requestedEntities.entities_list=taskCtrl.requestedEntities.entities_list.replace(/\r?\n|\r/g,"");var entitiesPattern=taskCtrl.entitiesPattern;if(("LOAD"!=taskCtrl.taskData.task_type||taskCtrl.taskData.version_ind)&&(entitiesPattern=new RegExp("^((\\w|-)+(?:,(\\w|-)+){0,"+((taskCtrl.maxToCopy||1e9)-1)+"})?$")),entitiesPattern.test(taskCtrl.requestedEntities.entities_list))if("LOAD"!=taskCtrl.taskData.task_type||taskCtrl.taskData.version_ind)taskCtrl.errorList=!1,form.$valid||1==taskCtrl.disableChange?taskCtrl.taskData.task_globals?taskCtrl.step=nextStep||5:("EXTRACT"!=taskCtrl.taskData.task_type&&"LOAD"!=taskCtrl.taskData.task_type||!taskCtrl.taskData.version_ind)&&("EXTRACT"!=taskCtrl.taskData.task_type||taskCtrl.taskData.version_ind||taskCtrl.userRole&&taskCtrl.userRole.allowed_request_of_fresh_data||taskCtrl.sourceUserRole&&taskCtrl.sourceUserRole.allowed_request_of_fresh_data)?taskCtrl.step=nextStep||3:taskCtrl.step=nextStep||4:form.submitted=!0,taskCtrl.requestedEntitiesForm=form;else(dataForValidation={}).exclusion_list=taskCtrl.requestedEntities.entities_list,dataForValidation.be_id=taskCtrl.taskData.be_id,TDMService.postEnvExclusionListValidateList(taskCtrl.taskData.environment_id,dataForValidation).then((function(response){if("SUCCESS"==response.errorCode){if(response.result.length>0){taskCtrl.enititesListNotPassedExclusionList=!0,taskCtrl.existingEntitiesInExclusionListMembers=[];for(var i=0;i<response.result.length;i++)taskCtrl.existingEntitiesInExclusionListMembers.push(response.result[i].unnest);return}taskCtrl.errorList=!1,form.$valid||1==taskCtrl.disableChange?taskCtrl.taskData.task_globals?taskCtrl.step=nextStep||5:taskCtrl.step=nextStep||3:form.submitted=!0,taskCtrl.requestedEntitiesForm=form}else toastr.error("Unable to execute validation against Exclusion List"+response.message)}));else taskCtrl.enititesListFailedPatternTest=!0}else if("synthetic"==taskCtrl.selectFieldType&&taskCtrl.requestedEntities.synthetic){var dataForValidation;(dataForValidation={}).exclusion_list=taskCtrl.requestedEntities.synthetic,dataForValidation.be_id=taskCtrl.taskData.be_id,TDMService.postEnvExclusionListValidateList(taskCtrl.taskData.environment_id,dataForValidation).then((function(response){if("SUCCESS"==response.errorCode){if(response.result.length>0){taskCtrl.enititesListNotPassedExclusionList=!0,taskCtrl.existingEntitiesInExclusionListMembers=[];for(var i=0;i<response.result.length;i++)taskCtrl.existingEntitiesInExclusionListMembers.push(response.result[i].unnest);return}taskCtrl.errorList=!1,form.$valid||1==taskCtrl.disableChange?taskCtrl.taskData.task_globals?taskCtrl.step=nextStep||5:taskCtrl.step=nextStep||3:form.submitted=!0,taskCtrl.requestedEntitiesForm=form}else toastr.error("Unable to execute validation against Exclusion List"+response.message)}))}else taskCtrl.errorList=!1,form.$valid||1==taskCtrl.disableChange?taskCtrl.taskData.task_globals?taskCtrl.step=nextStep||5:("EXTRACT"!=taskCtrl.taskData.task_type&&"LOAD"!=taskCtrl.taskData.task_type||!taskCtrl.taskData.version_ind)&&("EXTRACT"!=taskCtrl.taskData.task_type||taskCtrl.taskData.version_ind||taskCtrl.userRole&&taskCtrl.userRole.allowed_request_of_fresh_data||taskCtrl.sourceUserRole&&taskCtrl.sourceUserRole.allowed_request_of_fresh_data)?taskCtrl.step=nextStep||3:taskCtrl.step=nextStep||4:form.submitted=!0,taskCtrl.requestedEntitiesForm=form}else taskCtrl.checkMigrateStatus()},taskCtrl.globalsNext=function(nextStep){taskCtrl.taskData.version_ind||"refernceOnly"===taskCtrl.taskData.reference?taskCtrl.step=nextStep||4:taskCtrl.step=nextStep||3},taskCtrl.initReferenceForm=ReferenceForm=>{$scope.ReferenceForm=ReferenceForm},taskCtrl.requestParametersNext=function(form){form.$valid||1==taskCtrl.disableChange?taskCtrl.step=4:form.submitted=!0,taskCtrl.requestParametersForm=form},taskCtrl.executionTimingFinish=function(form){if(form.$valid||1==taskCtrl.disableChange){if(!$scope.generalForm.$valid)return void(taskCtrl.step=1);if(taskCtrl.taskData.reference&&0==_.filter(taskCtrl.taskData.refList,{selected:!0}).length)return void(taskCtrl.step=6);if("refernceOnly"!==taskCtrl.taskData.reference&&!$scope.requestedEntitiesForm.$valid)return void(taskCtrl.step=2);if(!$scope.requestParametersForm.$valid)return void(taskCtrl.step=3);taskCtrl.saveTask()}else form.submitted=!0;taskCtrl.executionTimingForm=form},taskCtrl.cronTabConfig={allowMultiple:!0},taskCtrl.toggleVersion=function(task_execution_id){taskCtrl.versionsToggle[task_execution_id]=!taskCtrl.versionsToggle[task_execution_id],taskCtrl.dtInstanceVersions&&taskCtrl.dtInstanceVersions.reloadData&&taskCtrl.dtInstanceVersions.reloadData((function(){}))},taskCtrl.versionsToggle={},taskCtrl.versionsForLoad=[],taskCtrl.dtInstanceVersions={},taskCtrl.dtColumnsVersions=[],taskCtrl.dtColumnDefsVersions=[],taskCtrl.headersVersions=[{column:"collapse",name:"",clickAble:!1},{column:"actions",name:"",clickAble:!1},{column:"version_name",name:"Version Name",clickAble:!0},{column:"task_id",name:"Task Id",clickAble:!1},{column:"task_last_updated_by",name:"Last Updated By",clickAble:!1},{column:"version_type",name:"Version Type",clickAble:!1},{column:"version_datetime",name:"Date Time",type:"date",clickAble:!1},{column:"lu_name",name:"Logical Unit Name",clickAble:!1},{column:"number_of_extracted_entities",name:"Number of Extracted Entities",clickAble:!1},{column:"rootIndicator",name:"Root LU",clickAble:!1}];for(var changeToLocalDate=function(data,type,full,meta){return moment(data).format("DD MMM YYYY, HH:mm")},renderSelectionColumn=function(data,type,full,meta){return full.isRoot?'<input type="radio" ng-value="\''+full.fabric_execution_id+'\'" name="versionsTableSelection" ng-model="taskCtrl.selectedVersionToLoad">':""},renderCollapseColumn=function(data,type,full,meta){return full.isRoot?'<a class="toggleVersions '+(taskCtrl.versionsToggle[full.task_execution_id]?"active":"")+'" ng-click="taskCtrl.toggleVersion('+full.task_execution_id+')"><i class="fa arrow"></i> </a>':""},i=0;i<taskCtrl.headersVersions.length;i++)"actions"==taskCtrl.headersVersions[i].column?taskCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(taskCtrl.headersVersions[i].column).withTitle(taskCtrl.headersVersions[i].name).renderWith(renderSelectionColumn).notSortable()):"collapse"==taskCtrl.headersVersions[i].column?taskCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(taskCtrl.headersVersions[i].column).withTitle(taskCtrl.headersVersions[i].name).renderWith(renderCollapseColumn).notSortable()):"date"==taskCtrl.headersVersions[i].type?taskCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(taskCtrl.headersVersions[i].column).withTitle(taskCtrl.headersVersions[i].name).renderWith(changeToLocalDate).notSortable()):"task_id"==taskCtrl.headersVersions[i].column||"version_name"==taskCtrl.headersVersions[i].column?taskCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(taskCtrl.headersVersions[i].column).withTitle(taskCtrl.headersVersions[i].name).notSortable()):"rootIndicator"==taskCtrl.headersVersions[i].column?taskCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(taskCtrl.headersVersions[i].column).withTitle(taskCtrl.headersVersions[i].name).notSortable().notVisible()):taskCtrl.dtColumnsVersions.push(DTColumnBuilder.newColumn(taskCtrl.headersVersions[i].column).withTitle(taskCtrl.headersVersions[i].name).notSortable());taskCtrl.dtOptionsVersions=DTOptionsBuilder.fromFnPromise((function(){return function(){var deferred=$q.defer(),versionsForLoad=[];taskCtrl.groupedSelections=new Set;var rootLUs=_.filter(taskCtrl.logicalUnits,{lu_parent_name:null});if(taskCtrl.versionsForLoad.forEach((function(versionForLoad){if(_.find(rootLUs,{lu_name:versionForLoad.lu_name})?versionForLoad.rootIndicator=!0:versionForLoad.rootIndicator=!1,versionForLoad.rootIndicator&&_.findIndex(versionsForLoad,{task_execution_id:versionForLoad.task_execution_id,isRoot:!0})<0)return versionForLoad.isRoot=!0,versionForLoad.rootIndicator=!0,void versionsForLoad.push(versionForLoad);taskCtrl.versionsToggle[versionForLoad.task_execution_id]&&(versionForLoad.isRoot=!1,versionsForLoad.push(versionForLoad))})),!taskCtrl.selectedVersionToLoad&&taskCtrl.taskData.selected_version_task_exe_id){var selectedVersion=_.find(taskCtrl.versionsForLoad,{rootIndicator:!0,task_execution_id:taskCtrl.taskData.selected_version_task_exe_id});selectedVersion&&(taskCtrl.selectedVersionToLoad=selectedVersion.fabric_execution_id)}return console.log(versionsForLoad),deferred.resolve(versionsForLoad),deferred.promise}()})).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("scrollX",!1).withOption("lengthChange",!1).withOption("paging",!1).withButtons([]).withOption("caseInsensitive",!0).withOption("order",[[6,"desc"],[9,"desc"]]).withOption("search",{caseInsensitive:!1}),taskCtrl.dtOptionsVersions.withLightColumnFilter({2:{type:"text"},3:{type:"text"},4:{type:"text"},5:{type:"text"},6:{type:"text"},7:{type:"text"},8:{type:"text"}}),taskCtrl.getVersionsForLoad=function(){var entitiesPassed=!0;taskCtrl.requestedEntities.entities_list&&taskCtrl.maxToCopy&&(entitiesPassed=new RegExp("^((\\w|-)+(?:,(\\w|-)+){0,"+((taskCtrl.maxToCopy||1e9)-1)+"})?$").test(taskCtrl.requestedEntities.entities_list),taskCtrl.enititesListFailedPatternTest=!1);if(taskCtrl.versionForLoadFrom&&taskCtrl.versionForLoadTo&&taskCtrl.logicalUnits&&taskCtrl.taskData.source_env_name&&(taskCtrl.taskData.selectAllEntites||taskCtrl.requestedEntities.entities_list&&entitiesPassed)){taskCtrl.loadingTableVersions=!0;var from=new Date(taskCtrl.versionForLoadFrom);from.setHours(0),from.setMinutes(0),from.setSeconds(0);var to=new Date(taskCtrl.versionForLoadTo);to.setHours(23),to.setMinutes(59),to.setSeconds(59),TDMService.postGenericAPI("tasks/versionsForLoad",{fromDate:from,toDate:to,entitiesList:taskCtrl.taskData.selectAllEntites?"":taskCtrl.requestedEntities.entities_list,lu_list:taskCtrl.logicalUnits,source_env_name:taskCtrl.taskData.source_env_name,be_id:taskCtrl.taskData.be_id}).then((function(response){if("SUCCESS"==response.errorCode){let overrideRootIndicators=data=>{var executionIdsSet=new Set;for(item of data)executionIdsSet.has(item.task_execution_id)||"Y"!=item.root_indicator||(item.root_indicator="YY",executionIdsSet.add(item.task_execution_id))};(data=>{})(response.result),overrideRootIndicators(response.result),taskCtrl.versionsForLoad=response.result,taskCtrl.versionsForLoad=_.sortBy(taskCtrl.versionsForLoad,version=>-1*new Date(version.version_datetime)),$timeout((function(){taskCtrl.dtInstanceVersions&&taskCtrl.dtInstanceVersions.reloadData&&taskCtrl.dtInstanceVersions.reloadData((function(){}))}),100),taskCtrl.loadingTableVersions=!1}else toastr.error("New Task # Failed to get Versions for Load")}))}else taskCtrl.requestedEntities.entities_list||taskCtrl.taskData.selectAllEntites?entitiesPassed||(taskCtrl.enititesListFailedPatternTest=!0):(taskCtrl.versionsForLoad=[],taskCtrl.dtInstanceVersions&&taskCtrl.dtInstanceVersions.reloadData&&taskCtrl.dtInstanceVersions.reloadData((function(){})))},("EXTRACT"==taskCtrl.taskData.task_type||"LOAD"==taskCtrl.taskData.task_type&&taskCtrl.taskData.version_ind)&&taskCtrl.taskModeChange(!0),taskCtrl.sourceEnvironmentChange(!0,!0),taskCtrl.requestParametersPrev=function(){taskCtrl.taskData.task_globals?taskCtrl.step=5:taskCtrl.step=2},BreadCrumbsService.push({task_id:taskCtrl.taskData.task_title},"TASK_BREADCRUMB",(function(){}))},controllerAs:"taskCtrl"}}angular.module("TDM-FE").directive("taskDirective",taskDirective);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvdGFza3MvdGFza0RpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJ0YXNrRGlyZWN0aXZlIiwicmVzdHJpY3QiLCJ0ZW1wbGF0ZVVybCIsInNjb3BlIiwiY29udGVudCIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJURE1TZXJ2aWNlIiwiQnJlYWRDcnVtYnNTZXJ2aWNlIiwiU3dlZXRBbGVydCIsIiR1aWJNb2RhbCIsInRvYXN0ciIsIiR0aW1lb3V0IiwiQXV0aFNlcnZpY2UiLCIkc3RhdGUiLCJEVE9wdGlvbnNCdWlsZGVyIiwiRFRDb2x1bW5CdWlsZGVyIiwiJHEiLCIkY29tcGlsZSIsInRhc2tDdHJsIiwidGhpcyIsIm1pbkRhdGUiLCJEYXRlIiwibW9tZW50IiwibWlsbGlzZWNvbmRzIiwic2Vjb25kcyIsIm1pbnV0ZXMiLCJob3VycyIsImFkZCIsInNjaGVkdWxlck9wdGlvbnMiLCJmb3JtSW5wdXRDbGFzcyIsImZvcm1TZWxlY3RDbGFzcyIsImZvcm1SYWRpb0NsYXNzIiwiZm9ybUNoZWNrYm94Q2xhc3MiLCJoaWRlTWludXRlc1RhYiIsImhpZGVIb3VybHlUYWIiLCJoaWRlRGFpbHlUYWIiLCJoaWRlV2Vla2x5VGFiIiwiaGlkZU1vbnRobHlUYWIiLCJoaWRlWWVhcmx5VGFiIiwiaGlkZUFkdmFuY2VkVGFiIiwidXNlMjRIb3VyVGltZSIsImhpZGVTZWNvbmRzIiwidGFza0RhdGEiLCJhbmd1bGFyIiwiY29weSIsInRhc2siLCJjb3B5VGFzayIsInRhc2tfdGl0bGUiLCJpc0ZsdXhNb2RlIiwicmV0ZW50aW9uUGVyaW9kIiwiZ2V0UmV0ZW50aW9uUGVyaW9kIiwicmVmZXJlbmNlIiwic3luY19tb2RlIiwicmVxdWVzdF9vZl9mcmVzaF9kYXRhIiwidGFza190eXBlIiwidmVyc2lvbl9pbmQiLCJyZXRlbnRpb25fcGVyaW9kX3ZhbHVlIiwic2VsZWN0aW9uX21ldGhvZCIsInJlZmNvdW50IiwiZ2V0R2VuZXJpY0FQSSIsInRhc2tfaWQiLCJ0aGVuIiwicmVzcG9uc2UiLCJyZWZMaXN0IiwiXyIsIm1hcCIsInJlc3VsdCIsInJlZiIsInNlbGVjdGVkIiwicmVmZXJlbmNlRHJvcERvd24iLCJ0ZXh0IiwidmFsdWUiLCJ0aW1lWm9uZU9mZnNldCIsImdldFRpbWVab25lIiwicmVtb3ZlIiwiYXZhaWxhYmxlT3B0aW9ucyIsInBlcmlvZCIsInVuaXRzIiwibWF4UmV0ZW50aW9uUGVyaW9kIiwiZ2xvYmFscyIsInJlZmVyZW5jZUNoYW5nZSIsInNlbGVjdEFsbEVudGl0ZXMiLCJzY2hlZHVsaW5nX2VuZF9kYXRlIiwic2NoZWR1bGVFbmRCeSIsInZlcnNpb25Gb3JMb2FkVG8iLCJ2ZXJzaW9uRm9yTG9hZEZyb20iLCJzZXREYXRlIiwiZ2V0RGF0ZSIsInJldGVudGlvbl9wZXJpb2RfdHlwZSIsImZpbmQiLCJuYW1lIiwicGFyc2VGbG9hdCIsImRlZmF1bHRQZXJpb2QiLCJ1bml0IiwiZGVmYXVsdFJldGludGlvbiIsInJldGVudGlvblBlcmlvZFR5cGVDaGFuZ2VkIiwiZGVsZXRlX2JlZm9yZV9sb2FkIiwibG9hZF9lbnRpdHkiLCJvcGVyYXRpb25Nb2RlIiwidGFza1RpdGxlUGF0dGVybiIsInN0ZXAiLCJ1c2VyUm9sZSIsImdldFJvbGUiLCJ1c2VybmFtZSIsImdldFVzZXJuYW1lIiwiZ2V0RmFicmljUm9sZXNmb3JVc2VyIiwiZ2V0VXNlcklkIiwidXNlckZhYnJpY1JvbGVzIiwidXNlclJvbGVUeXBlIiwidHlwZSIsImVudGl0aWVzUGF0dGVybiIsIlJlZ0V4cCIsIm51bWJlcl9vZl9lbnRpdGllc190b19jb3B5IiwiZXhjdWx0aW9uUGF0dGVybiIsInN5bnRoZXRpY1BhdHRlcm4iLCJ1cGRhdGVFbnRpdGllc1BhdHRlcm4iLCJlcnJvckNvZGUiLCJ0aW1lWm9uZU1lc3NhZ2UiLCJjdXJyZW50X3NldHRpbmciLCJkaXNhYmxlQ2hhbmdlIiwidGFza19zdGF0dXMiLCJ0YXNrX2NyZWF0ZWRfYnkiLCJvd25lcnMiLCJpbmRleE9mIiwiZ2V0RW52aXJvbm1lbnRzIiwiYWxsRW52aXJvbm1lbnRzIiwiZmlsdGVyIiwiZW52IiwiYWxsb3dfd3JpdGUiLCJlbnZpcm9ubWVudF9zdGF0dXMiLCJhbGxTb3VyY2VFbnZpcm9ubWVudHMiLCJhbGxvd19yZWFkIiwidW5pcXVlIiwiZXJyb3IiLCJnZXRFbnZpcm9ubWVudHNGb3JVc2VyIiwiZW50aXRpZXNMaXN0Q2hhbmdlIiwiZW50aXRpZXNMaXN0Q2hhbmdlVGltZW91dCIsImNhbmNlbCIsImdldFZlcnNpb25zRm9yTG9hZCIsInRhc2tNb2RlQ2hhbmdlIiwiaW5pdCIsInVuZGVmaW5lZCIsInNvdXJjZV9lbnZpcm9ubWVudF9pZCIsImVudmlyb25tZW50X2lkIiwic291cmNlX2Vudl9uYW1lIiwibWF4VG9Db3B5IiwibG9naWNhbFVuaXRzIiwibG9naWNhbFVuaXQiLCJiZV9pZCIsInNlbGVjdEZpZWxkVHlwZSIsImdldEFsbExvZ2ljYWxVbml0c0ZvckVudiIsImFsbFNpbmdsZUxvZ2ljYWxVbml0cyIsImx1X2lkIiwic291cmNlRW52aXJvbm1lbnRDaGFuZ2UiLCJnZXRSb2xlcyIsInNvdXJjZUVudiIsImVudmlyb25tZW50X25hbWUiLCJlbnZpcm9ubWVudENoYW5nZSIsImNoZWNrUmVmZXJlbmNlSWZBbGxvd2VkIiwiYWxsb3dlZF9yZWZyZXNoX3JlZmVyZW5jZV9kYXRhIiwic291cmNlVXNlclJvbGUiLCJzb3VyY2UiLCJhbGxvd2VkX3JhbmRvbV9lbnRpdHlfc2VsZWN0aW9uIiwiYWxsb3dlZF9jcmVhdGlvbl9vZl9zeW50aGV0aWNfZGF0YSIsImFsbG93ZWRfcmVxdWVzdF9vZl9mcmVzaF9kYXRhIiwiYWxsb3dlZF9kZWxldGVfYmVmb3JlX2xvYWQiLCJhbGxvd2VkX3Rhc2tfc2NoZWR1bGluZyIsImFsbG93ZWRfcmVwbGFjZV9zZXF1ZW5jZXMiLCJwYXJzZUludCIsImdldEVudmlyb25tZW50T3duZXJzIiwib3duZXJGb3VuZCIsInVzZXJfaWQiLCJpIiwibGVuZ3RoIiwidXNlcl90eXBlIiwic291cmNlRW52T3duZXIiLCJ0YXJnZXRFbnZPd25lciIsImdldFJvbGVGb3JVc2VySW5FbnYiLCJhbGxvd2VkX2VudGl0eV92ZXJzaW9uaW5nIiwibWluUmVhZCIsIm1pbldyaXRlIiwic291cmNlTWF4VG9Db3B5IiwidGFyZ2V0TWF4VG9Db3B5IiwibWVzc2FnZSIsImdldEJ1c2luZXNzRW50aXRpZXNGb3JFbnZQcm9kdWN0cyIsImJ1c2luZXNzRW50aXRpZXMiLCJhbGxMb2dpY2FsVW5pdHMiLCJwcm9kdWN0cyIsInVwZGF0ZVBhcmFtcyIsImNiIiwicGFyYW1ldGVycyIsInBhcmFtZXRlcnNLZXlzIiwiT2JqZWN0Iiwia2V5cyIsImNob3NlbkxVcyIsImx1IiwibHVfbmFtZSIsInRvTG93ZXJDYXNlIiwic3BsaXQiLCJrZXkiLCJwYXJhbV9uYW1lIiwiUEFSQU1fTkFNRSIsInBhcmFtX3R5cGUiLCJQQVJBTV9UWVBFIiwidmFsaWRfdmFsdWVzIiwibWluX3ZhbHVlIiwibWF4X3ZhbHVlIiwiYXBwbHkiLCJidXNpbmVzc0VudGl0eUNoYW5nZSIsImdyb3VwIiwicnVsZXMiLCJzZWxlY3Rpb25fcGFyYW1fdmFsdWUiLCJiZSIsImJlX25hbWUiLCJnZXRMb2dpY2FsVW5pdHNGb3JCdXNpbmVzc0VudGl0eUFuZEVudiIsInRlbXBMdXMiLCJwdXNoIiwiZ2V0QkVQb3N0RXhlY3V0aW9uUHJvY2VzcyIsImFsbFBvc3RFeGVjdXRpb25Qcm9jZXNzIiwiYWxsUG9zdEV4ZWN1dGlvblByb2Nlc3NJZHMiLCJwb3N0RXhlY3V0aW9uUHJvY2Vzc2VzIiwiZ2V0VGFza0xvZ2ljYWxVbml0cyIsImdldFRhc2tQb3N0RXhlY3V0aW9uUHJvY2Vzc2VzIiwidiIsInByb2Nlc3NfaWQiLCJyZXF1ZXN0ZWRFbnRpdGllcyIsImVudGl0aWVzX2xpc3QiLCJzeW50aGV0aWMiLCJKU09OIiwicGFyc2UiLCJxdWVyeV9wYXJhbWV0ZXJzIiwicGFyYW1ldGVyc1JhbmRvbSIsImJ1aWxkU3ViUXVlcnkiLCJydWxlIiwiZmllbGQiLCJjb25kaXRpb24iLCJkYXRhIiwiY29tcHV0ZWQiLCJzdHIiLCJvcGVyYXRvciIsInRvTG9jYWxlU3RyaW5nIiwidG9GaXhlZCIsIk1hdGgiLCJmbG9vciIsInZhbGlkVmFsdWVzIiwic2NoZWR1bGVyIiwic2VsZWN0U2NoZWR1bGUiLCJzY2hlZHVsZURhdGEiLCJzYXZlVGFzayIsImVudGl0eV9leGNsdXNpb25fbGlzdCIsImVycm9yTGlzdCIsImNyZWF0ZVRhc2tJblByb2dyZXNzIiwicGFyYW1ldGVyc0Vycm9yIiwicmVwbGFjZV9zZXF1ZW5jZXMiLCJzZWxlY3RlZFZlcnNpb25Ub0xvYWQiLCJ2ZXJzaW9uc0ZvckxvYWQiLCJmYWJyaWNfZXhlY3V0aW9uX2lkIiwic2VsZWN0ZWRfdmVyc2lvbl90YXNrX25hbWUiLCJ2ZXJzaW9uX25hbWUiLCJsb2NhbFRpbWVab25lIiwidmVyc2lvbl9kYXRldGltZSIsImdldFRpbWV6b25lT2Zmc2V0IiwiZ2V0VGltZSIsInNlbGVjdGVkX3ZlcnNpb25fZGF0ZXRpbWUiLCJmb3JtYXQiLCJzZWxlY3RlZF92ZXJzaW9uX3Rhc2tfZXhlX2lkIiwidGFza19leGVjdXRpb25faWQiLCJyZWZMb2FkVmVyc2lvbnMiLCJzZWxlY3RlZFJlZlZlcnNpb25Ub0xvYWQiLCJzZWxlY3RlZF9yZWZfdmVyc2lvbl90YXNrX25hbWUiLCJzZWxlY3RlZF9yZWZfdmVyc2lvbl9kYXRldGltZSIsInNlbGVjdGVkX3JlZl92ZXJzaW9uX3Rhc2tfZXhlX2lkIiwidGFza19nbG9iYWxzIiwicmVmcmVzaF9yZWZlcmVuY2VfZGF0YSIsInVwZGF0ZVRhc2siLCJwb3N0VGFza0xvZ2ljYWxVbml0cyIsImlkIiwic3VjY2VzcyIsImdvIiwicmVsb2FkIiwicG9zdFRhc2tQb3N0RXhlY3V0aW9uUHJvY2VzcyIsInBvc3RleGVjdXRpb25wcm9jZXNzZXMiLCJjcmVhdGVUYXNrUmVzdWx0IiwiZGVsZXRlVGFzayIsIm9wZW5UYXNrcyIsInBhcmFtZXRlcnNDb3VudCIsImdldEVudGl0ZXNDb3VudCIsImZvcmNlIiwicGVydmlvdXNRdWVyeVBhcmFtcyIsInBvc3RHZW5lcmljQVBJIiwid2hlcmUiLCIkd2F0Y2giLCJuZXdWYWx1ZSIsImFuYWx5c2lzQ291bnRUaW1lb3V0IiwiY2hlY2tHcm91cCIsInN0cmluZ2lmeSIsInF1ZXJ5IiwiY2hlY2tNaWdyYXRlU3RhdHVzIiwicmVxdWVzdGVkRW50aXRpZXNGb3JtIiwic3VibWl0dGVkIiwidGFza0V4ZWN1dGlvbklkIiwibHVOYW1lcyIsImVudGl0bGVzTGlzdCIsImx1TGlzdCIsImZhaWxlZEVudGl0aWVzIiwicmVxdWVzdGVkRW50aXRpZXNOZXh0IiwiZ2V0U3RlcHNBcnJheSIsInN0ZXBzQXJyYXkiLCJvcGVuU3RlcCIsImFycmF5U3RlcHMiLCJuZXh0U3RlcCIsImN1cnJlbnRJbmRleCIsIm5leHRJbmRleCIsImNvbnNvbGUiLCJsb2ciLCJnZW5lcmFsRm9ybSIsIiR2YWxpZCIsImdlbmVyYWxOZXh0IiwicmVxdWVzdFBhcmFtZXRlcnNGb3JtIiwiZXhlY3V0aW9uVGltaW5nRm9ybSIsIlJlZmVyZW5jZUZvcm0iLCJnbG9iYWxzTmV4dCIsInJlZmVyZW5jZU5leHQiLCJmb3JtIiwidGFza0xvZ2ljYWxVbml0IiwiJHNldFZhbGlkaXR5IiwiaXNTZWxlY3RlZExVIiwiY2hlY2tHYXAiLCJsdV9wYXJlbnRfbmFtZSIsImx1UGFyZW50IiwibWlzc2luZ1VuaXRJbkdhcCIsImNoZWNrSWZSb290SXNNaXNzaW5nIiwibWlzc2luZ1Jvb3RMVSIsImZvckVhY2giLCJzdWJtaXRGb3JtIiwic3RlcHMiLCIkc2V0U3VibWl0dGVkIiwicmVxdWVzdFBhcmFtZXRlcnNOZXh0IiwiZXhlY3V0aW9uVGltaW5nRmluaXNoIiwiQWRkR2xvYmFsRm9ybSIsInJlZmVyZW5jZVRhYkVycm9yIiwibWlncmF0ZWQiLCJMVXNNaXNzaW5nUGFyZW50IiwiZW5pdGl0ZXNMaXN0Tm90UGFzc2VkRXhjbHVzaW9uTGlzdCIsImVuaXRpdGVzTGlzdEZhaWxlZFBhdHRlcm5UZXN0IiwicmVwbGFjZSIsInRlc3QiLCJlbml0aXRlc0V4Y2x1c2lvbkxpc3RQYXR0ZXJuVGVzdCIsImRhdGFGb3JWYWxpZGF0aW9uIiwiZXhjbHVzaW9uX2xpc3QiLCJwb3N0RW52RXhjbHVzaW9uTGlzdFZhbGlkYXRlTGlzdCIsImV4aXN0aW5nRW50aXRpZXNJbkV4Y2x1c2lvbkxpc3RNZW1iZXJzIiwidW5uZXN0IiwiaW5pdFJlZmVyZW5jZUZvcm0iLCJjcm9uVGFiQ29uZmlnIiwiYWxsb3dNdWx0aXBsZSIsInRvZ2dsZVZlcnNpb24iLCJ2ZXJzaW9uc1RvZ2dsZSIsImR0SW5zdGFuY2VWZXJzaW9ucyIsInJlbG9hZERhdGEiLCJkdENvbHVtbnNWZXJzaW9ucyIsImR0Q29sdW1uRGVmc1ZlcnNpb25zIiwiaGVhZGVyc1ZlcnNpb25zIiwiY29sdW1uIiwiY2xpY2tBYmxlIiwiY2hhbmdlVG9Mb2NhbERhdGUiLCJmdWxsIiwibWV0YSIsInJlbmRlclNlbGVjdGlvbkNvbHVtbiIsImlzUm9vdCIsInJlbmRlckNvbGxhcHNlQ29sdW1uIiwibmV3Q29sdW1uIiwid2l0aFRpdGxlIiwicmVuZGVyV2l0aCIsIm5vdFNvcnRhYmxlIiwibm90VmlzaWJsZSIsImR0T3B0aW9uc1ZlcnNpb25zIiwiZnJvbUZuUHJvbWlzZSIsImRlZmVycmVkIiwiZGVmZXIiLCJncm91cGVkU2VsZWN0aW9ucyIsIlNldCIsInJvb3RMVXMiLCJ2ZXJzaW9uRm9yTG9hZCIsInJvb3RJbmRpY2F0b3IiLCJmaW5kSW5kZXgiLCJzZWxlY3RlZFZlcnNpb24iLCJyZXNvbHZlIiwicHJvbWlzZSIsImdldFRhYmxlRGF0YVZlcnNpb25zIiwid2l0aERPTSIsIndpdGhPcHRpb24iLCJyb3ciLCJlbGVtZW50IiwiY29udGVudHMiLCJ3aXRoQnV0dG9ucyIsImNhc2VJbnNlbnNpdGl2ZSIsIndpdGhMaWdodENvbHVtbkZpbHRlciIsIjIiLCIzIiwiNCIsIjUiLCI2IiwiNyIsIjgiLCJlbnRpdGllc1Bhc3NlZCIsImxvYWRpbmdUYWJsZVZlcnNpb25zIiwiZnJvbSIsInNldEhvdXJzIiwic2V0TWludXRlcyIsInNldFNlY29uZHMiLCJ0byIsImZyb21EYXRlIiwidG9EYXRlIiwiZW50aXRpZXNMaXN0IiwibHVfbGlzdCIsIm92ZXJyaWRlUm9vdEluZGljYXRvcnMiLCJleGVjdXRpb25JZHNTZXQiLCJpdGVtIiwiaGFzIiwicm9vdF9pbmRpY2F0b3IiLCJtYWtlUm9vdExVc09uVG9wRm9yRWFjaEV4ZWN1dGlvbiIsInNvcnRCeSIsInZlcnNpb24iLCJyZXF1ZXN0UGFyYW1ldGVyc1ByZXYiLCJjb250cm9sbGVyQXMiLCJtb2R1bGUiLCJkaXJlY3RpdmUiXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLGdCQSswREwsTUFBTyxDQUNIQyxTQUFVLElBQ1ZDLFlBLzBEVyx3QkFnMURYQyxNQUFPLENBQ0hDLFFBQVMsS0FFYkMsV0FqMURhLFNBQVVDLE9BQVFDLFdBQVlDLG1CQUFvQkMsV0FDeENDLFVBQVdDLE9BQVFDLFNBQVVDLFlBQWFDLE9BQVFDLGlCQUFrQkMsZ0JBQWlCQyxHQUFJQyxVQUNoSCxJQUFJQyxTQUFXQyxLQTBHZixHQXpHQUQsU0FBU0UsUUFBVSxJQUFJQyxLQUN2QkgsU0FBU0UsUUFBVUUsT0FBT0osU0FBU0UsU0FDbkNGLFNBQVNFLFFBQVFHLGFBQWEsR0FDOUJMLFNBQVNFLFFBQVFJLFFBQVEsR0FDekJOLFNBQVNFLFFBQVFLLFFBQVEsR0FDekJQLFNBQVNFLFFBQVFNLE1BQU0sR0FDdkJSLFNBQVNFLFFBQVFPLElBQUksRUFBRyxRQUN4QlQsU0FBU1UsaUJBQW1CLENBQ3hCQyxlQUFnQiwrQkFDaEJDLGdCQUFpQixnQ0FDakJDLGVBQWdCLGlCQUNoQkMsa0JBQW1CLG9CQUNuQkMsZ0JBQWdCLEVBQ2hCQyxlQUFlLEVBQ2ZDLGNBQWMsRUFDZEMsZUFBZSxFQUNmQyxnQkFBZ0IsRUFDaEJDLGVBQWUsRUFDZkMsaUJBQWlCLEVBQ2pCQyxlQUFlLEVBQ2ZDLGFBQWEsR0FJakJ2QixTQUFTd0IsU0FBV0MsUUFBUUMsS0FBS3ZDLE9BQU9G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QkFVaEIsV0FBL0JyVixTQUFTd0IsU0FBU1ksV0FBeUQsUUFBL0JwQyxTQUFTd0IsU0FBU1ksV0FBdUJwQyxTQUFTd0IsU0FBU2EsY0FDdkdyQyxTQUFTeUgsZ0JBQWUsR0FHNUJ6SCxTQUFTdUkseUJBQXdCLEdBQU0sR0FFdkN2SSxTQUFTc1osc0JBQXdCLFdBQ3pCdFosU0FBU3dCLFNBQVNzTyxhQUNsQjlQLFNBQVNrRixLQUFPLEVBRWhCbEYsU0FBU2tGLEtBQU8sR0FJeEI3RixtQkFBbUJpTixLQUFLLENBQUM1SixRQUFTMUMsU0FBU3dCLFNBQVNLLFlBQWEsbUJBQW1CLGdCQVlwRjBYLGFBQWMsWUFLdEI5WCxRQUNLK1gsT0FBTyxVQUNQQyxVQUFVLGdCQUFpQjVhIiwiZmlsZSI6ImRpcmVjdGl2ZXMvdGFza3MvdGFza0RpcmVjdGl2ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHRhc2tEaXJlY3RpdmUoKSB7XG5cbiAgICB2YXIgdGVtcGxhdGUgPSBcInZpZXdzL3Rhc2tzL3Rhc2suaHRtbFwiO1xuXG4gICAgdmFyIGNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoJHNjb3BlLCBURE1TZXJ2aWNlLCBCcmVhZENydW1ic1NlcnZpY2UsIFN3ZWV0QWxlcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVpYk1vZGFsLCB0b2FzdHIsICR0aW1lb3V0LCBBdXRoU2VydmljZSwgJHN0YXRlLCBEVE9wdGlvbnNCdWlsZGVyLCBEVENvbHVtbkJ1aWxkZXIsICRxLCAkY29tcGlsZSkge1xuICAgICAgICB2YXIgdGFza0N0cmwgPSB0aGlzO1xuICAgICAgICB0YXNrQ3RybC5taW5EYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgdGFza0N0cmwubWluRGF0ZSA9IG1vbWVudCh0YXNrQ3RybC5taW5EYXRlKTtcbiAgICAgICAgdGFza0N0cmwubWluRGF0ZS5taWxsaXNlY29uZHMoMCk7XG4gICAgICAgIHRhc2tDdHJsLm1pbkRhdGUuc2Vjb25kcygwKTtcbiAgICAgICAgdGFza0N0cmwubWluRGF0ZS5taW51dGVzKDApO1xuICAgICAgICB0YXNrQ3RybC5taW5EYXRlLmhvdXJzKDApO1xuICAgICAgICB0YXNrQ3RybC5taW5EYXRlLmFkZCgxLCAnZGF5cycpO1xuICAgICAgICB0YXNrQ3RybC5zY2hlZHVsZXJPcHRpb25zID0ge1xuICAgICAgICAgICAgZm9ybUlucHV0Q2xhc3M6ICdmb3JtLWNvbnRyb2wxIGNyb24tZ2VuLWlucHV0JywgLy8gRm9ybSBpbnB1dCBjbGFzcyBvdmVycmlkZVxuICAgICAgICAgICAgZm9ybVNlbGVjdENsYXNzOiAnZm9ybS1jb250cm9sMSBjcm9uLWdlbi1zZWxlY3QnLCAvLyBTZWxlY3QgY2xhc3Mgb3ZlcnJpZGVcbiAgICAgICAgICAgIGZvcm1SYWRpb0NsYXNzOiAnY3Jvbi1nZW4tcmFkaW8nLCAvLyBSYWRpbyBjbGFzcyBvdmVycmlkZVxuICAgICAgICAgICAgZm9ybUNoZWNrYm94Q2xhc3M6ICdjcm9uLWdlbi1jaGVja2JveCcsIC8vIFJhZGlvIGNsYXNzIG92ZXJyaWRlXG4gICAgICAgICAgICBoaWRlTWludXRlc1RhYjogZmFsc2UsIC8vIFdoZXRoZXIgdG8gaGlkZSB0aGUgbWludXRlcyB0YWJcbiAgICAgICAgICAgIGhpZGVIb3VybHlUYWI6IGZhbHNlLCAvLyBXaGV0aGVyIHRvIGhpZGUgdGhlIGhvdXJseSB0YWJcbiAgICAgICAgICAgIGhpZGVEYWlseVRhYjogZmFsc2UsIC8vIFdoZXRoZXIgdG8gaGlkZSB0aGUgZGFpbHkgdGFiXG4gICAgICAgICAgICBoaWRlV2Vla2x5VGFiOiBmYWxzZSwgLy8gV2hldGhlciB0byBoaWRlIHRoZSB3ZWVrbHkgdGFiXG4gICAgICAgICAgICBoaWRlTW9udGhseVRhYjogZmFsc2UsIC8vIFdoZXRoZXIgdG8gaGlkZSB0aGUgbW9udGhseSB0YWJcbiAgICAgICAgICAgIGhpZGVZZWFybHlUYWI6IGZhbHNlLCAvLyBXaGV0aGVyIHRvIGhpZGUgdGhlIHllYXJseSB0YWJcbiAgICAgICAgICAgIGhpZGVBZHZhbmNlZFRhYjogZmFsc2UsIC8vIFdoZXRoZXIgdG8gaGlkZSB0aGUgYWR2YW5jZWQgdGFiXG4gICAgICAgICAgICB1c2UyNEhvdXJUaW1lOiB0cnVlLCAvLyBXaGV0aGVyIHRvIHNob3cgQU0vUE0gb24gdGhlIHRpbWUgc2VsZWN0b3JzXG4gICAgICAgICAgICBoaWRlU2Vjb25kczogZmFsc2UgLy8gV2hldGhlciB0byBzaG93L2hpZGUgdGhlIHNlY29uZHMgdGltZSBwaWNrZXJcbiAgICAgICAgfTtcblxuXG4gICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhID0gYW5ndWxhci5jb3B5KCRzY29wZS5jb250ZW50LnRhc2spO1xuXG4gICAgICAgIHRhc2tDdHJsLmNvcHlUYXNrID0gJHNjb3BlLmNvbnRlbnQuY29weTtcbiAgICAgICAgaWYgKHRhc2tDdHJsLmNvcHlUYXNrKSB7XG4gICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS50YXNrX3RpdGxlID0gdGFza0N0cmwudGFza0RhdGEudGFza190aXRsZSArIFwiIENvcHlcIjtcbiAgICAgICAgfVxuICAgICAgICB0YXNrQ3RybC5pc0ZsdXhNb2RlID0gQXV0aFNlcnZpY2UuaXNGbHV4TW9kZSgpO1xuICAgICAgICB0YXNrQ3RybC5yZXRlbnRpb25QZXJpb2QgPSBBdXRoU2VydmljZS5nZXRSZXRlbnRpb25QZXJpb2QoKTtcbiAgICAgICAgdGFza0N0cmwudGFza0RhdGEucmVmZXJlbmNlID0gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS5zeW5jX21vZGUpIHtcbiAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnJlcXVlc3Rfb2ZfZnJlc2hfZGF0YSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgKCF0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCAmJiAhdGFza0N0cmwudGFza0RhdGEucmVxdWVzdF9vZl9mcmVzaF9kYXRhKXtcbiAgICAgICAgLy8gICAgIHRhc2tDdHJsLnRhc2tEYXRhLnN5bmNfbW9kZSA9ICdPRkYnO1xuICAgICAgICAvLyB9XG5cbiAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PT0gJ0VYVFJBQ1QnICYmICF0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCAmJiAhdGFza0N0cmwudGFza0RhdGEucmV0ZW50aW9uX3BlcmlvZF92YWx1ZSkge1xuICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEucmV0ZW50aW9uX3BlcmlvZF92YWx1ZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9tZXRob2QgPT0gXCJSRUZcIikge1xuICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEucmVmZXJlbmNlID0gXCJyZWZlcm5jZU9ubHlcIjtcblxuICAgICAgICB9IGVsc2UgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnJlZmNvdW50ID4gMCkge1xuICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEucmVmZXJlbmNlID0gXCJib3RoXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnJlZmVyZW5jZSkge1xuICAgICAgICAgICAgVERNU2VydmljZS5nZXRHZW5lcmljQVBJKFwidGFzay9yZWZzVGFibGUvXCIgKyB0YXNrQ3RybC50YXNrRGF0YS50YXNrX2lkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnJlZkxpc3QgPSBfLm1hcChyZXNwb25zZS5yZXN1bHQsIGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVmLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGFza0N0cmwucmVmZXJlbmNlRHJvcERvd24gPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGV4dDogXCJOb25lXCIsXG4gICAgICAgICAgICAgICAgdmFsdWU6IG51bGxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGV4dDogXCJSZWZlcmVuY2UgT25seVwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBcInJlZmVybmNlT25seVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRleHQ6IFwiQm90aCAtIHJlZmVyZW5jZSBhbmQgZW50aXRpZXNcIixcbiAgICAgICAgICAgICAgICB2YWx1ZTogXCJib3RoXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcblxuICAgICAgICB0YXNrQ3RybC50aW1lWm9uZU9mZnNldCA9IEF1dGhTZXJ2aWNlLmdldFRpbWVab25lKCk7XG5cbiAgICAgICAgXy5yZW1vdmUodGFza0N0cmwucmV0ZW50aW9uUGVyaW9kLmF2YWlsYWJsZU9wdGlvbnMsIGZ1bmN0aW9uIChwZXJpb2QpIHtcbiAgICAgICAgICAgIGlmIChwZXJpb2QudW5pdHMgPiB0YXNrQ3RybC5yZXRlbnRpb25QZXJpb2QubWF4UmV0ZW50aW9uUGVyaW9kKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHRhc2tDdHJsLmdldEVudklkID0gKCkgPT4gdGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09PSAnTE9BRCcgPyB0YXNrQ3RybC50YXNrRGF0YS5lbnZpcm9ubWVudF9pZCA6IHRhc2tDdHJsLnRhc2tEYXRhLnNvdXJjZV9lbnZpcm9ubWVudF9pZDtcblxuICAgICAgICBURE1TZXJ2aWNlLmdldEdlbmVyaWNBUEkoXCJ0YXNrL1wiICsgdGFza0N0cmwudGFza0RhdGEudGFza19pZCArIFwiL2dsb2JhbHNcIikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLmdsb2JhbHMgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgIH0pXG5cblxuICAgICAgICB0YXNrQ3RybC5yZWZlcmVuY2VDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEucmVmZXJlbmNlID09ICdyZWZlcm5jZU9ubHknKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc2VsZWN0QWxsRW50aXRlcyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS5zY2hlZHVsaW5nX2VuZF9kYXRlKSB7XG4gICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zY2hlZHVsaW5nX2VuZF9kYXRlID0gbW9tZW50KG5ldyBEYXRlKHRhc2tDdHJsLnRhc2tEYXRhLnNjaGVkdWxpbmdfZW5kX2RhdGUpKTtcbiAgICAgICAgICAgIHRhc2tDdHJsLnNjaGVkdWxlRW5kQnkgPSBcImVuZEJ5XCJcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRhc2tDdHJsLnNjaGVkdWxlRW5kQnkgPSBcIm5vRW5kQnlcIlxuICAgICAgICB9XG5cbiAgICAgICAgdGFza0N0cmwudmVyc2lvbkZvckxvYWRUbyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHRhc2tDdHJsLnZlcnNpb25Gb3JMb2FkRnJvbSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHRhc2tDdHJsLnZlcnNpb25Gb3JMb2FkRnJvbS5zZXREYXRlKHRhc2tDdHJsLnZlcnNpb25Gb3JMb2FkRnJvbS5nZXREYXRlKCkgLSAzMCk7XG4gICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS5yZXRlbnRpb25fcGVyaW9kX3ZhbHVlKSB7XG4gICAgICAgICAgICB0YXNrQ3RybC5yZXRlbnRpb25fcGVyaW9kX3R5cGUgPSBfLmZpbmQodGFza0N0cmwucmV0ZW50aW9uUGVyaW9kLmF2YWlsYWJsZU9wdGlvbnMsIHtuYW1lOiB0YXNrQ3RybC50YXNrRGF0YS5yZXRlbnRpb25fcGVyaW9kX3R5cGV9KTtcbiAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnJldGVudGlvbl9wZXJpb2RfdmFsdWUgPSBwYXJzZUZsb2F0KHRhc2tDdHJsLnRhc2tEYXRhLnJldGVudGlvbl9wZXJpb2RfdmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKHRhc2tDdHJsLnJldGVudGlvblBlcmlvZCAmJiB0YXNrQ3RybC5yZXRlbnRpb25QZXJpb2QuZGVmYXVsdFBlcmlvZCAmJlxuICAgICAgICAgICAgdGFza0N0cmwucmV0ZW50aW9uUGVyaW9kLmRlZmF1bHRQZXJpb2QudW5pdCkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRSZXRpbnRpb24gPSBfLmZpbmQodGFza0N0cmwucmV0ZW50aW9uUGVyaW9kLmF2YWlsYWJsZU9wdGlvbnMsIHtuYW1lOiB0YXNrQ3RybC5yZXRlbnRpb25QZXJpb2QuZGVmYXVsdFBlcmlvZC51bml0fSk7XG4gICAgICAgICAgICBpZiAoZGVmYXVsdFJldGludGlvbikge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJldGVudGlvbl9wZXJpb2RfdHlwZSA9IGRlZmF1bHRSZXRpbnRpb247XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEucmV0ZW50aW9uX3BlcmlvZF90eXBlID0gdGFza0N0cmwucmV0ZW50aW9uX3BlcmlvZF90eXBlLm5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PSBcIkVYVFJBQ1RcIiAmJiB0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCkge1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5yZXRlbnRpb25fcGVyaW9kX3ZhbHVlID0gdGFza0N0cmwucmV0ZW50aW9uUGVyaW9kLmRlZmF1bHRQZXJpb2QudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0YXNrQ3RybC5yZXRlbnRpb25QZXJpb2RUeXBlQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnJldGVudGlvbl9wZXJpb2RfdHlwZSA9IHRhc2tDdHJsLnJldGVudGlvbl9wZXJpb2RfdHlwZS5uYW1lO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLmRlbGV0ZV9iZWZvcmVfbG9hZCAmJiB0YXNrQ3RybC50YXNrRGF0YS5sb2FkX2VudGl0eSkge1xuICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEub3BlcmF0aW9uTW9kZSA9ICdkZWxldGVfYW5kX2xvYWRfZW50aXR5JztcbiAgICAgICAgfSBlbHNlIGlmICghdGFza0N0cmwudGFza0RhdGEuZGVsZXRlX2JlZm9yZV9sb2FkICYmIHRhc2tDdHJsLnRhc2tEYXRhLmxvYWRfZW50aXR5KSB7XG4gICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5vcGVyYXRpb25Nb2RlID0gJ2luc2VydF9lbnRpdHlfd2l0aG91dF9kZWxldGUnO1xuICAgICAgICB9IGVsc2UgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLmRlbGV0ZV9iZWZvcmVfbG9hZCAmJiAhdGFza0N0cmwudGFza0RhdGEubG9hZF9lbnRpdHkpIHtcbiAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLm9wZXJhdGlvbk1vZGUgPSAnZGVsZXRlX3dpdGhvdXRfbG9hZF9lbnRpdHknO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEub3BlcmF0aW9uTW9kZSA9ICdpbnNlcnRfZW50aXR5X3dpdGhvdXRfZGVsZXRlJztcbiAgICAgICAgfVxuXG4gICAgICAgIHRhc2tDdHJsLnRhc2tUaXRsZVBhdHRlcm4gPSBcIl4oKD8hXykuKSokXCI7XG5cbiAgICAgICAgdGFza0N0cmwuc3RlcCA9IDE7XG5cblxuXG4gICAgICAgIHZhciB1c2VyUm9sZSA9IEF1dGhTZXJ2aWNlLmdldFJvbGUoKTtcbiAgICAgICAgdmFyIHVzZXJuYW1lID0gQXV0aFNlcnZpY2UuZ2V0VXNlcm5hbWUoKTtcblxuICAgICAgICBURE1TZXJ2aWNlLmdldEZhYnJpY1JvbGVzZm9yVXNlcihBdXRoU2VydmljZS5nZXRVc2VySWQoKSkudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgIHRhc2tDdHJsLnVzZXJGYWJyaWNSb2xlcyA9IHJlc3BvbnNlLnJlc3VsdCB8fCBbXTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGFza0N0cmwudXNlclJvbGVUeXBlID0gdXNlclJvbGUudHlwZTtcblxuICAgICAgICB0YXNrQ3RybC5lbnRpdGllc1BhdHRlcm4gPSBuZXcgUmVnRXhwKFwiXigoXFxcXHd8LSkrKD86LChcXFxcd3wtKSspe1wiICsgKHRhc2tDdHJsLnRhc2tEYXRhLm51bWJlcl9vZl9lbnRpdGllc190b19jb3B5IC0gMSkgKyBcIn0pPyRcIik7XG4gICAgICAgIHRhc2tDdHJsLmV4Y3VsdGlvblBhdHRlcm4gPSBuZXcgUmVnRXhwKFwiXigoXFxcXHd8LSkrKD86LChcXFxcd3wtKSspezAsfSk/JFwiKTtcbiAgICAgICAgdGFza0N0cmwuc3ludGhldGljUGF0dGVybiA9IFwiXlthLXpBLVowLTkuXy1dKyRcIjtcblxuICAgICAgICB0YXNrQ3RybC51cGRhdGVFbnRpdGllc1BhdHRlcm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEubnVtYmVyX29mX2VudGl0aWVzX3RvX2NvcHkpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5lbnRpdGllc1BhdHRlcm4gPSBuZXcgUmVnRXhwKFwiXigoXFxcXHd8LSkrKD86LChcXFxcd3wtKSspe1wiICsgKHRhc2tDdHJsLnRhc2tEYXRhLm51bWJlcl9vZl9lbnRpdGllc190b19jb3B5IC0gMSkgKyBcIn0pPyRcIilcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuXG4gICAgICAgIFRETVNlcnZpY2UuZ2V0VGltZVpvbmUoKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRpbWVab25lTWVzc2FnZSA9ICdUYXNrIGV4ZWN1dGlvbiB0aW1lIHdpbGwgYmUgYmFzZWQgb24gJyArIHJlc3BvbnNlLnJlc3VsdC5jdXJyZW50X3NldHRpbmcgKyAnIHRpbWUgem9uZSdcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGltZVpvbmVNZXNzYWdlID0gJ1Rhc2sgZXhlY3V0aW9uIHRpbWUgd2lsbCBiZSBiYXNlZCBvbiBEQiB0aW1lIHpvbmUnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRhc2tDdHJsLmRpc2FibGVDaGFuZ2UgPSAodGFza0N0cmwudGFza0RhdGEudGFza19zdGF0dXMgPT0gJ0luYWN0aXZlJyB8fCB1c2VybmFtZSAhPSB0YXNrQ3RybC50YXNrRGF0YS50YXNrX2NyZWF0ZWRfYnkpO1xuXG4gICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS50YXNrX3N0YXR1cyA9PSAnQWN0aXZlJyAmJiAodGFza0N0cmwudGFza0RhdGEub3duZXJzLmluZGV4T2YodXNlcm5hbWUpID49IDAgfHwgdXNlclJvbGUudHlwZSA9PSAnYWRtaW4nKSkge1xuICAgICAgICAgICAgdGFza0N0cmwuZGlzYWJsZUNoYW5nZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRhc2tDdHJsLmNvcHlUYXNrKSB7XG4gICAgICAgICAgICB0YXNrQ3RybC5kaXNhYmxlQ2hhbmdlID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodXNlclJvbGUudHlwZSA9PSAnYWRtaW4nIHx8IHRhc2tDdHJsLmRpc2FibGVDaGFuZ2UpIHtcbiAgICAgICAgICAgIFRETVNlcnZpY2UuZ2V0RW52aXJvbm1lbnRzKCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlID09IFwiU1VDQ0VTU1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmFsbEVudmlyb25tZW50cyA9IF8uZmlsdGVyKGFuZ3VsYXIuY29weShyZXNwb25zZS5yZXN1bHQpLCBmdW5jdGlvbiAoZW52KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW52LmFsbG93X3dyaXRlICYmIGVudi5lbnZpcm9ubWVudF9zdGF0dXMgPT09ICdBY3RpdmUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5hbGxTb3VyY2VFbnZpcm9ubWVudHMgPSBfLmZpbHRlcihhbmd1bGFyLmNvcHkocmVzcG9uc2UucmVzdWx0KSwgZnVuY3Rpb24gKGVudikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVudi5hbGxvd19yZWFkICYmIGVudi5lbnZpcm9ubWVudF9zdGF0dXMgPT09ICdBY3RpdmUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5hbGxTb3VyY2VFbnZpcm9ubWVudHMgPSBfLnVuaXF1ZSh0YXNrQ3RybC5hbGxTb3VyY2VFbnZpcm9ubWVudHMsICdlbnZpcm9ubWVudF9uYW1lJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiVGFzayAjIFwiICsgdGFza0N0cmwudGFza0RhdGEudGFza19pZCwgXCJGYWlsZCB0byBnZXQgRW52aXJvbm1lbnRzIGZvciB1c2VyXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gVERNU2VydmljZS5nZXRHZW5lcmljQVBJKCdzb3VyY2VFbnZpcm9ubWVudHMnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIC8vICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlID09IFwiU1VDQ0VTU1wiKSB7XG4gICAgICAgICAgICAvLyAgICAgICAgIHRhc2tDdHJsLmFsbFNvdXJjZUVudmlyb25tZW50cyA9IHJlc3BvbnNlLnJlc3VsdDtcbiAgICAgICAgICAgIC8vICAgICAgICAgdGFza0N0cmwuYWxsU291cmNlRW52aXJvbm1lbnRzID0gXy5maWx0ZXIodGFza0N0cmwuYWxsU291cmNlRW52aXJvbm1lbnRzLCBmdW5jdGlvbiAoZW52KSB7XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm4gZW52LmVudmlyb25tZW50X3N0YXR1cyA9PT0gJ0FjdGl2ZSc7XG4gICAgICAgICAgICAvLyAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgIC8vICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgdG9hc3RyLmVycm9yKFwiRmFpbGQgdG8gZ2V0IFNvdXJjZSBFbnZpcm9ubWVudHMgZm9yIHVzZXIgXCIgKyBBdXRoU2VydmljZS5nZXRVc2VybmFtZSgpKTtcbiAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAvLyB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFRETVNlcnZpY2UuZ2V0RW52aXJvbm1lbnRzRm9yVXNlcigpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5hbGxFbnZpcm9ubWVudHMgPSBfLmZpbHRlcihhbmd1bGFyLmNvcHkocmVzcG9uc2UucmVzdWx0KSwgZnVuY3Rpb24gKGVudikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVudi5hbGxvd193cml0ZSAmJiBlbnYuZW52aXJvbm1lbnRfc3RhdHVzID09PSAnQWN0aXZlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuYWxsU291cmNlRW52aXJvbm1lbnRzID0gXy5maWx0ZXIoYW5ndWxhci5jb3B5KHJlc3BvbnNlLnJlc3VsdCksIGZ1bmN0aW9uIChlbnYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbnYuYWxsb3dfcmVhZCAmJiBlbnYuZW52aXJvbm1lbnRfc3RhdHVzID09PSAnQWN0aXZlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuYWxsU291cmNlRW52aXJvbm1lbnRzID0gXy51bmlxdWUodGFza0N0cmwuYWxsU291cmNlRW52aXJvbm1lbnRzLCAnZW52aXJvbm1lbnRfbmFtZScpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIlRhc2sgIyBcIiArIHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfaWQsIFwiRmFpbGQgdG8gZ2V0IEVudmlyb25tZW50cyBmb3IgdXNlclwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIFRETVNlcnZpY2UuZ2V0R2VuZXJpY0FQSSgnc291cmNlZW52aXJvbm1lbnRzYnl1c2VyJykudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAvLyAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgLy8gICAgICAgICB0YXNrQ3RybC5hbGxTb3VyY2VFbnZpcm9ubWVudHMgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgICAgICAvLyAgICAgICAgIHRhc2tDdHJsLmFsbFNvdXJjZUVudmlyb25tZW50cyA9IF8uZmlsdGVyKHRhc2tDdHJsLmFsbFNvdXJjZUVudmlyb25tZW50cywgZnVuY3Rpb24gKGVudikge1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuIGVudi5lbnZpcm9ubWVudF9zdGF0dXMgPT09ICdBY3RpdmUnO1xuICAgICAgICAgICAgLy8gICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAvLyAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyAgICAgICAgIHRvYXN0ci5lcnJvcihcIkZhaWxkIHRvIGdldCBTb3VyY2UgRW52aXJvbm1lbnRzIGZvciB1c2VyIFwiICsgQXV0aFNlcnZpY2UuZ2V0VXNlcm5hbWUoKSk7XG4gICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgLy8gfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0YXNrQ3RybC5lbnRpdGllc0xpc3RDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGFza0N0cmwuZW50aXRpZXNMaXN0Q2hhbmdlVGltZW91dCkge1xuICAgICAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0YXNrQ3RybC5lbnRpdGllc0xpc3RDaGFuZ2VUaW1lb3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS50YXNrX3R5cGUgPT0gJ0xPQUQnICYmIHRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kICYmICF0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RBbGxFbnRpdGVzKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuZW50aXRpZXNMaXN0Q2hhbmdlVGltZW91dCA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZ2V0VmVyc2lvbnNGb3JMb2FkKCk7XG4gICAgICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdGFza0N0cmwudGFza01vZGVDaGFuZ2UgPSBmdW5jdGlvbiAoaW5pdCwgdGFza190eXBlKSB7XG5cbiAgICAgICAgICAgIGxldCBjbGVhck51bWJlck9mRW50aXRpZXNUb0NvcHkgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLm51bWJlcl9vZl9lbnRpdGllc190b19jb3B5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2xlYXJOdW1iZXJPZkVudGl0aWVzVG9Db3B5KCk7XG5cbiAgICAgICAgICAgIGlmICh0YXNrX3R5cGUpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zb3VyY2VfZW52aXJvbm1lbnRfaWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLmVudmlyb25tZW50X2lkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zb3VyY2VfZW52X25hbWUgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLm1heFRvQ29weSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQgJiYgdGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09ICdMT0FEJykge1xuICAgICAgICAgICAgICAgIC8vdGFza0N0cmwuZ2V0QWxsTG9naWNhbFVuaXRzRm9yRW52KHRhc2tDdHJsLnRhc2tEYXRhLnNvdXJjZV9lbnZpcm9ubWVudF9pZCwgdGFza0N0cmwudGFza0RhdGEuZW52aXJvbm1lbnRfaWQsIGluaXQpO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmxvZ2ljYWxVbml0cyA9IFtdO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmxvZ2ljYWxVbml0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoIWluaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuYmVfaWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09ICdFWFRSQUNUJykge1xuICAgICAgICAgICAgICAgIC8vdGFza0N0cmwuZ2V0QWxsTG9naWNhbFVuaXRzRm9yRW52KHRhc2tDdHJsLnRhc2tEYXRhLnNvdXJjZV9lbnZpcm9ubWVudF9pZCwgdGFza0N0cmwudGFza0RhdGEuc291cmNlX2Vudmlyb25tZW50X2lkLCBpbml0KTtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5sb2dpY2FsVW5pdHMgPSBbXTtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5sb2dpY2FsVW5pdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKCFpbml0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLmJlX2lkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRhc2tfdHlwZSAmJiAhdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEucmV0ZW50aW9uX3BlcmlvZF92YWx1ZSA9IDA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCAmJiAhdGFza0N0cmwudGFza0RhdGEucmV0ZW50aW9uX3BlcmlvZF92YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwucmV0ZW50aW9uUGVyaW9kICYmIHRhc2tDdHJsLnJldGVudGlvblBlcmlvZC5kZWZhdWx0UGVyaW9kICYmXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5yZXRlbnRpb25QZXJpb2QuZGVmYXVsdFBlcmlvZC51bml0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdFJldGludGlvbiA9IF8uZmluZCh0YXNrQ3RybC5yZXRlbnRpb25QZXJpb2QuYXZhaWxhYmxlT3B0aW9ucywge25hbWU6IHRhc2tDdHJsLnJldGVudGlvblBlcmlvZC5kZWZhdWx0UGVyaW9kLnVuaXR9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0UmV0aW50aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwucmV0ZW50aW9uX3BlcmlvZF90eXBlID0gZGVmYXVsdFJldGludGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5yZXRlbnRpb25fcGVyaW9kX3R5cGUgPSB0YXNrQ3RybC5yZXRlbnRpb25fcGVyaW9kX3R5cGUubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09IFwiRVhUUkFDVFwiICYmIHRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnJldGVudGlvbl9wZXJpb2RfdmFsdWUgPSB0YXNrQ3RybC5yZXRlbnRpb25QZXJpb2QuZGVmYXVsdFBlcmlvZC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdEFsbEVudGl0ZXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5sb2dpY2FsVW5pdCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdEFsbEVudGl0ZXMpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5zZWxlY3RGaWVsZFR5cGUgPSBcImdpdmVuXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdGFza0N0cmwuZ2V0QWxsTG9naWNhbFVuaXRzRm9yRW52ID0gZnVuY3Rpb24gKHNvdXJjZV9lbnZpcm9ubWVudF9pZCwgZW52aXJvbm1lbnRfaWQsIGluaXQpIHtcbiAgICAgICAgICAgIGlmIChzb3VyY2VfZW52aXJvbm1lbnRfaWQgJiYgZW52aXJvbm1lbnRfaWQpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5hbGxTaW5nbGVMb2dpY2FsVW5pdHMgPSBbXTtcbiAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLmdldEdlbmVyaWNBUEkoJ3NvdXJjZWVudmlkLycgKyBzb3VyY2VfZW52aXJvbm1lbnRfaWQgK1xuICAgICAgICAgICAgICAgICAgICAnL3RhcmdldGVuZGlkLycgKyBlbnZpcm9ubWVudF9pZCArICcvbG9naWNhbFVuaXRzJykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuYWxsU2luZ2xlTG9naWNhbFVuaXRzID0gcmVzcG9uc2UucmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluaXQgJiYgdGFza0N0cmwubG9naWNhbFVuaXRzICYmIHRhc2tDdHJsLmxvZ2ljYWxVbml0c1swXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmxvZ2ljYWxVbml0ID0gXy5maW5kKHRhc2tDdHJsLmFsbFNpbmdsZUxvZ2ljYWxVbml0cywge2x1X2lkOiB0YXNrQ3RybC5sb2dpY2FsVW5pdHNbMF0ubHVfaWR9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIkZhaWxkIHRvIGdldCBMb2dpY2FsIHVuaXRzXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0YXNrQ3RybC5zb3VyY2VFbnZpcm9ubWVudENoYW5nZSA9IGZ1bmN0aW9uIChnZXRSb2xlcywgaW5pdCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZUVudiA9IF8uZmluZCh0YXNrQ3RybC5hbGxTb3VyY2VFbnZpcm9ubWVudHMsIHtlbnZpcm9ubWVudF9pZDogdGFza0N0cmwudGFza0RhdGEuc291cmNlX2Vudmlyb25tZW50X2lkfSk7XG4gICAgICAgICAgICBpZiAoc291cmNlRW52KSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc291cmNlX2Vudl9uYW1lID0gc291cmNlRW52LmVudmlyb25tZW50X25hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2V0Um9sZXMpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5lbnZpcm9ubWVudENoYW5nZShpbml0LCB0YXNrQ3RybC50YXNrRGF0YS5zb3VyY2VfZW52aXJvbm1lbnRfaWQsdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0YXNrQ3RybC5jaGVja1JlZmVyZW5jZUlmQWxsb3dlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICgoIXRhc2tDdHJsLnVzZXJSb2xlIHx8ICF0YXNrQ3RybC51c2VyUm9sZS5hbGxvd2VkX3JlZnJlc2hfcmVmZXJlbmNlX2RhdGEpICYmIFxuICAgICAgICAgICAgICAgICghdGFza0N0cmwuc291cmNlVXNlclJvbGUgfHwgIXRhc2tDdHJsLnNvdXJjZVVzZXJSb2xlLmFsbG93ZWRfcmVmcmVzaF9yZWZlcmVuY2VfZGF0YSkpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5yZWZlcmVuY2UgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGFza0N0cmwuZW52aXJvbm1lbnRDaGFuZ2UgPSBmdW5jdGlvbiAoaW5pdCwgZW52aXJvbm1lbnRfaWQsIHNvdXJjZSkge1xuXG4gICAgICAgICAgICBpZiAodXNlclJvbGUudHlwZSA9PSAnYWRtaW4nKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudXNlclJvbGUgPSB7fTtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC51c2VyUm9sZS5hbGxvd2VkX3JhbmRvbV9lbnRpdHlfc2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC51c2VyUm9sZS5hbGxvd2VkX2NyZWF0aW9uX29mX3N5bnRoZXRpY19kYXRhID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC51c2VyUm9sZS5hbGxvd2VkX3JlZnJlc2hfcmVmZXJlbmNlX2RhdGEgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnVzZXJSb2xlLmFsbG93ZWRfcmVxdWVzdF9vZl9mcmVzaF9kYXRhID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC51c2VyUm9sZS5hbGxvd2VkX2RlbGV0ZV9iZWZvcmVfbG9hZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudXNlclJvbGUuYWxsb3dlZF90YXNrX3NjaGVkdWxpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnVzZXJSb2xlLmFsbG93ZWRfcmVwbGFjZV9zZXF1ZW5jZXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLm1heFRvQ29weSA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEubnVtYmVyX29mX2VudGl0aWVzX3RvX2NvcHkgPSBwYXJzZUludCh0YXNrQ3RybC50YXNrRGF0YS5udW1iZXJfb2ZfZW50aXRpZXNfdG9fY29weSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFRETVNlcnZpY2UuZ2V0RW52aXJvbm1lbnRPd25lcnMoZW52aXJvbm1lbnRfaWQgfHwgdGFza0N0cmwudGFza0RhdGEuZW52aXJvbm1lbnRfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvd25lckZvdW5kID0gXy5maW5kKHJlc3BvbnNlLnJlc3VsdCwge3VzZXJfaWQ6IEF1dGhTZXJ2aWNlLmdldFVzZXJJZCgpfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW93bmVyRm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGkgPSAwO2kgPCB0YXNrQ3RybC51c2VyRmFicmljUm9sZXMubGVuZ3RoIDtpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3duZXJGb3VuZCA9IF8uZmluZChyZXNwb25zZS5yZXN1bHQse3VzZXJfdHlwZTogJ0dST1VQJywgdXNlcl9pZDogdGFza0N0cmwudXNlckZhYnJpY1JvbGVzW2ldfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvd25lckZvdW5kKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG93bmVyRm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC51c2VyUm9sZSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnVzZXJSb2xlLmFsbG93ZWRfcmFuZG9tX2VudGl0eV9zZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnVzZXJSb2xlLmFsbG93ZWRfY3JlYXRpb25fb2Zfc3ludGhldGljX2RhdGEgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnVzZXJSb2xlLmFsbG93ZWRfcmVmcmVzaF9yZWZlcmVuY2VfZGF0YSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudXNlclJvbGUuYWxsb3dlZF9yZXF1ZXN0X29mX2ZyZXNoX2RhdGEgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnVzZXJSb2xlLmFsbG93ZWRfZGVsZXRlX2JlZm9yZV9sb2FkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC51c2VyUm9sZS5hbGxvd2VkX3Rhc2tfc2NoZWR1bGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudXNlclJvbGUuYWxsb3dlZF9yZXBsYWNlX3NlcXVlbmNlcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEubnVtYmVyX29mX2VudGl0aWVzX3RvX2NvcHkgPSBwYXJzZUludCh0YXNrQ3RybC50YXNrRGF0YS5udW1iZXJfb2ZfZW50aXRpZXNfdG9fY29weSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVudmlyb25tZW50X2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnNvdXJjZUVudk93bmVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXJnZXRFbnZPd25lciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW52aXJvbm1lbnRfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc291cmNlRW52T3duZXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXJnZXRFbnZPd25lciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLmdldFJvbGVGb3JVc2VySW5FbnYoZW52aXJvbm1lbnRfaWQgfHwgdGFza0N0cmwudGFza0RhdGEuZW52aXJvbm1lbnRfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZW52aXJvbm1lbnRfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC51c2VyUm9sZSA9IHJlc3BvbnNlLnJlc3VsdC51c2VyUm9sZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc291cmNlVXNlclJvbGUgPSByZXNwb25zZS5yZXN1bHQudXNlclJvbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09ICdMT0FEJyAmJiB0YXNrQ3RybC51c2VyUm9sZS5hbGxvd2VkX2VudGl0eV92ZXJzaW9uaW5nICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc291cmNlVXNlclJvbGUuYWxsb3dlZF9lbnRpdHlfdmVyc2lvbmluZykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09ICdFWFRSQUNUJyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zb3VyY2VVc2VyUm9sZS5hbGxvd2VkX2VudGl0eV92ZXJzaW9uaW5nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmFsbG93ZWRfZW50aXR5X3ZlcnNpb25pbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5hbGxvd2VkX2VudGl0eV92ZXJzaW9uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuY2hlY2tSZWZlcmVuY2VJZkFsbG93ZWQoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWluUmVhZCA9IHJlc3BvbnNlLnJlc3VsdC5taW5SZWFkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pbldyaXRlID0gcmVzcG9uc2UucmVzdWx0Lm1pbldyaXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1pblJlYWQgPiAtMSB8fCBtaW5Xcml0ZSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluV3JpdGUgPSBwYXJzZUludChtaW5Xcml0ZSB8fCBcIjBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluUmVhZCA9IHBhcnNlSW50KG1pblJlYWQgfHwgXCIwXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbnZpcm9ubWVudF9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zb3VyY2VNYXhUb0NvcHkgPSBtaW5SZWFkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwubWF4VG9Db3B5ID4gbWluUmVhZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwubWF4VG9Db3B5ID0gbWluUmVhZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghdGFza0N0cmwubWF4VG9Db3B5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5tYXhUb0NvcHkgPSBtaW5SZWFkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFyZ2V0TWF4VG9Db3B5ID0gbWluV3JpdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrQ3RybC5tYXhUb0NvcHkgPiBtaW5Xcml0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwubWF4VG9Db3B5ID0gbWluV3JpdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRhc2tDdHJsLm1heFRvQ29weSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwubWF4VG9Db3B5ID0gbWluV3JpdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJUYXNrICMgXCIgKyB0YXNrQ3RybC50YXNrRGF0YS50YXNrX2lkLCBcIkZhaWxkIHRvIGdldCBSb2xlIGZvciB1c2VyIFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiRW52aXJvbm1lbnQgIyBcIiArIGVudmlyb25tZW50X2lkIHx8IHRhc2tDdHJsLnRhc2tEYXRhLmVudmlyb25tZW50X2lkLCBcImZhaWxlZCB0byBnZXQgb3duZXJzIDogXCIgKyByZXNwb25zZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCghc291cmNlIHx8IHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PT0gJ0VYVFJBQ1QnIHx8IChpbml0ICYmICFzb3VyY2UpKSAmJiAoZW52aXJvbm1lbnRfaWQgfHwgdGFza0N0cmwudGFza0RhdGEuZW52aXJvbm1lbnRfaWQpKSB7XG4gICAgICAgICAgICAgICAgVERNU2VydmljZS5nZXRCdXNpbmVzc0VudGl0aWVzRm9yRW52UHJvZHVjdHMoZW52aXJvbm1lbnRfaWQgfHwgdGFza0N0cmwudGFza0RhdGEuZW52aXJvbm1lbnRfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuYnVzaW5lc3NFbnRpdGllcyA9IHJlc3BvbnNlLnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIlRhc2sgIyBcIiArIHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfaWQsIFwiRmFpbGQgdG8gZ2V0IEJ1c2luZXNzIEVudGl0aWVzXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWluaXQpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5iZV9pZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5sb2dpY2FsVW5pdHMgPSBbXTtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5hbGxMb2dpY2FsVW5pdHMgID0gW107XG4gICAgICAgICAgICAgICAgdGFza0N0cmwucHJvZHVjdHMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB0YXNrQ3RybC51cGRhdGVQYXJhbXMgPSBjYiA9PiB7XG4gICAgICAgICAgICBURE1TZXJ2aWNlLmdldEdlbmVyaWNBUEkoJ2J1c2luZXNzZW50aXR5LycgKyB0YXNrQ3RybC50YXNrRGF0YS5iZV9pZCArICcvc291cmNlRW52LycgKyB0YXNrQ3RybC50YXNrRGF0YS5zb3VyY2VfZW52X25hbWUgKyAnL3BhcmFtZXRlcnMnKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwucGFyYW1ldGVycyA9IHJlc3BvbnNlLnJlc3VsdDtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYW1ldGVyc0tleXMgPSBPYmplY3Qua2V5cyh0YXNrQ3RybC5wYXJhbWV0ZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNob3NlbkxVcyA9IF8ubWFwKHRhc2tDdHJsLmxvZ2ljYWxVbml0cyxmdW5jdGlvbihsdSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbHUubHVfbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYW1ldGVyc0tleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaG9zZW5MVXMuaW5kZXhPZihwYXJhbWV0ZXJzS2V5c1tpXS5zcGxpdChcIi5cIilbMF0udG9Mb3dlckNhc2UoKSkgPCAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFza0N0cmwucGFyYW1ldGVyc1twYXJhbWV0ZXJzS2V5c1tpXV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnBhcmFtZXRlcnMgPSBfLm1hcCh0YXNrQ3RybC5wYXJhbWV0ZXJzLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbV9uYW1lOiBrZXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdmFsdWUuUEFSQU1fTkFNRSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbV90eXBlOiB2YWx1ZS5QQVJBTV9UWVBFLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkX3ZhbHVlczogdmFsdWVbJ1ZBTElEX1ZBTFVFUyddLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbl92YWx1ZTogdmFsdWUuUEFSQU1fVFlQRSA9PSAnbnVtYmVyJyA/IHBhcnNlRmxvYXQodmFsdWVbJ01JTl9WQUxVRSddKSA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4X3ZhbHVlOiB2YWx1ZS5QQVJBTV9UWVBFID09ICdudW1iZXInID8gcGFyc2VGbG9hdCh2YWx1ZVsnTUFYX1ZBTFVFJ10pIDogMFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNiLmFwcGx5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJCdXNpbmVzcyBlbnRpdHkgIyBcIiArIHRhc2tDdHJsLnRhc2tEYXRhLmJlX2lkLCBcIkZhaWxlZCB0byBnZXQgYnVzaW5lc3MgZW50aXR5IHBhcmFtZXRlcnNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGFza0N0cmwuYnVzaW5lc3NFbnRpdHlDaGFuZ2UgPSBmdW5jdGlvbiAoaW5pdCkge1xuXG4gICAgICAgICAgICBpZiAoIWluaXQpIHtcbiAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwuZmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXNrQ3RybC5maWx0ZXIuZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmZpbHRlci5ncm91cC5ydWxlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9wYXJhbV92YWx1ZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEucGFyYW1ldGVycyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYmUgPSBfLmZpbmQodGFza0N0cmwuYnVzaW5lc3NFbnRpdGllcywge2JlX2lkOiB0YXNrQ3RybC50YXNrRGF0YS5iZV9pZH0pO1xuICAgICAgICAgICAgaWYgKGJlKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuYmVfbmFtZSA9IGJlLmJlX25hbWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBlbnZpcm9ubWVudF9pZCA9IHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PT0gJ0VYVFJBQ1QnID8gdGFza0N0cmwudGFza0RhdGEuc291cmNlX2Vudmlyb25tZW50X2lkIDogdGFza0N0cmwudGFza0RhdGEuZW52aXJvbm1lbnRfaWRcbiAgICAgICAgICAgIGlmIChlbnZpcm9ubWVudF9pZCAmJiB0YXNrQ3RybC50YXNrRGF0YS5iZV9pZCkge1xuICAgICAgICAgICAgICAgIFRETVNlcnZpY2UuZ2V0TG9naWNhbFVuaXRzRm9yQnVzaW5lc3NFbnRpdHlBbmRFbnYodGFza0N0cmwudGFza0RhdGEuYmVfaWQsIGVudmlyb25tZW50X2lkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlID09IFwiU1VDQ0VTU1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5hbGxMb2dpY2FsVW5pdHMgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWluaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5sb2dpY2FsVW5pdHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhc2tDdHJsLmFsbExvZ2ljYWxVbml0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5sb2dpY2FsVW5pdHMucHVzaCh0YXNrQ3RybC5hbGxMb2dpY2FsVW5pdHNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBMdXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhc2tDdHJsLmxvZ2ljYWxVbml0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbHUgPSBfLmZpbmQodGFza0N0cmwuYWxsTG9naWNhbFVuaXRzLCB7bHVfbmFtZTogdGFza0N0cmwubG9naWNhbFVuaXRzW2ldLmx1X25hbWV9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGx1KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wTHVzLnB1c2gobHUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmxvZ2ljYWxVbml0cyA9IHRlbXBMdXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJCdXNpbmVzcyBlbnRpdHkgIyBcIiArIHRhc2tDdHJsLnRhc2tEYXRhLmJlX2lkLCBcIkZhaWxlZCB0byBnZXQgTG9naWNhbCB1bml0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGlmICh0YXNrQ3RybC50YXNrRGF0YS5zb3VyY2VfZW52X25hbWUgJiYgdGFza0N0cmwudGFza0RhdGEuYmVfaWQpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgdGFza0N0cmwudXBkYXRlUGFyYW1zKCk7XG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEuYmVfaWQpIHtcbiAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLmdldEJFUG9zdEV4ZWN1dGlvblByb2Nlc3ModGFza0N0cmwudGFza0RhdGEuYmVfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmFsbFBvc3RFeGVjdXRpb25Qcm9jZXNzID0gcmVzcG9uc2UucmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuYWxsUG9zdEV4ZWN1dGlvblByb2Nlc3NJZHMgPSBfLm1hcChyZXNwb25zZS5yZXN1bHQsJ3Byb2Nlc3NfaWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaW5pdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnBvc3RFeGVjdXRpb25Qcm9jZXNzZXMgPSB0YXNrQ3RybC5hbGxQb3N0RXhlY3V0aW9uUHJvY2Vzc0lkcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIkJ1c2luZXNzIGVudGl0eSAjIFwiICsgdGFza0N0cmwudGFza0RhdGEuYmVfaWQsIFwiRmFpbGVkIHRvIGdldCBQb3N0IEV4ZWN1dGlvbiBQcm9jZXNzZXNcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBURE1TZXJ2aWNlLmdldFRhc2tMb2dpY2FsVW5pdHModGFza0N0cmwudGFza0RhdGEudGFza19pZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHRhc2tDdHJsLmJ1c2luZXNzRW50aXR5Q2hhbmdlKHRydWUpO1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmxvZ2ljYWxVbml0cyA9IHJlc3BvbnNlLnJlc3VsdDtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5hbGxTaW5nbGVMb2dpY2FsVW5pdHMgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLmFsbFNpbmdsZUxvZ2ljYWxVbml0cyAmJlxuICAgICAgICAgICAgICAgICAgICAhKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PSBcIkxPQURcIiAmJiAhdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQpXG4gICAgICAgICAgICAgICAgICAgICYmIHRhc2tDdHJsLmxvZ2ljYWxVbml0c1swXSkge1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5sb2dpY2FsVW5pdCA9IF8uZmluZCh0YXNrQ3RybC5hbGxTaW5nbGVMb2dpY2FsVW5pdHMsIHtsdV9pZDogdGFza0N0cmwubG9naWNhbFVuaXRzWzBdLmx1X2lkfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJTeXN0ZW1zICMgXCIgKyB0YXNrQ3RybC50YXNrRGF0YS50YXNrX2lkLCBcIkZhaWxlZCB0byBnZXQgVGFzayBTeXN0ZW1zXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBURE1TZXJ2aWNlLmdldFRhc2tQb3N0RXhlY3V0aW9uUHJvY2Vzc2VzKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5wb3N0RXhlY3V0aW9uUHJvY2Vzc2VzID0gXy5tYXAocmVzcG9uc2UucmVzdWx0LHYgPT4gcGFyc2VJbnQodi5wcm9jZXNzX2lkKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIlRhc2sgIyBcIiArIHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfaWQsIFwiRmFpbGVkIHRvIGdldCBUYXNrIFBvc3QgRXhlY3V0aW9uIFByb2Nlc3Nlc1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGFza0N0cmwuZW52aXJvbm1lbnRDaGFuZ2UodHJ1ZSk7XG5cbiAgICAgICAgdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMgPSB7fTtcbiAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9tZXRob2QgIT0gXCJBTExcIikge1xuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9tZXRob2QgPT0gJ0wnKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuc2VsZWN0RmllbGRUeXBlID0gJ2dpdmVuJztcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllcy5lbnRpdGllc19saXN0ID0gdGFza0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX3BhcmFtX3ZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID09ICdSJykge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnNlbGVjdEZpZWxkVHlwZSA9ICdyYW5kb20nO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID09ICdTJykge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnNlbGVjdEZpZWxkVHlwZSA9ICdzeW50aGV0aWMnO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLnN5bnRoZXRpYyA9IHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9wYXJhbV92YWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGFza0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX21ldGhvZCA9PSAnUCcgfHwgdGFza0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX21ldGhvZCA9PSAnUFInKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuc2VsZWN0RmllbGRUeXBlID0gJ3BhcmFtZXRlcnMnO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmZpbHRlciA9IEpTT04ucGFyc2UodGFza0N0cmwudGFza0RhdGEucGFyYW1ldGVycyk7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMucXVlcnlfcGFyYW1ldGVycyA9IHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9wYXJhbV92YWx1ZTtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllcy5wYXJhbWV0ZXJzID0gdGFza0N0cmwudGFza0RhdGEucGFyYW1ldGVycztcbiAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX21ldGhvZCA9PSAnUFInKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnBhcmFtZXRlcnNSYW5kb20gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnBhcmFtZXRlcnNSYW5kb20gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RBbGxFbnRpdGVzID0gdHJ1ZTtcbiAgICAgICAgICAgIHRhc2tDdHJsLnNlbGVjdEZpZWxkVHlwZSA9IFwiZ2l2ZW5cIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGFza0N0cmwuZmlsdGVyKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9ICd7XCJncm91cFwiOiB7XCJvcGVyYXRvclwiOiBcIkFORFwiLFwicnVsZXNcIjogW119fSc7XG4gICAgICAgICAgICB0YXNrQ3RybC5maWx0ZXIgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnNjaGVkdWxlciA9PSAnaW1tZWRpYXRlJykge1xuICAgICAgICAgICAgdGFza0N0cmwuc2VsZWN0U2NoZWR1bGUgPSAnaW1tZWRpYXRlJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRhc2tDdHJsLnNlbGVjdFNjaGVkdWxlID0gJ3NjaGVkdWxlJztcbiAgICAgICAgICAgIHRhc2tDdHJsLnNjaGVkdWxlRGF0YSA9IHRhc2tDdHJsLnRhc2tEYXRhLnNjaGVkdWxlcjtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgdGFza0N0cmwuc2F2ZVRhc2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdEFsbEVudGl0ZXMgJiYgdGFza0N0cmwudGFza0RhdGEucmVmZXJlbmNlICE9PSAncmVmZXJuY2VPbmx5Jykge1xuICAgICAgICAgICAgICAgIGlmICh0YXNrQ3RybC5zZWxlY3RGaWVsZFR5cGUgPT0gJ2dpdmVuJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMgJiYgdGFza0N0cmwudGFza0RhdGEuZW50aXR5X2V4Y2x1c2lvbl9saXN0ID09IHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmVycm9yTGlzdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmNyZWF0ZVRhc2tJblByb2dyZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX21ldGhvZCA9ICdMJztcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX3BhcmFtX3ZhbHVlID0gdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMuZW50aXRpZXNfbGlzdDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2tDdHJsLnNlbGVjdEZpZWxkVHlwZSA9PSAncmFuZG9tJykge1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID0gJ1InO1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fcGFyYW1fdmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFza0N0cmwuc2VsZWN0RmllbGRUeXBlID09ICdzeW50aGV0aWMnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9tZXRob2QgPSAnUyc7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9wYXJhbV92YWx1ZSA9IHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLnN5bnRoZXRpYztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLnF1ZXJ5X3BhcmFtZXRlcnMgfHwgdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMucXVlcnlfcGFyYW1ldGVycyA9PSAnKCknKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5wYXJhbWV0ZXJzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnBhcmFtZXRlcnNSYW5kb20gPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX21ldGhvZCA9ICdQUic7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3Rpb25fbWV0aG9kID0gJ1AnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGlvbl9wYXJhbV92YWx1ZSA9IHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLnF1ZXJ5X3BhcmFtZXRlcnM7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnBhcmFtZXRlcnMgPSB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllcy5wYXJhbWV0ZXJzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnNlbGVjdFNjaGVkdWxlID09ICdpbW1lZGlhdGUnKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc2NoZWR1bGVyID0gdGFza0N0cmwuc2VsZWN0U2NoZWR1bGU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNjaGVkdWxlciA9IHRhc2tDdHJsLnNjaGVkdWxlRGF0YTtcbiAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwuc2NoZWR1bGVFbmRCeSAhPT0gXCJlbmRCeVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNjaGVkdWxpbmdfZW5kX2RhdGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc2NoZWR1bGluZ19lbmRfZGF0ZS5ob3VycygxMik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09ICdMT0FEJyAmJiB0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCkge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLm9wZXJhdGlvbk1vZGUgPSAnZGVsZXRlX2FuZF9sb2FkX2VudGl0eSc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS5vcGVyYXRpb25Nb2RlID09ICdkZWxldGVfYW5kX2xvYWRfZW50aXR5Jykge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnJlcGxhY2Vfc2VxdWVuY2VzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEubG9hZF9lbnRpdHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLmRlbGV0ZV9iZWZvcmVfbG9hZCA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLm9wZXJhdGlvbk1vZGUgPT0gJ2luc2VydF9lbnRpdHlfd2l0aG91dF9kZWxldGUnKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEubG9hZF9lbnRpdHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLmRlbGV0ZV9iZWZvcmVfbG9hZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC50YXNrRGF0YS5vcGVyYXRpb25Nb2RlID09ICdkZWxldGVfd2l0aG91dF9sb2FkX2VudGl0eScpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5yZXBsYWNlX3NlcXVlbmNlcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLmxvYWRfZW50aXR5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuZGVsZXRlX2JlZm9yZV9sb2FkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEubG9hZF9lbnRpdHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLmRlbGV0ZV9iZWZvcmVfbG9hZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS50YXNrX3R5cGUgPT0gJ0xPQUQnICYmIHRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kICYmIHRhc2tDdHJsLnRhc2tEYXRhLnJlZmVyZW5jZSAhPT0gXCJyZWZlcm5jZU9ubHlcIikge1xuICAgICAgICAgICAgICAgIC8vIGlmICghdGFza0N0cmwuc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIHRhc2tDdHJsLnN0ZXAgPSAyO1xuICAgICAgICAgICAgICAgIC8vICAgICB0YXNrQ3RybC5jcmVhdGVUYXNrSW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgdmFyIHNlbGVjdGVkVmVyc2lvblRvTG9hZCA9IF8uZmluZCh0YXNrQ3RybC52ZXJzaW9uc0ZvckxvYWQsIHtmYWJyaWNfZXhlY3V0aW9uX2lkOiB0YXNrQ3RybC5zZWxlY3RlZFZlcnNpb25Ub0xvYWR9KTtcbiAgICAgICAgICAgICAgICAvLyAgICAgaWYgKHNlbGVjdGVkVmVyc2lvblRvTG9hZCkge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc2VsZWN0ZWRfdmVyc2lvbl90YXNrX25hbWUgPSBzZWxlY3RlZFZlcnNpb25Ub0xvYWQudmVyc2lvbl9uYW1lO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdmFyIHZlcnNpb25fZGF0ZXRpbWUgPSBuZXcgRGF0ZShzZWxlY3RlZFZlcnNpb25Ub0xvYWQudmVyc2lvbl9kYXRldGltZSk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB2YXIgbG9jYWxUaW1lWm9uZSA9IHZlcnNpb25fZGF0ZXRpbWUuZ2V0VGltZXpvbmVPZmZzZXQoKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHZlcnNpb25fZGF0ZXRpbWUgPSB2ZXJzaW9uX2RhdGV0aW1lLmdldFRpbWUoKSArIGxvY2FsVGltZVpvbmUgKiA2MDAwMDtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGVkX3ZlcnNpb25fZGF0ZXRpbWUgPSBtb21lbnQodmVyc2lvbl9kYXRldGltZSkuZm9ybWF0KFwiWVlZWU1NRERISG1tc3NcIik7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RlZF92ZXJzaW9uX3Rhc2tfZXhlX2lkID0gc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkLnRhc2tfZXhlY3V0aW9uX2lkO1xuICAgICAgICAgICAgICAgIC8vICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdGFza0N0cmwuc3RlcCA9IDI7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB0YXNrQ3RybC5jcmVhdGVUYXNrSW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnNlbGVjdGVkVmVyc2lvblRvTG9hZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkID0gXy5maW5kKHRhc2tDdHJsLnZlcnNpb25zRm9yTG9hZCwge2ZhYnJpY19leGVjdXRpb25faWQ6IHRhc2tDdHJsLnNlbGVjdGVkVmVyc2lvblRvTG9hZH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RlZF92ZXJzaW9uX3Rhc2tfbmFtZSA9IHNlbGVjdGVkVmVyc2lvblRvTG9hZC52ZXJzaW9uX25hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbl9kYXRldGltZSA9IG5ldyBEYXRlKHNlbGVjdGVkVmVyc2lvblRvTG9hZC52ZXJzaW9uX2RhdGV0aW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbFRpbWVab25lID0gdmVyc2lvbl9kYXRldGltZS5nZXRUaW1lem9uZU9mZnNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbl9kYXRldGltZSA9IHZlcnNpb25fZGF0ZXRpbWUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc2VsZWN0ZWRfdmVyc2lvbl9kYXRldGltZSA9IG1vbWVudCh2ZXJzaW9uX2RhdGV0aW1lKS5mb3JtYXQoXCJZWVlZTU1EREhIbW1zc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGVkX3ZlcnNpb25fdGFza19leGVfaWQgPSBzZWxlY3RlZFZlcnNpb25Ub0xvYWQudGFza19leGVjdXRpb25faWQ7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmNyZWF0ZVRhc2tJblByb2dyZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS50YXNrX3R5cGUgPT0gJ0xPQUQnICYmIHRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kICYmXG4gICAgICAgICAgICAgICAgKHRhc2tDdHJsLnRhc2tEYXRhLnJlZmVyZW5jZSA9PSBcInJlZmVybmNlT25seVwiIHx8IHRhc2tDdHJsLnRhc2tEYXRhLnJlZmVyZW5jZSA9PSBcImJvdGhcIikpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRhc2tDdHJsLnRhc2tEYXRhLnJlZkxvYWRWZXJzaW9ucykge1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gNjtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuY3JlYXRlVGFza0luUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZFZlcnNpb25Ub0xvYWQgPSBfLmZpbmQodGFza0N0cmwudGFza0RhdGEucmVmTG9hZFZlcnNpb25zLCB7dGFza19leGVjdXRpb25faWQ6IHBhcnNlSW50KHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGVkUmVmVmVyc2lvblRvTG9hZCl9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkVmVyc2lvblRvTG9hZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc2VsZWN0ZWRfcmVmX3ZlcnNpb25fdGFza19uYW1lID0gc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkLnZlcnNpb25fbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ZXJzaW9uX2RhdGV0aW1lID0gbmV3IERhdGUoc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkLnZlcnNpb25fZGF0ZXRpbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsVGltZVpvbmUgPSB2ZXJzaW9uX2RhdGV0aW1lLmdldFRpbWV6b25lT2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uX2RhdGV0aW1lID0gdmVyc2lvbl9kYXRldGltZS5nZXRUaW1lKCkgKyBsb2NhbFRpbWVab25lICogNjAwMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RlZF9yZWZfdmVyc2lvbl9kYXRldGltZSA9IG1vbWVudCh2ZXJzaW9uX2RhdGV0aW1lIC0gdGFza0N0cmwudGltZVpvbmVPZmZzZXQgKiA2MDAwMCkuZm9ybWF0KFwiWVlZWU1NRERISG1tc3NcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RlZF9yZWZfdmVyc2lvbl90YXNrX2V4ZV9pZCA9IHNlbGVjdGVkVmVyc2lvblRvTG9hZC50YXNrX2V4ZWN1dGlvbl9pZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF0YXNrQ3RybC50YXNrRGF0YS5yZXF1ZXN0X29mX2ZyZXNoX2RhdGEpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zeW5jX21vZGUgPSBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09PSAnRVhUUkFDVCcpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5sb2FkX2VudGl0eSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLmVudmlyb25tZW50X2lkID0gdGFza0N0cmwudGFza0RhdGEuc291cmNlX2Vudmlyb25tZW50X2lkO1xuICAgICAgICAgICAgICAgIGlmICghdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQgJiYgdGFza0N0cmwudGFza0RhdGEucmVxdWVzdF9vZl9mcmVzaF9kYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnN5bmNfbW9kZSA9ICdGT1JDRSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFza0N0cmwudGFza0RhdGEuc3luY19tb2RlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCEodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09PSAnRVhUUkFDVCcgJiYgdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQpICYmICF0YXNrQ3RybC50YXNrRGF0YS5yZXRlbnRpb25fcGVyaW9kX3ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRhc2tDdHJsLnRhc2tEYXRhLnJldGVudGlvbl9wZXJpb2RfdHlwZTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGFza0N0cmwudGFza0RhdGEucmV0ZW50aW9uX3BlcmlvZF92YWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaWYgKCEodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09ICdMT0FEJyAmJiAhdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQpKSB7XG4gICAgICAgICAgICAvLyAgICAgdGFza0N0cmwubG9naWNhbFVuaXRzID0gdGFza0N0cmwubG9naWNhbFVuaXQ7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RBbGxFbnRpdGVzKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuc2VsZWN0aW9uX3BhcmFtX3ZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBpZiAoIXRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdEFsbEVudGl0ZXMgJiYgISh0YXNrQ3RybC50YXNrRGF0YS50YXNrX3R5cGUgPT09ICdMT0FEJyAmJiAhdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQpXG4gICAgICAgICAgICAgICAgJiYgdGFza0N0cmwudGFza0RhdGEucmVmZXJlbmNlICE9PSAncmVmZXJuY2VPbmx5Jykge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLm51bWJlcl9vZl9lbnRpdGllc190b19jb3B5ID0gdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMuZW50aXRpZXNfbGlzdC5zcGxpdChcIixcIikubGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEuZ2xvYmFscyAmJiB0YXNrQ3RybC50YXNrRGF0YS5nbG9iYWxzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEudGFza19nbG9iYWxzID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRhc2tDdHJsLnRhc2tEYXRhLnJlZmVyZW5jZSkge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnJlZkxpc3QgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnJlZkxpc3QgJiYgdGFza0N0cmwudGFza0RhdGEucmVmTGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEucmVmcmVzaF9yZWZlcmVuY2VfZGF0YSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLmNvcHlUYXNrKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEuY29weSA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQpe1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGVkX3ZlcnNpb25fdGFza19uYW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RlZF92ZXJzaW9uX2RhdGV0aW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RlZF92ZXJzaW9uX3Rhc2tfZXhlX2lkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RlZF9yZWZfdmVyc2lvbl90YXNrX25hbWUgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGVkX3JlZl92ZXJzaW9uX2RhdGV0aW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RlZF9yZWZfdmVyc2lvbl90YXNrX2V4ZV9pZCA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHRhc2tDdHJsLnRhc2tEYXRhLmxvZ2ljYWxVbml0cyA9IF8ubWFwKHRhc2tDdHJsLmxvZ2ljYWxVbml0cyxpdCA9PiB7XG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgXCJsdV9wYXJlbnRfbmFtZVwiOiBpdC5sdV9wYXJlbnRfbmFtZSxcbiAgICAgICAgICAgIC8vICAgICAgICAgXCJsdV9uYW1lXCI6IGl0Lmx1X25hbWUsXG4gICAgICAgICAgICAvLyAgICAgICAgIFwibHVfaWRcIjogaXQubHVfaWQsICAgICAgICAgXG4gICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgLy8gfSk7XG4gICAgICAgICAgICAvLyBpZiAodGFza0N0cmwucG9zdEV4ZWN1dGlvblByb2Nlc3Nlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAvLyAgICAgdGFza0N0cmwudGFza0RhdGEucG9zdEV4ZWN1dGlvblByb2Nlc3NlcyA9IF8ubWFwKF8uZmlsdGVyKHRhc2tDdHJsLmFsbFBvc3RFeGVjdXRpb25Qcm9jZXNzLCB2ID0+IHRhc2tDdHJsLnBvc3RFeGVjdXRpb25Qcm9jZXNzZXMuaW5kZXhPZih2LnByb2Nlc3NfaWQpID49IDApLGl0ID0+IHtcbiAgICAgICAgICAgIC8vICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIFwicHJvY2Vzc19pZFwiOiBpdC5wcm9jZXNzX2lkLFxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgXCJwcm9jZXNzX25hbWVcIjogaXQucHJvY2Vzc19uYW1lLFxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgXCJleGVjdXRpb25fb3JkZXJcIjogaXQuZXhlY3V0aW9uX29yZGVyICAgICAgICBcbiAgICAgICAgICAgIC8vICAgICAgICAgfVxuICAgICAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gZWxzZSB7XG4gICAgICAgICAgICAvLyAgICAgdGFza0N0cmwudGFza0RhdGEucG9zdEV4ZWN1dGlvblByb2Nlc3NlcyA9IFtdO1xuICAgICAgICAgICAgLy8gfVxuXG5cbiAgICAgICAgICAgIFRETVNlcnZpY2UudXBkYXRlVGFzayh0YXNrQ3RybC50YXNrRGF0YSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5jb3B5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLnBvc3RUYXNrTG9naWNhbFVuaXRzKHJlc3BvbnNlLnJlc3VsdC5pZCwgdGFza0N0cmwudGFza0RhdGEudGFza190aXRsZSwge2xvZ2ljYWxVbml0czogdGFza0N0cmwubG9naWNhbFVuaXRzfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhcIlRhc2sgIyBcIiArIHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdGl0bGUsIFwiIElzIFVwZGF0ZWQgU3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCd0YXNrcycsIHt9LCB7cmVsb2FkOiB0cnVlfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJUYXNrICMgXCIgKyB0YXNrQ3RybC50YXNrRGF0YS50YXNrX2lkLCBcIiBGYWlsZWQgdG8gVXBkYXRlIDogXCIgKyByZXNwb25zZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXNrQ3RybC5wb3N0RXhlY3V0aW9uUHJvY2Vzc2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFRETVNlcnZpY2UucG9zdFRhc2tQb3N0RXhlY3V0aW9uUHJvY2VzcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5yZXN1bHQuaWQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdGl0bGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtwb3N0ZXhlY3V0aW9ucHJvY2Vzc2VzIDpfLmZpbHRlcih0YXNrQ3RybC5hbGxQb3N0RXhlY3V0aW9uUHJvY2VzcywgdiA9PiB0YXNrQ3RybC5wb3N0RXhlY3V0aW9uUHJvY2Vzc2VzLmluZGV4T2Yodi5wcm9jZXNzX2lkKSA+PSAwKX0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSAhPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiVGFzayAjIFwiICsgY3JlYXRlVGFza1Jlc3VsdC5pZCwgXCIgRmFpbGVkIHRvIFVwZGF0ZSBQb3N0IEV4ZWN1dGlvbiBQcm9jZXNzZXM6IFwiICsgcmVzcG9uc2UubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIlRhc2sgIyBcIiArIHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfaWQsIFwiIEZhaWxlZCB0byBVcGRhdGUgOiBcIiArIHJlc3BvbnNlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRhc2tDdHJsLmRlbGV0ZVRhc2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBURE1TZXJ2aWNlLmRlbGV0ZVRhc2sodGFza0N0cmwudGFza0RhdGEpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhcIlRhc2sgIyBcIiArIHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfaWQsIFwiZGVsZXRlZCBTdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jb250ZW50Lm9wZW5UYXNrcyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgNDAwKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIlRhc2sgIyBcIiArIHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfaWQsIFwiZmFpbGVkIHRvIGRlbGV0ZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBidWlsZFN1YlF1ZXJ5KHJ1bGUpIHtcbiAgICAgICAgICAgIHZhciBmaWVsZCA9IFwiXFxcIlwiICsgcnVsZS5maWVsZCArIFwiXFxcIlwiO1xuICAgICAgICAgICAgbGV0IGNvbmRpdGlvbiA9IHJ1bGUuY29uZGl0aW9uO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBcIidcIiArIHJ1bGUuZGF0YSArIFwiJ1wiO1xuICAgICAgICAgICAgaWYgKHJ1bGUudHlwZSA9PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgZmllbGQgPSBmaWVsZCArIFwiOjpudW1lcmljW10gXCI7XG4gICAgICAgICAgICAgICAgZGF0YSA9IHJ1bGUuZGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChydWxlLmNvbmRpdGlvbiA9PT0gJ0lzIG51bGwnIHx8IHJ1bGUuY29uZGl0aW9uID09PSAnSXMgbm90IG51bGwnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiKCBcIiArIGZpZWxkICsgXCIgXCIgKyBjb25kaXRpb24gKyBcIiApXCI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIiggXCIgKyBkYXRhICsgXCIgXCIgKyBjb25kaXRpb24gKyBcIiBBTlkoXCIgKyBmaWVsZCArIFwiKSApXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjb21wdXRlZChncm91cCkge1xuICAgICAgICAgICAgaWYgKCFncm91cCkgcmV0dXJuIFwiXCI7XG4gICAgICAgICAgICBmb3IgKHZhciBzdHIgPSBcIihcIiwgaSA9IDA7IGkgPCBncm91cC5ydWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChncm91cC5ydWxlc1tpXS5ncm91cCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSBncm91cC5ydWxlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gY29tcHV0ZWQoZ3JvdXAucnVsZXNbaV0uZ3JvdXApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IGNvbXB1dGVkKGdyb3VwLnJ1bGVzW2ldLmdyb3VwKSArIFwiIFwiICsgZ3JvdXAucnVsZXNbaV0uZ3JvdXAub3BlcmF0b3IgKyBcIiBcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXAucnVsZXNbaV0uZGF0YSA9PT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBncm91cC5ydWxlc1tpXS5jb25kaXRpb24gIT0gXCJJcyBudWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIGdyb3VwLnJ1bGVzW2ldLmNvbmRpdGlvbiAhPSBcIklzIG5vdCBudWxsXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXAucnVsZXNbaV0udHlwZSA9PSAncmVhbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncm91cC5ydWxlc1tpXS5kYXRhLnRvTG9jYWxlU3RyaW5nKCkuaW5kZXhPZignLicpIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gZ3JvdXAucnVsZXNbaV0uZGF0YS50b0ZpeGVkKDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gZ3JvdXAucnVsZXNbaV0uZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChncm91cC5ydWxlc1tpXS50eXBlID09ICdpbnRlZ2VyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IE1hdGguZmxvb3IoZ3JvdXAucnVsZXNbaV0uZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3JvdXAucnVsZXNbaV0udHlwZSA9PSAnY29tYm8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXAucnVsZXNbaV0udmFsaWRWYWx1ZXMuaW5kZXhPZihncm91cC5ydWxlc1tpXS5kYXRhKSA8IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBncm91cC5ydWxlc1tpXS5jb25kaXRpb24gIT0gXCJJcyBudWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBncm91cC5ydWxlc1tpXS5jb25kaXRpb24gIT0gXCJJcyBub3QgbnVsbFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGdyb3VwLnJ1bGVzW2ldLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gZ3JvdXAucnVsZXNbaV0uZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSBncm91cC5ydWxlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gYnVpbGRTdWJRdWVyeShncm91cC5ydWxlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gYnVpbGRTdWJRdWVyeShncm91cC5ydWxlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gXCIgXCIgKyBncm91cC5ydWxlc1tpXS5vcGVyYXRvciArIFwiIFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHN0ciArIFwiKVwiO1xuICAgICAgICB9XG5cbiAgICAgICAgdGFza0N0cmwucGFyYW1ldGVyc0NvdW50ID0gMDtcbiAgICAgICAgJHNjb3BlLmdldEVudGl0ZXNDb3VudCA9IGZ1bmN0aW9uIChmb3JjZSkge1xuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLnF1ZXJ5X3BhcmFtZXRlcnMgPT0gXCIoKVwiKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwucGFyYW1ldGVyc0NvdW50ID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLnF1ZXJ5X3BhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5wYXJhbWV0ZXJzQ291bnQgPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZm9yY2UgJiYgdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMucXVlcnlfcGFyYW1ldGVycyA9PT0gdGFza0N0cmwucGVydmlvdXNRdWVyeVBhcmFtcyl7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFza0N0cmwucGFyYW1ldGVyc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICBxdWVyeTogdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMucXVlcnlfcGFyYW1ldGVycyxcbiAgICAgICAgICAgICAgICBlbnZJZDogdGFza0N0cmwudGFza0RhdGEuZW52aXJvbm1lbnRfaWQsXG4gICAgICAgICAgICAgICAgYmVJZDogdGFza0N0cmwudGFza0RhdGEuYmVfaWRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEuc291cmNlX2Vudl9uYW1lKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwucGFyYW1ldGVyc0NvdW50ID0gXCJpbnByb2dyZXNzXCI7XG4gICAgICAgICAgICAgICAgVERNU2VydmljZS5wb3N0R2VuZXJpY0FQSSgnYnVzaW5lc3NlbnRpdHkvJyArIHRhc2tDdHJsLnRhc2tEYXRhLmJlX2lkICsgJy9zb3VyY2VFbnYvJyArIHRhc2tDdHJsLnRhc2tEYXRhLnNvdXJjZV9lbnZfbmFtZSArICcvYW5hbHlzaXNjb3VudCcsIHt3aGVyZTogdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMucXVlcnlfcGFyYW1ldGVyc30pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnBhcmFtZXRlcnNDb3VudCA9IHJlc3BvbnNlLnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnBhcmFtZXRlcnNDb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuJHdhdGNoKCd0YXNrQ3RybC5maWx0ZXInLCBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0YXNrQ3RybC5hbmFseXNpc0NvdW50VGltZW91dCkge1xuICAgICAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0YXNrQ3RybC5hbmFseXNpc0NvdW50VGltZW91dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YXNrQ3RybC5hbmFseXNpc0NvdW50VGltZW91dCA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEuYmVfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoZWNrUnVsZSA9IGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocnVsZS5ncm91cCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja0dyb3VwKHJ1bGUuZ3JvdXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocnVsZS5jb25kaXRpb24gPT09IFwiXCIgfHwgcnVsZS5kYXRhID09PSBcIlwiIHx8IHJ1bGUuZmllbGQgPT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoZWNrR3JvdXAgPSBmdW5jdGlvbiAoZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncm91cC5vcGVyYXRvciA9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBncm91cC5ydWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGVja1J1bGUoZ3JvdXAucnVsZXNbaV0pID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlICYmIGNoZWNrR3JvdXAobmV3VmFsdWUuZ3JvdXApID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLnBhcmFtZXRlcnMgPSBKU09OLnN0cmluZ2lmeShuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnk6IGNvbXB1dGVkKG5ld1ZhbHVlLmdyb3VwKVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLnF1ZXJ5X3BhcmFtZXRlcnMgPSBxdWVyeS5xdWVyeTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0RW50aXRlc0NvdW50KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgfSwgdHJ1ZSk7XG5cbiAgICAgICAgdGFza0N0cmwuY2hlY2tNaWdyYXRlU3RhdHVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllcy5lbnRpdGllc19saXN0IHx8ICF0YXNrQ3RybC5zZWxlY3RlZFZlcnNpb25Ub0xvYWQpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllc0Zvcm0gPSAkc2NvcGUucmVxdWVzdGVkRW50aXRpZXNGb3JtO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0ZWRFbnRpdGllc0Zvcm0uc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkID0gXy5maW5kKHRhc2tDdHJsLnZlcnNpb25zRm9yTG9hZCwge2ZhYnJpY19leGVjdXRpb25faWQ6IHRhc2tDdHJsLnNlbGVjdGVkVmVyc2lvblRvTG9hZH0pO1xuICAgICAgICAgICAgdmFyIHRhc2tFeGVjdXRpb25JZCA9IFwiXCI7XG4gICAgICAgICAgICB2YXIgbHVOYW1lcyA9IFwiXCI7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkKSB7XG4gICAgICAgICAgICAgICAgdGFza0V4ZWN1dGlvbklkID0gc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkLnRhc2tfZXhlY3V0aW9uX2lkO1xuICAgICAgICAgICAgICAgIGx1TmFtZXMgPSBzZWxlY3RlZFZlcnNpb25Ub0xvYWQubHVfbmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2ZXJzaW9uX2RhdGV0aW1lID0gbmV3IERhdGUoc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkLnZlcnNpb25fZGF0ZXRpbWUpO1xuICAgICAgICAgICAgdmFyIGxvY2FsVGltZVpvbmUgPSB2ZXJzaW9uX2RhdGV0aW1lLmdldFRpbWV6b25lT2Zmc2V0KCk7XG4gICAgICAgICAgICB2ZXJzaW9uX2RhdGV0aW1lID0gdmVyc2lvbl9kYXRldGltZS5nZXRUaW1lKCkgKyBsb2NhbFRpbWVab25lICogNjAwMDA7XG4gICAgICAgICAgICBURE1TZXJ2aWNlLnBvc3RHZW5lcmljQVBJKCdjaGVja01pZ3JhdGVTdGF0dXNGb3JFbnRpdGllc0xpc3QnLCB7XG4gICAgICAgICAgICAgICAgZW50aXRsZXNMaXN0OiB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllcy5lbnRpdGllc19saXN0LFxuICAgICAgICAgICAgICAgIHRhc2tFeGVjdXRpb25JZDogdGFza0V4ZWN1dGlvbklkLFxuICAgICAgICAgICAgICAgIGx1TGlzdDogbHVOYW1lcyxcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbGVkRW50aXRpZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHJlc3BvbnNlLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdFtrZXldID09IFwiZmFsc2VcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxlZEVudGl0aWVzLnB1c2goa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmFpbGVkRW50aXRpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiRW50aXRpZXMgXCIgKyBmYWlsZWRFbnRpdGllcyArIFwiIHdlcmUgbm90IG1pZ3JhdGVkIHN1Y2Nlc3NmdWxseSBpbnRvIHRoZSBURE0gc3RvcmFnZSBieSB0aGUgc2VsZWN0ZWQgdmVyc2lvbi4gUGxlYXNlIHJlbW92ZSB0aGVtIGZyb20gdGhlIEVudGl0aWVzIExpc3Qgb3Igc2VsZWN0IGFub3RoZXIgdmVyc2lvbiBcIik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllc05leHQoJHNjb3BlLnJlcXVlc3RlZEVudGl0aWVzRm9ybSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJGYWlsZWQgdG8gY2hlY2sgTWlncmF0ZSBTdGF0dXMgRm9yIEVudGl0ZXMgTGlzdFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRhc2tDdHJsLmdldFN0ZXBzQXJyYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc3RlcHNBcnJheSA9IFtdO1xuICAgICAgICAgICAgc3RlcHNBcnJheS5wdXNoKDEpO1xuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnJlZmVyZW5jZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgc3RlcHNBcnJheS5wdXNoKDYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09ICdFWFRSQUNUJyAmJiB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RBbGxFbnRpdGVzKSAmJiB0YXNrQ3RybC50YXNrRGF0YS5yZWZlcmVuY2UgIT09ICdyZWZlcm5jZU9ubHknKSB7XG4gICAgICAgICAgICAgICAgc3RlcHNBcnJheS5wdXNoKDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfZ2xvYmFscykge1xuICAgICAgICAgICAgICAgIHN0ZXBzQXJyYXkucHVzaCg1KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PSAnTE9BRCcgJiYgIXRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kKSB8fFxuICAgICAgICAgICAgICAgICh0YXNrQ3RybC50YXNrRGF0YS50YXNrX3R5cGUgPT0gJ0VYVFJBQ1QnICYmICF0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCBcbiAgICAgICAgICAgICAgICAgICAgJiYgKCh0YXNrQ3RybC5zb3VyY2VVc2VyUm9sZSAmJiB0YXNrQ3RybC5zb3VyY2VVc2VyUm9sZS5hbGxvd2VkX3JlcXVlc3Rfb2ZfZnJlc2hfZGF0YSkgXG4gICAgICAgICAgICAgICAgICAgIHx8ICh0YXNrQ3RybC51c2VyUm9sZSAmJiB0YXNrQ3RybC51c2VyUm9sZS5hbGxvd2VkX3JlcXVlc3Rfb2ZfZnJlc2hfZGF0YSkpKSkgJiZcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5yZWZlcmVuY2UgIT09ICdyZWZlcm5jZU9ubHknKSB7XG4gICAgICAgICAgICAgICAgc3RlcHNBcnJheS5wdXNoKDMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RlcHNBcnJheS5wdXNoKDQpO1xuICAgICAgICAgICAgcmV0dXJuIHN0ZXBzQXJyYXk7XG4gICAgICAgIH1cblxuICAgICAgICB0YXNrQ3RybC5vcGVuU3RlcCA9IGZ1bmN0aW9uIChzdGVwLCB0eXBlKSB7XG4gICAgICAgICAgICBpZiAoISh0YXNrQ3RybC51c2VyUm9sZVR5cGUgPT0gJ2FkbWluJyB8fCB0YXNrQ3RybC5zb3VyY2VFbnZPd25lciAmJiB0YXNrQ3RybC50YXJnZXRFbnZPd25lcikpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RBbGxFbnRpdGVzID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGFza0N0cmwuc3RlcCA9PSAyICYmIHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PSAnTE9BRCdcbiAgICAgICAgICAgICAgICAmJiB0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCAmJiAhdGFza0N0cmwudGFza0RhdGEuc2VsZWN0QWxsRW50aXRlcykge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlID09ICdiYWNrJyAmJiB0YXNrQ3RybC50YXNrRGF0YS5yZWZlcmVuY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFza0N0cmwuc3RlcCA9IDY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzdGVwID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhc2tDdHJsLnN0ZXAgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5jaGVja01pZ3JhdGVTdGF0dXMoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYXJyYXlTdGVwcyA9IHRhc2tDdHJsLmdldFN0ZXBzQXJyYXkoKTtcbiAgICAgICAgICAgIHZhciBuZXh0U3RlcCA9IHN0ZXA7XG4gICAgICAgICAgICB2YXIgY3VycmVudEluZGV4ID0gYXJyYXlTdGVwcy5pbmRleE9mKHRhc2tDdHJsLnN0ZXApO1xuICAgICAgICAgICAgdmFyIG5leHRJbmRleCA9IGFycmF5U3RlcHMuaW5kZXhPZihzdGVwKTtcbiAgICAgICAgICAgIGlmIChuZXh0SW5kZXggPCBjdXJyZW50SW5kZXggJiYgbmV4dEluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgICBuZXh0U3RlcCA9IGFycmF5U3RlcHNbbmV4dEluZGV4XTtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gbmV4dFN0ZXA7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgPT0gJ25leHQnKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRJbmRleCA9PSBhcnJheVN0ZXBzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0aGVyZSBpcyBubyBuZXh0XCIpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbmV4dFN0ZXAgPSBhcnJheVN0ZXBzW2N1cnJlbnRJbmRleCArIDFdO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09ICdiYWNrJykge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50SW5kZXggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRoZXJlIGlzIG5vIGJhY2tcIilcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuZXh0U3RlcCA9IGFycmF5U3RlcHNbY3VycmVudEluZGV4IC0gMV07XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmICh0YXNrQ3RybC5zdGVwID09IDUpe1xuICAgICAgICAgICAgLy8gICAgIHJldHVybiB0YXNrQ3RybC5zdGVwID0gc3RlcDtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGlmIChzdGVwIDwgdGFza0N0cmwuc3RlcCB8fCB0YXNrQ3RybC5kaXNhYmxlQ2hhbmdlID09IHRydWUpIHtcbiAgICAgICAgICAgIC8vICAgICBpZiAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09ICdMT0FEJyAmJiAhdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQpe1xuICAgICAgICAgICAgLy8gICAgICAgICByZXR1cm4gdGFza0N0cmwuc3RlcCA9IHN0ZXA7XG4gICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgLy8gICAgIGVsc2UgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PSAnRVhUUkFDVCcpe1xuICAgICAgICAgICAgLy8gICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEuc2VsZWN0QWxsRW50aXRlcyB8fCB0YXNrQ3RybC50YXNrRGF0YS5yZWZlcmVuY2UgPT0gJ3JlZmVybmNlT25seScpe1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuIHRhc2tDdHJsLnN0ZXAgPSAxO1xuICAgICAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgLy8gICAgIGlmICh0YXNrQ3RybC5zdGVwID09IDQpe1xuICAgICAgICAgICAgLy8gICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEudGFza19nbG9iYWxzKXtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIHJldHVybiB0YXNrQ3RybC5zdGVwID0gNTtcbiAgICAgICAgICAgIC8vICAgICAgICAgfVxuICAgICAgICAgICAgLy8gICAgICAgICByZXR1cm4gdGFza0N0cmwuc3RlcCA9IDI7XG4gICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgLy8gICAgIGVsc2V7XG4gICAgICAgICAgICAvLyAgICAgICAgIHJldHVybiB0YXNrQ3RybC5zdGVwID0gMTtcbiAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICBpZiAodGFza0N0cmwuc3RlcCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEkc2NvcGUuZ2VuZXJhbEZvcm0uJHZhbGlkKXtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZ2VuZXJhbEZvcm0gPSAkc2NvcGUuZ2VuZXJhbEZvcm07XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZW5lcmFsRm9ybS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmdlbmVyYWxOZXh0KCRzY29wZS5nZW5lcmFsRm9ybSxuZXh0U3RlcCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC5zdGVwID09IDIpIHtcbiAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5yZXF1ZXN0ZWRFbnRpdGllc0Zvcm0uJHZhbGlkKXtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXNGb3JtID0gJHNjb3BlLnJlcXVlc3RlZEVudGl0aWVzRm9ybTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3RlZEVudGl0aWVzRm9ybS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzTmV4dCgkc2NvcGUucmVxdWVzdGVkRW50aXRpZXNGb3JtLCBmYWxzZSwgbmV4dFN0ZXApO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0ZWRFbnRpdGllc0Zvcm0uc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2tDdHJsLnN0ZXAgPT0gMyAmJiAhJHNjb3BlLnJlcXVlc3RQYXJhbWV0ZXJzRm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5yZXF1ZXN0UGFyYW1ldGVyc0Zvcm0gPSAkc2NvcGUucmVxdWVzdFBhcmFtZXRlcnNGb3JtO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0UGFyYW1ldGVyc0Zvcm0uc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2tDdHJsLnN0ZXAgPT0gNCAmJiAhJHNjb3BlLmV4ZWN1dGlvblRpbWluZ0Zvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuZXhlY3V0aW9uVGltaW5nRm9ybSA9ICRzY29wZS5leGVjdXRpb25UaW1pbmdGb3JtO1xuICAgICAgICAgICAgICAgICRzY29wZS5leGVjdXRpb25UaW1pbmdGb3JtLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC5zdGVwID09IDYgJiYgICEkc2NvcGUuUmVmZXJlbmNlRm9ybS4kdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuUmVmZXJlbmNlRm9ybS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlZmVyZW5jZU5leHQobmV4dFN0ZXApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGFza0N0cmwuc3RlcCA9PSA1KSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuZ2xvYmFsc05leHQobmV4dFN0ZXApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhc2tDdHJsLnN0ZXAgPSBuZXh0U3RlcDtcblxuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnN0ZXAgPT0gMSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZW5lcmFsRm9ybS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC5zdGVwID09IDIpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0RW50aXRlc0NvdW50KCk7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwudXBkYXRlUGFyYW1zKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3BhcmFtZXRlcnMgbG9hZGVkJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3RlZEVudGl0aWVzRm9ybS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC5zdGVwID09IDMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVxdWVzdFBhcmFtZXRlcnNGb3JtLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2tDdHJsLnN0ZXAgPT0gNCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5leGVjdXRpb25UaW1pbmdGb3JtLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdGFza0N0cmwuZ2VuZXJhbE5leHQgPSBmdW5jdGlvbiAoZm9ybSwgbmV4dFN0ZXApIHtcbiAgICAgICAgICAgIC8vIGdhcCBjYW4gaGFwcGVuIGluIGF0IGxlYXN0IDIgTFVzXG4gICAgICAgICAgICBpZiAodGFza0N0cmwuaXNGbHV4TW9kZSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZW5lcmFsRm9ybS50YXNrTG9naWNhbFVuaXQuJHNldFZhbGlkaXR5KCdnYXAnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2VuZXJhbEZvcm0udGFza0xvZ2ljYWxVbml0LiRzZXRWYWxpZGl0eSgnbWlzc2luZ1BhcmVudCcsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBsb2dpY2FsIHVuaXQgbmFtZSBoYXMgYmVlbiBzZWxlY3RlZFxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSBsdV9uYW1lXG4gICAgICAgICAgICAgICAgICogQHJldHVybnMgeyp9XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgbGV0IGlzU2VsZWN0ZWRMVSA9IChsdV9uYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfLmZpbmQodGFza0N0cmwubG9naWNhbFVuaXRzLCB7bHVfbmFtZTogbHVfbmFtZX0pXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGxldCBjaGVja0dhcCA9IGx1ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGx1Lmx1X3BhcmVudF9uYW1lICYmICFpc1NlbGVjdGVkTFUobHUubHVfcGFyZW50X25hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIElmIGEgbG9naWNhbCB1bml0IGhhcyBhIHBhcmVudCBhbmQgaXQgaGFzIG5vdCBiZWluZyBzZWxlY3RlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICogdGhlbiB0aGlzIGlzIHRoZSBvbmx5IGNoYW5jZSB0aGF0IHdlIG1pZ2h0IGhhdmUgYSBnYXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBUaGUgZ2FwIHdpbGwgb2NjdXIgaWYgdGhlIGx1IHBhcmVudCBuYW1lIHRoYXQgaXMgbWlzc2luZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICogaGFzIGEgcGFyZW50IHdoaWNoIGlzIG5vdCBtaXNzaW5nLiBUaGlzIHdpbGwgZ2VuZXJhdGUgYSBnYXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbHVQYXJlbnQgPSBfLmZpbmQodGFza0N0cmwuYWxsTG9naWNhbFVuaXRzLCB7bHVfbmFtZTogbHUubHVfcGFyZW50X25hbWV9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsdVBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsdVBhcmVudC5sdV9wYXJlbnRfbmFtZSAmJiBpc1NlbGVjdGVkTFUobHVQYXJlbnQubHVfcGFyZW50X25hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZW5lcmFsRm9ybS50YXNrTG9naWNhbFVuaXQuJHNldFZhbGlkaXR5KCdnYXAnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLm1pc3NpbmdVbml0SW5HYXAgPSBsdVBhcmVudC5sdV9uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBsZXQgY2hlY2tJZlJvb3RJc01pc3NpbmcgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZW5lcmFsRm9ybS50YXNrTG9naWNhbFVuaXQuJHNldFZhbGlkaXR5KCdtaXNzaW5nUGFyZW50JywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLm1pc3NpbmdSb290TFUgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGVyZSBpcyBsdSB3aGljaCBoYXMgYSBwYXJlbnQgdGhhdCBkb2VzIG5vdCBoYXZlIGEgcGFyZW50IChyb290KVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGx1IG9mIHRhc2tDdHJsLmxvZ2ljYWxVbml0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGx1Lmx1X3BhcmVudF9uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbHVQYXJlbnQgPSBfLmZpbmQodGFza0N0cmwuYWxsTG9naWNhbFVuaXRzLCB7bHVfbmFtZTogbHUubHVfcGFyZW50X25hbWV9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobHVQYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgbHUgaGFzIGEgcGFyZW50IHRoYXQgZG9lcyBub3QgaGF2ZSBhIHBhcmVudCB3aGljaCBpcyBtaXNzaW5nIHRoZW4gcm9vdCBpcyBtaXNzaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbHVQYXJlbnQubHVfcGFyZW50X25hbWUgJiYgIWlzU2VsZWN0ZWRMVShsdVBhcmVudC5sdV9uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdlbmVyYWxGb3JtLnRhc2tMb2dpY2FsVW5pdC4kc2V0VmFsaWRpdHkoJ21pc3NpbmdQYXJlbnQnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5taXNzaW5nUm9vdExVLnB1c2gobHVQYXJlbnQubHVfbmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmICh0YXNrQ3RybC5sb2dpY2FsVW5pdHMgJiYgdGFza0N0cmwubG9naWNhbFVuaXRzLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5sb2dpY2FsVW5pdHMuZm9yRWFjaChsdSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEucmVmZXJlbmNlICE9PSAncmVmZXJuY2VPbmx5Jyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tHYXAobHUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrSWZSb290SXNNaXNzaW5nKGx1KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBpZiAoZm9ybS4kdmFsaWQgfHwgdGFza0N0cmwuZGlzYWJsZUNoYW5nZSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNiID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gbmV4dFN0ZXAgfHwgMjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodGFza0N0cmwudXNlclJvbGVUeXBlID09ICdhZG1pbicgfHwgdGFza0N0cmwuc291cmNlRW52T3duZXIgJiYgdGFza0N0cmwudGFyZ2V0RW52T3duZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RBbGxFbnRpdGVzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHNvdXJjZUVudiA9IF8uZmluZCh0YXNrQ3RybC5hbGxTb3VyY2VFbnZpcm9ubWVudHMsIHtlbnZpcm9ubWVudF9pZDogdGFza0N0cmwudGFza0RhdGEuc291cmNlX2Vudmlyb25tZW50X2lkfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VFbnYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnNvdXJjZV9lbnZfbmFtZSA9IHNvdXJjZUVudi5lbnZpcm9ubWVudF9uYW1lO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdEFsbEVudGl0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09IFwiRVhUUkFDVFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfZ2xvYmFscyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnN0ZXAgPSBuZXh0U3RlcCB8fCA1O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCB8fCAhdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIXRhc2tDdHJsLnVzZXJSb2xlIHx8IXRhc2tDdHJsLnVzZXJSb2xlLmFsbG93ZWRfcmVxdWVzdF9vZl9mcmVzaF9kYXRhKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIXRhc2tDdHJsLnNvdXJjZVVzZXJSb2xlIHx8ICF0YXNrQ3RybC5zb3VyY2VVc2VyUm9sZS5hbGxvd2VkX3JlcXVlc3Rfb2ZfZnJlc2hfZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gbmV4dFN0ZXAgfHwgNDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnN0ZXAgPSBuZXh0U3RlcCB8fCAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEucmVmZXJlbmNlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnN0ZXAgPSBuZXh0U3RlcCB8fCA2O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09PSAnTE9BRCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudXBkYXRlUGFyYW1zKGNiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgY2IuYXBwbHkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvcm0uc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhc2tDdHJsLmdlbmVyYWxGb3JtID0gZm9ybTtcbiAgICAgICAgfTtcblxuICAgICAgICBcbiAgICAgICAgdGFza0N0cmwuc3VibWl0Rm9ybT1mdW5jdGlvbihzdGVwLG5leHRTdGVwKXtcbiAgICAgICAgICAgIGNvbnN0IHN0ZXBzID0gdGFza0N0cmwuZ2V0U3RlcHNBcnJheSgpO1xuICAgICAgICAgICAgaWYgKHN0ZXAgPT09IG5leHRTdGVwKXtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3RlcHMuaW5kZXhPZihzdGVwKSA+IHN0ZXBzLmluZGV4T2YobmV4dFN0ZXApKXtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5vcGVuU3RlcChuZXh0U3RlcCwnYmFjaycpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaChzdGVwKXtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZW5lcmFsRm9ybS4kc2V0U3VibWl0dGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmdlbmVyYWxOZXh0KCRzY29wZS5nZW5lcmFsRm9ybSxuZXh0U3RlcCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVxdWVzdGVkRW50aXRpZXNGb3JtLiRzZXRTdWJtaXR0ZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXNOZXh0KCRzY29wZS5yZXF1ZXN0ZWRFbnRpdGllc0Zvcm0sIHVuZGVmaW5lZCwgbmV4dFN0ZXApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3RQYXJhbWV0ZXJzRm9ybS4kc2V0U3VibWl0dGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RQYXJhbWV0ZXJzTmV4dCgkc2NvcGUucmVxdWVzdFBhcmFtZXRlcnNGb3JtKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5leGVjdXRpb25UaW1pbmdGb3JtLiRzZXRTdWJtaXR0ZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZXhlY3V0aW9uVGltaW5nRmluaXNoKCRzY29wZS5leGVjdXRpb25UaW1pbmdGb3JtKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLkFkZEdsb2JhbEZvcm0uJHNldFN1Ym1pdHRlZCgpO1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5nbG9iYWxzTmV4dChuZXh0U3RlcClcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5SZWZlcmVuY2VGb3JtLiRzZXRTdWJtaXR0ZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwucmVmZXJlbmNlTmV4dChuZXh0U3RlcClcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRhc2tDdHJsLnJlZmVyZW5jZU5leHQgPSBmdW5jdGlvbiAobmV4dFN0ZXApIHtcbiAgICAgICAgICAgIGlmIChfLmZpbHRlcih0YXNrQ3RybC50YXNrRGF0YS5yZWZMaXN0LCB7c2VsZWN0ZWQ6IHRydWV9KS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlZmVyZW5jZVRhYkVycm9yID0gJ1BsZWFzZSBTZWxlY3QgUmVmZXJlbmNlIFRhYmxlJztcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YXNrQ3RybC5yZWZlcmVuY2VUYWJFcnJvciA9ICcnO1xuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfZ2xvYmFscykge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnN0ZXAgPSBuZXh0U3RlcCB8fCA1O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGFza0N0cmwudGFza0RhdGEucmVmZXJlbmNlICE9PSAncmVmZXJuY2VPbmx5Jykge1xuICAgICAgICAgICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS50YXNrX3R5cGUgPT0gXCJFWFRSQUNUXCIgJiYgdGFza0N0cmwudGFza0RhdGEuc2VsZWN0QWxsRW50aXRlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwIHx8IDM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0YXNrQ3RybC5zdGVwID0gbmV4dFN0ZXAgfHwgMjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwIHx8IDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllc05leHQgPSBmdW5jdGlvbiAoZm9ybSwgbWlncmF0ZWQsIG5leHRTdGVwKSB7XG4gICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09PSAnTE9BRCdcbiAgICAgICAgICAgICAgICAmJiB0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCAmJiAhdGFza0N0cmwudGFza0RhdGEuc2VsZWN0QWxsRW50aXRlcyAmJiAhbWlncmF0ZWQpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5jaGVja01pZ3JhdGVTdGF0dXMoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0YXNrQ3RybC5pc0ZsdXhNb2RlICYmXG4gICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09PSAnTE9BRCcgJiYgIXRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kICYmXG4gICAgICAgICAgICAgICAgKHRhc2tDdHJsLnNlbGVjdEZpZWxkVHlwZSA9PT0gJ3N5bnRoZXRpYycgfHwgdGFza0N0cmwuc2VsZWN0RmllbGRUeXBlID09PSAncGFyYW1ldGVycycpXG4gICAgICAgICAgICApIHtcblxuICAgICAgICAgICAgICAgICRzY29wZS5MVXNNaXNzaW5nUGFyZW50ID0gW107XG5cbiAgICAgICAgICAgICAgICBmb3IgKGx1IG9mIHRhc2tDdHJsLmxvZ2ljYWxVbml0cykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobHUubHVfcGFyZW50X25hbWUgJiYgIV8uZmluZCh0YXNrQ3RybC5sb2dpY2FsVW5pdHMsIHtsdV9uYW1lOiBsdS5sdV9wYXJlbnRfbmFtZX0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuTFVzTWlzc2luZ1BhcmVudC5wdXNoKGx1Lmx1X25hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0ZWRFbnRpdGllc0Zvcm0uJHNldFZhbGlkaXR5KCdtaXNzaW5nUGFyZW50JywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLkxVc01pc3NpbmdQYXJlbnQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVxdWVzdGVkRW50aXRpZXNGb3JtLiRzZXRWYWxpZGl0eSgnbWlzc2luZ1BhcmVudCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnNlbGVjdEZpZWxkVHlwZSA9PT0gJ2dpdmVuJyAmJiB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllcyAmJiB0eXBlb2YgdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMuZW50aXRpZXNfbGlzdCA9PT0gJ3N0cmluZydcbiAgICAgICAgICAgICAgICAmJiB0YXNrQ3RybC50YXNrRGF0YS5lbnRpdHlfZXhjbHVzaW9uX2xpc3QgPT0gdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMuZW50aXRpZXNfbGlzdCkge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmVycm9yTGlzdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKCFmb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBmb3JtLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzRm9ybSA9IGZvcm07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGFza0N0cmwuZW5pdGl0ZXNMaXN0Tm90UGFzc2VkRXhjbHVzaW9uTGlzdCA9IGZhbHNlO1xuICAgICAgICAgICAgdGFza0N0cmwuZW5pdGl0ZXNMaXN0RmFpbGVkUGF0dGVyblRlc3QgPSBmYWxzZTtcblxuICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PT0gXCJMT0FEXCIgJiYgIXRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kICYmXG4gICAgICAgICAgICAgICAgdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMuZW50aXRpZXNfbGlzdCAmJiB0eXBlb2YgdGFza0N0cmwudGFza0RhdGEuZW50aXR5X2V4Y2x1c2lvbl9saXN0ID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgICAgICYmIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLmVudGl0eV9leGNsdXNpb25fbGlzdCA9IHRhc2tDdHJsLnRhc2tEYXRhLmVudGl0eV9leGNsdXNpb25fbGlzdC5yZXBsYWNlKC9cXHMvZywgJycpOyAvL3JlbW92ZSBzcGFjZXNcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC50YXNrRGF0YS5lbnRpdHlfZXhjbHVzaW9uX2xpc3QgPSB0YXNrQ3RybC50YXNrRGF0YS5lbnRpdHlfZXhjbHVzaW9uX2xpc3QucmVwbGFjZSgvXFxyP1xcbnxcXHIvZywgJycpOyAvL3JlbW92ZSBuZXcgbGluZXNcbiAgICAgICAgICAgICAgICBpZiAoIXRhc2tDdHJsLmVudGl0aWVzUGF0dGVybi50ZXN0KHRhc2tDdHJsLnRhc2tEYXRhLmVudGl0eV9leGNsdXNpb25fbGlzdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZW5pdGl0ZXNFeGNsdXNpb25MaXN0UGF0dGVyblRlc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIC8vY2hlY2sgaWYgdGhlIGN1cnJlbnQgXCJlbnRpdGllcyBMaXN0XCIgaW5jbHVkZXMgYW55dGhpbmcgZnJvbSB0aGUgZXhjbHVzaW9uIGxpc3Qgd2UgZGVmaW5lZCBiZWZvcmUuXG4gICAgICAgICAgICBpZiAodGFza0N0cmwuc2VsZWN0RmllbGRUeXBlID09ICdnaXZlbicgJiYgdHlwZW9mIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QgPT09ICdzdHJpbmcnICYmIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QgPSB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllcy5lbnRpdGllc19saXN0LnJlcGxhY2UoL1xccy9nLCAnJyk7IC8vcmVtb3ZlIHNwYWNlc1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QgPSB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllcy5lbnRpdGllc19saXN0LnJlcGxhY2UoL1xccj9cXG58XFxyL2csICcnKTsgLy9yZW1vdmUgbmV3IGxpbmVzXG4gICAgICAgICAgICAgICAgdmFyIGVudGl0aWVzUGF0dGVybiA9IHRhc2tDdHJsLmVudGl0aWVzUGF0dGVybjtcbiAgICAgICAgICAgICAgICBpZiAoISh0YXNrQ3RybC50YXNrRGF0YS50YXNrX3R5cGUgPT0gXCJMT0FEXCIgJiYgIXRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kKSkge1xuICAgICAgICAgICAgICAgICAgICBlbnRpdGllc1BhdHRlcm4gPSBuZXcgUmVnRXhwKFwiXigoXFxcXHd8LSkrKD86LChcXFxcd3wtKSspezAsXCIgKyAoKHRhc2tDdHJsLm1heFRvQ29weSB8fCAxMDAwMDAwMDAwKSAtIDEpICsgXCJ9KT8kXCIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlbnRpdGllc1BhdHRlcm4udGVzdCh0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllcy5lbnRpdGllc19saXN0KSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09IFwiTE9BRFwiICYmICF0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy92YWxpZGF0ZSBhZ2FpbnN0IGV4Y2x1c2lvbiBsaXN0LiBBcyB3ZSBhcmUgdXNpbmcgc2FtZSBleGNsdXNpb24gbGlzdCB2YWxpZGF0aW9uIG1ldGhvZCwgd2UgcHJlcGFyZSBvYmplY3QgZm9yIHZhbGlkYXRpb24gdGhhdCBjb250YWlucyB0aGUgbmFtZXMgdGhhdCB0aGUgQmFja0VuZCBFeHBlY3RzLlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGFGb3JWYWxpZGF0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhRm9yVmFsaWRhdGlvbi5leGNsdXNpb25fbGlzdCA9IHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhRm9yVmFsaWRhdGlvbi5iZV9pZCA9IHRhc2tDdHJsLnRhc2tEYXRhLmJlX2lkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLnBvc3RFbnZFeGNsdXNpb25MaXN0VmFsaWRhdGVMaXN0KHRhc2tDdHJsLnRhc2tEYXRhLmVudmlyb25tZW50X2lkLCBkYXRhRm9yVmFsaWRhdGlvbikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlID09IFwiU1VDQ0VTU1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZW5pdGl0ZXNMaXN0Tm90UGFzc2VkRXhjbHVzaW9uTGlzdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5leGlzdGluZ0VudGl0aWVzSW5FeGNsdXNpb25MaXN0TWVtYmVycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZS5yZXN1bHQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5leGlzdGluZ0VudGl0aWVzSW5FeGNsdXNpb25MaXN0TWVtYmVycy5wdXNoKHJlc3BvbnNlLnJlc3VsdFtpXS51bm5lc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugey8vTm8gZXhjbHVzaW9ucyBmb3VuZCwgY29udGludWUgdG8gc3RlcCAzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZXJyb3JMaXN0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybS4kdmFsaWQgfHwgdGFza0N0cmwuZGlzYWJsZUNoYW5nZSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfZ2xvYmFscykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gbmV4dFN0ZXAgfHwgNTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gbmV4dFN0ZXAgfHwgMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzRm9ybSA9IGZvcm07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJVbmFibGUgdG8gZXhlY3V0ZSB2YWxpZGF0aW9uIGFnYWluc3QgRXhjbHVzaW9uIExpc3RcIiArIHJlc3BvbnNlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZXJyb3JMaXN0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybS4kdmFsaWQgfHwgdGFza0N0cmwuZGlzYWJsZUNoYW5nZSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfZ2xvYmFscykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gbmV4dFN0ZXAgfHwgNTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICBlbHNlIGlmICgodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09IFwiRVhUUkFDVFwiIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PSBcIkxPQURcIikgJiYgdGFza0N0cmwudGFza0RhdGEudmVyc2lvbl9pbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwIHx8IDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgZWxzZSBpZiAodGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09IFwiRVhUUkFDVFwiICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICghdGFza0N0cmwudXNlclJvbGUgfHwhdGFza0N0cmwudXNlclJvbGUuYWxsb3dlZF9yZXF1ZXN0X29mX2ZyZXNoX2RhdGEpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICghdGFza0N0cmwuc291cmNlVXNlclJvbGUgfHwgIXRhc2tDdHJsLnNvdXJjZVVzZXJSb2xlLmFsbG93ZWRfcmVxdWVzdF9vZl9mcmVzaF9kYXRhIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwIHx8IDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwIHx8IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5yZXF1ZXN0ZWRFbnRpdGllc0Zvcm0gPSBmb3JtO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgLy9wYXR0ZXJuIHZhbGlkYXRpb24gZGlkbid0IHBhc3NcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZW5pdGl0ZXNMaXN0RmFpbGVkUGF0dGVyblRlc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGFza0N0cmwuc2VsZWN0RmllbGRUeXBlID09ICdzeW50aGV0aWMnICYmIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLnN5bnRoZXRpYykge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhRm9yVmFsaWRhdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgIGRhdGFGb3JWYWxpZGF0aW9uLmV4Y2x1c2lvbl9saXN0ID0gdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMuc3ludGhldGljO1xuICAgICAgICAgICAgICAgIGRhdGFGb3JWYWxpZGF0aW9uLmJlX2lkID0gdGFza0N0cmwudGFza0RhdGEuYmVfaWQ7XG4gICAgICAgICAgICAgICAgVERNU2VydmljZS5wb3N0RW52RXhjbHVzaW9uTGlzdFZhbGlkYXRlTGlzdCh0YXNrQ3RybC50YXNrRGF0YS5lbnZpcm9ubWVudF9pZCwgZGF0YUZvclZhbGlkYXRpb24pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmVuaXRpdGVzTGlzdE5vdFBhc3NlZEV4Y2x1c2lvbkxpc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmV4aXN0aW5nRW50aXRpZXNJbkV4Y2x1c2lvbkxpc3RNZW1iZXJzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZS5yZXN1bHQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZXhpc3RpbmdFbnRpdGllc0luRXhjbHVzaW9uTGlzdE1lbWJlcnMucHVzaChyZXNwb25zZS5yZXN1bHRbaV0udW5uZXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsvL05vIGV4Y2x1c2lvbnMgZm91bmQsIGNvbnRpbnVlIHRvIHN0ZXAgMy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5lcnJvckxpc3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybS4kdmFsaWQgfHwgdGFza0N0cmwuZGlzYWJsZUNoYW5nZSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS50YXNrX2dsb2JhbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnN0ZXAgPSBuZXh0U3RlcCB8fCA1O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwIHx8IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzRm9ybSA9IGZvcm07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJVbmFibGUgdG8gZXhlY3V0ZSB2YWxpZGF0aW9uIGFnYWluc3QgRXhjbHVzaW9uIExpc3RcIiArIHJlc3BvbnNlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Ugey8vY29udGludWUgdG8gc3RlcCAzLlxuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmVycm9yTGlzdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChmb3JtLiR2YWxpZCB8fCB0YXNrQ3RybC5kaXNhYmxlQ2hhbmdlID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfZ2xvYmFscykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwIHx8IDU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PSBcIkVYVFJBQ1RcIiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09IFwiTE9BRFwiKSAmJiB0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwIHx8IDQ7XG4gICAgICAgICAgICAgICAgICAgIH0gIGVsc2UgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PSBcIkVYVFJBQ1RcIiAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIXRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICghdGFza0N0cmwudXNlclJvbGUgfHwhdGFza0N0cmwudXNlclJvbGUuYWxsb3dlZF9yZXF1ZXN0X29mX2ZyZXNoX2RhdGEpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIXRhc2tDdHJsLnNvdXJjZVVzZXJSb2xlIHx8ICF0YXNrQ3RybC5zb3VyY2VVc2VyUm9sZS5hbGxvd2VkX3JlcXVlc3Rfb2ZfZnJlc2hfZGF0YSApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwIHx8IDQ7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gbmV4dFN0ZXAgfHwgMztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm0uc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXNGb3JtID0gZm9ybTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgXG4gICAgICAgIH07XG5cbiAgICAgICAgdGFza0N0cmwuZ2xvYmFsc05leHQgPSBmdW5jdGlvbiAobmV4dFN0ZXApIHtcbiAgICAgICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS52ZXJzaW9uX2luZCB8fCB0YXNrQ3RybC50YXNrRGF0YS5yZWZlcmVuY2UgPT09ICdyZWZlcm5jZU9ubHknKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IG5leHRTdGVwIHx8IDQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnN0ZXAgPSBuZXh0U3RlcCB8fCAzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIFxuICAgICAgICB0YXNrQ3RybC5pbml0UmVmZXJlbmNlRm9ybSA9IChSZWZlcmVuY2VGb3JtKSA9PiB7XG4gICAgICAgICAgICAkc2NvcGUuUmVmZXJlbmNlRm9ybSA9IFJlZmVyZW5jZUZvcm07XG4gICAgICAgIH1cbiAgICAgICAgdGFza0N0cmwucmVxdWVzdFBhcmFtZXRlcnNOZXh0ID0gZnVuY3Rpb24gKGZvcm0pIHtcbiAgICAgICAgICAgIGlmIChmb3JtLiR2YWxpZCB8fCB0YXNrQ3RybC5kaXNhYmxlQ2hhbmdlID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gNDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9ybS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFza0N0cmwucmVxdWVzdFBhcmFtZXRlcnNGb3JtID0gZm9ybTtcbiAgICAgICAgfTtcblxuICAgICAgICB0YXNrQ3RybC5leGVjdXRpb25UaW1pbmdGaW5pc2ggPSBmdW5jdGlvbiAoZm9ybSkge1xuICAgICAgICAgICAgaWYgKGZvcm0uJHZhbGlkIHx8IHRhc2tDdHJsLmRpc2FibGVDaGFuZ2UgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLmdlbmVyYWxGb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gMTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFza0N0cmwudGFza0RhdGEucmVmZXJlbmNlICYmIF8uZmlsdGVyKHRhc2tDdHJsLnRhc2tEYXRhLnJlZkxpc3QsIHtzZWxlY3RlZDogdHJ1ZX0pLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnN0ZXAgPSA2O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC50YXNrRGF0YS5yZWZlcmVuY2UgIT09ICdyZWZlcm5jZU9ubHknICYmICEkc2NvcGUucmVxdWVzdGVkRW50aXRpZXNGb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gMjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoISRzY29wZS5yZXF1ZXN0UGFyYW1ldGVyc0Zvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnN0ZXAgPSAzO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnNhdmVUYXNrKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvcm0uc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhc2tDdHJsLmV4ZWN1dGlvblRpbWluZ0Zvcm0gPSBmb3JtO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRhc2tDdHJsLmNyb25UYWJDb25maWcgPSB7XG4gICAgICAgICAgICBhbGxvd011bHRpcGxlOiB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICB0YXNrQ3RybC50b2dnbGVWZXJzaW9uID0gZnVuY3Rpb24odGFza19leGVjdXRpb25faWQpIHtcbiAgICAgICAgICAgIHRhc2tDdHJsLnZlcnNpb25zVG9nZ2xlW3Rhc2tfZXhlY3V0aW9uX2lkXSA9ICF0YXNrQ3RybC52ZXJzaW9uc1RvZ2dsZVt0YXNrX2V4ZWN1dGlvbl9pZF07XG4gICAgICAgICAgICBpZiAodGFza0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zICYmIHRhc2tDdHJsLmR0SW5zdGFuY2VWZXJzaW9ucy5yZWxvYWREYXRhKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0YXNrQ3RybC52ZXJzaW9uc1RvZ2dsZSA9IHt9O1xuICAgICAgICB0YXNrQ3RybC52ZXJzaW9uc0ZvckxvYWQgPSBbXTtcbiAgICAgICAgdGFza0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zID0ge307XG4gICAgICAgIHRhc2tDdHJsLmR0Q29sdW1uc1ZlcnNpb25zID0gW107XG4gICAgICAgIHRhc2tDdHJsLmR0Q29sdW1uRGVmc1ZlcnNpb25zID0gW107XG4gICAgICAgIHRhc2tDdHJsLmhlYWRlcnNWZXJzaW9ucyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICdjb2xsYXBzZScsXG4gICAgICAgICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICdhY3Rpb25zJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbHVtbjogJ3ZlcnNpb25fbmFtZScsXG4gICAgICAgICAgICAgICAgbmFtZTogJ1ZlcnNpb24gTmFtZScsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbHVtbjogJ3Rhc2tfaWQnLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdUYXNrIElkJyxcbiAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbHVtbjogJ3Rhc2tfbGFzdF91cGRhdGVkX2J5JyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnTGFzdCBVcGRhdGVkIEJ5JyxcbiAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbHVtbjogJ3ZlcnNpb25fdHlwZScsXG4gICAgICAgICAgICAgICAgbmFtZTogJ1ZlcnNpb24gVHlwZScsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICd2ZXJzaW9uX2RhdGV0aW1lJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnRGF0ZSBUaW1lJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnZGF0ZScsXG4gICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW46ICdsdV9uYW1lJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnTG9naWNhbCBVbml0IE5hbWUnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1uOiAnbnVtYmVyX29mX2V4dHJhY3RlZF9lbnRpdGllcycsXG4gICAgICAgICAgICAgICAgbmFtZTogJ051bWJlciBvZiBFeHRyYWN0ZWQgRW50aXRpZXMnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1uOiAncm9vdEluZGljYXRvcicsXG4gICAgICAgICAgICAgICAgbmFtZTogJ1Jvb3QgTFUnLFxuICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF07XG5cbiAgICAgICAgdmFyIGNoYW5nZVRvTG9jYWxEYXRlID0gZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwsIG1ldGEpIHtcbiAgICAgICAgICAgIHJldHVybiBtb21lbnQoZGF0YSkuZm9ybWF0KCdERCBNTU0gWVlZWSwgSEg6bW0nKVxuICAgICAgICB9O1xuXG5cbiAgICAgICAgdmFyIHJlbmRlclNlbGVjdGlvbkNvbHVtbiA9IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCBmdWxsLCBtZXRhKSB7XG4gICAgICAgICAgICBpZiAoZnVsbC5pc1Jvb3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxpbnB1dCB0eXBlPVwicmFkaW9cIiBuZy12YWx1ZT1cIlxcJycgKyBmdWxsLmZhYnJpY19leGVjdXRpb25faWQgKyAnXFwnXCIgbmFtZT1cInZlcnNpb25zVGFibGVTZWxlY3Rpb25cIiBuZy1tb2RlbD1cInRhc2tDdHJsLnNlbGVjdGVkVmVyc2lvblRvTG9hZFwiPic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH07XG4gICAgICAgIHZhciByZW5kZXJDb2xsYXBzZUNvbHVtbiA9IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCBmdWxsLCBtZXRhKSB7XG4gICAgICAgICAgICBpZiAoZnVsbC5pc1Jvb3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxhIGNsYXNzPVwidG9nZ2xlVmVyc2lvbnMgJyArICh0YXNrQ3RybC52ZXJzaW9uc1RvZ2dsZVtmdWxsLnRhc2tfZXhlY3V0aW9uX2lkXSA/ICdhY3RpdmUnIDogJycpICArICdcIiBuZy1jbGljaz1cInRhc2tDdHJsLnRvZ2dsZVZlcnNpb24oJyArIGZ1bGwudGFza19leGVjdXRpb25faWQgKyAnKVwiPjxpIGNsYXNzPVwiZmEgYXJyb3dcIj48L2k+IDwvYT4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9O1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbiA9PSAnYWN0aW9ucycpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5kdENvbHVtbnNWZXJzaW9ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4odGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbikud2l0aFRpdGxlKHRhc2tDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5uYW1lKS5yZW5kZXJXaXRoKHJlbmRlclNlbGVjdGlvbkNvbHVtbikubm90U29ydGFibGUoKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2tDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5jb2x1bW4gPT0gJ2NvbGxhcHNlJykge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmR0Q29sdW1uc1ZlcnNpb25zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbih0YXNrQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uKS53aXRoVGl0bGUodGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLm5hbWUpLnJlbmRlcldpdGgocmVuZGVyQ29sbGFwc2VDb2x1bW4pLm5vdFNvcnRhYmxlKCkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0udHlwZSA9PSAnZGF0ZScpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5kdENvbHVtbnNWZXJzaW9ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4odGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbikud2l0aFRpdGxlKHRhc2tDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5uYW1lKS5yZW5kZXJXaXRoKGNoYW5nZVRvTG9jYWxEYXRlKS5ub3RTb3J0YWJsZSgpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbiA9PSAndGFza19pZCcpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5kdENvbHVtbnNWZXJzaW9ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4odGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbikud2l0aFRpdGxlKHRhc2tDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5uYW1lKS5ub3RTb3J0YWJsZSgpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbiA9PSAndmVyc2lvbl9uYW1lJykge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmR0Q29sdW1uc1ZlcnNpb25zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbih0YXNrQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uKS53aXRoVGl0bGUodGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLm5hbWUpLm5vdFNvcnRhYmxlKCkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrQ3RybC5oZWFkZXJzVmVyc2lvbnNbaV0uY29sdW1uID09ICdyb290SW5kaWNhdG9yJyApIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5kdENvbHVtbnNWZXJzaW9ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4odGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbikud2l0aFRpdGxlKHRhc2tDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5uYW1lKS5ub3RTb3J0YWJsZSgpLm5vdFZpc2libGUoKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5kdENvbHVtbnNWZXJzaW9ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4odGFza0N0cmwuaGVhZGVyc1ZlcnNpb25zW2ldLmNvbHVtbikud2l0aFRpdGxlKHRhc2tDdHJsLmhlYWRlcnNWZXJzaW9uc1tpXS5uYW1lKS5ub3RTb3J0YWJsZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdmFyIGdldFRhYmxlRGF0YVZlcnNpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciB2ZXJzaW9uc0ZvckxvYWQgPSBbXTsgICBcbiAgICAgICAgICAgIHRhc2tDdHJsLmdyb3VwZWRTZWxlY3Rpb25zID0gbmV3IFNldCgpO1xuICAgICAgICAgICAgdmFyIHJvb3RMVXMgPSBfLmZpbHRlcih0YXNrQ3RybC5sb2dpY2FsVW5pdHMse2x1X3BhcmVudF9uYW1lIDogbnVsbH0pO1xuICAgICAgICAgICAgdGFza0N0cmwudmVyc2lvbnNGb3JMb2FkLmZvckVhY2goZnVuY3Rpb24odmVyc2lvbkZvckxvYWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoXy5maW5kKHJvb3RMVXMse2x1X25hbWU6IHZlcnNpb25Gb3JMb2FkLmx1X25hbWV9KSl7XG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb25Gb3JMb2FkLnJvb3RJbmRpY2F0b3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbkZvckxvYWQucm9vdEluZGljYXRvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodmVyc2lvbkZvckxvYWQucm9vdEluZGljYXRvciAmJiBfLmZpbmRJbmRleCh2ZXJzaW9uc0ZvckxvYWQse3Rhc2tfZXhlY3V0aW9uX2lkIDogdmVyc2lvbkZvckxvYWQudGFza19leGVjdXRpb25faWQsaXNSb290OiB0cnVlfSkgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb25Gb3JMb2FkLmlzUm9vdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb25Gb3JMb2FkLnJvb3RJbmRpY2F0b3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uc0ZvckxvYWQucHVzaCh2ZXJzaW9uRm9yTG9hZCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRhc2tDdHJsLnZlcnNpb25zVG9nZ2xlW3ZlcnNpb25Gb3JMb2FkLnRhc2tfZXhlY3V0aW9uX2lkXSkge1xuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uRm9yTG9hZC5pc1Jvb3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbnNGb3JMb2FkLnB1c2godmVyc2lvbkZvckxvYWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pOyBcbiAgICAgICAgICAgIC8vIHZhciBncm91cGVkVmVyc2lvbnMgPSBfLmdyb3VwQnkodGFza0N0cmwudmVyc2lvbnNGb3JMb2FkLCd0YXNrX2V4ZWN1dGlvbl9pZCcpO1xuICAgICAgICAgICAgLy8gZm9yICh2YXIga2V5IGluIGdyb3VwZWRWZXJzaW9ucyl7XG4gICAgICAgICAgICAvLyAgICAgdmFyIHJvb3RWZXJzaW9uRm9yTG9hZCA9IF8uZmluZChncm91cGVkVmVyc2lvbnNba2V5XSx7cm9vdF9pbmRpY2F0b3IgOiAnWVknfSk7XG4gICAgICAgICAgICAvLyAgICAgaWYgKHJvb3RWZXJzaW9uRm9yTG9hZCkge1xuICAgICAgICAgICAgLy8gICAgICAgICByb290VmVyc2lvbkZvckxvYWQubHVfbmFtZXMgPSBbcm9vdFZlcnNpb25Gb3JMb2FkLmx1X25hbWVdO1xuICAgICAgICAgICAgLy8gICAgICAgICB2ZXJzaW9uc0ZvckxvYWQucHVzaChyb290VmVyc2lvbkZvckxvYWQpO1xuICAgICAgICAgICAgLy8gICAgICAgICByb290VmVyc2lvbkZvckxvYWQuZXh0cmFjdF9lbnRpdGllc19wZXJfbHUgPSBbcm9vdFZlcnNpb25Gb3JMb2FkLm51bWJlcl9vZl9leHRyYWN0ZWRfZW50aXRpZXNdO1xuICAgICAgICAgICAgLy8gICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCBncm91cGVkVmVyc2lvbnNba2V5XS5sZW5ndGggOyBpKyspe1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIHZlcnNpb25Gb3JMb2FkID0gZ3JvdXBlZFZlcnNpb25zW2tleV1baV07XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICBpZiAodmVyc2lvbkZvckxvYWQucm9vdF9pbmRpY2F0b3IgIT09ICdZWScpe1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHJvb3RWZXJzaW9uRm9yTG9hZC5sdV9uYW1lcy5wdXNoKHZlcnNpb25Gb3JMb2FkLmx1X25hbWUpO1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHJvb3RWZXJzaW9uRm9yTG9hZC5leHRyYWN0X2VudGl0aWVzX3Blcl9sdS5wdXNoKHZlcnNpb25Gb3JMb2FkLm51bWJlcl9vZl9leHRyYWN0ZWRfZW50aXRpZXMpO1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgICAgICAvLyAgICAgICAgIHJvb3RWZXJzaW9uRm9yTG9hZC5sdV9uYW1lcyA9IHJvb3RWZXJzaW9uRm9yTG9hZC5sdV9uYW1lcy50b1N0cmluZygpO1xuICAgICAgICAgICAgLy8gICAgICAgICByb290VmVyc2lvbkZvckxvYWQuZXh0cmFjdF9lbnRpdGllc19wZXJfbHUgPSByb290VmVyc2lvbkZvckxvYWQuZXh0cmFjdF9lbnRpdGllc19wZXJfbHUudG9TdHJpbmcoKTsgICAgXG4gICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgLy8gICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gICAgICAgICBmb3IgKHZhciBpID0gMDtpIDwgZ3JvdXBlZFZlcnNpb25zW2tleV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciB2ZXJzaW9uRm9yTG9hZFRlbXAgPSBncm91cGVkVmVyc2lvbnNba2V5XVtpXTsgXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICB2ZXJzaW9uRm9yTG9hZFRlbXAubHVfbmFtZXMgPSAoW3ZlcnNpb25Gb3JMb2FkVGVtcC5sdV9uYW1lXSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZlcnNpb25Gb3JMb2FkVGVtcC5leHRyYWN0X2VudGl0aWVzX3Blcl9sdSA9IChbdmVyc2lvbkZvckxvYWRUZW1wLm51bWJlcl9vZl9leHRyYWN0ZWRfZW50aXRpZXNdKS50b1N0cmluZygpO1xuICAgICAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgICAgICAvLyAgICAgICAgIHZlcnNpb25zRm9yTG9hZCA9IHZlcnNpb25zRm9yTG9hZC5jb25jYXQoZ3JvdXBlZFZlcnNpb25zW2tleV0pO1xuICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGlmICh0YXNrQ3RybC50YXNrRGF0YS5zZWxlY3RlZF92ZXJzaW9uX3Rhc2tfZXhlX2lkKSB7XG4gICAgICAgICAgICAvLyAgICAgdmFyIHNlbGVjdGVkVmVyc2lvbiA9IF8uZmluZCh2ZXJzaW9uc0ZvckxvYWQsIHt0YXNrX2V4ZWN1dGlvbl9pZDogdGFza0N0cmwudGFza0RhdGEuc2VsZWN0ZWRfdmVyc2lvbl90YXNrX2V4ZV9pZH0pO1xuICAgICAgICAgICAgLy8gICAgIGlmIChzZWxlY3RlZFZlcnNpb24pIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgdGFza0N0cmwuc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkID0gc2VsZWN0ZWRWZXJzaW9uLmZhYnJpY19leGVjdXRpb25faWQ7XG4gICAgICAgICAgICAvLyAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIGlmICghdGFza0N0cmwuc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkICYmIHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdGVkX3ZlcnNpb25fdGFza19leGVfaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRWZXJzaW9uID0gXy5maW5kKHRhc2tDdHJsLnZlcnNpb25zRm9yTG9hZCwge3Jvb3RJbmRpY2F0b3IgOiB0cnVlLCB0YXNrX2V4ZWN1dGlvbl9pZDogdGFza0N0cmwudGFza0RhdGEuc2VsZWN0ZWRfdmVyc2lvbl90YXNrX2V4ZV9pZH0pO1xuICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZFZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuc2VsZWN0ZWRWZXJzaW9uVG9Mb2FkID0gc2VsZWN0ZWRWZXJzaW9uLmZhYnJpY19leGVjdXRpb25faWQ7XG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHZlcnNpb25zRm9yTG9hZCk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHZlcnNpb25zRm9yTG9hZCk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICB0YXNrQ3RybC5kdE9wdGlvbnNWZXJzaW9ucyA9IERUT3B0aW9uc0J1aWxkZXIuZnJvbUZuUHJvbWlzZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0VGFibGVEYXRhVmVyc2lvbnMoKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC53aXRoRE9NKCc8XCJodG1sNWJ1dHRvbnNcIkI+bFRmZ2l0cCcpXG4gICAgICAgICAgICAud2l0aE9wdGlvbignY3JlYXRlZFJvdycsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAvLyBSZWNvbXBpbGluZyBzbyB3ZSBjYW4gYmluZCBBbmd1bGFyIGRpcmVjdGl2ZSB0byB0aGUgRFRcbiAgICAgICAgICAgICAgICAkY29tcGlsZShhbmd1bGFyLmVsZW1lbnQocm93KS5jb250ZW50cygpKSgkc2NvcGUpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aXRoT3B0aW9uKCdzY3JvbGxYJywgZmFsc2UpXG4gICAgICAgICAgICAud2l0aE9wdGlvbignbGVuZ3RoQ2hhbmdlJywgZmFsc2UpXG4gICAgICAgICAgICAud2l0aE9wdGlvbigncGFnaW5nJywgZmFsc2UpXG4gICAgICAgICAgICAud2l0aEJ1dHRvbnMoW10pXG4gICAgICAgICAgICAud2l0aE9wdGlvbihcImNhc2VJbnNlbnNpdGl2ZVwiLCB0cnVlKVxuICAgICAgICAgICAgLndpdGhPcHRpb24oXCJvcmRlclwiLCAgW1sgNiwgXCJkZXNjXCIgXSxbOSwgXCJkZXNjXCJdXSlcbiAgICAgICAgICAgIC53aXRoT3B0aW9uKCdzZWFyY2gnLCB7XG4gICAgICAgICAgICAgICAgXCJjYXNlSW5zZW5zaXRpdmVcIjogZmFsc2VcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRhc2tDdHJsLmR0T3B0aW9uc1ZlcnNpb25zLndpdGhMaWdodENvbHVtbkZpbHRlcih7XG4gICAgICAgICAgICAyOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgMzoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDQ6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICA1OiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgNjoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDc6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICA4OiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRhc2tDdHJsLmdldFZlcnNpb25zRm9yTG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBlbnRpdGllc1Bhc3NlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMuZW50aXRpZXNfbGlzdCAmJiB0YXNrQ3RybC5tYXhUb0NvcHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZW50aXRpZXNQYXR0ZXJuID0gbmV3IFJlZ0V4cChcIl4oKFxcXFx3fC0pKyg/OiwoXFxcXHd8LSkrKXswLFwiICsgKCh0YXNrQ3RybC5tYXhUb0NvcHkgfHwgMTAwMDAwMDAwMCkgLSAxKSArIFwifSk/JFwiKTtcbiAgICAgICAgICAgICAgICBlbnRpdGllc1Bhc3NlZCA9IGVudGl0aWVzUGF0dGVybi50ZXN0KHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QpO1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmVuaXRpdGVzTGlzdEZhaWxlZFBhdHRlcm5UZXN0ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGFza0N0cmwudmVyc2lvbkZvckxvYWRGcm9tICYmIHRhc2tDdHJsLnZlcnNpb25Gb3JMb2FkVG8gJiZcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5sb2dpY2FsVW5pdHMgJiYgdGFza0N0cmwudGFza0RhdGEuc291cmNlX2Vudl9uYW1lXG4gICAgICAgICAgICAgICAgJiYgKHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdEFsbEVudGl0ZXMgfHxcbiAgICAgICAgICAgICAgICAgICAgKHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QgJiYgZW50aXRpZXNQYXNzZWQpKSkge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLmxvYWRpbmdUYWJsZVZlcnNpb25zID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IG5ldyBEYXRlKHRhc2tDdHJsLnZlcnNpb25Gb3JMb2FkRnJvbSk7XG4gICAgICAgICAgICAgICAgZnJvbS5zZXRIb3VycygwKTtcbiAgICAgICAgICAgICAgICBmcm9tLnNldE1pbnV0ZXMoMCk7XG4gICAgICAgICAgICAgICAgZnJvbS5zZXRTZWNvbmRzKDApO1xuICAgICAgICAgICAgICAgIHZhciB0byA9IG5ldyBEYXRlKHRhc2tDdHJsLnZlcnNpb25Gb3JMb2FkVG8pO1xuICAgICAgICAgICAgICAgIHRvLnNldEhvdXJzKDIzKTtcbiAgICAgICAgICAgICAgICB0by5zZXRNaW51dGVzKDU5KTtcbiAgICAgICAgICAgICAgICB0by5zZXRTZWNvbmRzKDU5KTtcbiAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLnBvc3RHZW5lcmljQVBJKCd0YXNrcy92ZXJzaW9uc0ZvckxvYWQnLCB7XG4gICAgICAgICAgICAgICAgICAgIGZyb21EYXRlOiBmcm9tLFxuICAgICAgICAgICAgICAgICAgICB0b0RhdGU6IHRvLFxuICAgICAgICAgICAgICAgICAgICBlbnRpdGllc0xpc3Q6IHRhc2tDdHJsLnRhc2tEYXRhLnNlbGVjdEFsbEVudGl0ZXMgPyAnJyA6IHRhc2tDdHJsLnJlcXVlc3RlZEVudGl0aWVzLmVudGl0aWVzX2xpc3QsXG4gICAgICAgICAgICAgICAgICAgIGx1X2xpc3Q6IHRhc2tDdHJsLmxvZ2ljYWxVbml0cyxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlX2Vudl9uYW1lOiB0YXNrQ3RybC50YXNrRGF0YS5zb3VyY2VfZW52X25hbWUsXG4gICAgICAgICAgICAgICAgICAgIGJlX2lkIDogdGFza0N0cmwudGFza0RhdGEuYmVfaWQsXG4gICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgb3ZlcnJpZGVSb290SW5kaWNhdG9ycyA9IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleGVjdXRpb25JZHNTZXQgPSBuZXcgU2V0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gb2YgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWV4ZWN1dGlvbklkc1NldC5oYXMoaXRlbS50YXNrX2V4ZWN1dGlvbl9pZCkgJiYgaXRlbS5yb290X2luZGljYXRvciA9PSAnWScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ucm9vdF9pbmRpY2F0b3IgPSAnWVknO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhlY3V0aW9uSWRzU2V0LmFkZChpdGVtLnRhc2tfZXhlY3V0aW9uX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtYWtlUm9vdExVc09uVG9wRm9yRWFjaEV4ZWN1dGlvbiA9IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG8gbWFrZSB0aGUgc2VsZWN0aW9uIGljb24gb24gdG9wIG9mIGV2ZXJ5IGV4ZWN1dGlvbiBncm91cFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVJvb3RMVXNPblRvcEZvckVhY2hFeGVjdXRpb24ocmVzcG9uc2UucmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluIG9yZGVyIHRvIGFsbG93IG9ubHkgb25lIHNlbGVjdGlvbiBpY29uXG4gICAgICAgICAgICAgICAgICAgICAgICBvdmVycmlkZVJvb3RJbmRpY2F0b3JzKHJlc3BvbnNlLnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnZlcnNpb25zRm9yTG9hZCA9IHJlc3BvbnNlLnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLnZlcnNpb25zRm9yTG9hZCA9IF8uc29ydEJ5KHRhc2tDdHJsLnZlcnNpb25zRm9yTG9hZCwgdmVyc2lvbiA9PiAgLTEgKiBuZXcgRGF0ZSh2ZXJzaW9uLnZlcnNpb25fZGF0ZXRpbWUpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrQ3RybC5kdEluc3RhbmNlVmVyc2lvbnMgJiYgdGFza0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tDdHJsLmxvYWRpbmdUYWJsZVZlcnNpb25zID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIk5ldyBUYXNrICMgRmFpbGVkIHRvIGdldCBWZXJzaW9ucyBmb3IgTG9hZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghdGFza0N0cmwucmVxdWVzdGVkRW50aXRpZXMuZW50aXRpZXNfbGlzdCAmJiAhdGFza0N0cmwudGFza0RhdGEuc2VsZWN0QWxsRW50aXRlcykge1xuICAgICAgICAgICAgICAgIHRhc2tDdHJsLnZlcnNpb25zRm9yTG9hZCA9IFtdO1xuICAgICAgICAgICAgICAgIGlmICh0YXNrQ3RybC5kdEluc3RhbmNlVmVyc2lvbnMgJiYgdGFza0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza0N0cmwuZHRJbnN0YW5jZVZlcnNpb25zLnJlbG9hZERhdGEoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWVudGl0aWVzUGFzc2VkKSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuZW5pdGl0ZXNMaXN0RmFpbGVkUGF0dGVyblRlc3QgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG5cbiAgICAgICAgaWYgKHRhc2tDdHJsLnRhc2tEYXRhLnRhc2tfdHlwZSA9PSAnRVhUUkFDVCcgfHwgdGFza0N0cmwudGFza0RhdGEudGFza190eXBlID09IFwiTE9BRFwiICYmIHRhc2tDdHJsLnRhc2tEYXRhLnZlcnNpb25faW5kKSB7XG4gICAgICAgICAgICB0YXNrQ3RybC50YXNrTW9kZUNoYW5nZSh0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRhc2tDdHJsLnNvdXJjZUVudmlyb25tZW50Q2hhbmdlKHRydWUsIHRydWUpO1xuXG4gICAgICAgIHRhc2tDdHJsLnJlcXVlc3RQYXJhbWV0ZXJzUHJldiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0YXNrQ3RybC50YXNrRGF0YS50YXNrX2dsb2JhbHMpIHtcbiAgICAgICAgICAgICAgICB0YXNrQ3RybC5zdGVwID0gNTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGFza0N0cmwuc3RlcCA9IDI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBCcmVhZENydW1ic1NlcnZpY2UucHVzaCh7dGFza19pZDogdGFza0N0cmwudGFza0RhdGEudGFza190aXRsZX0sICdUQVNLX0JSRUFEQ1JVTUInLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiBcIkVcIixcbiAgICAgICAgdGVtcGxhdGVVcmw6IHRlbXBsYXRlLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgY29udGVudDogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2xsZXI6IGNvbnRyb2xsZXIsXG4gICAgICAgIGNvbnRyb2xsZXJBczogJ3Rhc2tDdHJsJ1xuICAgIH07XG59XG5cblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ1RETS1GRScpXG4gICAgLmRpcmVjdGl2ZSgndGFza0RpcmVjdGl2ZScsIHRhc2tEaXJlY3RpdmUpO1xuIl19
