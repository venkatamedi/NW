function sourceEnvironmentsTableDirective(){return{restrict:"E",templateUrl:"views/soruceEnvrionments/sourceEnvironmentsTable.html",scope:{content:"="},controller:function($scope,$compile,TDMService,DTColumnBuilder,DTOptionsBuilder,$q,$timeout){var sourceEnvironmentsTableCtrl=this;sourceEnvironmentsTableCtrl.loadingTable=!0,TDMService.getGenericAPI("sourceEnvironments").then((function(response){if("SUCCESS"==response.errorCode){sourceEnvironmentsTableCtrl.environmentsData=_.sortBy(response.result,(function(value){return new Date(value.environment_creation_date)})),sourceEnvironmentsTableCtrl.environmentsData.reverse(),sourceEnvironmentsTableCtrl.dtInstance={},sourceEnvironmentsTableCtrl.dtColumns=[],sourceEnvironmentsTableCtrl.dtColumnDefs=[],sourceEnvironmentsTableCtrl.headers=[{column:"source_environment_name",name:"Name",clickAble:!0},{column:"environment_point_of_contact_first_name",name:"Contact First Name",clickAble:!1},{column:"environment_point_of_contact_last_name",name:"Contact Last Name",clickAble:!1},{column:"environment_point_of_contact_email",name:"Contact Email",clickAble:!1},{column:"environment_creation_date",name:"Creation Date",clickAble:!1,type:"date"},{column:"environment_created_by",name:"Created By",clickAble:!1},{column:"environment_last_updated_date",name:"Last Update Date",clickAble:!1,type:"date"},{column:"environment_last_updated_by",name:"Updated By",clickAble:!1},{column:"environment_status",name:"Status",clickAble:!1}];for(var clickAbleColumn=function(data,type,full,meta){return'<a ng-click="sourceEnvironmentsTableCtrl.openEnvironment('+full.source_environment_id+')">'+data+"</a>"},changeToLocalDate=function(data,type,full,meta){return data?moment(data).format("DD MMM YYYY, HH:mm"):""},i=0;i<sourceEnvironmentsTableCtrl.headers.length;i++)1==sourceEnvironmentsTableCtrl.headers[i].clickAble?sourceEnvironmentsTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(sourceEnvironmentsTableCtrl.headers[i].column).withTitle(sourceEnvironmentsTableCtrl.headers[i].name).renderWith(clickAbleColumn)):"date"==sourceEnvironmentsTableCtrl.headers[i].type?sourceEnvironmentsTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(sourceEnvironmentsTableCtrl.headers[i].column).withTitle(sourceEnvironmentsTableCtrl.headers[i].name).renderWith(changeToLocalDate)):sourceEnvironmentsTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(sourceEnvironmentsTableCtrl.headers[i].column).withTitle(sourceEnvironmentsTableCtrl.headers[i].name));var getTableData=function(){var deferred=$q.defer();return deferred.resolve(sourceEnvironmentsTableCtrl.environmentsData),deferred.promise};sourceEnvironmentsTableCtrl.dtOptions=DTOptionsBuilder.fromFnPromise((function(){return getTableData()})).withOption("aaSorting",[8,"asc"]).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("scrollX",!1).withButtons([]).withOption("caseInsensitive",!0).withOption("search",{caseInsensitive:!1}),sourceEnvironmentsTableCtrl.environmentsData&&sourceEnvironmentsTableCtrl.environmentsData.length>0&&sourceEnvironmentsTableCtrl.dtOptions.withLightColumnFilter({0:{type:"text"},1:{type:"text"},2:{type:"text"},3:{type:"text"},4:{type:"text"},5:{type:"select",values:_.map(_.unique(_.map(sourceEnvironmentsTableCtrl.environmentsData,"environment_created_by")),(function(el){return{value:el,label:el}}))},6:{type:"text"},7:{type:"select",values:_.map(_.unique(_.map(sourceEnvironmentsTableCtrl.environmentsData,"environment_last_updated_by")),(function(el){return{value:el,label:el}}))},8:{type:"select",defaultValue:"Active",values:[{value:"Inactive",label:"Inactive"},{value:"Active",label:"Active"}]}}),sourceEnvironmentsTableCtrl.dtInstanceCallback=function(dtInstance){angular.isFunction(sourceEnvironmentsTableCtrl.dtInstance)?sourceEnvironmentsTableCtrl.dtInstance(dtInstance):angular.isDefined(sourceEnvironmentsTableCtrl.dtInstance)&&(sourceEnvironmentsTableCtrl.dtInstance=dtInstance)},null!=sourceEnvironmentsTableCtrl.dtInstance.changeData&&sourceEnvironmentsTableCtrl.dtInstance.changeData(getTableData()),$timeout(()=>{sourceEnvironmentsTableCtrl.loadingTable=!1})}})),sourceEnvironmentsTableCtrl.openEnvironment=function(environmentID){if($scope.content.openEnvironment){var environmentData=_.find(sourceEnvironmentsTableCtrl.environmentsData,{source_environment_id:environmentID});if(environmentData)return void $scope.content.openEnvironment(environmentData)}},sourceEnvironmentsTableCtrl.openNewEnvironment=function(){$scope.content.openNewEnvironment&&$scope.content.openNewEnvironment(sourceEnvironmentsTableCtrl.environmentsData)}},controllerAs:"sourceEnvironmentsTableCtrl"}}angular.module("TDM-FE").directive("sourceEnvironmentsTableDirective",sourceEnvironmentsTableDirective);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvc291cmNlRW52aXJvbm1lbnQvc291cmNlRW52aXJvbm1lbnRUYWJsZURpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJzb3VyY2VFbnZpcm9ubWVudHNUYWJsZURpcmVjdGl2ZSIsInJlc3RyaWN0IiwidGVtcGxhdGVVcmwiLCJzY29wZSIsImNvbnRlbnQiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJGNvbXBpbGUiLCJURE1TZXJ2aWNlIiwiRFRDb2x1bW5CdWlsZGVyIiwiRFRPcHRpb25zQnVpbGRlciIsIiRxIiwiJHRpbWVvdXQiLCJzb3VyY2VFbnZpcm9ubWVudHNUYWJsZUN0cmwiLCJ0aGlzIiwibG9hZGluZ1RhYmxlIiwiZ2V0R2VuZXJpY0FQSSIsInRoZW4iLCJyZXNwb25zZSIsImVycm9yQ29kZSIsImVudmlyb25tZW50c0RhdGEiLCJfIiwic29ydEJ5IiwicmVzdWx0IiwidmFsdWUiLCJEYXRlIiwiZW52aXJvbm1lbnRfY3JlYXRpb25fZGF0ZSIsInJldmVyc2UiLCJkdEluc3RhbmNlIiwiZHRDb2x1bW5zIiwiZHRDb2x1bW5EZWZzIiwiaGVhZGVycyIsImNvbHVtbiIsIm5hbWUiLCJjbGlja0FibGUiLCJ0eXBlIiwiY2xpY2tBYmxlQ29sdW1uIiwiZGF0YSIsImZ1bGwiLCJtZXRhIiwic291cmNlX2Vudmlyb25tZW50X2lkIiwiY2hhbmdlVG9Mb2NhbERhdGUiLCJtb21lbnQiLCJmb3JtYXQiLCJpIiwibGVuZ3RoIiwicHVzaCIsIm5ld0NvbHVtbiIsIndpdGhUaXRsZSIsInJlbmRlcldpdGgiLCJnZXRUYWJsZURhdGEiLCJkZWZlcnJlZCIsImRlZmVyIiwicmVzb2x2ZSIsInByb21pc2UiLCJkdE9wdGlvbnMiLCJmcm9tRm5Qcm9taXNlIiwid2l0aE9wdGlvbiIsIndpdGhET00iLCJyb3ciLCJhbmd1bGFyIiwiZWxlbWVudCIsImNvbnRlbnRzIiwid2l0aEJ1dHRvbnMiLCJjYXNlSW5zZW5zaXRpdmUiLCJ3aXRoTGlnaHRDb2x1bW5GaWx0ZXIiLCIwIiwiMSIsIjIiLCIzIiwiNCIsIjUiLCJ2YWx1ZXMiLCJtYXAiLCJ1bmlxdWUiLCJlbCIsImxhYmVsIiwiNiIsIjciLCI4IiwiZGVmYXVsdFZhbHVlIiwiZHRJbnN0YW5jZUNhbGxiYWNrIiwiaXNGdW5jdGlvbiIsImlzRGVmaW5lZCIsImNoYW5nZURhdGEiLCJvcGVuRW52aXJvbm1lbnQiLCJlbnZpcm9ubWVudElEIiwiZW52aXJvbm1lbnREYXRhIiwiZmluZCIsIm9wZW5OZXdFbnZpcm9ubWVudCIsImNvbnRyb2xsZXJBcyIsIm1vZHVsZSIsImRpcmVjdGl2ZSJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsbUNBNE1MLE1BQU8sQ0FDSEMsU0FBVSxJQUNWQyxZQTVNVyx3REE2TVhDLE1BQU8sQ0FDSEMsUUFBUyxLQUViQyxXQTlNYSxTQUFVQyxPQUFPQyxTQUFTQyxXQUFXQyxnQkFBZ0JDLGlCQUFpQkMsR0FBR0MsVUFDdEYsSUFBSUMsNEJBQThCQyxLQUVsQ0QsNEJBQTRCRSxjQUFlLEVBRTNDUCxXQUFXUSxjQUFjLHNCQUFzQkMsTUFBSyxTQUFTQyxVQUN6RCxHQUEwQixXQUF0QkEsU0FBU0MsVUFBYixDQUtBTiw0QkFBNEJPLGlCQUFrQkMsRUFBRUMsT0FBT0osU0FBU0ssUUFBUSxTQUFTQyxPQUM3RSxPQUFPLElBQUlDLEtBQUtELE1BQU1FLDhCQUUxQmIsNEJBQTRCTyxpQkFBaUJPLFVBQzdDZCw0QkFBNEJlLFdBQWEsR0FDekNmLDRCQUE0QmdCLFVBQVksR0FDeENoQiw0QkFBNEJpQixhQUFlLEdBQzNDakIsNEJBQTRCa0IsUUFBVSxDQUNsQyxDQUNJQyxPQUFTLDBCQUNUQyxLQUFPLE9BQ1BDLFdBQVksR0FFaEIsQ0FDSUYsT0FBUywwQ0FDVEMsS0FBTyxxQkFDUEMsV0FBWSxHQUVoQixDQUNJRixPQUFTLHlDQUNUQyxLQUFPLG9CQUNQQyxXQUFZLEdBRWhCLENBQ0lGLE9BQVMscUNBQ1RDLEtBQU8sZ0JBQ1BDLFdBQVksR0FFaEIsQ0FDSUYsT0FBUyw0QkFDVEMsS0FB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Z0MsUUFBUXNCLFdBQVdyRSw0QkFBNEJlLFlBQy9DZiw0QkFBNEJlLFdBQVdBLFlBQ2hDZ0MsUUFBUXVCLFVBQVV0RSw0QkFBNEJlLGNBQ3JEZiw0QkFBNEJlLFdBQWFBLGFBR1EsTUFBckRmLDRCQUE0QmUsV0FBV3dELFlBQ3ZDdkUsNEJBQTRCZSxXQUFXd0QsV0FBV2xDLGdCQUVsRHRDLFNBQVMsS0FDTEMsNEJBQTRCRSxjQUFlLFFBTXZERiw0QkFBNEJ3RSxnQkFBa0IsU0FBU0MsZUFDbkQsR0FBSWhGLE9BQU9GLFFBQVFpRixnQkFBaUIsQ0FDaEMsSUFBSUUsZ0JBQWtCbEUsRUFBRW1FLEtBQUszRSw0QkFBNEJPLGlCQUFrQixDQUFDb0Isc0JBQXVCOEMsZ0JBQ25HLEdBQUlDLGdCQUVBLFlBREFqRixPQUFPRixRQUFRaUYsZ0JBQWdCRSxtQkFPM0MxRSw0QkFBNEI0RSxtQkFBcUIsV0FDekNuRixPQUFPRixRQUFRcUYsb0JBQ1huRixPQUFPRixRQUFRcUYsbUJBQW1CNUUsNEJBQTRCTyxvQkFjMUVzRSxhQUFjLCtCQUt0QjlCLFFBQ0srQixPQUFPLFVBQ1BDLFVBQVUsbUNBQW9DNUYiLCJmaWxlIjoiZGlyZWN0aXZlcy9zb3VyY2VFbnZpcm9ubWVudC9zb3VyY2VFbnZpcm9ubWVudFRhYmxlRGlyZWN0aXZlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gc291cmNlRW52aXJvbm1lbnRzVGFibGVEaXJlY3RpdmUoKXtcblxuICAgIHZhciB0ZW1wbGF0ZSA9IFwidmlld3Mvc29ydWNlRW52cmlvbm1lbnRzL3NvdXJjZUVudmlyb25tZW50c1RhYmxlLmh0bWxcIjtcblxuICAgIHZhciBjb250cm9sbGVyID0gZnVuY3Rpb24gKCRzY29wZSwkY29tcGlsZSxURE1TZXJ2aWNlLERUQ29sdW1uQnVpbGRlcixEVE9wdGlvbnNCdWlsZGVyLCRxLCR0aW1lb3V0KSB7XG4gICAgICAgIHZhciBzb3VyY2VFbnZpcm9ubWVudHNUYWJsZUN0cmwgPSB0aGlzO1xuXG4gICAgICAgIHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5sb2FkaW5nVGFibGUgPSB0cnVlO1xuXG4gICAgICAgIFRETVNlcnZpY2UuZ2V0R2VuZXJpY0FQSSgnc291cmNlRW52aXJvbm1lbnRzJykudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlICE9ICdTVUNDRVNTJyl7XG4gICAgICAgICAgICAgICAgLy9UT0RPIHNob3cgRXJyb3JcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5lbnZpcm9ubWVudHNEYXRhID1fLnNvcnRCeShyZXNwb25zZS5yZXN1bHQsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHZhbHVlLmVudmlyb25tZW50X2NyZWF0aW9uX2RhdGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzb3VyY2VFbnZpcm9ubWVudHNUYWJsZUN0cmwuZW52aXJvbm1lbnRzRGF0YS5yZXZlcnNlKCk7XG4gICAgICAgICAgICBzb3VyY2VFbnZpcm9ubWVudHNUYWJsZUN0cmwuZHRJbnN0YW5jZSA9IHt9O1xuICAgICAgICAgICAgc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmR0Q29sdW1ucyA9IFtdO1xuICAgICAgICAgICAgc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmR0Q29sdW1uRGVmcyA9IFtdO1xuICAgICAgICAgICAgc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmhlYWRlcnMgPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnc291cmNlX2Vudmlyb25tZW50X25hbWUnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ05hbWUnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGUgOiB0cnVlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdlbnZpcm9ubWVudF9wb2ludF9vZl9jb250YWN0X2ZpcnN0X25hbWUnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ0NvbnRhY3QgRmlyc3QgTmFtZScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdlbnZpcm9ubWVudF9wb2ludF9vZl9jb250YWN0X2xhc3RfbmFtZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnQ29udGFjdCBMYXN0IE5hbWUnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGUgOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnZW52aXJvbm1lbnRfcG9pbnRfb2ZfY29udGFjdF9lbWFpbCcsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnQ29udGFjdCBFbWFpbCcsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdlbnZpcm9ubWVudF9jcmVhdGlvbl9kYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdDcmVhdGlvbiBEYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdkYXRlJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnZW52aXJvbm1lbnRfY3JlYXRlZF9ieScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnQ3JlYXRlZCBCeScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdlbnZpcm9ubWVudF9sYXN0X3VwZGF0ZWRfZGF0ZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnTGFzdCBVcGRhdGUgRGF0ZScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZGF0ZSdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2Vudmlyb25tZW50X2xhc3RfdXBkYXRlZF9ieScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnVXBkYXRlZCBCeScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdlbnZpcm9ubWVudF9zdGF0dXMnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ1N0YXR1cycsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgdmFyIGNsaWNrQWJsZUNvbHVtbiA9IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCBmdWxsLCBtZXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICc8YSBuZy1jbGljaz1cInNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5vcGVuRW52aXJvbm1lbnQoJyArIGZ1bGwuc291cmNlX2Vudmlyb25tZW50X2lkICsgJylcIj4nICsgZGF0YSArICc8L2E+JztcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBjaGFuZ2VUb0xvY2FsRGF0ZSA9IGZ1bmN0aW9uKGRhdGEsIHR5cGUsIGZ1bGwsIG1ldGEpe1xuICAgICAgICAgICAgICAgIGlmIChkYXRhKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50KGRhdGEpLmZvcm1hdCgnREQgTU1NIFlZWVksIEhIOm1tJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAgc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmhlYWRlcnMubGVuZ3RoIDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5oZWFkZXJzW2ldLmNsaWNrQWJsZSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5kdENvbHVtbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5oZWFkZXJzW2ldLmNvbHVtbikud2l0aFRpdGxlKHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5oZWFkZXJzW2ldLm5hbWUpLnJlbmRlcldpdGgoY2xpY2tBYmxlQ29sdW1uKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5oZWFkZXJzW2ldLnR5cGUgPT0gJ2RhdGUnKXtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmR0Q29sdW1ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4oc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmhlYWRlcnNbaV0uY29sdW1uKS53aXRoVGl0bGUoc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmhlYWRlcnNbaV0ubmFtZSkucmVuZGVyV2l0aChjaGFuZ2VUb0xvY2FsRGF0ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmR0Q29sdW1ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4oc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmhlYWRlcnNbaV0uY29sdW1uKS53aXRoVGl0bGUoc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmhlYWRlcnNbaV0ubmFtZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGdldFRhYmxlRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmVudmlyb25tZW50c0RhdGEpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmR0T3B0aW9ucyA9IERUT3B0aW9uc0J1aWxkZXIuZnJvbUZuUHJvbWlzZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRUYWJsZURhdGEoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdhYVNvcnRpbmcnLCBbOCwgJ2FzYyddKVxuICAgICAgICAgICAgICAgIC53aXRoRE9NKCc8XCJodG1sNWJ1dHRvbnNcIkI+bFRmZ2l0cCcpXG4gICAgICAgICAgICAgICAgLndpdGhPcHRpb24oJ2NyZWF0ZWRSb3cnLCBmdW5jdGlvbiAocm93KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlY29tcGlsaW5nIHNvIHdlIGNhbiBiaW5kIEFuZ3VsYXIgZGlyZWN0aXZlIHRvIHRoZSBEVFxuICAgICAgICAgICAgICAgICAgICAkY29tcGlsZShhbmd1bGFyLmVsZW1lbnQocm93KS5jb250ZW50cygpKSgkc2NvcGUpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLndpdGhPcHRpb24oJ3Njcm9sbFgnLCBmYWxzZSlcbiAgICAgICAgICAgICAgICAud2l0aEJ1dHRvbnMoW1xuICAgICAgICAgICAgICAgIF0pXG4gICAgICAgICAgICAgICAgLndpdGhPcHRpb24oXCJjYXNlSW5zZW5zaXRpdmVcIix0cnVlKVxuICAgICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdzZWFyY2gnLHtcbiAgICAgICAgICAgICAgICAgICAgXCJjYXNlSW5zZW5zaXRpdmVcIjogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmVudmlyb25tZW50c0RhdGEgJiYgc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmVudmlyb25tZW50c0RhdGEubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5kdE9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgLndpdGhMaWdodENvbHVtbkZpbHRlcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMyA6e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNSA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogXy5tYXAoXy51bmlxdWUoXy5tYXAoc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmVudmlyb25tZW50c0RhdGEsICdlbnZpcm9ubWVudF9jcmVhdGVkX2J5JykpLGZ1bmN0aW9uKGVsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7dmFsdWUgOiBlbCxsYWJlbCA6ZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA2IDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDcgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IF8ubWFwKF8udW5pcXVlKF8ubWFwKHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5lbnZpcm9ubWVudHNEYXRhLCAnZW52aXJvbm1lbnRfbGFzdF91cGRhdGVkX2J5JykpLGZ1bmN0aW9uKGVsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7dmFsdWUgOiBlbCxsYWJlbCA6ZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA4IDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAnQWN0aXZlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgOiBcIkluYWN0aXZlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWwgOiBcIkluYWN0aXZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgOiBcIkFjdGl2ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsIDogXCJBY3RpdmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5kdEluc3RhbmNlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZHRJbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24oc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmR0SW5zdGFuY2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5kdEluc3RhbmNlKGR0SW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5ndWxhci5pc0RlZmluZWQoc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmR0SW5zdGFuY2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5kdEluc3RhbmNlID0gZHRJbnN0YW5jZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5kdEluc3RhbmNlLmNoYW5nZURhdGEgIT0gbnVsbClcbiAgICAgICAgICAgICAgICBzb3VyY2VFbnZpcm9ubWVudHNUYWJsZUN0cmwuZHRJbnN0YW5jZS5jaGFuZ2VEYXRhKGdldFRhYmxlRGF0YSgpKTtcblxuICAgICAgICAgICAgICAgICR0aW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmxvYWRpbmdUYWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSk7XG5cblxuICAgICAgICBzb3VyY2VFbnZpcm9ubWVudHNUYWJsZUN0cmwub3BlbkVudmlyb25tZW50ID0gZnVuY3Rpb24oZW52aXJvbm1lbnRJRCl7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNvbnRlbnQub3BlbkVudmlyb25tZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGVudmlyb25tZW50RGF0YSA9IF8uZmluZChzb3VyY2VFbnZpcm9ubWVudHNUYWJsZUN0cmwuZW52aXJvbm1lbnRzRGF0YSwge3NvdXJjZV9lbnZpcm9ubWVudF9pZDogZW52aXJvbm1lbnRJRH0pO1xuICAgICAgICAgICAgICAgIGlmIChlbnZpcm9ubWVudERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnQub3BlbkVudmlyb25tZW50KGVudmlyb25tZW50RGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL1RPRE8gc2hvdyBlcnJvciA/P1xuICAgICAgICB9O1xuXG4gICAgICAgIHNvdXJjZUVudmlyb25tZW50c1RhYmxlQ3RybC5vcGVuTmV3RW52aXJvbm1lbnQgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jb250ZW50Lm9wZW5OZXdFbnZpcm9ubWVudCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29udGVudC5vcGVuTmV3RW52aXJvbm1lbnQoc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsLmVudmlyb25tZW50c0RhdGEpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vVE9ETyBzaG93IGVycm9yID8/XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6IFwiRVwiLFxuICAgICAgICB0ZW1wbGF0ZVVybDogdGVtcGxhdGUsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBjb250ZW50OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlcjogY29udHJvbGxlcixcbiAgICAgICAgY29udHJvbGxlckFzIDonc291cmNlRW52aXJvbm1lbnRzVGFibGVDdHJsJ1xuICAgIH07XG59XG5cblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ1RETS1GRScpXG4gICAgLmRpcmVjdGl2ZSgnc291cmNlRW52aXJvbm1lbnRzVGFibGVEaXJlY3RpdmUnLCBzb3VyY2VFbnZpcm9ubWVudHNUYWJsZURpcmVjdGl2ZSk7Il19
