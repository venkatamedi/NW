function businessEntitiesTableDirective(){return{restrict:"E",templateUrl:"views/businessEntities/businessEntitiesTable.html",scope:{content:"="},controller:function($scope,$compile,TDMService,DTColumnBuilder,DTOptionsBuilder,$q,$timeout){var businessEntitiesTableCtrl=this;businessEntitiesTableCtrl.loadingTable=!0,TDMService.getBusinessEntities().then((function(response){if("SUCCESS"==response.errorCode){businessEntitiesTableCtrl.businessEntitiesData=_.sortBy(response.result,(function(value){return new Date(value.be_creation_date)})),businessEntitiesTableCtrl.businessEntitiesData.reverse(),businessEntitiesTableCtrl.dtInstance={},businessEntitiesTableCtrl.dtColumns=[],businessEntitiesTableCtrl.dtColumnDefs=[],businessEntitiesTableCtrl.headers=[{column:"be_name",name:"Name",clickAble:!0},{column:"be_description",name:"Description",clickAble:!1},{column:"be_creation_date",name:"Creation Date",clickAble:!1,type:"date"},{column:"be_created_by",name:"Created By",clickAble:!1},{column:"be_last_updated_date",name:"Last Update Date",clickAble:!1,type:"date"},{column:"be_last_updated_by",name:"Updated By",clickAble:!1},{column:"be_status",name:"Status",clickAble:!1}];for(var clickAbleColumn=function(data,type,full,meta){return'<a ng-click="businessEntitiesTableCtrl.openBusinessEntity('+full.be_id+')">'+data+"</a>"},changeToLocalDate=function(data,type,full,meta){return moment(data).format("DD MMM YYYY, HH:mm")},i=0;i<businessEntitiesTableCtrl.headers.length;i++)1==businessEntitiesTableCtrl.headers[i].clickAble?businessEntitiesTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(businessEntitiesTableCtrl.headers[i].column).withTitle(businessEntitiesTableCtrl.headers[i].name).renderWith(clickAbleColumn)):"date"==businessEntitiesTableCtrl.headers[i].type?businessEntitiesTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(businessEntitiesTableCtrl.headers[i].column).withTitle(businessEntitiesTableCtrl.headers[i].name).renderWith(changeToLocalDate)):businessEntitiesTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(businessEntitiesTableCtrl.headers[i].column).withTitle(businessEntitiesTableCtrl.headers[i].name));var getTableData=function(){var deferred=$q.defer();return deferred.resolve(businessEntitiesTableCtrl.businessEntitiesData),deferred.promise};businessEntitiesTableCtrl.dtOptions=DTOptionsBuilder.fromFnPromise((function(){return getTableData()})).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("aaSorting",[6,"asc"]).withOption("scrollX",!1).withButtons([]).withOption("caseInsensitive",!0).withOption("search",{caseInsensitive:!1}),businessEntitiesTableCtrl.businessEntitiesData&&businessEntitiesTableCtrl.businessEntitiesData.length>0&&businessEntitiesTableCtrl.dtOptions.withLightColumnFilter({0:{type:"text"},1:{type:"text"},2:{type:"text"},3:{type:"select",values:_.map(_.unique(_.map(businessEntitiesTableCtrl.businessEntitiesData,"be_created_by")),(function(el){return{value:el,label:el}}))},4:{type:"text"},5:{type:"select",values:_.map(_.unique(_.map(businessEntitiesTableCtrl.businessEntitiesData,"be_last_updated_by")),(function(el){return{value:el,label:el}}))},6:{type:"select",defaultValue:"Active",values:[{value:"Inactive",label:"Inactive"},{value:"Active",label:"Active"}]}}),businessEntitiesTableCtrl.dtInstanceCallback=function(dtInstance){angular.isFunction(businessEntitiesTableCtrl.dtInstance)?businessEntitiesTableCtrl.dtInstance(dtInstance):angular.isDefined(businessEntitiesTableCtrl.dtInstance)&&(businessEntitiesTableCtrl.dtInstance=dtInstance)},null!=businessEntitiesTableCtrl.dtInstance.changeData&&businessEntitiesTableCtrl.dtInstance.changeData(getTableData()),$timeout(()=>{businessEntitiesTableCtrl.loadingTable=!1})}})),businessEntitiesTableCtrl.openBusinessEntity=function(businessEntityId){if($scope.content.openBusinessEntity){var businessEntityData=_.find(businessEntitiesTableCtrl.businessEntitiesData,{be_id:businessEntityId});if(businessEntityData)return void $scope.content.openBusinessEntity(businessEntityData)}},businessEntitiesTableCtrl.openNewBusinessEntity=function(){$scope.content.openNewBusinessEntity&&$scope.content.openNewBusinessEntity(businessEntitiesTableCtrl.businessEntitiesData)}},controllerAs:"businessEntitiesTableCtrl"}}angular.module("TDM-FE").directive("businessEntitiesTableDirective",businessEntitiesTableDirective);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvYnVzaW5lc3NFbnRpdGllcy9idXNpbmVzc0VudGl0aWVzVGFibGVEaXJlY3RpdmUuanMiXSwibmFtZXMiOlsiYnVzaW5lc3NFbnRpdGllc1RhYmxlRGlyZWN0aXZlIiwicmVzdHJpY3QiLCJ0ZW1wbGF0ZVVybCIsInNjb3BlIiwiY29udGVudCIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkY29tcGlsZSIsIlRETVNlcnZpY2UiLCJEVENvbHVtbkJ1aWxkZXIiLCJEVE9wdGlvbnNCdWlsZGVyIiwiJHEiLCIkdGltZW91dCIsImJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwiLCJ0aGlzIiwibG9hZGluZ1RhYmxlIiwiZ2V0QnVzaW5lc3NFbnRpdGllcyIsInRoZW4iLCJyZXNwb25zZSIsImVycm9yQ29kZSIsImJ1c2luZXNzRW50aXRpZXNEYXRhIiwiXyIsInNvcnRCeSIsInJlc3VsdCIsInZhbHVlIiwiRGF0ZSIsImJlX2NyZWF0aW9uX2RhdGUiLCJyZXZlcnNlIiwiZHRJbnN0YW5jZSIsImR0Q29sdW1ucyIsImR0Q29sdW1uRGVmcyIsImhlYWRlcnMiLCJjb2x1bW4iLCJuYW1lIiwiY2xpY2tBYmxlIiwidHlwZSIsImNsaWNrQWJsZUNvbHVtbiIsImRhdGEiLCJmdWxsIiwibWV0YSIsImJlX2lkIiwiY2hhbmdlVG9Mb2NhbERhdGUiLCJtb21lbnQiLCJmb3JtYXQiLCJpIiwibGVuZ3RoIiwicHVzaCIsIm5ld0NvbHVtbiIsIndpdGhUaXRsZSIsInJlbmRlcldpdGgiLCJnZXRUYWJsZURhdGEiLCJkZWZlcnJlZCIsImRlZmVyIiwicmVzb2x2ZSIsInByb21pc2UiLCJkdE9wdGlvbnMiLCJmcm9tRm5Qcm9taXNlIiwid2l0aERPTSIsIndpdGhPcHRpb24iLCJyb3ciLCJhbmd1bGFyIiwiZWxlbWVudCIsImNvbnRlbnRzIiwid2l0aEJ1dHRvbnMiLCJjYXNlSW5zZW5zaXRpdmUiLCJ3aXRoTGlnaHRDb2x1bW5GaWx0ZXIiLCIwIiwiMSIsIjIiLCIzIiwidmFsdWVzIiwibWFwIiwidW5pcXVlIiwiZWwiLCJsYWJlbCIsIjQiLCI1IiwiNiIsImRlZmF1bHRWYWx1ZSIsImR0SW5zdGFuY2VDYWxsYmFjayIsImlzRnVuY3Rpb24iLCJpc0RlZmluZWQiLCJjaGFuZ2VEYXRhIiwib3BlbkJ1c2luZXNzRW50aXR5IiwiYnVzaW5lc3NFbnRpdHlJZCIsImJ1c2luZXNzRW50aXR5RGF0YSIsImZpbmQiLCJvcGVuTmV3QnVzaW5lc3NFbnRpdHkiLCJjb250cm9sbGVyQXMiLCJtb2R1bGUiLCJkaXJlY3RpdmUiXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLGlDQTBMTCxNQUFPLENBQ0hDLFNBQVUsSUFDVkMsWUExTFcsb0RBMkxYQyxNQUFPLENBQ0hDLFFBQVMsS0FFYkMsV0E1TGEsU0FBVUMsT0FBT0MsU0FBU0MsV0FBV0MsZ0JBQWdCQyxpQkFBaUJDLEdBQUdDLFVBQ3RGLElBQUlDLDBCQUE0QkMsS0FFaENELDBCQUEwQkUsY0FBZSxFQUV6Q1AsV0FBV1Esc0JBQXNCQyxNQUFLLFNBQVNDLFVBQzNDLEdBQTBCLFdBQXRCQSxTQUFTQyxVQUFiLENBS0FOLDBCQUEwQk8scUJBQXNCQyxFQUFFQyxPQUFPSixTQUFTSyxRQUFRLFNBQVNDLE9BQy9FLE9BQU8sSUFBSUMsS0FBS0QsTUFBTUUscUJBRTFCYiwwQkFBMEJPLHFCQUFxQk8sVUFDL0NkLDBCQUEwQmUsV0FBYSxHQUN2Q2YsMEJBQTBCZ0IsVUFBWSxHQUN0Q2hCLDBCQUEwQmlCLGFBQWUsR0FDekNqQiwwQkFBMEJrQixRQUFVLENBQ2hDLENBQ0lDLE9BQVMsVUFDVEMsS0FBTyxPQUNQQyxXQUFZLEdBRWhCLENBQ0lGLE9BQVMsaUJBQ1RDLEtBQU8sY0FDUEMsV0FBWSxHQUVoQixDQUNJRixPQUFTLG1CQUNUQyxLQUFPLGdCQUNQQyxXQUFZLEVBQ1pDLEtBQU0sUUFFVixDQUNJSCxPQUFTLGdCQUNUQyxLQUFPLGFBQ1BDLFdBQVksR0FFaEIsQ0FDSUYsT0FBUyx1QkFDVEMsS0FBTyxtQkFDUEMsV0FBWSxF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S0FDTEMsMEJBQTBCRSxjQUFlLFFBTXJERiwwQkFBMEJzRSxtQkFBcUIsU0FBU0Msa0JBQ3BELEdBQUk5RSxPQUFPRixRQUFRK0UsbUJBQW9CLENBQ25DLElBQUlFLG1CQUFxQmhFLEVBQUVpRSxLQUFLekUsMEJBQTBCTyxxQkFBc0IsQ0FBQ29CLE1BQU80QyxtQkFDeEYsR0FBSUMsbUJBRUEsWUFEQS9FLE9BQU9GLFFBQVErRSxtQkFBbUJFLHNCQU85Q3hFLDBCQUEwQjBFLHNCQUF3QixXQUMxQ2pGLE9BQU9GLFFBQVFtRix1QkFDZmpGLE9BQU9GLFFBQVFtRixzQkFBc0IxRSwwQkFBMEJPLHdCQWN2RW9FLGFBQWMsNkJBS3RCNUIsUUFDSzZCLE9BQU8sVUFDUEMsVUFBVSxpQ0FBa0MxRiIsImZpbGUiOiJkaXJlY3RpdmVzL2J1c2luZXNzRW50aXRpZXMvYnVzaW5lc3NFbnRpdGllc1RhYmxlRGlyZWN0aXZlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gYnVzaW5lc3NFbnRpdGllc1RhYmxlRGlyZWN0aXZlKCl7XG5cbiAgICB2YXIgdGVtcGxhdGUgPSBcInZpZXdzL2J1c2luZXNzRW50aXRpZXMvYnVzaW5lc3NFbnRpdGllc1RhYmxlLmh0bWxcIjtcblxuICAgIHZhciBjb250cm9sbGVyID0gZnVuY3Rpb24gKCRzY29wZSwkY29tcGlsZSxURE1TZXJ2aWNlLERUQ29sdW1uQnVpbGRlcixEVE9wdGlvbnNCdWlsZGVyLCRxLCR0aW1lb3V0KSB7XG4gICAgICAgIHZhciBidXNpbmVzc0VudGl0aWVzVGFibGVDdHJsID0gdGhpcztcblxuICAgICAgICBidXNpbmVzc0VudGl0aWVzVGFibGVDdHJsLmxvYWRpbmdUYWJsZSA9IHRydWU7XG5cbiAgICAgICAgVERNU2VydmljZS5nZXRCdXNpbmVzc0VudGl0aWVzKCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlICE9ICdTVUNDRVNTJyl7XG4gICAgICAgICAgICAgICAgLy9UT0RPIHNob3cgRXJyb3JcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuYnVzaW5lc3NFbnRpdGllc0RhdGEgPV8uc29ydEJ5KHJlc3BvbnNlLnJlc3VsdCwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUodmFsdWUuYmVfY3JlYXRpb25fZGF0ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuYnVzaW5lc3NFbnRpdGllc0RhdGEucmV2ZXJzZSgpO1xuICAgICAgICAgICAgYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5kdEluc3RhbmNlID0ge307XG4gICAgICAgICAgICBidXNpbmVzc0VudGl0aWVzVGFibGVDdHJsLmR0Q29sdW1ucyA9IFtdO1xuICAgICAgICAgICAgYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5kdENvbHVtbkRlZnMgPSBbXTtcbiAgICAgICAgICAgIGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuaGVhZGVycyA9IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdiZV9uYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdOYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnYmVfZGVzY3JpcHRpb24nLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ0Rlc2NyaXB0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2JlX2NyZWF0aW9uX2RhdGUnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ0NyZWF0aW9uIERhdGUnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGUgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2RhdGUnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdiZV9jcmVhdGVkX2J5JyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdDcmVhdGVkIEJ5JyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2JlX2xhc3RfdXBkYXRlZF9kYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdMYXN0IFVwZGF0ZSBEYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdkYXRlJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnYmVfbGFzdF91cGRhdGVkX2J5JyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdVcGRhdGVkIEJ5JyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2JlX3N0YXR1cycsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnU3RhdHVzJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICB2YXIgY2xpY2tBYmxlQ29sdW1uID0gZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwsIG1ldGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxhIG5nLWNsaWNrPVwiYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5vcGVuQnVzaW5lc3NFbnRpdHkoJyArIGZ1bGwuYmVfaWQgKyAnKVwiPicgKyBkYXRhICsgJzwvYT4nO1xuICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICB2YXIgY2hhbmdlVG9Mb2NhbERhdGUgPSBmdW5jdGlvbihkYXRhLCB0eXBlLCBmdWxsLCBtZXRhKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50KGRhdGEpLmZvcm1hdCgnREQgTU1NIFlZWVksIEhIOm1tJylcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgIGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuaGVhZGVycy5sZW5ndGggOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5oZWFkZXJzW2ldLmNsaWNrQWJsZSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuZHRDb2x1bW5zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihidXNpbmVzc0VudGl0aWVzVGFibGVDdHJsLmhlYWRlcnNbaV0uY29sdW1uKS53aXRoVGl0bGUoYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5oZWFkZXJzW2ldLm5hbWUpLnJlbmRlcldpdGgoY2xpY2tBYmxlQ29sdW1uKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuaGVhZGVyc1tpXS50eXBlID09ICdkYXRlJyl7XG4gICAgICAgICAgICAgICAgICAgIGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuZHRDb2x1bW5zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihidXNpbmVzc0VudGl0aWVzVGFibGVDdHJsLmhlYWRlcnNbaV0uY29sdW1uKS53aXRoVGl0bGUoYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5oZWFkZXJzW2ldLm5hbWUpLnJlbmRlcldpdGgoY2hhbmdlVG9Mb2NhbERhdGUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuZHRDb2x1bW5zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihidXNpbmVzc0VudGl0aWVzVGFibGVDdHJsLmhlYWRlcnNbaV0uY29sdW1uKS53aXRoVGl0bGUoYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5oZWFkZXJzW2ldLm5hbWUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBnZXRUYWJsZURhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuYnVzaW5lc3NFbnRpdGllc0RhdGEpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5kdE9wdGlvbnMgPSBEVE9wdGlvbnNCdWlsZGVyLmZyb21GblByb21pc2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRUYWJsZURhdGEoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLndpdGhET00oJzxcImh0bWw1YnV0dG9uc1wiQj5sVGZnaXRwJylcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignY3JlYXRlZFJvdycsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVjb21waWxpbmcgc28gd2UgY2FuIGJpbmQgQW5ndWxhciBkaXJlY3RpdmUgdG8gdGhlIERUXG4gICAgICAgICAgICAgICAgICAgICRjb21waWxlKGFuZ3VsYXIuZWxlbWVudChyb3cpLmNvbnRlbnRzKCkpKCRzY29wZSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignYWFTb3J0aW5nJywgWzYsICdhc2MnXSlcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignc2Nyb2xsWCcsIGZhbHNlKVxuICAgICAgICAgICAgICAgIC53aXRoQnV0dG9ucyhbXG4gICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbihcImNhc2VJbnNlbnNpdGl2ZVwiLHRydWUpXG4gICAgICAgICAgICAgICAgLndpdGhPcHRpb24oJ3NlYXJjaCcse1xuICAgICAgICAgICAgICAgICAgICBcImNhc2VJbnNlbnNpdGl2ZVwiOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuYnVzaW5lc3NFbnRpdGllc0RhdGEgJiYgYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5idXNpbmVzc0VudGl0aWVzRGF0YS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5kdE9wdGlvbnMud2l0aExpZ2h0Q29sdW1uRmlsdGVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAwIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMyA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogXy5tYXAoXy51bmlxdWUoXy5tYXAoYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5idXNpbmVzc0VudGl0aWVzRGF0YSwgJ2JlX2NyZWF0ZWRfYnknKSksZnVuY3Rpb24oZWwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt2YWx1ZSA6IGVsLGxhYmVsIDplbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNSA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogXy5tYXAoXy51bmlxdWUoXy5tYXAoYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5idXNpbmVzc0VudGl0aWVzRGF0YSwgJ2JlX2xhc3RfdXBkYXRlZF9ieScpKSxmdW5jdGlvbihlbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3ZhbHVlIDogZWwsbGFiZWwgOmVsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNiA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ0FjdGl2ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlIDogXCJJbmFjdGl2ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsIDogXCJJbmFjdGl2ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlIDogXCJBY3RpdmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbCA6IFwiQWN0aXZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuZHRJbnN0YW5jZUNhbGxiYWNrID0gZnVuY3Rpb24gKGR0SW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0Z1bmN0aW9uKGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuZHRJbnN0YW5jZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5kdEluc3RhbmNlKGR0SW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5ndWxhci5pc0RlZmluZWQoYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5kdEluc3RhbmNlKSkge1xuICAgICAgICAgICAgICAgICAgICBidXNpbmVzc0VudGl0aWVzVGFibGVDdHJsLmR0SW5zdGFuY2UgPSBkdEluc3RhbmNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5kdEluc3RhbmNlLmNoYW5nZURhdGEgIT0gbnVsbClcbiAgICAgICAgICAgICAgICBidXNpbmVzc0VudGl0aWVzVGFibGVDdHJsLmR0SW5zdGFuY2UuY2hhbmdlRGF0YShnZXRUYWJsZURhdGEoKSk7XG5cbiAgICAgICAgICAgICAgICAkdGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwubG9hZGluZ1RhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgXG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5vcGVuQnVzaW5lc3NFbnRpdHkgPSBmdW5jdGlvbihidXNpbmVzc0VudGl0eUlkKXtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY29udGVudC5vcGVuQnVzaW5lc3NFbnRpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYnVzaW5lc3NFbnRpdHlEYXRhID0gXy5maW5kKGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwuYnVzaW5lc3NFbnRpdGllc0RhdGEsIHtiZV9pZDogYnVzaW5lc3NFbnRpdHlJZH0pO1xuICAgICAgICAgICAgICAgIGlmIChidXNpbmVzc0VudGl0eURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnQub3BlbkJ1c2luZXNzRW50aXR5KGJ1c2luZXNzRW50aXR5RGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL1RPRE8gc2hvdyBlcnJvciA/P1xuICAgICAgICB9O1xuXG4gICAgICAgIGJ1c2luZXNzRW50aXRpZXNUYWJsZUN0cmwub3Blbk5ld0J1c2luZXNzRW50aXR5ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY29udGVudC5vcGVuTmV3QnVzaW5lc3NFbnRpdHkpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29udGVudC5vcGVuTmV3QnVzaW5lc3NFbnRpdHkoYnVzaW5lc3NFbnRpdGllc1RhYmxlQ3RybC5idXNpbmVzc0VudGl0aWVzRGF0YSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9UT0RPIHNob3cgZXJyb3IgPz9cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogXCJFXCIsXG4gICAgICAgIHRlbXBsYXRlVXJsOiB0ZW1wbGF0ZSxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGNvbnRlbnQ6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBjb250cm9sbGVyLFxuICAgICAgICBjb250cm9sbGVyQXMgOididXNpbmVzc0VudGl0aWVzVGFibGVDdHJsJ1xuICAgIH07XG59XG5cblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ1RETS1GRScpXG4gICAgLmRpcmVjdGl2ZSgnYnVzaW5lc3NFbnRpdGllc1RhYmxlRGlyZWN0aXZlJywgYnVzaW5lc3NFbnRpdGllc1RhYmxlRGlyZWN0aXZlKTsiXX0=
