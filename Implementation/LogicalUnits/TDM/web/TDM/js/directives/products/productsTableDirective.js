function productsTableDirective(){return{restrict:"E",templateUrl:"views/products/productsTable.html",scope:{content:"="},controller:function($scope,$compile,TDMService,DTColumnBuilder,DTOptionsBuilder,$q,$timeout){var productsTableCtrl=this;productsTableCtrl.loadingTable=!0,TDMService.getProducts().then((function(response){if("SUCCESS"==response.errorCode){productsTableCtrl.productsData=_.sortBy(response.result,(function(value){return new Date(value.product_creation_date)})),productsTableCtrl.productsData.reverse(),productsTableCtrl.dtInstance={},productsTableCtrl.dtColumns=[],productsTableCtrl.dtColumnDefs=[],productsTableCtrl.headers=[{column:"product_name",name:"Name",clickAble:!0},{column:"product_vendor",name:"System Vendor",clickAble:!1},{column:"product_versions",name:"System Versions",clickAble:!1},{column:"product_creation_date",name:"Creation Date",clickAble:!1,type:"date"},{column:"product_created_by",name:"Created By",clickAble:!1},{column:"product_last_updated_date",name:"Last Update Date",clickAble:!1,type:"date"},{column:"product_last_updated_by",name:"Updated By",clickAble:!1},{column:"product_status",name:"Status",clickAble:!1}];for(var clickAbleColumn=function(data,type,full,meta){return'<a ng-click="productsTableCtrl.openProduct('+full.product_id+')">'+data+"</a>"},changeToLocalDate=function(data,type,full,meta){return moment(data).format("DD MMM YYYY, HH:mm")},i=0;i<productsTableCtrl.headers.length;i++)1==productsTableCtrl.headers[i].clickAble?productsTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(productsTableCtrl.headers[i].column).withTitle(productsTableCtrl.headers[i].name).renderWith(clickAbleColumn)):"date"==productsTableCtrl.headers[i].type?productsTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(productsTableCtrl.headers[i].column).withTitle(productsTableCtrl.headers[i].name).renderWith(changeToLocalDate)):productsTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(productsTableCtrl.headers[i].column).withTitle(productsTableCtrl.headers[i].name));var getTableData=function(){var deferred=$q.defer();return deferred.resolve(productsTableCtrl.productsData),deferred.promise};productsTableCtrl.dtOptions=DTOptionsBuilder.fromFnPromise((function(){return getTableData()})).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("scrollX",!1).withOption("aaSorting",[7,"asc"]).withButtons([]).withOption("search",{caseInsensitive:!1}),productsTableCtrl.productsData&&productsTableCtrl.productsData.length>0&&productsTableCtrl.dtOptions.withLightColumnFilter({0:{type:"text"},1:{type:"text"},2:{type:"text"},3:{type:"text"},4:{type:"select",values:_.map(_.unique(_.map(productsTableCtrl.productsData,"product_created_by")),(function(el){return{value:el,label:el}}))},5:{type:"text"},6:{type:"select",values:_.map(_.unique(_.map(productsTableCtrl.productsData,"product_last_updated_by")),(function(el){return{value:el,label:el}}))},7:{type:"select",defaultValue:"Active",values:[{value:"Inactive",label:"Inactive"},{value:"Active",label:"Active"}]}}),productsTableCtrl.dtInstanceCallback=function(dtInstance){angular.isFunction(productsTableCtrl.dtInstance)?productsTableCtrl.dtInstance(dtInstance):angular.isDefined(productsTableCtrl.dtInstance)&&(productsTableCtrl.dtInstance=dtInstance)},null!=productsTableCtrl.dtInstance.changeData&&productsTableCtrl.dtInstance.changeData(getTableData()),$timeout(()=>{productsTableCtrl.loadingTable=!1})}})),productsTableCtrl.openProduct=function(productID){if($scope.content.openProduct){var productData=_.find(productsTableCtrl.productsData,{product_id:productID});if(productData)return void $scope.content.openProduct(productData)}},productsTableCtrl.openNewProduct=function(){$scope.content.openNewProduct&&$scope.content.openNewProduct(productsTableCtrl.productsData)}},controllerAs:"productsTableCtrl"}}angular.module("TDM-FE").directive("productsTableDirective",productsTableDirective);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvcHJvZHVjdHMvcHJvZHVjdHNUYWJsZURpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJwcm9kdWN0c1RhYmxlRGlyZWN0aXZlIiwicmVzdHJpY3QiLCJ0ZW1wbGF0ZVVybCIsInNjb3BlIiwiY29udGVudCIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkY29tcGlsZSIsIlRETVNlcnZpY2UiLCJEVENvbHVtbkJ1aWxkZXIiLCJEVE9wdGlvbnNCdWlsZGVyIiwiJHEiLCIkdGltZW91dCIsInByb2R1Y3RzVGFibGVDdHJsIiwidGhpcyIsImxvYWRpbmdUYWJsZSIsImdldFByb2R1Y3RzIiwidGhlbiIsInJlc3BvbnNlIiwiZXJyb3JDb2RlIiwicHJvZHVjdHNEYXRhIiwiXyIsInNvcnRCeSIsInJlc3VsdCIsInZhbHVlIiwiRGF0ZSIsInByb2R1Y3RfY3JlYXRpb25fZGF0ZSIsInJldmVyc2UiLCJkdEluc3RhbmNlIiwiZHRDb2x1bW5zIiwiZHRDb2x1bW5EZWZzIiwiaGVhZGVycyIsImNvbHVtbiIsIm5hbWUiLCJjbGlja0FibGUiLCJ0eXBlIiwiY2xpY2tBYmxlQ29sdW1uIiwiZGF0YSIsImZ1bGwiLCJtZXRhIiwicHJvZHVjdF9pZCIsImNoYW5nZVRvTG9jYWxEYXRlIiwibW9tZW50IiwiZm9ybWF0IiwiaSIsImxlbmd0aCIsInB1c2giLCJuZXdDb2x1bW4iLCJ3aXRoVGl0bGUiLCJyZW5kZXJXaXRoIiwiZ2V0VGFibGVEYXRhIiwiZGVmZXJyZWQiLCJkZWZlciIsInJlc29sdmUiLCJwcm9taXNlIiwiZHRPcHRpb25zIiwiZnJvbUZuUHJvbWlzZSIsIndpdGhET00iLCJ3aXRoT3B0aW9uIiwicm93IiwiYW5ndWxhciIsImVsZW1lbnQiLCJjb250ZW50cyIsIndpdGhCdXR0b25zIiwiY2FzZUluc2Vuc2l0aXZlIiwid2l0aExpZ2h0Q29sdW1uRmlsdGVyIiwiMCIsIjEiLCIyIiwiMyIsIjQiLCJ2YWx1ZXMiLCJtYXAiLCJ1bmlxdWUiLCJlbCIsImxhYmVsIiwiNSIsIjYiLCI3IiwiZGVmYXVsdFZhbHVlIiwiZHRJbnN0YW5jZUNhbGxiYWNrIiwiaXNGdW5jdGlvbiIsImlzRGVmaW5lZCIsImNoYW5nZURhdGEiLCJvcGVuUHJvZHVjdCIsInByb2R1Y3RJRCIsInByb2R1Y3REYXRhIiwiZmluZCIsIm9wZW5OZXdQcm9kdWN0IiwiY29udHJvbGxlckFzIiwibW9kdWxlIiwiZGlyZWN0aXZlIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSx5QkErTEwsTUFBTyxDQUNIQyxTQUFVLElBQ1ZDLFlBL0xXLG9DQWdNWEMsTUFBTyxDQUNIQyxRQUFTLEtBRWJDLFdBak1hLFNBQVVDLE9BQU9DLFNBQVNDLFdBQVdDLGdCQUFnQkMsaUJBQWlCQyxHQUFJQyxVQUN2RixJQUFJQyxrQkFBb0JDLEtBRXhCRCxrQkFBa0JFLGNBQWUsRUFFakNQLFdBQVdRLGNBQWNDLE1BQUssU0FBU0MsVUFDbkMsR0FBMEIsV0FBdEJBLFNBQVNDLFVBQWIsQ0FJQU4sa0JBQWtCTyxhQUFjQyxFQUFFQyxPQUFPSixTQUFTSyxRQUFRLFNBQVNDLE9BQy9ELE9BQU8sSUFBSUMsS0FBS0QsTUFBTUUsMEJBRTFCYixrQkFBa0JPLGFBQWFPLFVBQy9CZCxrQkFBa0JlLFdBQWEsR0FDL0JmLGtCQUFrQmdCLFVBQVksR0FDOUJoQixrQkFBa0JpQixhQUFlLEdBQ2pDakIsa0JBQWtCa0IsUUFBVSxDQUN4QixDQUNJQyxPQUFTLGVBQ1RDLEtBQU8sT0FDUEMsV0FBWSxHQUVoQixDQUNJRixPQUFTLGlCQUNUQyxLQUFPLGdCQUNQQyxXQUFZLEdBRWhCLENBQ0lGLE9BQVMsbUJBQ1RDLEtBQU8sa0JBQ1BDLFdBQVksR0FFaEIsQ0FDSUYsT0FBUyx3QkFDVEMsS0FBTyxnQkFDUEMsV0FBWSxFQUNaQyxLQUFNLFFBRVYsQ0FDSUgsT0FBUyxxQkFDVEMsS0FBTyxhQUNQQyxXQUFZLEdBRWhCLENBQ0lGLE9BQVMsNEJBQ1RDLEtBQU8sbUJBQ1BDLFdBQVksRUFDWkMsS0FBTSxRQUVWLENBQ0lILE9BQVMs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QUFrQnVFLFlBQWMsU0FBU0MsV0FDckMsR0FBSS9FLE9BQU9GLFFBQVFnRixZQUFhLENBQzVCLElBQUlFLFlBQWNqRSxFQUFFa0UsS0FBSzFFLGtCQUFrQk8sYUFBYyxDQUFDb0IsV0FBWTZDLFlBQ3RFLEdBQUlDLFlBRUEsWUFEQWhGLE9BQU9GLFFBQVFnRixZQUFZRSxlQU92Q3pFLGtCQUFrQjJFLGVBQWlCLFdBQzNCbEYsT0FBT0YsUUFBUW9GLGdCQUNmbEYsT0FBT0YsUUFBUW9GLGVBQWUzRSxrQkFBa0JPLGdCQWN4RHFFLGFBQWMscUJBS3RCN0IsUUFDSzhCLE9BQU8sVUFDUEMsVUFBVSx5QkFBMEIzRiIsImZpbGUiOiJkaXJlY3RpdmVzL3Byb2R1Y3RzL3Byb2R1Y3RzVGFibGVEaXJlY3RpdmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBwcm9kdWN0c1RhYmxlRGlyZWN0aXZlKCl7XG5cbiAgICB2YXIgdGVtcGxhdGUgPSBcInZpZXdzL3Byb2R1Y3RzL3Byb2R1Y3RzVGFibGUuaHRtbFwiO1xuXG4gICAgdmFyIGNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoJHNjb3BlLCRjb21waWxlLFRETVNlcnZpY2UsRFRDb2x1bW5CdWlsZGVyLERUT3B0aW9uc0J1aWxkZXIsJHEsICR0aW1lb3V0KSB7XG4gICAgICAgIHZhciBwcm9kdWN0c1RhYmxlQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwubG9hZGluZ1RhYmxlID0gdHJ1ZTtcblxuICAgICAgICBURE1TZXJ2aWNlLmdldFByb2R1Y3RzKCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlICE9ICdTVUNDRVNTJyl7XG4gICAgICAgICAgICAgICAgLy9UT0RPIHNob3cgRXJyb3JcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5wcm9kdWN0c0RhdGEgPV8uc29ydEJ5KHJlc3BvbnNlLnJlc3VsdCwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUodmFsdWUucHJvZHVjdF9jcmVhdGlvbl9kYXRlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwucHJvZHVjdHNEYXRhLnJldmVyc2UoKTtcbiAgICAgICAgICAgIHByb2R1Y3RzVGFibGVDdHJsLmR0SW5zdGFuY2UgPSB7fTtcbiAgICAgICAgICAgIHByb2R1Y3RzVGFibGVDdHJsLmR0Q29sdW1ucyA9IFtdO1xuICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuZHRDb2x1bW5EZWZzID0gW107XG4gICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5oZWFkZXJzID0gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ3Byb2R1Y3RfbmFtZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnTmFtZScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IHRydWVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ3Byb2R1Y3RfdmVuZG9yJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdTeXN0ZW0gVmVuZG9yJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ3Byb2R1Y3RfdmVyc2lvbnMnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ1N5c3RlbSBWZXJzaW9ucycsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdwcm9kdWN0X2NyZWF0aW9uX2RhdGUnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ0NyZWF0aW9uIERhdGUnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGUgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2RhdGUnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdwcm9kdWN0X2NyZWF0ZWRfYnknLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ0NyZWF0ZWQgQnknLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGUgOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAncHJvZHVjdF9sYXN0X3VwZGF0ZWRfZGF0ZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnTGFzdCBVcGRhdGUgRGF0ZScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZGF0ZSdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ3Byb2R1Y3RfbGFzdF91cGRhdGVkX2J5JyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdVcGRhdGVkIEJ5JyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ3Byb2R1Y3Rfc3RhdHVzJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdTdGF0dXMnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGUgOiBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIHZhciBjbGlja0FibGVDb2x1bW4gPSBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgZnVsbCwgbWV0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnPGEgbmctY2xpY2s9XCJwcm9kdWN0c1RhYmxlQ3RybC5vcGVuUHJvZHVjdCgnICsgZnVsbC5wcm9kdWN0X2lkICsgJylcIj4nICsgZGF0YSArICc8L2E+JztcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBjaGFuZ2VUb0xvY2FsRGF0ZSA9IGZ1bmN0aW9uKGRhdGEsIHR5cGUsIGZ1bGwsIG1ldGEpe1xuICAgICAgICAgICAgICAgIHJldHVybiBtb21lbnQoZGF0YSkuZm9ybWF0KCdERCBNTU0gWVlZWSwgSEg6bW0nKVxuICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICBwcm9kdWN0c1RhYmxlQ3RybC5oZWFkZXJzLmxlbmd0aCA7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0c1RhYmxlQ3RybC5oZWFkZXJzW2ldLmNsaWNrQWJsZSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzVGFibGVDdHJsLmR0Q29sdW1ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4ocHJvZHVjdHNUYWJsZUN0cmwuaGVhZGVyc1tpXS5jb2x1bW4pLndpdGhUaXRsZShwcm9kdWN0c1RhYmxlQ3RybC5oZWFkZXJzW2ldLm5hbWUpLnJlbmRlcldpdGgoY2xpY2tBYmxlQ29sdW1uKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHByb2R1Y3RzVGFibGVDdHJsLmhlYWRlcnNbaV0udHlwZSA9PSAnZGF0ZScpe1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5kdENvbHVtbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHByb2R1Y3RzVGFibGVDdHJsLmhlYWRlcnNbaV0uY29sdW1uKS53aXRoVGl0bGUocHJvZHVjdHNUYWJsZUN0cmwuaGVhZGVyc1tpXS5uYW1lKS5yZW5kZXJXaXRoKGNoYW5nZVRvTG9jYWxEYXRlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5kdENvbHVtbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHByb2R1Y3RzVGFibGVDdHJsLmhlYWRlcnNbaV0uY29sdW1uKS53aXRoVGl0bGUocHJvZHVjdHNUYWJsZUN0cmwuaGVhZGVyc1tpXS5uYW1lKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZ2V0VGFibGVEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShwcm9kdWN0c1RhYmxlQ3RybC5wcm9kdWN0c0RhdGEpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuZHRPcHRpb25zID0gRFRPcHRpb25zQnVpbGRlci5mcm9tRm5Qcm9taXNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFRhYmxlRGF0YSgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLndpdGhET00oJzxcImh0bWw1YnV0dG9uc1wiQj5sVGZnaXRwJylcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignY3JlYXRlZFJvdycsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVjb21waWxpbmcgc28gd2UgY2FuIGJpbmQgQW5ndWxhciBkaXJlY3RpdmUgdG8gdGhlIERUXG4gICAgICAgICAgICAgICAgICAgICRjb21waWxlKGFuZ3VsYXIuZWxlbWVudChyb3cpLmNvbnRlbnRzKCkpKCRzY29wZSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignc2Nyb2xsWCcsIGZhbHNlKVxuICAgICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdhYVNvcnRpbmcnLCBbNywgJ2FzYyddKVxuICAgICAgICAgICAgICAgIC53aXRoQnV0dG9ucyhbXG4gICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignc2VhcmNoJyx7XG4gICAgICAgICAgICAgICAgICAgIFwiY2FzZUluc2Vuc2l0aXZlXCI6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAocHJvZHVjdHNUYWJsZUN0cmwucHJvZHVjdHNEYXRhICYmIHByb2R1Y3RzVGFibGVDdHJsLnByb2R1Y3RzRGF0YS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuZHRPcHRpb25zLndpdGhMaWdodENvbHVtbkZpbHRlcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMyA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0IDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBfLm1hcChfLnVuaXF1ZShfLm1hcChwcm9kdWN0c1RhYmxlQ3RybC5wcm9kdWN0c0RhdGEsICdwcm9kdWN0X2NyZWF0ZWRfYnknKSksZnVuY3Rpb24oZWwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt2YWx1ZSA6IGVsLGxhYmVsIDplbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNiA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogXy5tYXAoXy51bmlxdWUoXy5tYXAocHJvZHVjdHNUYWJsZUN0cmwucHJvZHVjdHNEYXRhLCAncHJvZHVjdF9sYXN0X3VwZGF0ZWRfYnknKSksZnVuY3Rpb24oZWwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt2YWx1ZSA6IGVsLGxhYmVsIDplbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDcgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICdBY3RpdmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA6IFwiSW5hY3RpdmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbCA6IFwiSW5hY3RpdmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA6IFwiQWN0aXZlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWwgOiBcIkFjdGl2ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5kdEluc3RhbmNlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZHRJbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24ocHJvZHVjdHNUYWJsZUN0cmwuZHRJbnN0YW5jZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuZHRJbnN0YW5jZShkdEluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHByb2R1Y3RzVGFibGVDdHJsLmR0SW5zdGFuY2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzVGFibGVDdHJsLmR0SW5zdGFuY2UgPSBkdEluc3RhbmNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAocHJvZHVjdHNUYWJsZUN0cmwuZHRJbnN0YW5jZS5jaGFuZ2VEYXRhICE9IG51bGwpXG4gICAgICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuZHRJbnN0YW5jZS5jaGFuZ2VEYXRhKGdldFRhYmxlRGF0YSgpKTtcbiAgICAgICAgICAgICAgICAkdGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzVGFibGVDdHJsLmxvYWRpbmdUYWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgXG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwub3BlblByb2R1Y3QgPSBmdW5jdGlvbihwcm9kdWN0SUQpe1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jb250ZW50Lm9wZW5Qcm9kdWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb2R1Y3REYXRhID0gXy5maW5kKHByb2R1Y3RzVGFibGVDdHJsLnByb2R1Y3RzRGF0YSwge3Byb2R1Y3RfaWQ6IHByb2R1Y3RJRH0pO1xuICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0RGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29udGVudC5vcGVuUHJvZHVjdChwcm9kdWN0RGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL1RPRE8gc2hvdyBlcnJvciA/P1xuICAgICAgICB9O1xuXG4gICAgICAgIHByb2R1Y3RzVGFibGVDdHJsLm9wZW5OZXdQcm9kdWN0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY29udGVudC5vcGVuTmV3UHJvZHVjdCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jb250ZW50Lm9wZW5OZXdQcm9kdWN0KHByb2R1Y3RzVGFibGVDdHJsLnByb2R1Y3RzRGF0YSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9UT0RPIHNob3cgZXJyb3IgPz9cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogXCJFXCIsXG4gICAgICAgIHRlbXBsYXRlVXJsOiB0ZW1wbGF0ZSxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGNvbnRlbnQ6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBjb250cm9sbGVyLFxuICAgICAgICBjb250cm9sbGVyQXMgOidwcm9kdWN0c1RhYmxlQ3RybCdcbiAgICB9O1xufVxuXG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdURE0tRkUnKVxuICAgIC5kaXJlY3RpdmUoJ3Byb2R1Y3RzVGFibGVEaXJlY3RpdmUnLCBwcm9kdWN0c1RhYmxlRGlyZWN0aXZlKTsiXX0=
