function productDirective(){return{restrict:"E",templateUrl:"views/products/product.html",scope:{content:"="},controller:function($scope,$compile,TDMService,BreadCrumbsService,$uibModal,toastr,$timeout,SweetAlert,AuthService,DTColumnBuilder,DTOptionsBuilder,$q){var productCtrl=this;productCtrl.productData=$scope.content.productData,productCtrl.productData.product_versions=productCtrl.productData.product_versions.split(","),productCtrl.supportedDBTypes=TDMService.getDBTypes(),productCtrl.disableChange="Inactive"==productCtrl.productData.product_status||!AuthService.authorizedToEdit(0)||!$scope.content.openProducts,productCtrl.addInterface=function(update,index){if(1==update)var productInterface=angular.copy(productCtrl.interfacesData[index]);$uibModal.open({templateUrl:"views/products/productDBInterfaceModal.html",resolve:{productID:productCtrl.productData.product_id,productName:function(){return productCtrl.productData.product_name}},controller:function($scope,$uibModalInstance,TDMService,productID,productName){var productInterfacesCtrl=this;productInterfacesCtrl.productDBInterface={},productInterfacesCtrl.saveButton="ADD",1==update&&(productInterfacesCtrl.productDBInterface=productInterface,productInterfacesCtrl.productDBInterface.general_interface_type_id=productInterfacesCtrl.productDBInterface.interface_type_id,productInterfacesCtrl.saveButton="SAVE"),productInterfacesCtrl.supportedDBTypes=TDMService.getDBTypes(),productInterfacesCtrl.title="ADD_DB_INTERFACE",productInterfacesCtrl.addProductDBInterface=function(){if(productInterfacesCtrl.productDBInterface.interface_name&&productInterfacesCtrl.productDBInterface.interface_type_id)if(1==update){if(_.find(productCtrl.interfacesData,{interface_name:productInterfacesCtrl.productDBInterface.interface_name,interface_type_id:productInterfacesCtrl.productDBInterface.interface_type_id}))return toastr.error("No Changes Made Or Interface With The Same Name And Type Already Exists");TDMService.putProductInterface(productID,productName,productInterface.interface_id,productInterfacesCtrl.productDBInterface).then((function(response){if("SUCCESS"==response.errorCode){if(productInterfacesCtrl.productDBInterface.general_interface_type_id==productInterfacesCtrl.productDBInterface.interface_type_id)return void $uibModalInstance.close(productInterfacesCtrl.productDBInterface);if(productCtrl.hasActiveEnvironment.length>0){for(var envMessage="",i=0;i<productCtrl.hasActiveEnvironment.length;i++)envMessage+=productCtrl.hasActiveEnvironment[i].environment_name,i<productCtrl.hasActiveEnvironment.length-1&&(envMessage+=",");SweetAlert.swal({title:"Warning",type:"warning",text:"Please Update the interface details for related environments ["+envMessage+"]"})}$uibModalInstance.close(productInterfacesCtrl.productDBInterface)}else productInterfacesCtrl.interfacesAlert={type:"danger",msg:"failed to Update DB Interface ["+response.message+"]"}}))}else{if(_.find(productCtrl.interfacesData,{interface_name:productInterfacesCtrl.productDBInterface.interface_name,interface_type_id:productInterfacesCtrl.productDBInterface.interface_type_id}))return toastr.error("Interface With The Same Name And Type Already Exists");TDMService.postProductInterface(productID,productName,productInterfacesCtrl.productDBInterface).then((function(response){if("SUCCESS"==response.errorCode){if(productCtrl.hasActiveEnvironment.length>0){for(var envMessage="",i=0;i<productCtrl.hasActiveEnvironment.length;i++)envMessage+=productCtrl.hasActiveEnvironment[i].environment_name,i<productCtrl.hasActiveEnvironment.length-1&&(envMessage+=",");SweetAlert.swal({title:"Warning",type:"warning",text:"Please add the interface details for related environments ["+envMessage+"]"})}productInterfacesCtrl.productDBInterface.interface_id=response.result,$uibModalInstance.close(productInterfacesCtrl.productDBInterface)}else productInterfacesCtrl.interfacesAlert={type:"danger",msg:"failed to Add DB Interface ["+response.message+"]"}}))}},productInterfacesCtrl.close=function(){$uibModalInstance.close()}},controllerAs:"productInterfacesCtrl"}).result.then((function(productInterface){productInterface&&(1==update?productCtrl.interfacesData[index]=productInterface:productCtrl.interfacesData.push(productInterface),productCtrl.dtInstanceInterfaces.reloadData((function(data){}),!0))}))},productCtrl.removeInterface=function(index){productCtrl.hasActiveEnvironment.length>0?SweetAlert.swal({title:(1==productCtrl.interfacesData.length?"Product may be deleted from environments. Related tasks may also be deleted":"Interface may be also deleted from environments having this product.")+"Are you sure ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"No",cancelButtonText:"Yes",closeOnConfirm:!0,closeOnCancel:!0,animation:"false",customClass:"animated fadeInUp"},(function(isConfirm){isConfirm||TDMService.deleteProductInterface(productCtrl.productData.product_id,productCtrl.productData.product_name,productCtrl.interfacesData[index].interface_id,productCtrl.interfacesData[index].interface_name,productCtrl.interfacesData.length,productCtrl.hasActiveEnvironment.length).then((function(response){"SUCCESS"==response.errorCode?(productCtrl.interfacesData.splice(index,1),productCtrl.dtInstanceInterfaces.reloadData((function(data){}),!0)):toastr.error("Interface # "+productCtrl.interfacesData[index].interface_name,"Failed to delete : "+response.message)}))})):TDMService.deleteProductInterface(productCtrl.productData.product_id,productCtrl.productData.product_name,productCtrl.interfacesData[index].interface_id,productCtrl.interfacesData[index].interface_name,productCtrl.interfacesData.length,productCtrl.hasActiveEnvironment.length).then((function(response){"SUCCESS"==response.errorCode?(productCtrl.interfacesData.splice(index,1),productCtrl.dtInstanceInterfaces.reloadData((function(data){}),!0)):toastr.error("Interface # "+productCtrl.interfacesData[index].interface_name,"Failed to delete : "+response.message)}))},productCtrl.addLogicalUnit=function(){$uibModal.open({templateUrl:"views/products/productLogicalUnitModal.html",resolve:{productID:function(){return productCtrl.productData.product_id},productName:function(){return productCtrl.productData.product_name}},controller:function($scope,$uibModalInstance,TDMService,productID,productName){var productLogicalUnitCtrl=this;productLogicalUnitCtrl.title="ADD_LOGICAL_UNIT",TDMService.getLogicalUnitsWithoutProduct().then((function(response){"SUCCESS"==response.errorCode?(productLogicalUnitCtrl.logicalUnitsWithoutProductData=_.map(response.result,(function(lu){return lu.be_id=parseInt(lu.be_id),lu})),TDMService.getBusinessEntities().then((function(response){"SUCCESS"==response.errorCode?productLogicalUnitCtrl.businessEntities=_.filter(response.result,(function(be){return!("Active"!=be.be_status||!_.find(productLogicalUnitCtrl.logicalUnitsWithoutProductData,{be_id:be.be_id}))})):productLogicalUnitCtrl.businessEntitiesAlert={type:"danger",msg:"failed to get logical units without system"}}))):productLogicalUnitCtrl.logicalUnitAlert={type:"danger",msg:"failed to get logical units without system"}})),productLogicalUnitCtrl.addLogicalUnit=function(){var be_id=-1;if(productLogicalUnitCtrl.newProductLogicalUnit&&productLogicalUnitCtrl.newProductLogicalUnit.length>0){be_id=productLogicalUnitCtrl.newProductLogicalUnit[0].be_id;var body={product_id:productID,product_name:productName,logicalUnits:productLogicalUnitCtrl.newProductLogicalUnit,be_id:be_id};TDMService.putLogicalUnits(body).then((function(response){"SUCCESS"==response.errorCode?$uibModalInstance.close(productLogicalUnitCtrl.newProductLogicalUnit):productLogicalUnitCtrl.logicalUnitAlert={type:"danger",msg:"failed to Add Logical Unit ["+response.message+"]"}}))}},productLogicalUnitCtrl.closeAlert=function(){delete productLogicalUnitCtrl.logicalUnitAlert},productLogicalUnitCtrl.close=function(){$uibModalInstance.close()}},controllerAs:"productLogicalUnitCtrl"}).result.then((function(newProductLogicalUnit){if(newProductLogicalUnit)for(var i=0;i<newProductLogicalUnit.length;i++)newProductLogicalUnit[i].product_id=productCtrl.productData.product_id,newProductLogicalUnit[i].product_name=productCtrl.productData.product_name,productCtrl.logicalUnitsData.push(newProductLogicalUnit[i]);productCtrl.dtInstanceLUs.reloadData((function(data){}),!0)}))},productCtrl.removeLogicalUnit=function(index){var el=angular.copy(productCtrl.logicalUnitsData).splice(index,1);el[0].product_id=-1,el[0].product_name="",TDMService.putLogicalUnit(el[0]).then((function(response){if("SUCCESS"==response.errorCode){if(productCtrl.logicalUnitsData.splice(index,1),0==productCtrl.logicalUnitsData.length)for(var i=0;i<productCtrl.hasActiveEnvironment.length;i++)TDMService.deleteEnvProduct(productCtrl.hasActiveEnvironment[i].environment_id,productCtrl.hasActiveEnvironment[i].environment_name,productCtrl.productData.product_id).then((function(response){}));productCtrl.dtInstanceLUs.reloadData((function(data){}),!0)}else toastr.error("Logical Unit "+productCtrl.logicalUnitsData[index].lu_name,"Failed to delete : "+response.message)}))},productCtrl.loadingTableInterfaces=!0,TDMService.getProductEnvCount(productCtrl.productData.product_id).then((function(response){"SUCCESS"==response.errorCode?(productCtrl.hasActiveEnvironment=response.result,productCtrl.loadingTableLUs=!0,TDMService.getProductLogicalUnits(productCtrl.productData.product_id).then((function(response){if("SUCCESS"==response.errorCode){productCtrl.logicalUnitsData=response.result,productCtrl.dtInstanceLUs={},productCtrl.dtColumnsLUs=[],productCtrl.dtColumnDefsLUs=[],productCtrl.headersLUs=[{column:"actions",name:"",clickAble:!1},{column:"lu_name",name:"Name",clickAble:!0},{column:"lu_description",name:"Description",clickAble:!1},{column:"lu_parent_name",name:"Parent LU",clickAble:!1},{column:"be_name",name:"Business Entity",clickAble:!1}];for(var renderLUActions=function(data,type,full,meta){return'<div style="display: flex;justify-content: space-around;max-width: 100px;"><div ><img  src="icons/delete-icon.svg" alt="delete"  uib-tooltip="Remove Logical Unit" tooltip-placement="right"  tooltip-append-to-body="true"mwl-confirm message="'+(productCtrl.hasActiveEnvironment.length>0?1==productCtrl.logicalUnitsData.length?"Logical Unit "+full.lu_name+" is attached to testing environments. If you remove this Logical Unit, system may be removed from environments. Tasks for this system may be also deleted. Are you sure you want to delete it ?":"Logical Unit "+full.lu_name+" is attached to testing environments. Are you sure you want to delete it ?":"Are you sure you want to delete this Logical Unit?")+'" confirm-text="Yes <i class=\'glyphicon glyphicon-ok\'</i>" cancel-text="No <i class=\'glyphicon glyphicon-remove\'></i>"  placement="right" on-confirm="productCtrl.removeLogicalUnit('+meta.row+')" on-cancel="cancelClicked = true" confirm-button-type="danger" cancel-button-type="default"role-handler="" role="0" ng-if="!productCtrl.disableChange"></div></div>'},i=0;i<productCtrl.headersLUs.length;i++)"actions"==productCtrl.headersLUs[i].column?productCtrl.dtColumnsLUs.push(DTColumnBuilder.newColumn(productCtrl.headersLUs[i].column).withTitle(productCtrl.headersLUs[i].name).renderWith(renderLUActions)):productCtrl.dtColumnsLUs.push(DTColumnBuilder.newColumn(productCtrl.headersLUs[i].column).withTitle(productCtrl.headersLUs[i].name));var getTableDataLUs=function(){var deferred=$q.defer();return deferred.resolve(productCtrl.logicalUnitsData),deferred.promise};productCtrl.dtOptionsLUs=DTOptionsBuilder.fromFnPromise((function(){return getTableDataLUs()})).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("scrollX",!1).withOption("lengthChange",!1).withOption("paging",!1).withOption("searching",!1).withOption("info",!1).withButtons([]).withButtons([]).withOption("search",{caseInsensitive:!1}),productCtrl.dtInstanceCallbackLUs=function(dtInstance){angular.isFunction(productCtrl.dtInstanceLUs)?productCtrl.dtInstance(dtInstance):angular.isDefined(productCtrl.dtInstanceLUs)&&(productCtrl.dtInstanceLUs=dtInstance)},null!=productCtrl.dtInstanceLUs.changeData&&productCtrl.dtInstanceLUs.changeData(getTableDataLUs()),productCtrl.loadingTableLUs=!1}else toastr.error("System # "+productCtrl.productData.product_name,"failed to get Logical Units")}))):productCtrl.hasActiveEnvironment=[]})),productCtrl.saveChanges=function(){var productToUpdate=angular.copy(productCtrl.productData);productToUpdate.product_versions=productToUpdate.product_versions.join(","),TDMService.updateProduct(productCtrl.productData.product_id,productToUpdate).then((function(response){"SUCCESS"==response.errorCode?(toastr.success("System # "+productCtrl.productData.product_name,"Updated Successfully"),$timeout((function(){$scope.content.openProducts()}),400)):toastr.error("System # "+productCtrl.productData.product_name,"failed to Update : "+response.message)}))},productCtrl.deleteProduct=function(){productCtrl.hasActiveEnvironment.length>0?SweetAlert.swal({title:"System may be deleted from environments. Related tasks may also be deleted,Are you sure ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"No",cancelButtonText:"Yes",closeOnConfirm:!0,closeOnCancel:!0,animation:"false",customClass:"animated fadeInUp"},(function(isConfirm){isConfirm||TDMService.deleteProduct(productCtrl.productData.product_id).then((function(response){"SUCCESS"==response.errorCode?(toastr.success("System # "+productCtrl.productData.product_id,"deleted Successfully"),$timeout((function(){$scope.content.openProducts()}),400)):toastr.error("System # "+productCtrl.productData.product_id,"failed to delete")}))})):TDMService.deleteProduct(productCtrl.productData.product_id).then((function(response){"SUCCESS"==response.errorCode?(toastr.success("System # "+productCtrl.productData.product_id,"deleted Successfully"),$timeout((function(){$scope.content.openProducts()}),400)):toastr.error("System # "+productCtrl.productData.product_id,"failed to delete")}))},productCtrl.addVersion=function(newVersion){newVersion&&(productCtrl.productData.product_versions||(productCtrl.productData.product_versions=[]),productCtrl.productData.product_versions.indexOf(newVersion)>=0?productCtrl.addVersionError=!0:(productCtrl.productData.product_versions.push(newVersion),productCtrl.isOpen=!1))},productCtrl.initAddVersionPopup=function(){productCtrl.addVersionError=!1,productCtrl.versionToAdd="",productCtrl.isOpen=!0},BreadCrumbsService.push({productID:productCtrl.productData.product_name},"PRODUCT_BREADCRUMB",(function(){}))},controllerAs:"productCtrl"}}angular.module("TDM-FE").directive("productDirective",productDirective);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvcHJvZHVjdHMvcHJvZHVjdERpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJwcm9kdWN0RGlyZWN0aXZlIiwicmVzdHJpY3QiLCJ0ZW1wbGF0ZVVybCIsInNjb3BlIiwiY29udGVudCIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkY29tcGlsZSIsIlRETVNlcnZpY2UiLCJCcmVhZENydW1ic1NlcnZpY2UiLCIkdWliTW9kYWwiLCJ0b2FzdHIiLCIkdGltZW91dCIsIlN3ZWV0QWxlcnQiLCJBdXRoU2VydmljZSIsIkRUQ29sdW1uQnVpbGRlciIsIkRUT3B0aW9uc0J1aWxkZXIiLCIkcSIsInByb2R1Y3RDdHJsIiwidGhpcyIsInByb2R1Y3REYXRhIiwicHJvZHVjdF92ZXJzaW9ucyIsInNwbGl0Iiwic3VwcG9ydGVkREJUeXBlcyIsImdldERCVHlwZXMiLCJkaXNhYmxlQ2hhbmdlIiwicHJvZHVjdF9zdGF0dXMiLCJhdXRob3JpemVkVG9FZGl0Iiwib3BlblByb2R1Y3RzIiwiYWRkSW50ZXJmYWNlIiwidXBkYXRlIiwiaW5kZXgiLCJwcm9kdWN0SW50ZXJmYWNlIiwiYW5ndWxhciIsImNvcHkiLCJpbnRlcmZhY2VzRGF0YSIsIm9wZW4iLCJyZXNvbHZlIiwicHJvZHVjdElEIiwicHJvZHVjdF9pZCIsInByb2R1Y3ROYW1lIiwicHJvZHVjdF9uYW1lIiwiJHVpYk1vZGFsSW5zdGFuY2UiLCJwcm9kdWN0SW50ZXJmYWNlc0N0cmwiLCJwcm9kdWN0REJJbnRlcmZhY2UiLCJzYXZlQnV0dG9uIiwiZ2VuZXJhbF9pbnRlcmZhY2VfdHlwZV9pZCIsImludGVyZmFjZV90eXBlX2lkIiwidGl0bGUiLCJhZGRQcm9kdWN0REJJbnRlcmZhY2UiLCJpbnRlcmZhY2VfbmFtZSIsIl8iLCJmaW5kIiwiZXJyb3IiLCJwdXRQcm9kdWN0SW50ZXJmYWNlIiwiaW50ZXJmYWNlX2lkIiwidGhlbiIsInJlc3BvbnNlIiwiZXJyb3JDb2RlIiwiY2xvc2UiLCJoYXNBY3RpdmVFbnZpcm9ubWVudCIsImxlbmd0aCIsImVudk1lc3NhZ2UiLCJpIiwiZW52aXJvbm1lbnRfbmFtZSIsInN3YWwiLCJ0eXBlIiwidGV4dCIsImludGVyZmFjZXNBbGVydCIsIm1zZyIsIm1lc3NhZ2UiLCJwb3N0UHJvZHVjdEludGVyZmFjZSIsInJlc3VsdCIsImNvbnRyb2xsZXJBcyIsInB1c2giLCJkdEluc3RhbmNlSW50ZXJmYWNlcyIsInJlbG9hZERhdGEiLCJkYXRhIiwicmVtb3ZlSW50ZXJmYWNlIiwic2hvd0NhbmNlbEJ1dHRvbiIsImNvbmZpcm1CdXR0b25Db2xvciIsImNvbmZpcm1CdXR0b25UZXh0IiwiY2FuY2VsQnV0dG9uVGV4dCIsImNsb3NlT25Db25maXJtIiwiY2xvc2VPbkNhbmNlbCIsImFuaW1hdGlvbiIsImN1c3RvbUNsYXNzIiwiaXNDb25maXJtIiwiZGVsZXRlUHJvZHVjdEludGVyZmFjZSIsInNwbGljZSIsImFkZExvZ2ljYWxVbml0IiwicHJvZHVjdExvZ2ljYWxVbml0Q3RybCIsImdldExvZ2ljYWxVbml0c1dpdGhvdXRQcm9kdWN0IiwibG9naWNhbFVuaXRzV2l0aG91dFByb2R1Y3REYXRhIiwibWFwIiwibHUiLCJiZV9pZCIsInBhcnNlSW50IiwiZ2V0QnVzaW5lc3NFbnRpdGllcyIsImJ1c2luZXNzRW50aXRpZXMiLCJmaWx0ZXIiLCJiZSIsImJlX3N0YXR1cyIsImJ1c2luZXNzRW50aXRpZXNBbGVydCIsImxvZ2ljYWxVbml0QWxlcnQiLCJuZXdQcm9kdWN0TG9naWNhbFVuaXQiLCJib2R5IiwibG9naWNhbFVuaXRzIiwicHV0TG9naWNhbFVuaXRzIiwiY2xvc2VBbGVydCIsImxvZ2ljYWxVbml0c0RhdGEiLCJkdEluc3RhbmNlTFVzIiwicmVtb3ZlTG9naWNhbFVuaXQiLCJlbCIsInB1dExvZ2ljYWxVbml0IiwiZGVsZXRlRW52UHJvZHVjdCIsImVudmlyb25tZW50X2lkIiwibHVfbmFtZSIsImxvYWRpbmdUYWJsZUludGVyZmFjZXMiLCJnZXRQcm9kdWN0RW52Q291bnQiLCJsb2FkaW5nVGFibGVMVXMiLCJnZXRQcm9kdWN0TG9naWNhbFVuaXRzIiwiZHRDb2x1bW5zTFVzIiwiZHRDb2x1bW5EZWZzTFVzIiwiaGVhZGVyc0xVcyIsImNvbHVtbiIsIm5hbWUiLCJjbGlja0FibGUiLCJyZW5kZXJMVUFjdGlvbnMiLCJmdWxsIiwibWV0YSIsInJvdyIsIm5ld0NvbHVtbiIsIndpdGhUaXRsZSIsInJlbmRlcldpdGgiLCJnZXRUYWJsZURhdGFMVXMiLCJkZWZlcnJlZCIsImRlZmVyIiwicHJvbWlzZSIsImR0T3B0aW9uc0xVcyIsImZyb21GblByb21pc2UiLCJ3aXRoRE9NIiwid2l0aE9wdGlvbiIsImVsZW1lbnQiLCJjb250ZW50cyIsIndpdGhCdXR0b25zIiwiY2FzZUluc2Vuc2l0aXZlIiwiZHRJbnN0YW5jZUNhbGxiYWNrTFVzIiwiZHRJbnN0YW5jZSIsImlzRnVuY3Rpb24iLCJpc0RlZmluZWQiLCJjaGFuZ2VEYXRhIiwic2F2ZUNoYW5nZXMiLCJwcm9kdWN0VG9VcGRhdGUiLCJqb2luIiwidXBkYXRlUHJvZHVjdCIsInN1Y2Nlc3MiLCJkZWxldGVQcm9kdWN0IiwiYWRkVmVyc2lvbiIsIm5ld1ZlcnNpb24iLCJpbmRleE9mIiwiYWRkVmVyc2lvbkVycm9yIiwiaXNPcGVuIiwiaW5pdEFkZFZlcnNpb25Qb3B1cCIsInZlcnNpb25Ub0FkZCIsIm1vZHVsZSIsImRpcmVjdGl2ZSJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsbUJBaW5CTCxNQUFPLENBQ0hDLFNBQVUsSUFDVkMsWUFqbkJXLDhCQWtuQlhDLE1BQU8sQ0FDSEMsUUFBUyxLQUViQyxXQW5uQmEsU0FBVUMsT0FBT0MsU0FBVUMsV0FBWUMsbUJBQW9CQyxVQUFXQyxPQUFRQyxTQUFVQyxXQUFZQyxZQUFZQyxnQkFBZ0JDLGlCQUFpQkMsSUFDOUosSUFBSUMsWUFBY0MsS0FDbEJELFlBQVlFLFlBQWNkLE9BQU9GLFFBQVFnQixZQUV6Q0YsWUFBWUUsWUFBWUMsaUJBQW1CSCxZQUFZRSxZQUFZQyxpQkFB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dWN0RGlyZWN0aXZlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gcHJvZHVjdERpcmVjdGl2ZSgpIHtcblxuICAgIHZhciB0ZW1wbGF0ZSA9IFwidmlld3MvcHJvZHVjdHMvcHJvZHVjdC5odG1sXCI7XG5cbiAgICB2YXIgY29udHJvbGxlciA9IGZ1bmN0aW9uICgkc2NvcGUsJGNvbXBpbGUsIFRETVNlcnZpY2UsIEJyZWFkQ3J1bWJzU2VydmljZSwgJHVpYk1vZGFsLCB0b2FzdHIsICR0aW1lb3V0LCBTd2VldEFsZXJ0LCBBdXRoU2VydmljZSxEVENvbHVtbkJ1aWxkZXIsRFRPcHRpb25zQnVpbGRlciwkcSkge1xuICAgICAgICB2YXIgcHJvZHVjdEN0cmwgPSB0aGlzO1xuICAgICAgICBwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YSA9ICRzY29wZS5jb250ZW50LnByb2R1Y3REYXRhO1xuXG4gICAgICAgIHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfdmVyc2lvbnMgPSBwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X3ZlcnNpb25zLnNwbGl0KCcsJyk7XG5cbiAgICAgICAgcHJvZHVjdEN0cmwuc3VwcG9ydGVkREJUeXBlcyA9IFRETVNlcnZpY2UuZ2V0REJUeXBlcygpO1xuICAgICAgICBwcm9kdWN0Q3RybC5kaXNhYmxlQ2hhbmdlID0gKHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3Rfc3RhdHVzID09ICdJbmFjdGl2ZScgfHwgIUF1dGhTZXJ2aWNlLmF1dGhvcml6ZWRUb0VkaXQoMCkgfHwgISRzY29wZS5jb250ZW50Lm9wZW5Qcm9kdWN0cyk7XG5cbiAgICAgICAgcHJvZHVjdEN0cmwuYWRkSW50ZXJmYWNlID0gZnVuY3Rpb24gKHVwZGF0ZSwgaW5kZXgpIHtcbiAgICAgICAgICAgIGlmICh1cGRhdGUgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwcm9kdWN0SW50ZXJmYWNlID0gYW5ndWxhci5jb3B5KHByb2R1Y3RDdHJsLmludGVyZmFjZXNEYXRhW2luZGV4XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcHJvZHVjdEludGVyZmFjZXNNb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wcm9kdWN0cy9wcm9kdWN0REJJbnRlcmZhY2VNb2RhbC5odG1sJyxcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJRDogcHJvZHVjdEN0cmwucHJvZHVjdERhdGEucHJvZHVjdF9pZCxcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X25hbWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gKCRzY29wZSwgJHVpYk1vZGFsSW5zdGFuY2UsIFRETVNlcnZpY2UsIHByb2R1Y3RJRCwgcHJvZHVjdE5hbWUpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvZHVjdEludGVyZmFjZXNDdHJsID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEludGVyZmFjZXNDdHJsLnByb2R1Y3REQkludGVyZmFjZSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW50ZXJmYWNlc0N0cmwuc2F2ZUJ1dHRvbiA9IFwiQUREXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGUgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEludGVyZmFjZXNDdHJsLnByb2R1Y3REQkludGVyZmFjZSA9IHByb2R1Y3RJbnRlcmZhY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW50ZXJmYWNlc0N0cmwucHJvZHVjdERCSW50ZXJmYWNlLmdlbmVyYWxfaW50ZXJmYWNlX3R5cGVfaWQgPSBwcm9kdWN0SW50ZXJmYWNlc0N0cmwucHJvZHVjdERCSW50ZXJmYWNlLmludGVyZmFjZV90eXBlX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEludGVyZmFjZXNDdHJsLnNhdmVCdXR0b24gPSBcIlNBVkVcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW50ZXJmYWNlc0N0cmwuc3VwcG9ydGVkREJUeXBlcyA9IFRETVNlcnZpY2UuZ2V0REJUeXBlcygpO1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW50ZXJmYWNlc0N0cmwudGl0bGUgPSBcIkFERF9EQl9JTlRFUkZBQ0VcIjtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEludGVyZmFjZXNDdHJsLmFkZFByb2R1Y3REQkludGVyZmFjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0SW50ZXJmYWNlc0N0cmwucHJvZHVjdERCSW50ZXJmYWNlLmludGVyZmFjZV9uYW1lICYmIHByb2R1Y3RJbnRlcmZhY2VzQ3RybC5wcm9kdWN0REJJbnRlcmZhY2UuaW50ZXJmYWNlX3R5cGVfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uZmluZChwcm9kdWN0Q3RybC5pbnRlcmZhY2VzRGF0YSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludGVyZmFjZV9uYW1lOiBwcm9kdWN0SW50ZXJmYWNlc0N0cmwucHJvZHVjdERCSW50ZXJmYWNlLmludGVyZmFjZV9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludGVyZmFjZV90eXBlX2lkOiBwcm9kdWN0SW50ZXJmYWNlc0N0cmwucHJvZHVjdERCSW50ZXJmYWNlLmludGVyZmFjZV90eXBlX2lkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvYXN0ci5lcnJvcihcIk5vIENoYW5nZXMgTWFkZSBPciBJbnRlcmZhY2UgV2l0aCBUaGUgU2FtZSBOYW1lIEFuZCBUeXBlIEFscmVhZHkgRXhpc3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRETVNlcnZpY2UucHV0UHJvZHVjdEludGVyZmFjZShwcm9kdWN0SUQsIHByb2R1Y3ROYW1lLCBwcm9kdWN0SW50ZXJmYWNlLmludGVyZmFjZV9pZCwgcHJvZHVjdEludGVyZmFjZXNDdHJsLnByb2R1Y3REQkludGVyZmFjZSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvZHVjdEludGVyZmFjZXNDdHJsLnByb2R1Y3REQkludGVyZmFjZS5nZW5lcmFsX2ludGVyZmFjZV90eXBlX2lkID09IHByb2R1Y3RJbnRlcmZhY2VzQ3RybC5wcm9kdWN0REJJbnRlcmZhY2UuaW50ZXJmYWNlX3R5cGVfaWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdWliTW9kYWxJbnN0YW5jZS5jbG9zZShwcm9kdWN0SW50ZXJmYWNlc0N0cmwucHJvZHVjdERCSW50ZXJmYWNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvZHVjdEN0cmwuaGFzQWN0aXZlRW52aXJvbm1lbnQubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbnZNZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcHJvZHVjdEN0cmwuaGFzQWN0aXZlRW52aXJvbm1lbnQubGVuZ3RoIDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudk1lc3NhZ2UgPSBlbnZNZXNzYWdlICsgcHJvZHVjdEN0cmwuaGFzQWN0aXZlRW52aXJvbm1lbnRbaV0uZW52aXJvbm1lbnRfbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpIDwgcHJvZHVjdEN0cmwuaGFzQWN0aXZlRW52aXJvbm1lbnQubGVuZ3RoIC0gMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW52TWVzc2FnZSA9IGVudk1lc3NhZ2UgKyBcIixcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTd2VldEFsZXJ0LnN3YWwoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiV2FybmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA6IFwid2FybmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJQbGVhc2UgVXBkYXRlIHRoZSBpbnRlcmZhY2UgZGV0YWlscyBmb3IgcmVsYXRlZCBlbnZpcm9ubWVudHMgW1wiICsgZW52TWVzc2FnZSArIFwiXVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdWliTW9kYWxJbnN0YW5jZS5jbG9zZShwcm9kdWN0SW50ZXJmYWNlc0N0cmwucHJvZHVjdERCSW50ZXJmYWNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbnRlcmZhY2VzQ3RybC5pbnRlcmZhY2VzQWxlcnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2c6ICdmYWlsZWQgdG8gVXBkYXRlIERCIEludGVyZmFjZSBbJyArIHJlc3BvbnNlLm1lc3NhZ2UgKyAnXSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uZmluZChwcm9kdWN0Q3RybC5pbnRlcmZhY2VzRGF0YSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludGVyZmFjZV9uYW1lOiBwcm9kdWN0SW50ZXJmYWNlc0N0cmwucHJvZHVjdERCSW50ZXJmYWNlLmludGVyZmFjZV9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludGVyZmFjZV90eXBlX2lkOiBwcm9kdWN0SW50ZXJmYWNlc0N0cmwucHJvZHVjdERCSW50ZXJmYWNlLmludGVyZmFjZV90eXBlX2lkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvYXN0ci5lcnJvcihcIkludGVyZmFjZSBXaXRoIFRoZSBTYW1lIE5hbWUgQW5kIFR5cGUgQWxyZWFkeSBFeGlzdHNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVERNU2VydmljZS5wb3N0UHJvZHVjdEludGVyZmFjZShwcm9kdWN0SUQsIHByb2R1Y3ROYW1lLCBwcm9kdWN0SW50ZXJmYWNlc0N0cmwucHJvZHVjdERCSW50ZXJmYWNlKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0Q3RybC5oYXNBY3RpdmVFbnZpcm9ubWVudC5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVudk1lc3NhZ2UgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCBwcm9kdWN0Q3RybC5oYXNBY3RpdmVFbnZpcm9ubWVudC5sZW5ndGggOyBpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW52TWVzc2FnZSA9IGVudk1lc3NhZ2UgKyBwcm9kdWN0Q3RybC5oYXNBY3RpdmVFbnZpcm9ubWVudFtpXS5lbnZpcm9ubWVudF9uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCBwcm9kdWN0Q3RybC5oYXNBY3RpdmVFbnZpcm9ubWVudC5sZW5ndGggLSAxKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnZNZXNzYWdlID0gZW52TWVzc2FnZSArIFwiLFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN3ZWV0QWxlcnQuc3dhbCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJXYXJuaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlIDogXCJ3YXJuaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIlBsZWFzZSBhZGQgdGhlIGludGVyZmFjZSBkZXRhaWxzIGZvciByZWxhdGVkIGVudmlyb25tZW50cyBbXCIgKyBlbnZNZXNzYWdlICsgXCJdXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbnRlcmZhY2VzQ3RybC5wcm9kdWN0REJJbnRlcmZhY2UuaW50ZXJmYWNlX2lkID0gcmVzcG9uc2UucmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR1aWJNb2RhbEluc3RhbmNlLmNsb3NlKHByb2R1Y3RJbnRlcmZhY2VzQ3RybC5wcm9kdWN0REJJbnRlcmZhY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEludGVyZmFjZXNDdHJsLmludGVyZmFjZXNBbGVydCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZzogJ2ZhaWxlZCB0byBBZGQgREIgSW50ZXJmYWNlIFsnICsgcmVzcG9uc2UubWVzc2FnZSArICddJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbnRlcmZhY2VzQ3RybC5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICR1aWJNb2RhbEluc3RhbmNlLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdwcm9kdWN0SW50ZXJmYWNlc0N0cmwnXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocHJvZHVjdEludGVyZmFjZSkge1xuICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0SW50ZXJmYWNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGUgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuaW50ZXJmYWNlc0RhdGFbaW5kZXhdID0gcHJvZHVjdEludGVyZmFjZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLmludGVyZmFjZXNEYXRhLnB1c2gocHJvZHVjdEludGVyZmFjZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuZHRJbnN0YW5jZUludGVyZmFjZXMucmVsb2FkRGF0YShmdW5jdGlvbihkYXRhKXt9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBwcm9kdWN0Q3RybC5yZW1vdmVJbnRlcmZhY2UgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIGlmIChwcm9kdWN0Q3RybC5oYXNBY3RpdmVFbnZpcm9ubWVudC5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICBTd2VldEFsZXJ0LnN3YWwoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IChwcm9kdWN0Q3RybC5pbnRlcmZhY2VzRGF0YS5sZW5ndGggPT0gMSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQcm9kdWN0IG1heSBiZSBkZWxldGVkIGZyb20gZW52aXJvbm1lbnRzLiBSZWxhdGVkIHRhc2tzIG1heSBhbHNvIGJlIGRlbGV0ZWRcIiA6IFwiSW50ZXJmYWNlIG1heSBiZSBhbHNvIGRlbGV0ZWQgZnJvbSBlbnZpcm9ubWVudHMgaGF2aW5nIHRoaXMgcHJvZHVjdC5cIiApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkFyZSB5b3Ugc3VyZSA/XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIndhcm5pbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6IFwiI0RENkI1NVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IFwiTm9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6IFwiWWVzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlT25DYW5jZWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IFwiZmFsc2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbUNsYXNzIDogXCJhbmltYXRlZCBmYWRlSW5VcFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChpc0NvbmZpcm0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNDb25maXJtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVERNU2VydmljZS5kZWxldGVQcm9kdWN0SW50ZXJmYWNlKHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfaWQsIHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfbmFtZSwgcHJvZHVjdEN0cmwuaW50ZXJmYWNlc0RhdGFbaW5kZXhdLmludGVyZmFjZV9pZCwgcHJvZHVjdEN0cmwuaW50ZXJmYWNlc0RhdGFbaW5kZXhdLmludGVyZmFjZV9uYW1lLHByb2R1Y3RDdHJsLmludGVyZmFjZXNEYXRhLmxlbmd0aCxwcm9kdWN0Q3RybC5oYXNBY3RpdmVFbnZpcm9ubWVudC5sZW5ndGgpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLmludGVyZmFjZXNEYXRhLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5kdEluc3RhbmNlSW50ZXJmYWNlcy5yZWxvYWREYXRhKGZ1bmN0aW9uKGRhdGEpe30sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiSW50ZXJmYWNlICMgXCIgKyBwcm9kdWN0Q3RybC5pbnRlcmZhY2VzRGF0YVtpbmRleF0uaW50ZXJmYWNlX25hbWUsIFwiRmFpbGVkIHRvIGRlbGV0ZSA6IFwiICsgcmVzcG9uc2UubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIFRETVNlcnZpY2UuZGVsZXRlUHJvZHVjdEludGVyZmFjZShwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X2lkLCBwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X25hbWUsIHByb2R1Y3RDdHJsLmludGVyZmFjZXNEYXRhW2luZGV4XS5pbnRlcmZhY2VfaWQsIHByb2R1Y3RDdHJsLmludGVyZmFjZXNEYXRhW2luZGV4XS5pbnRlcmZhY2VfbmFtZSxwcm9kdWN0Q3RybC5pbnRlcmZhY2VzRGF0YS5sZW5ndGgscHJvZHVjdEN0cmwuaGFzQWN0aXZlRW52aXJvbm1lbnQubGVuZ3RoKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlID09IFwiU1VDQ0VTU1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5pbnRlcmZhY2VzRGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuZHRJbnN0YW5jZUludGVyZmFjZXMucmVsb2FkRGF0YShmdW5jdGlvbihkYXRhKXt9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIkludGVyZmFjZSAjIFwiICsgcHJvZHVjdEN0cmwuaW50ZXJmYWNlc0RhdGFbaW5kZXhdLmludGVyZmFjZV9uYW1lLCBcIkZhaWxlZCB0byBkZWxldGUgOiBcIiArIHJlc3BvbnNlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBwcm9kdWN0Q3RybC5hZGRMb2dpY2FsVW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwcm9kdWN0TG9naWNhbFVuaXRNb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcHJvZHVjdHMvcHJvZHVjdExvZ2ljYWxVbml0TW9kYWwuaHRtbCcsXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SUQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X2lkXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZHVjdEN0cmwucHJvZHVjdERhdGEucHJvZHVjdF9uYW1lXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uICgkc2NvcGUsICR1aWJNb2RhbEluc3RhbmNlLCBURE1TZXJ2aWNlLCBwcm9kdWN0SUQsIHByb2R1Y3ROYW1lKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb2R1Y3RMb2dpY2FsVW5pdEN0cmwgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0TG9naWNhbFVuaXRDdHJsLnRpdGxlID0gXCJBRERfTE9HSUNBTF9VTklUXCI7XG5cblxuICAgICAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLmdldExvZ2ljYWxVbml0c1dpdGhvdXRQcm9kdWN0KCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0TG9naWNhbFVuaXRDdHJsLmxvZ2ljYWxVbml0c1dpdGhvdXRQcm9kdWN0RGF0YSA9IF8ubWFwKHJlc3BvbnNlLnJlc3VsdCxmdW5jdGlvbihsdSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGx1LmJlX2lkID0gcGFyc2VJbnQobHUuYmVfaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbHU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVERNU2VydmljZS5nZXRCdXNpbmVzc0VudGl0aWVzKCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RMb2dpY2FsVW5pdEN0cmwuYnVzaW5lc3NFbnRpdGllcyA9IF8uZmlsdGVyKHJlc3BvbnNlLnJlc3VsdCxmdW5jdGlvbihiZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmJlX3N0YXR1cyA9PSAnQWN0aXZlJyAmJiBfLmZpbmQocHJvZHVjdExvZ2ljYWxVbml0Q3RybC5sb2dpY2FsVW5pdHNXaXRob3V0UHJvZHVjdERhdGEse2JlX2lkIDogYmUuYmVfaWR9KSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RMb2dpY2FsVW5pdEN0cmwuYnVzaW5lc3NFbnRpdGllc0FsZXJ0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLCBtc2c6ICdmYWlsZWQgdG8gZ2V0IGxvZ2ljYWwgdW5pdHMgd2l0aG91dCBzeXN0ZW0nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RMb2dpY2FsVW5pdEN0cmwubG9naWNhbFVuaXRBbGVydCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsIG1zZzogJ2ZhaWxlZCB0byBnZXQgbG9naWNhbCB1bml0cyB3aXRob3V0IHN5c3RlbSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RMb2dpY2FsVW5pdEN0cmwuYWRkTG9naWNhbFVuaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmVfaWQgPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0TG9naWNhbFVuaXRDdHJsLm5ld1Byb2R1Y3RMb2dpY2FsVW5pdCAmJiBwcm9kdWN0TG9naWNhbFVuaXRDdHJsLm5ld1Byb2R1Y3RMb2dpY2FsVW5pdC5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZV9pZCA9IHByb2R1Y3RMb2dpY2FsVW5pdEN0cmwubmV3UHJvZHVjdExvZ2ljYWxVbml0WzBdLmJlX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJvZHkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF9pZCA6IHByb2R1Y3RJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X25hbWUgOiBwcm9kdWN0TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dpY2FsVW5pdHMgOiBwcm9kdWN0TG9naWNhbFVuaXRDdHJsLm5ld1Byb2R1Y3RMb2dpY2FsVW5pdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZV9pZCA6IGJlX2lkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLnB1dExvZ2ljYWxVbml0cyhib2R5KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVpYk1vZGFsSW5zdGFuY2UuY2xvc2UocHJvZHVjdExvZ2ljYWxVbml0Q3RybC5uZXdQcm9kdWN0TG9naWNhbFVuaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdExvZ2ljYWxVbml0Q3RybC5sb2dpY2FsVW5pdEFsZXJ0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsIG1zZzogJ2ZhaWxlZCB0byBBZGQgTG9naWNhbCBVbml0IFsnICsgcmVzcG9uc2UubWVzc2FnZSArICddJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdExvZ2ljYWxVbml0Q3RybC5jbG9zZUFsZXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHByb2R1Y3RMb2dpY2FsVW5pdEN0cmwubG9naWNhbFVuaXRBbGVydDtcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0TG9naWNhbFVuaXRDdHJsLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHVpYk1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3Byb2R1Y3RMb2dpY2FsVW5pdEN0cmwnXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAobmV3UHJvZHVjdExvZ2ljYWxVbml0KSB7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1Byb2R1Y3RMb2dpY2FsVW5pdCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCA7IGkgPCBuZXdQcm9kdWN0TG9naWNhbFVuaXQubGVuZ3RoIDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Byb2R1Y3RMb2dpY2FsVW5pdFtpXS5wcm9kdWN0X2lkID0gcHJvZHVjdEN0cmwucHJvZHVjdERhdGEucHJvZHVjdF9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Byb2R1Y3RMb2dpY2FsVW5pdFtpXS5wcm9kdWN0X25hbWUgPSBwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X25hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5sb2dpY2FsVW5pdHNEYXRhLnB1c2gobmV3UHJvZHVjdExvZ2ljYWxVbml0W2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5kdEluc3RhbmNlTFVzLnJlbG9hZERhdGEoZnVuY3Rpb24oZGF0YSl7fSwgdHJ1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBwcm9kdWN0Q3RybC5yZW1vdmVMb2dpY2FsVW5pdCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdmFyIHRtcEFyciA9IGFuZ3VsYXIuY29weShwcm9kdWN0Q3RybC5sb2dpY2FsVW5pdHNEYXRhKTtcbiAgICAgICAgICAgIHZhciBlbCA9IHRtcEFyci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgZWxbMF0ucHJvZHVjdF9pZCA9IC0xO1xuICAgICAgICAgICAgZWxbMF0ucHJvZHVjdF9uYW1lID0gJyc7XG4gICAgICAgICAgICBURE1TZXJ2aWNlLnB1dExvZ2ljYWxVbml0KGVsWzBdKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwubG9naWNhbFVuaXRzRGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvZHVjdEN0cmwubG9naWNhbFVuaXRzRGF0YS5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDtpIDwgIHByb2R1Y3RDdHJsLmhhc0FjdGl2ZUVudmlyb25tZW50Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLmRlbGV0ZUVudlByb2R1Y3QocHJvZHVjdEN0cmwuaGFzQWN0aXZlRW52aXJvbm1lbnRbaV0uZW52aXJvbm1lbnRfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLmhhc0FjdGl2ZUVudmlyb25tZW50W2ldLmVudmlyb25tZW50X25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfaWQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuZHRJbnN0YW5jZUxVcy5yZWxvYWREYXRhKGZ1bmN0aW9uKGRhdGEpe30sIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiTG9naWNhbCBVbml0IFwiICsgcHJvZHVjdEN0cmwubG9naWNhbFVuaXRzRGF0YVtpbmRleF0ubHVfbmFtZSwgXCJGYWlsZWQgdG8gZGVsZXRlIDogXCIgKyByZXNwb25zZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuXG4gICAgICAgIHByb2R1Y3RDdHJsLmxvYWRpbmdUYWJsZUludGVyZmFjZXMgPSB0cnVlO1xuICAgICAgICBURE1TZXJ2aWNlLmdldFByb2R1Y3RFbnZDb3VudChwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X2lkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gJ1NVQ0NFU1MnKXtcbiAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5oYXNBY3RpdmVFbnZpcm9ubWVudCA9IHJlc3BvbnNlLnJlc3VsdDtcbiAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5sb2FkaW5nVGFibGVMVXMgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgVERNU2VydmljZS5nZXRQcm9kdWN0TG9naWNhbFVuaXRzKHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLmxvZ2ljYWxVbml0c0RhdGEgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5kdEluc3RhbmNlTFVzID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5kdENvbHVtbnNMVXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLmR0Q29sdW1uRGVmc0xVcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuaGVhZGVyc0xVcyA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdhY3Rpb25zJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGlja0FibGUgOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnbHVfbmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnTmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2x1X2Rlc2NyaXB0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdEZXNjcmlwdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdsdV9wYXJlbnRfbmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnUGFyZW50IExVJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2JlX25hbWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ0J1c2luZXNzIEVudGl0eScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbmRlckxVQWN0aW9ucyA9IGZ1bmN0aW9uKGRhdGEsIHR5cGUsIGZ1bGwsIG1ldGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0Q3RybC5oYXNBY3RpdmVFbnZpcm9ubWVudC5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2R1Y3RDdHJsLmxvZ2ljYWxVbml0c0RhdGEubGVuZ3RoID09IDEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9ICdMb2dpY2FsIFVuaXQgJyArIGZ1bGwubHVfbmFtZSArJyBpcyBhdHRhY2hlZCB0byB0ZXN0aW5nIGVudmlyb25tZW50cy4gSWYgeW91IHJlbW92ZSB0aGlzIExvZ2ljYWwgVW5pdCwgc3lzdGVtIG1heSBiZSByZW1vdmVkIGZyb20gZW52aXJvbm1lbnRzLiBUYXNrcyBmb3IgdGhpcyBzeXN0ZW0gbWF5IGJlIGFsc28gZGVsZXRlZC4gQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSBpdCA/J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlICA9ICdMb2dpY2FsIFVuaXQgJyArIGZ1bGwubHVfbmFtZSArJyBpcyBhdHRhY2hlZCB0byB0ZXN0aW5nIGVudmlyb25tZW50cy4gQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSBpdCA/JyA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IFwiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIExvZ2ljYWwgVW5pdD9cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4O2p1c3RpZnktY29udGVudDogc3BhY2UtYXJvdW5kO21heC13aWR0aDogMTAwcHg7XCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2ID48aW1nICBzcmM9XCJpY29ucy9kZWxldGUtaWNvbi5zdmdcIiBhbHQ9XCJkZWxldGVcIiAgdWliLXRvb2x0aXA9XCJSZW1vdmUgTG9naWNhbCBVbml0XCIgdG9vbHRpcC1wbGFjZW1lbnQ9XCJyaWdodFwiICB0b29sdGlwLWFwcGVuZC10by1ib2R5PVwidHJ1ZVwiJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtd2wtY29uZmlybSBtZXNzYWdlPVwiJyArIG1lc3NhZ2UgKyAnXCIgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb25maXJtLXRleHQ9XCJZZXMgPGkgY2xhc3M9XFwnZ2x5cGhpY29uIGdseXBoaWNvbi1va1xcJzwvaT5cIiBjYW5jZWwtdGV4dD1cIk5vIDxpIGNsYXNzPVxcJ2dseXBoaWNvbiBnbHlwaGljb24tcmVtb3ZlXFwnPjwvaT5cIiAgcGxhY2VtZW50PVwicmlnaHRcIiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29uLWNvbmZpcm09XCJwcm9kdWN0Q3RybC5yZW1vdmVMb2dpY2FsVW5pdCgnK21ldGEucm93KycpXCIgb24tY2FuY2VsPVwiY2FuY2VsQ2xpY2tlZCA9IHRydWVcIiBjb25maXJtLWJ1dHRvbi10eXBlPVwiZGFuZ2VyXCIgY2FuY2VsLWJ1dHRvbi10eXBlPVwiZGVmYXVsdFwiJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyb2xlLWhhbmRsZXI9XCJcIiByb2xlPVwiMFwiIG5nLWlmPVwiIXByb2R1Y3RDdHJsLmRpc2FibGVDaGFuZ2VcIj48L2Rpdj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgIHByb2R1Y3RDdHJsLmhlYWRlcnNMVXMubGVuZ3RoIDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2R1Y3RDdHJsLmhlYWRlcnNMVXNbaV0uY29sdW1uID09ICdhY3Rpb25zJyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLmR0Q29sdW1uc0xVcy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4ocHJvZHVjdEN0cmwuaGVhZGVyc0xVc1tpXS5jb2x1bW4pLndpdGhUaXRsZShwcm9kdWN0Q3RybC5oZWFkZXJzTFVzW2ldLm5hbWUpLnJlbmRlcldpdGgocmVuZGVyTFVBY3Rpb25zKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuZHRDb2x1bW5zTFVzLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihwcm9kdWN0Q3RybC5oZWFkZXJzTFVzW2ldLmNvbHVtbikud2l0aFRpdGxlKHByb2R1Y3RDdHJsLmhlYWRlcnNMVXNbaV0ubmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdldFRhYmxlRGF0YUxVcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocHJvZHVjdEN0cmwubG9naWNhbFVuaXRzRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5kdE9wdGlvbnNMVXMgPSBEVE9wdGlvbnNCdWlsZGVyLmZyb21GblByb21pc2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0VGFibGVEYXRhTFVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAud2l0aERPTSgnPFwiaHRtbDVidXR0b25zXCJCPmxUZmdpdHAnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdjcmVhdGVkUm93JywgZnVuY3Rpb24gKHJvdykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWNvbXBpbGluZyBzbyB3ZSBjYW4gYmluZCBBbmd1bGFyIGRpcmVjdGl2ZSB0byB0aGUgRFRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvbXBpbGUoYW5ndWxhci5lbGVtZW50KHJvdykuY29udGVudHMoKSkoJHNjb3BlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdzY3JvbGxYJywgZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpdGhPcHRpb24oJ2xlbmd0aENoYW5nZScsIGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdwYWdpbmcnLCBmYWxzZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignc2VhcmNoaW5nJywgZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpdGhPcHRpb24oJ2luZm8nLCBmYWxzZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAud2l0aEJ1dHRvbnMoW10pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpdGhCdXR0b25zKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdzZWFyY2gnLHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjYXNlSW5zZW5zaXRpdmVcIjogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5kdEluc3RhbmNlQ2FsbGJhY2tMVXMgPSBmdW5jdGlvbiAoZHRJbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24ocHJvZHVjdEN0cmwuZHRJbnN0YW5jZUxVcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuZHRJbnN0YW5jZShkdEluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHByb2R1Y3RDdHJsLmR0SW5zdGFuY2VMVXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLmR0SW5zdGFuY2VMVXMgPSBkdEluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvZHVjdEN0cmwuZHRJbnN0YW5jZUxVcy5jaGFuZ2VEYXRhICE9IG51bGwpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuZHRJbnN0YW5jZUxVcy5jaGFuZ2VEYXRhKGdldFRhYmxlRGF0YUxVcygpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwubG9hZGluZ1RhYmxlTFVzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJTeXN0ZW0gIyBcIiArIHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfbmFtZSwgXCJmYWlsZWQgdG8gZ2V0IExvZ2ljYWwgVW5pdHNcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBURE1TZXJ2aWNlLmdldFByb2R1Y3RJbnRlcmZhY2VzKHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHByb2R1Y3RDdHJsLmludGVyZmFjZXNEYXRhID0gXy5maWx0ZXIocmVzcG9uc2UucmVzdWx0LGZ1bmN0aW9uKGVsKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm4gKGVsLmludGVyZmFjZV9zdGF0dXMgPT0gJ0FjdGl2ZScpO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBwcm9kdWN0Q3RybC5kdEluc3RhbmNlSW50ZXJmYWNlcyA9IHt9O1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgcHJvZHVjdEN0cmwuZHRDb2x1bW5zSW50ZXJmYWNlcyA9IFtdO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgcHJvZHVjdEN0cmwuZHRDb2x1bW5EZWZzSW50ZXJmYWNlcyA9IFtdO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgcHJvZHVjdEN0cmwuaGVhZGVyc0ludGVyZmFjZXMgPSBbXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnaW50ZXJmYWNlX25hbWUnLFxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBuYW1lIDogJ0ludGVyZmFjZSBuYW1lJyxcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogdHJ1ZVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnaW50ZXJmYWNlX3R5cGVfaWQnLFxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBuYW1lIDogJ0ludGVyZmFjZSB0eXBlJyxcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2FjdGlvbnMnLFxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBuYW1lIDogJycsXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgXTtcblxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdmFyIHJlbmRlckludGVyZmFjZVR5cGUgPSBmdW5jdGlvbihkYXRhLCB0eXBlLCBmdWxsLCBtZXRhKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBpZiAoZGF0YSl7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHZhciBpbnRlcmZhY2VfdHlwZSA9IF8uZmluZChwcm9kdWN0Q3RybC5zdXBwb3J0ZWREQlR5cGVzLHtkYl90eXBlX2lkIDogZGF0YSB9KTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgaWYgKGludGVyZmFjZV90eXBlKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnRlcmZhY2VfdHlwZS5kYl90eXBlX25hbWU7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdmFyIHJlbmRlckludGVyZmFjZUFjdGlvbnMgPSBmdW5jdGlvbihkYXRhLCB0eXBlLCBmdWxsLCBtZXRhKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IFwiXCI7XG5cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBpZiAocHJvZHVjdEN0cmwuaGFzQWN0aXZlRW52aXJvbm1lbnQubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0Q3RybC5pbnRlcmZhY2VzRGF0YS5sZW5ndGggPT0gMSl7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gJ0ludGVyZmFjZSAnICsgZnVsbC5pbnRlcmZhY2VfbmFtZSArJyBpcyBhdHRhY2hlZCB0byB0ZXN0aW5nIGVudmlyb25tZW50cy4gSWYgeW91IHJlbW92ZSB0aGlzIGludGVyZmFjZSwgcHJvZHVjdCBtYXkgYmUgcmVtb3ZlZCBmcm9tIGVudmlyb25tZW50cy4gVGFza3MgZm9yIHRoaXMgcHJvZHVjdCBtYXkgYmUgYWxzbyBkZWxldGVkLiBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIGl0ID8nXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgID0gJ0ludGVyZmFjZSAnICsgZnVsbC5pbnRlcmZhY2VfbmFtZSArJyBpcyBhdHRhY2hlZCB0byB0ZXN0aW5nIGVudmlyb25tZW50cy4gQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSBpdCA/JyA7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IFwiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIGludGVyZmFjZT9cIjtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm4gJycgK1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAnPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjtcIj48YnV0dG9uIHN0eWxlPVwibWFyZ2luLWxlZnQ6IDEwcHhcIiB0eXBlPVwiYnV0dG9uXCIgdWliLXRvb2x0aXA9XCJFZGl0IERCIEludGVyZmFjZVwiIHRvb2x0aXAtcGxhY2VtZW50PVwidG9wXCIgJyArXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICdjbGFzcz1cImJ0biBidG4tY2lyY2xlIGJ0bi1wcmltYXJ5XCIgcm9sZS1oYW5kbGVyPVwiXCIgcm9sZT1cIjBcIiBuZy1pZj1cIiFwcm9kdWN0Q3RybC5kaXNhYmxlQ2hhbmdlXCIgJyArXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICduZy1jbGljaz1cInByb2R1Y3RDdHJsLmFkZEludGVyZmFjZSh0cnVlLCAnK21ldGEucm93KycpXCI+PGkgY2xhc3M9XCJmYSBmYS1wZW5jaWxcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+PC9idXR0b24+JyArXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICc8YnV0dG9uIHN0eWxlPVwibWFyZ2luLWxlZnQ6IDEwcHhcIiB0eXBlPVwiYnV0dG9uXCIgdWliLXRvb2x0aXA9XCJEZWxldGUgREIgSW50ZXJmYWNlXCIgdG9vbHRpcC1wbGFjZW1lbnQ9XCJ0b3BcIiAnICtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgJ3JvbGUtaGFuZGxlcj1cIlwiIHJvbGU9XCIwXCIgbmctaWY9XCIhcHJvZHVjdEN0cmwuZGlzYWJsZUNoYW5nZVwiIGNsYXNzPVwiYnRuIGJ0bi1jaXJjbGUgYnRuLWRhbmdlclwiIG13bC1jb25maXJtIG1lc3NhZ2U9XCInICsgbWVzc2FnZSArICdcIiAnICtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgJ2NvbmZpcm0tdGV4dD1cIlllcyA8aSBjbGFzcz1cXCdnbHlwaGljb24gZ2x5cGhpY29uLW9rXFwnPC9pPlwiIGNhbmNlbC10ZXh0PVwiTm8gPGkgY2xhc3M9XFwnZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmVcXCc+PC9pPlwiICBwbGFjZW1lbnQ9XCJEZWxldGUgSW50ZXJmYWNlXCIgJyArXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICdvbi1jb25maXJtPVwicHJvZHVjdEN0cmwucmVtb3ZlSW50ZXJmYWNlKCcrbWV0YS5yb3crJylcIiBvbi1jYW5jZWw9XCJjYW5jZWxDbGlja2VkID0gdHJ1ZVwiIGNvbmZpcm0tYnV0dG9uLXR5cGU9XCJkYW5nZXJcIiBjYW5jZWwtYnV0dG9uLXR5cGU9XCJkZWZhdWx0XCInICtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgJ3JvbGUtaGFuZGxlcj1cIlwiIHJvbGU9XCIwXCIgbmctaWY9XCIhYnVzaW5lc3NFbnRpdHlDdHJsLmRpc2FibGVDaGFuZ2VcIiA+PGkgY2xhc3M9XCJmYSBmYS10cmFzaFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT48L2J1dHRvbj48L2Rpdj4nICtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgJyc7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICBwcm9kdWN0Q3RybC5oZWFkZXJzSW50ZXJmYWNlcy5sZW5ndGggOyBpKyspIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBpZiAocHJvZHVjdEN0cmwuaGVhZGVyc0ludGVyZmFjZXNbaV0uY29sdW1uID09ICdpbnRlcmZhY2VfdHlwZV9pZCcpe1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5kdENvbHVtbnNJbnRlcmZhY2VzLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihwcm9kdWN0Q3RybC5oZWFkZXJzSW50ZXJmYWNlc1tpXS5jb2x1bW4pLndpdGhUaXRsZShwcm9kdWN0Q3RybC5oZWFkZXJzSW50ZXJmYWNlc1tpXS5uYW1lKS5yZW5kZXJXaXRoKHJlbmRlckludGVyZmFjZVR5cGUpKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgZWxzZSBpZiAocHJvZHVjdEN0cmwuaGVhZGVyc0ludGVyZmFjZXNbaV0uY29sdW1uID09ICdhY3Rpb25zJyl7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLmR0Q29sdW1uc0ludGVyZmFjZXMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKHByb2R1Y3RDdHJsLmhlYWRlcnNJbnRlcmZhY2VzW2ldLmNvbHVtbikud2l0aFRpdGxlKHByb2R1Y3RDdHJsLmhlYWRlcnNJbnRlcmZhY2VzW2ldLm5hbWUpLnJlbmRlcldpdGgocmVuZGVySW50ZXJmYWNlQWN0aW9ucykpO1xuXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5kdENvbHVtbnNJbnRlcmZhY2VzLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihwcm9kdWN0Q3RybC5oZWFkZXJzSW50ZXJmYWNlc1tpXS5jb2x1bW4pLndpdGhUaXRsZShwcm9kdWN0Q3RybC5oZWFkZXJzSW50ZXJmYWNlc1tpXS5uYW1lKSk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB2YXIgZ2V0VGFibGVEYXRhSW50ZXJmYWNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocHJvZHVjdEN0cmwuaW50ZXJmYWNlc0RhdGEpO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgcHJvZHVjdEN0cmwuZHRPcHRpb25zSW50ZXJmYWNlcyA9IERUT3B0aW9uc0J1aWxkZXIuZnJvbUZuUHJvbWlzZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHJldHVybiBnZXRUYWJsZURhdGFJbnRlcmZhY2VzKCk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAud2l0aERPTSgnPFwiaHRtbDVidXR0b25zXCJCPmxUZmdpdHAnKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdjcmVhdGVkUm93JywgZnVuY3Rpb24gKHJvdykge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAvLyBSZWNvbXBpbGluZyBzbyB3ZSBjYW4gYmluZCBBbmd1bGFyIGRpcmVjdGl2ZSB0byB0aGUgRFRcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgJGNvbXBpbGUoYW5ndWxhci5lbGVtZW50KHJvdykuY29udGVudHMoKSkoJHNjb3BlKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdzY3JvbGxYJywgZmFsc2UpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgLndpdGhPcHRpb24oJ2xlbmd0aENoYW5nZScsIGZhbHNlKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdwYWdpbmcnLCBmYWxzZSlcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAud2l0aE9wdGlvbignc2VhcmNoaW5nJywgZmFsc2UpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgLndpdGhPcHRpb24oJ2luZm8nLCBmYWxzZSlcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAud2l0aEJ1dHRvbnMoW10pXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgLndpdGhCdXR0b25zKFtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBdKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdzZWFyY2gnLHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgXCJjYXNlSW5zZW5zaXRpdmVcIjogZmFsc2VcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgcHJvZHVjdEN0cmwuZHRJbnN0YW5jZUNhbGxiYWNrSW50ZXJmYWNlcyA9IGZ1bmN0aW9uIChkdEluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbihwcm9kdWN0Q3RybC5kdEluc3RhbmNlSW50ZXJmYWNlcykpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuZHRJbnN0YW5jZShkdEluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9IGVsc2UgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHByb2R1Y3RDdHJsLmR0SW5zdGFuY2VJbnRlcmZhY2VzKSkge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5kdEluc3RhbmNlSW50ZXJmYWNlcyA9IGR0SW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGlmIChwcm9kdWN0Q3RybC5kdEluc3RhbmNlSW50ZXJmYWNlcy5jaGFuZ2VEYXRhICE9IG51bGwpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgcHJvZHVjdEN0cmwuZHRJbnN0YW5jZUludGVyZmFjZXMuY2hhbmdlRGF0YShnZXRUYWJsZURhdGFJbnRlcmZhY2VzKCkpO1xuXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBwcm9kdWN0Q3RybC5sb2FkaW5nVGFibGVJbnRlcmZhY2VzID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgICAgIC8vICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHRvYXN0ci5lcnJvcihcIlN5c3RlbSAjIFwiICsgcHJvZHVjdEN0cmwucHJvZHVjdERhdGEucHJvZHVjdF9uYW1lLCBcImZhaWxlZCB0byBnZXQgREIgSW50ZXJmYWNlc1wiKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgICAgIC8vIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuaGFzQWN0aXZlRW52aXJvbm1lbnQgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcHJvZHVjdEN0cmwuc2F2ZUNoYW5nZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcHJvZHVjdFRvVXBkYXRlID0gYW5ndWxhci5jb3B5KHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhKTtcbiAgICAgICAgICAgIHByb2R1Y3RUb1VwZGF0ZS5wcm9kdWN0X3ZlcnNpb25zID0gcHJvZHVjdFRvVXBkYXRlLnByb2R1Y3RfdmVyc2lvbnMuam9pbignLCcpO1xuICAgICAgICAgICAgVERNU2VydmljZS51cGRhdGVQcm9kdWN0KHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfaWQsIHByb2R1Y3RUb1VwZGF0ZSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlID09IFwiU1VDQ0VTU1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKFwiU3lzdGVtICMgXCIgKyBwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X25hbWUsIFwiVXBkYXRlZCBTdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jb250ZW50Lm9wZW5Qcm9kdWN0cygpO1xuICAgICAgICAgICAgICAgICAgICB9LCA0MDApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJTeXN0ZW0gIyBcIiArIHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfbmFtZSwgXCJmYWlsZWQgdG8gVXBkYXRlIDogXCIgKyByZXNwb25zZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBwcm9kdWN0Q3RybC5kZWxldGVQcm9kdWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHByb2R1Y3RDdHJsLmhhc0FjdGl2ZUVudmlyb25tZW50Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBTd2VldEFsZXJ0LnN3YWwoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiU3lzdGVtIG1heSBiZSBkZWxldGVkIGZyb20gZW52aXJvbm1lbnRzLiBSZWxhdGVkIHRhc2tzIG1heSBhbHNvIGJlIGRlbGV0ZWQsQXJlIHlvdSBzdXJlID9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwid2FybmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogXCIjREQ2QjU1XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogXCJOb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogXCJZZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlT25Db25maXJtOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogXCJmYWxzZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tQ2xhc3M6IFwiYW5pbWF0ZWQgZmFkZUluVXBcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoaXNDb25maXJtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzQ29uZmlybSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRETVNlcnZpY2UuZGVsZXRlUHJvZHVjdChwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X2lkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlID09IFwiU1VDQ0VTU1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhcIlN5c3RlbSAjIFwiICsgcHJvZHVjdEN0cmwucHJvZHVjdERhdGEucHJvZHVjdF9pZCwgXCJkZWxldGVkIFN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29udGVudC5vcGVuUHJvZHVjdHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDQwMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIlN5c3RlbSAjIFwiICsgcHJvZHVjdEN0cmwucHJvZHVjdERhdGEucHJvZHVjdF9pZCwgXCJmYWlsZWQgdG8gZGVsZXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLmRlbGV0ZVByb2R1Y3QocHJvZHVjdEN0cmwucHJvZHVjdERhdGEucHJvZHVjdF9pZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoXCJTeXN0ZW0gIyBcIiArIHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfaWQsIFwiZGVsZXRlZCBTdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnQub3BlblByb2R1Y3RzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCA0MDApXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJTeXN0ZW0gIyBcIiArIHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfaWQsIFwiZmFpbGVkIHRvIGRlbGV0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHByb2R1Y3RDdHJsLmFkZFZlcnNpb24gPSBmdW5jdGlvbihuZXdWZXJzaW9uKXtcbiAgICAgICAgICAgIGlmIChuZXdWZXJzaW9uKXtcbiAgICAgICAgICAgICAgICBpZiAoIXByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfdmVyc2lvbnMpe1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X3ZlcnNpb25zID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0Q3RybC5wcm9kdWN0RGF0YS5wcm9kdWN0X3ZlcnNpb25zLmluZGV4T2YobmV3VmVyc2lvbikgPj0gMCl7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLmFkZFZlcnNpb25FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RDdHJsLnByb2R1Y3REYXRhLnByb2R1Y3RfdmVyc2lvbnMucHVzaChuZXdWZXJzaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEN0cmwuaXNPcGVuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHByb2R1Y3RDdHJsLmluaXRBZGRWZXJzaW9uUG9wdXAgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgcHJvZHVjdEN0cmwuYWRkVmVyc2lvbkVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICBwcm9kdWN0Q3RybC52ZXJzaW9uVG9BZGQgPSAnJztcbiAgICAgICAgICAgIHByb2R1Y3RDdHJsLmlzT3BlbiA9IHRydWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgQnJlYWRDcnVtYnNTZXJ2aWNlLnB1c2goe3Byb2R1Y3RJRDogcHJvZHVjdEN0cmwucHJvZHVjdERhdGEucHJvZHVjdF9uYW1lfSwgJ1BST0RVQ1RfQlJFQURDUlVNQicsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6IFwiRVwiLFxuICAgICAgICB0ZW1wbGF0ZVVybDogdGVtcGxhdGUsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBjb250ZW50OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlcjogY29udHJvbGxlcixcbiAgICAgICAgY29udHJvbGxlckFzOiAncHJvZHVjdEN0cmwnXG4gICAgfTtcbn1cblxuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnVERNLUZFJylcbiAgICAuZGlyZWN0aXZlKCdwcm9kdWN0RGlyZWN0aXZlJywgcHJvZHVjdERpcmVjdGl2ZSk7Il19
