function environmentProductsDirective(){return{restrict:"E",templateUrl:"views/environments/products/products.html",scope:{content:"="},controller:function($scope,$compile,TDMService,DTColumnBuilder,DTOptionsBuilder,$q,BreadCrumbsService){var environmentProductsCtrl=this;environmentProductsCtrl.environmentID=$scope.content.environmentData.environment_id,environmentProductsCtrl.pageDisplay="productsTable",environmentProductsCtrl.openProducts=function(){environmentProductsCtrl.productsData={openProduct:environmentProductsCtrl.openProduct,openNewProduct:environmentProductsCtrl.openNewProduct,environmentID:environmentProductsCtrl.environmentID,isOwner:$scope.content.environmentData.isOwner},environmentProductsCtrl.pageDisplay="productsTable",BreadCrumbsService.breadCrumbChange(2)},environmentProductsCtrl.openProduct=function(productData){environmentProductsCtrl.productData={productData:productData,environmentID:environmentProductsCtrl.environmentID,environmentName:$scope.content.environmentData.environment_name,openProducts:environmentProductsCtrl.openProducts,openProduct:environmentProductsCtrl.openProduct,isOwner:$scope.content.environmentData.isOwner},environmentProductsCtrl.pageDisplay="product"},environmentProductsCtrl.openNewProduct=function(){environmentProductsCtrl.newProductData={openProducts:environmentProductsCtrl.openProducts,environmentID:environmentProductsCtrl.environmentID,environmentName:$scope.content.environmentData.environment_name,isOwner:$scope.content.environmentData.isOwner},environmentProductsCtrl.pageDisplay="newProduct"},BreadCrumbsService.push({},"PRODUCTS",(function(){environmentProductsCtrl.openProducts()})),environmentProductsCtrl.openProducts()},controllerAs:"envProductsCtrl"}}function environmentNewProductDirective(){return{restrict:"E",templateUrl:"views/environments/products/newProduct.html",scope:{content:"="},controller:function($scope,$compile,TDMService,SweetAlert,BreadCrumbsService,toastr,$timeout,DTColumnBuilder,DTOptionsBuilder,$q,$uibModal){var environmentNewProductCtrl=this;environmentNewProductCtrl.environmentID=$scope.content.environmentID,TDMService.getProducts().then((function(response){if("SUCCESS"==response.errorCode){var allProducts=response.result;TDMService.getEnvProducts(environmentNewProductCtrl.environmentID).then((function(response){var envProducts=response.result;"SUCCESS"==response.errorCode?environmentNewProductCtrl.newEnvProducts=_.reject(allProducts,(function(product){if("Inactive"===product.product_status)return!0;for(var i=0;i<envProducts.length;i++)if(envProducts[i].product_id===product.product_id&&"Active"===envProducts[i].status)return!0;return!1})):toastr.error("Environment # "+environmentNewProductCtrl.environmentID,"Faild to get new products")}))}else toastr.error("Environment # "+environmentNewProductCtrl.environmentID,"Faild to get new products")})),environmentNewProductCtrl.addProduct=function(){var result=!0;if(environmentNewProductCtrl.envProduct.interfaces){for(var i=0;i<environmentNewProductCtrl.envProduct.interfaces.length;i++){var dbInterfaceData=environmentNewProductCtrl.envProduct.interfaces[i];if(!(dbInterfaceData.db_connection_string||dbInterfaceData.db_schema&&dbInterfaceData.db_port&&dbInterfaceData.db_password&&dbInterfaceData.db_host)){result=!1;break}}if(!result)return void SweetAlert.swal({title:"Please Update All DB Interfaces Data"})}TDMService.postEnvProduct(environmentNewProductCtrl.environmentID,$scope.content.environmentName,environmentNewProductCtrl.envProduct).then((function(response){"SUCCESS"==response.errorCode?(toastr.success("System # "+environmentNewProductCtrl.envProduct.product_id,"Created Successfully"),$timeout((function(){$scope.content.openProducts()}),300)):toastr.error("System # "+environmentNewProductCtrl.envProduct.product_id,"Unable to Create : "+response.message)}))},TDMService.getDataCenters().then((function(response){"SUCCESS"==response.errorCode?environmentNewProductCtrl.dataCenters=response.result:toastr.error("System # "+environmentNewProductCtrl.newEnvProduct.product_id,"failed to get data centers")})),environmentNewProductCtrl.productChanged=function(){if(environmentNewProductCtrl.envProduct.product_id){TDMService.getProductInterfaces(environmentNewProductCtrl.envProduct.product_id).then((function(response){if("SUCCESS"==response.errorCode){environmentNewProductCtrl.envProduct.interfaces=response.result;var dbTypes=TDMService.getDBTypes();_.each(environmentNewProductCtrl.envProduct.interfaces,(function(interface1){var db_type=_.find(dbTypes,{db_type_id:interface1.interface_type_id});interface1.interface_type_name=db_type.db_type_name})),environmentNewProductCtrl.getTableData?environmentNewProductCtrl.dtInstance.changeData(environmentNewProductCtrl.getTableData()):environmentNewProductCtrl.DBInterfacesTable()}else toastr.error("System # "+environmentNewProductCtrl.envProduct.product_id,"failed to get interfaces")}));var product=_.find(environmentNewProductCtrl.newEnvProducts,{product_id:environmentNewProductCtrl.envProduct.product_id});product&&(environmentNewProductCtrl.versions=product.product_versions.split(","))}},environmentNewProductCtrl.DBInterfacesTable=function(){environmentNewProductCtrl.loadingTable=!0,environmentNewProductCtrl.dtInstance={},environmentNewProductCtrl.dtColumns=[],environmentNewProductCtrl.dtColumnDefs=[],environmentNewProductCtrl.headers=[{column:"interface_name",name:"Name",clickAble:!1},{column:"interface_type_name",name:"Interface Type",clickAble:!1},{column:"db_schema",name:"Schema",clickAble:!1},{column:"db_port",name:"Port",clickAble:!1},{column:"db_user",name:"User",clickAble:!1},{column:"db_password",name:"Password",clickAble:!1,type:"date"},{column:"db_host",name:"Host",clickAble:!1},{column:"db_connection_string",name:"Connection String",clickAble:!1,type:"date"},{column:"update_db_interface",name:"Update",clickAble:!0}];for(var updateCell=function(data,type,full,meta){return'<img src="icons/edit.svg" alt="edit" ng-click="envNewProductCtrl.openDBInterfaceModal(\''+full.interface_id+"')\">"},i=0;i<environmentNewProductCtrl.headers.length;i++)"update_db_interface"==environmentNewProductCtrl.headers[i].column?environmentNewProductCtrl.dtColumns.push(DTColumnBuilder.newColumn(environmentNewProductCtrl.headers[i].column).withTitle(environmentNewProductCtrl.headers[i].name).renderWith(updateCell).notSortable().withOption("defaultContent"," ")):environmentNewProductCtrl.dtColumns.push(DTColumnBuilder.newColumn(environmentNewProductCtrl.headers[i].column).withTitle(environmentNewProductCtrl.headers[i].name).withOption("defaultContent"," "));environmentNewProductCtrl.getTableData=function(){var deferred=$q.defer();return deferred.resolve(environmentNewProductCtrl.envProduct.interfaces),deferred.promise},environmentNewProductCtrl.dtOptions=DTOptionsBuilder.fromFnPromise((function(){return environmentNewProductCtrl.getTableData()})).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("scrollX",!1).withButtons([]),environmentNewProductCtrl.dtInstanceCallback=function(dtInstance){angular.isFunction(environmentNewProductCtrl.dtInstance)?environmentNewProductCtrl.dtInstance(dtInstance):angular.isDefined(environmentNewProductCtrl.dtInstance)&&(environmentNewProductCtrl.dtInstance=dtInstance)},null!=environmentNewProductCtrl.dtInstance.changeData&&environmentNewProductCtrl.dtInstance.changeData(environmentNewProductCtrl.getTableData()),$timeout(()=>{environmentNewProductCtrl.loadingTable=!1}),environmentNewProductCtrl.openDBInterfaceModal=function(db_interface_id){var interfaceIndex=_.findIndex(environmentNewProductCtrl.envProduct.interfaces,{interface_id:db_interface_id});if(!(interfaceIndex<0))$uibModal.open({templateUrl:"views/environments/products/dbInterfaceModal.html",resolve:{dbInterface:environmentNewProductCtrl.envProduct.interfaces[interfaceIndex]},controller:function($scope,$uibModalInstance,dbInterface){var dbInterfaceCtrl=this;dbInterfaceCtrl.dbInterfaceData=dbInterface,dbInterfaceCtrl.connectionType=!0,dbInterfaceCtrl.saveDBInterface=function(){$uibModalInstance.close(dbInterfaceCtrl.dbInterfaceData)},dbInterfaceCtrl.testDBInterfaceConn=function(){dbInterfaceCtrl.testDBInterfaceConnResult="Success",console.log("Test done.")},dbInterfaceCtrl.close=function(){$uibModalInstance.close()}},controllerAs:"dbInterfaceCtrl"}).result.then((function(interfaceData){interfaceData&&(environmentNewProductCtrl.envProduct.interfaces[interfaceIndex]=interfaceData,environmentNewProductCtrl.dtInstance.changeData(environmentNewProductCtrl.getTableData()))}))}},BreadCrumbsService.push({},"NEW_PRODUCT",(function(){}))},controllerAs:"envNewProductCtrl"}}function environmentProductsTableDirective(){return{restrict:"E",templateUrl:"views/environments/products/productsTable.html",scope:{content:"="},controller:function($scope,$compile,TDMService,DTColumnBuilder,DTOptionsBuilder,$q,AuthService,toastr){var productsTableCtrl=this;productsTableCtrl.environmentID=$scope.content.environmentID,productsTableCtrl.disableChange=!AuthService.authorizedToEdit(1)||!$scope.content.isOwner,TDMService.getEnvProducts(productsTableCtrl.environmentID).then((function(response){if("SUCCESS"==response.errorCode){productsTableCtrl.products=response.result,productsTableCtrl.dtInstance={},productsTableCtrl.dtColumns=[],productsTableCtrl.dtColumnDefs=[],productsTableCtrl.headers=[{column:"product_name",name:"Name",clickAble:!0},{column:"data_center_name",name:"Data Center Name",clickAble:!1},{column:"product_version",name:"Version",clickAble:!1},{column:"created_by",name:"Created By",clickAble:!1},{column:"creation_date",name:"Creation Date",clickAble:!1,type:"date"},{column:"last_updated_by",name:"Updated By",clickAble:!1},{column:"last_updated_date",name:"Update Date",clickAble:!1,type:"date"},{column:"status",name:"Status",clickAble:!1}];for(var clickAbleColumn=function(data,type,full,meta){return'<a ng-click="envProductsTableCtrl.openProduct('+full.product_id+')">'+data+"</a>"},changeToLocalDate=function(data,type,full,meta){return data?moment(data).format("D MMM YYYY, h:mm"):""},i=0;i<productsTableCtrl.headers.length;i++)1==productsTableCtrl.headers[i].clickAble?productsTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(productsTableCtrl.headers[i].column).withTitle(productsTableCtrl.headers[i].name).renderWith(clickAbleColumn)):"date"==productsTableCtrl.headers[i].type?productsTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(productsTableCtrl.headers[i].column).withTitle(productsTableCtrl.headers[i].name).renderWith(changeToLocalDate)):productsTableCtrl.dtColumns.push(DTColumnBuilder.newColumn(productsTableCtrl.headers[i].column).withTitle(productsTableCtrl.headers[i].name));var getTableData=function(){var deferred=$q.defer();return deferred.resolve(productsTableCtrl.products),deferred.promise};productsTableCtrl.dtOptions=DTOptionsBuilder.fromFnPromise((function(){return getTableData()})).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("scrollX",!1).withButtons([]).withColumnFilter({aoColumns:[{type:"text",bRegex:!0,bSmart:!0},{type:"text",bRegex:!0,bSmart:!0},{type:"text",bRegex:!0,bSmart:!0},{type:"select",bRegex:!1,values:_.unique(_.map(productsTableCtrl.products,"created_by"))},{type:"text",bRegex:!0,bSmart:!0},{type:"select",bRegex:!1,values:_.unique(_.map(productsTableCtrl.products,"last_updated_by"))},{type:"text",bRegex:!0,bSmart:!0}]}),productsTableCtrl.dtInstanceCallback=function(dtInstance){angular.isFunction(productsTableCtrl.dtInstance)?productsTableCtrl.dtInstance(dtInstance):angular.isDefined(productsTableCtrl.dtInstance)&&(productsTableCtrl.dtInstance=dtInstance)},null!=productsTableCtrl.dtInstance.changeData&&productsTableCtrl.dtInstance.changeData(getTableData()),productsTableCtrl.loadingTable=!1}else toastr.error("Environment # "+productsTableCtrl.environmentID,"Faild to get products")})),productsTableCtrl.openProduct=function(productID){if($scope.content.openProduct){var productData=_.find(productsTableCtrl.products,{product_id:productID});if(productData)return void $scope.content.openProduct(productData)}},productsTableCtrl.openNewProduct=function(){$scope.content.openNewProduct&&$scope.content.openNewProduct()}},controllerAs:"envProductsTableCtrl"}}function environmentProductDirective(){return{restrict:"E",templateUrl:"views/environments/products/product.html",scope:{content:"="},controller:function($scope,$compile,TDMService,BreadCrumbsService,toastr,SweetAlert,AuthService,DTColumnBuilder,DTOptionsBuilder,$q,$uibModal,$timeout){var environmentProductCtrl=this;environmentProductCtrl.envProduct=$scope.content.productData;var dbTypes=TDMService.getDBTypes();_.each(environmentProductCtrl.envProduct.interfaces,(function(interface1){var db_type=_.find(dbTypes,{db_type_id:interface1.interface_type_id});interface1.interface_type_name=db_type.db_type_name})),environmentProductCtrl.environmentID=$scope.content.environmentID,environmentProductCtrl.disableChange="Inactive"==environmentProductCtrl.envProduct.status||!AuthService.authorizedToEdit(1)||!$scope.content.isOwner,TDMService.getDataCenters().then((function(response){"SUCCESS"==response.errorCode?environmentProductCtrl.dataCenters=response.result:toastr.error("System # "+environmentProductCtrl.envProduct.product_name,"failed to get data centers")})),environmentProductCtrl.versions=environmentProductCtrl.envProduct.product_versions.split(","),environmentProductCtrl.updateEnvProduct=function(){TDMService.putEnvProduct(environmentProductCtrl.environmentID,$scope.content.environmentName,environmentProductCtrl.envProduct).then((function(response){"SUCCESS"==response.errorCode?(toastr.success("System # "+environmentProductCtrl.envProduct.product_name,"Updated Successfully"),$timeout((function(){$scope.content.openProducts()}),400)):toastr.error("System # "+environmentProductCtrl.envProduct.product_name,"failed to update")}))},environmentProductCtrl.deleteEnvProduct=function(){SweetAlert.swal({title:"Are you sure you want to remove System "+environmentProductCtrl.envProduct.product_name,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",cancelButtonText:"No",closeOnConfirm:!0,closeOnCancel:!0,animation:"false",customClass:"animated fadeInUp"},(function(isConfirm){isConfirm&&TDMService.deleteEnvProduct(environmentProductCtrl.environmentID,$scope.content.environmentName,environmentProductCtrl.envProduct.product_id).then((function(response){"SUCCESS"==response.errorCode?(toastr.success("System # "+environmentProductCtrl.envProduct.product_name,"deleted Successfully"),$timeout((function(){$scope.content.openProducts()}),400)):toastr.error("System # "+environmentProductCtrl.envProduct.product_name,"failed to delete")}))}))},environmentProductCtrl.DBInterfacesTable=function(){environmentProductCtrl.loadingTable=!0,environmentProductCtrl.dtInstance={},environmentProductCtrl.dtColumns=[],environmentProductCtrl.dtColumnDefs=[],environmentProductCtrl.headers=[{column:"interface_name",name:"Name",clickAble:!1},{column:"interface_type_name",name:"Interface Type",clickAble:!1},{column:"db_schema",name:"Schema",clickAble:!1},{column:"db_port",name:"Port",clickAble:!1},{column:"db_user",name:"User",clickAble:!1},{column:"db_password",name:"Password",clickAble:!1,type:"date"},{column:"db_host",name:"Host",clickAble:!1},{column:"db_connection_string",name:"Connection String",clickAble:!1,type:"date"}],environmentProductCtrl.disableChange||environmentProductCtrl.headers.push({column:"update_db_interface",name:"Update",clickAble:!0});for(var updateCell=function(data,type,full,meta){return'<img src="icons/edit.svg" alt="edit"  ng-click="envProductCtrl.openDBInterfaceModal(\''+full.interface_id+"')\">"},i=0;i<environmentProductCtrl.headers.length;i++)"update_db_interface"==environmentProductCtrl.headers[i].column?environmentProductCtrl.dtColumns.push(DTColumnBuilder.newColumn(environmentProductCtrl.headers[i].column).withTitle(environmentProductCtrl.headers[i].name).renderWith(updateCell).notSortable()):environmentProductCtrl.dtColumns.push(DTColumnBuilder.newColumn(environmentProductCtrl.headers[i].column).withTitle(environmentProductCtrl.headers[i].name));var getTableData=function(){var deferred=$q.defer();return deferred.resolve(environmentProductCtrl.envProduct.interfaces),deferred.promise};environmentProductCtrl.dtOptions=DTOptionsBuilder.fromFnPromise((function(){return getTableData()})).withDOM('<"html5buttons"B>lTfgitp').withOption("createdRow",(function(row){$compile(angular.element(row).contents())($scope)})).withOption("scrollX",!1).withButtons([]),environmentProductCtrl.dtInstanceCallback=function(dtInstance){angular.isFunction(environmentProductCtrl.dtInstance)?environmentProductCtrl.dtInstance(dtInstance):angular.isDefined(environmentProductCtrl.dtInstance)&&(environmentProductCtrl.dtInstance=dtInstance)},null!=environmentProductCtrl.dtInstance.changeData&&environmentProductCtrl.dtInstance.changeData(getTableData()),$timeout(()=>{environmentProductCtrl.loadingTable=!1}),environmentProductCtrl.openDBInterfaceModal=function(db_interface_id){var interfaceIndex=_.findIndex(environmentProductCtrl.envProduct.interfaces,{interface_id:db_interface_id});if(!(interfaceIndex<0))$uibModal.open({templateUrl:"views/environments/products/dbInterfaceModal.html",resolve:{dbInterface:environmentProductCtrl.envProduct.interfaces[interfaceIndex]},controller:function($scope,$uibModalInstance,dbInterface){var dbInterfaceCtrl=this;dbInterfaceCtrl.dbInterfaceData=dbInterface,dbInterfaceCtrl.connectionType=!0,dbInterfaceCtrl.saveDBInterface=function(){$uibModalInstance.close(dbInterfaceCtrl.dbInterfaceData)},dbInterfaceCtrl.testDBInterfaceConn=function(){dbInterfaceCtrl.testDBInterfaceConnResult="Success",console.log("Test done.")},dbInterfaceCtrl.close=function(){$uibModalInstance.close()}},controllerAs:"dbInterfaceCtrl"}).result.then((function(interface1){interface1&&(environmentProductCtrl.envProduct.interfaces[interfaceIndex]=interface1,environmentProductCtrl.dtInstance.changeData(getTableData()))}))}},BreadCrumbsService.push({productID:environmentProductCtrl.envProduct.product_name},"PRODUCT_BREADCRUMB",(function(){$scope.content.openProduct(environmentProductCtrl.envProduct)})),environmentProductCtrl.DBInterfacesTable()},controllerAs:"envProductCtrl"}}angular.module("TDM-FE").directive("environmentProductsDirective",environmentProductsDirective).directive("environmentProductsTableDirective",environmentProductsTableDirective).directive("environmentNewProductDirective",environmentNewProductDirective).directive("environmentProductDirective",environmentProductDirective);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvZW52aXJvbm1lbnRzL2VudlByb2R1Y3RzRGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImVudmlyb25tZW50UHJvZHVjdHNEaXJlY3RpdmUiLCJyZXN0cmljdCIsInRlbXBsYXRlVXJsIiwic2NvcGUiLCJjb250ZW50IiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRjb21waWxlIiwiVERNU2VydmljZSIsIkRUQ29sdW1uQnVpbGRlciIsIkRUT3B0aW9uc0J1aWxkZXIiLCIkcSIsIkJyZWFkQ3J1bWJzU2VydmljZSIsImVudmlyb25tZW50UHJvZHVjdHNDdHJsIiwidGhpcyIsImVudmlyb25tZW50SUQiLCJlbnZpcm9ubWVudERhdGEiLCJlbnZpcm9ubWVudF9pZCIsInBhZ2VEaXNwbGF5Iiwib3BlblByb2R1Y3RzIiwicHJvZHVjdHNEYXRhIiwib3BlblByb2R1Y3QiLCJvcGVuTmV3UHJvZHVjdCIsImlzT3duZXIiLCJicmVhZENydW1iQ2hhbmdlIiwicHJvZHVjdERhdGEiLCJlbnZpcm9ubWVudE5hbWUiLCJlbnZpcm9ubWVudF9uYW1lIiwibmV3UHJvZHVjdERhdGEiLCJwdXNoIiwiY29udHJvbGxlckFzIiwiZW52aXJvbm1lbnROZXdQcm9kdWN0RGlyZWN0aXZlIiwiU3dlZXRBbGVydCIsInRvYXN0ciIsIiR0aW1lb3V0IiwiJHVpYk1vZGFsIiwiZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybCIsImdldFByb2R1Y3RzIiwidGhlbiIsInJlc3BvbnNlIiwiZXJyb3JDb2RlIiwiYWxsUHJvZHVjdHMiLCJyZXN1bHQiLCJnZXRFbnZQcm9kdWN0cyIsImVudlByb2R1Y3RzIiwibmV3RW52UHJvZHVjdHMiLCJfIiwicmVqZWN0IiwicHJvZHVjdCIsInByb2R1Y3Rfc3RhdHVzIiwiaSIsImxlbmd0aCIsInByb2R1Y3RfaWQiLCJzdGF0dXMiLCJlcnJvciIsImFkZFByb2R1Y3QiLCJlbnZQcm9kdWN0IiwiaW50ZXJmYWNlcyIsImRiSW50ZXJmYWNlRGF0YSIsImRiX3NjaGVtYSIsImRiX3BvcnQiLCJkYl9wYXNzd29yZCIsImRiX2hvc3QiLCJzd2FsIiwidGl0bGUiLCJwb3N0RW52UHJvZHVjdCIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiZ2V0RGF0YUNlbnRlcnMiLCJkYXRhQ2VudGVycyIsIm5ld0VudlByb2R1Y3QiLCJwcm9kdWN0Q2hhbmdlZCIsImdldFByb2R1Y3RJbnRlcmZhY2VzIiwiZGJUeXBlcyIsImdldERCVHlwZXMiLCJlYWNoIiwiaW50ZXJmYWNlMSIsImRiX3R5cGUiLCJmaW5kIiwiZGJfdHlwZV9pZCIsImludGVyZmFjZV90eXBlX2lkIiwiaW50ZXJmYWNlX3R5cGVfbmFtZSIsImRiX3R5cGVfbmFtZSIsImdldFRhYmxlRGF0YSIsImR0SW5zdGFuY2UiLCJjaGFuZ2VEYXRhIiwiREJJbnRlcmZhY2VzVGFibGUiLCJ2ZXJzaW9ucyIsInByb2R1Y3RfdmVyc2lvbnMiLCJzcGxpdCIsImxvYWRpbmdUYWJsZSIsImR0Q29sdW1ucyIsImR0Q29sdW1uRGVmcyIsImhlYWRlcnMiLCJjb2x1bW4iLCJuYW1lIiwiY2xpY2tBYmxlIiwidHlwZSIsInVwZGF0ZUNlbGwiLCJkYXRhIiwiZnVsbCIsIm1ldGEiLCJpbnRlcmZhY2VfaWQiLCJuZXdDb2x1bW4iLCJ3aXRoVGl0bGUiLCJyZW5kZXJXaXRoIiwibm90U29ydGFibGUiLCJ3aXRoT3B0aW9uIiwiZGVmZXJyZWQiLCJkZWZlciIsInJlc29sdmUiLCJwcm9taXNlIiwiZHRPcHRpb25zIiwiZnJvbUZuUHJvbWlzZSIsIndpdGhET00iLCJyb3ciLCJhbmd1bGFyIiwiZWxlbWVudCIsImNvbnRlbnRzIiwid2l0aEJ1dHRvbnMiLCJkdEluc3RhbmNlQ2FsbGJhY2siLCJpc0Z1bmN0aW9uIiwiaXNEZWZpbmVkIiwib3BlbkRCSW50ZXJmYWNlTW9kYWwiLCJkYl9pbnRlcmZhY2VfaWQiLCJpbnRlcmZhY2VJbmRleCIsImZpbmRJbmRleCIsIm9wZW4iLCJkYkludGVyZmFjZSIsIiR1aWJNb2RhbEluc3RhbmNlIiwiZGJJbnRlcmZhY2VDdHJsIiwiY29ubmVjdGlvblR5cGUiLCJzYXZlREJJbnRlcmZhY2UiLCJjbG9zZSIsInRlc3REQkludGVyZmFjZUNvbm4iLCJ0ZXN0REJJbnRlcmZhY2VDb25uUmVzdWx0IiwiY29uc29sZSIsImxvZyIsImludGVyZmFjZURhdGEiLCJlbnZpcm9ubWVudFByb2R1Y3RzVGFibGVEaXJlY3RpdmUiLCJBdXRoU2VydmljZSIsInByb2R1Y3RzVGFibGVDdHJsIiwiZGlzYWJsZUNoYW5nZSIsImF1dGhvcml6ZWRUb0VkaXQiLCJwcm9kdWN0cyIsImNsaWNrQWJsZUNvbHVtbiIsImNoYW5nZVRvTG9jYWxEYXRlIiwibW9tZW50IiwiZm9ybWF0Iiwid2l0aENvbHVtbkZpbHRlciIsImFvQ29sdW1ucyIsImJSZWdleCIsImJTbWFydCIsInZhbHVlcyIsInVuaXF1ZSIsIm1hcCIsInByb2R1Y3RJRCIsImVudmlyb25tZW50UHJvZHVjdERpcmVjdGl2ZSIsImVudmlyb25tZW50UHJvZHVjdEN0cmwiLCJwcm9kdWN0X25hbWUiLCJ1cGRhdGVFbnZQcm9kdWN0IiwicHV0RW52UHJvZHVjdCIsImRlbGV0ZUVudlByb2R1Y3QiLCJzaG93Q2FuY2VsQnV0dG9uIiwiY29uZmlybUJ1dHRvbkNvbG9yIiwiY29uZmlybUJ1dHRvblRleHQiLCJjYW5jZWxCdXR0b25UZXh0IiwiY2xvc2VPbkNvbmZpcm0iLCJjbG9zZU9uQ2FuY2VsIiwiYW5pbWF0aW9uIiwiY3VzdG9tQ2xhc3MiLCJpc0NvbmZpcm0iLCJtb2R1bGUiLCJkaXJlY3RpdmUiXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLCtCQW1ETCxNQUFPLENBQ0hDLFNBQVUsSUFDVkMsWUFuRFcsNENBb0RYQyxNQUFPLENBQ0hDLFFBQVMsS0FFYkMsV0FyRGEsU0FBVUMsT0FBUUMsU0FBVUMsV0FBWUMsZ0JBQWlCQyxpQkFBa0JDLEdBQUlDLG9CQUM1RixJQUFJQyx3QkFBMEJDLEtBRTlCRCx3QkFBd0JFLGNBQWdCVCxPQUFPRixRQUFRWSxnQkFB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Ryx1QkFBdUJ4RSxxQkFVdkJ4RCxhQUFjLGtCQUl0QnNGLFFBQ0t3RCxPQUFPLFVBQ1BDLFVBQVUsK0JBQWdDN0ssOEJBQzFDNkssVUFBVSxvQ0FBcUNsQyxtQ0FDL0NrQyxVQUFVLGlDQUFrQzlJLGdDQUM1QzhJLFVBQVUsOEJBQStCaEIiLCJmaWxlIjoiZGlyZWN0aXZlcy9lbnZpcm9ubWVudHMvZW52UHJvZHVjdHNEaXJlY3RpdmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBlbnZpcm9ubWVudFByb2R1Y3RzRGlyZWN0aXZlKCkge1xuXG4gICAgdmFyIHRlbXBsYXRlID0gXCJ2aWV3cy9lbnZpcm9ubWVudHMvcHJvZHVjdHMvcHJvZHVjdHMuaHRtbFwiO1xuXG4gICAgdmFyIGNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoJHNjb3BlLCAkY29tcGlsZSwgVERNU2VydmljZSwgRFRDb2x1bW5CdWlsZGVyLCBEVE9wdGlvbnNCdWlsZGVyLCAkcSwgQnJlYWRDcnVtYnNTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBlbnZpcm9ubWVudFByb2R1Y3RzQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0c0N0cmwuZW52aXJvbm1lbnRJRCA9ICRzY29wZS5jb250ZW50LmVudmlyb25tZW50RGF0YS5lbnZpcm9ubWVudF9pZDtcblxuICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RzQ3RybC5wYWdlRGlzcGxheSA9ICdwcm9kdWN0c1RhYmxlJztcblxuICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RzQ3RybC5vcGVuUHJvZHVjdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RzQ3RybC5wcm9kdWN0c0RhdGEgPSB7XG4gICAgICAgICAgICAgICAgb3BlblByb2R1Y3Q6IGVudmlyb25tZW50UHJvZHVjdHNDdHJsLm9wZW5Qcm9kdWN0LFxuICAgICAgICAgICAgICAgIG9wZW5OZXdQcm9kdWN0OiBlbnZpcm9ubWVudFByb2R1Y3RzQ3RybC5vcGVuTmV3UHJvZHVjdCxcbiAgICAgICAgICAgICAgICBlbnZpcm9ubWVudElEOiBlbnZpcm9ubWVudFByb2R1Y3RzQ3RybC5lbnZpcm9ubWVudElELFxuICAgICAgICAgICAgICAgIGlzT3duZXIgOiAkc2NvcGUuY29udGVudC5lbnZpcm9ubWVudERhdGEuaXNPd25lclxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGVudmlyb25tZW50UHJvZHVjdHNDdHJsLnBhZ2VEaXNwbGF5ID0gJ3Byb2R1Y3RzVGFibGUnO1xuICAgICAgICAgICAgQnJlYWRDcnVtYnNTZXJ2aWNlLmJyZWFkQ3J1bWJDaGFuZ2UoMik7XG4gICAgICAgIH07XG5cbiAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0c0N0cmwub3BlblByb2R1Y3QgPSBmdW5jdGlvbiAocHJvZHVjdERhdGEpIHtcbiAgICAgICAgICAgIGVudmlyb25tZW50UHJvZHVjdHNDdHJsLnByb2R1Y3REYXRhID0ge1xuICAgICAgICAgICAgICAgIHByb2R1Y3REYXRhOiBwcm9kdWN0RGF0YSxcbiAgICAgICAgICAgICAgICBlbnZpcm9ubWVudElEOiBlbnZpcm9ubWVudFByb2R1Y3RzQ3RybC5lbnZpcm9ubWVudElELFxuICAgICAgICAgICAgICAgIGVudmlyb25tZW50TmFtZTogJHNjb3BlLmNvbnRlbnQuZW52aXJvbm1lbnREYXRhLmVudmlyb25tZW50X25hbWUsXG4gICAgICAgICAgICAgICAgb3BlblByb2R1Y3RzOiBlbnZpcm9ubWVudFByb2R1Y3RzQ3RybC5vcGVuUHJvZHVjdHMsXG4gICAgICAgICAgICAgICAgb3BlblByb2R1Y3Q6IGVudmlyb25tZW50UHJvZHVjdHNDdHJsLm9wZW5Qcm9kdWN0LFxuICAgICAgICAgICAgICAgIGlzT3duZXIgOiAkc2NvcGUuY29udGVudC5lbnZpcm9ubWVudERhdGEuaXNPd25lclxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGVudmlyb25tZW50UHJvZHVjdHNDdHJsLnBhZ2VEaXNwbGF5ID0gJ3Byb2R1Y3QnO1xuICAgICAgICB9O1xuXG4gICAgICAgIGVudmlyb25tZW50UHJvZHVjdHNDdHJsLm9wZW5OZXdQcm9kdWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0c0N0cmwubmV3UHJvZHVjdERhdGEgPSB7XG4gICAgICAgICAgICAgICAgb3BlblByb2R1Y3RzOiBlbnZpcm9ubWVudFByb2R1Y3RzQ3RybC5vcGVuUHJvZHVjdHMsXG4gICAgICAgICAgICAgICAgZW52aXJvbm1lbnRJRDogZW52aXJvbm1lbnRQcm9kdWN0c0N0cmwuZW52aXJvbm1lbnRJRCxcbiAgICAgICAgICAgICAgICBlbnZpcm9ubWVudE5hbWU6ICRzY29wZS5jb250ZW50LmVudmlyb25tZW50RGF0YS5lbnZpcm9ubWVudF9uYW1lLFxuICAgICAgICAgICAgICAgIGlzT3duZXIgOiAkc2NvcGUuY29udGVudC5lbnZpcm9ubWVudERhdGEuaXNPd25lclxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGVudmlyb25tZW50UHJvZHVjdHNDdHJsLnBhZ2VEaXNwbGF5ID0gJ25ld1Byb2R1Y3QnO1xuICAgICAgICB9O1xuXG4gICAgICAgIEJyZWFkQ3J1bWJzU2VydmljZS5wdXNoKHt9LCAnUFJPRFVDVFMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RzQ3RybC5vcGVuUHJvZHVjdHMoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0c0N0cmwub3BlblByb2R1Y3RzKCk7XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiBcIkVcIixcbiAgICAgICAgdGVtcGxhdGVVcmw6IHRlbXBsYXRlLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgY29udGVudDogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2xsZXI6IGNvbnRyb2xsZXIsXG4gICAgICAgIGNvbnRyb2xsZXJBczogJ2VudlByb2R1Y3RzQ3RybCdcbiAgICB9O1xufVxuXG5cbmZ1bmN0aW9uIGVudmlyb25tZW50TmV3UHJvZHVjdERpcmVjdGl2ZSgpIHtcblxuICAgIHZhciB0ZW1wbGF0ZSA9IFwidmlld3MvZW52aXJvbm1lbnRzL3Byb2R1Y3RzL25ld1Byb2R1Y3QuaHRtbFwiO1xuXG4gICAgdmFyIGNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoJHNjb3BlLCRjb21waWxlLCBURE1TZXJ2aWNlLFN3ZWV0QWxlcnQsIEJyZWFkQ3J1bWJzU2VydmljZSwgdG9hc3RyLCAkdGltZW91dCxEVENvbHVtbkJ1aWxkZXIsIERUT3B0aW9uc0J1aWxkZXIsICRxLCR1aWJNb2RhbCkge1xuICAgICAgICB2YXIgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybCA9IHRoaXM7XG4gICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZW52aXJvbm1lbnRJRCA9ICRzY29wZS5jb250ZW50LmVudmlyb25tZW50SUQ7XG5cbiAgICAgICAgVERNU2VydmljZS5nZXRQcm9kdWN0cygpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlID09IFwiU1VDQ0VTU1wiKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFsbFByb2R1Y3RzID0gcmVzcG9uc2UucmVzdWx0O1xuICAgICAgICAgICAgICAgIFRETVNlcnZpY2UuZ2V0RW52UHJvZHVjdHMoZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5lbnZpcm9ubWVudElEKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW52UHJvZHVjdHMgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwubmV3RW52UHJvZHVjdHMgPSBfLnJlamVjdChhbGxQcm9kdWN0cywgZnVuY3Rpb24gKHByb2R1Y3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvZHVjdC5wcm9kdWN0X3N0YXR1cyA9PT0gJ0luYWN0aXZlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbnZQcm9kdWN0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW52UHJvZHVjdHNbaV0ucHJvZHVjdF9pZCA9PT0gcHJvZHVjdC5wcm9kdWN0X2lkICYmIGVudlByb2R1Y3RzW2ldLnN0YXR1cyA9PT0gJ0FjdGl2ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiRW52aXJvbm1lbnQgIyBcIiArIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZW52aXJvbm1lbnRJRCwgXCJGYWlsZCB0byBnZXQgbmV3IHByb2R1Y3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIkVudmlyb25tZW50ICMgXCIgKyBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmVudmlyb25tZW50SUQsIFwiRmFpbGQgdG8gZ2V0IG5ldyBwcm9kdWN0c1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5hZGRQcm9kdWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LmludGVyZmFjZXMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZW52UHJvZHVjdC5pbnRlcmZhY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYkludGVyZmFjZURhdGEgPSBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmVudlByb2R1Y3QuaW50ZXJmYWNlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGJJbnRlcmZhY2VEYXRhLmRiX2Nvbm5lY3Rpb25fc3RyaW5nKSAmJiAhKGRiSW50ZXJmYWNlRGF0YS5kYl9zY2hlbWEgJiYgZGJJbnRlcmZhY2VEYXRhLmRiX3BvcnQgJiYgZGJJbnRlcmZhY2VEYXRhLmRiX3Bhc3N3b3JkICYmIGRiSW50ZXJmYWNlRGF0YS5kYl9ob3N0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIFN3ZWV0QWxlcnQuc3dhbCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJQbGVhc2UgVXBkYXRlIEFsbCBEQiBJbnRlcmZhY2VzIERhdGFcIlxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFRETVNlcnZpY2UucG9zdEVudlByb2R1Y3QoZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5lbnZpcm9ubWVudElELCRzY29wZS5jb250ZW50LmVudmlyb25tZW50TmFtZSwgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5lbnZQcm9kdWN0KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoXCJTeXN0ZW0gIyBcIiArIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZW52UHJvZHVjdC5wcm9kdWN0X2lkLCBcIkNyZWF0ZWQgU3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29udGVudC5vcGVuUHJvZHVjdHMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMzAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIlN5c3RlbSAjIFwiICsgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LnByb2R1Y3RfaWQsIFwiVW5hYmxlIHRvIENyZWF0ZSA6IFwiICsgcmVzcG9uc2UubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgVERNU2VydmljZS5nZXREYXRhQ2VudGVycygpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlID09IFwiU1VDQ0VTU1wiKSB7XG4gICAgICAgICAgICAgICAgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5kYXRhQ2VudGVycyA9IHJlc3BvbnNlLnJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIlN5c3RlbSAjIFwiICsgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5uZXdFbnZQcm9kdWN0LnByb2R1Y3RfaWQsIFwiZmFpbGVkIHRvIGdldCBkYXRhIGNlbnRlcnNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwucHJvZHVjdENoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LnByb2R1Y3RfaWQpIHtcbiAgICAgICAgICAgICAgICBURE1TZXJ2aWNlLmdldFByb2R1Y3RJbnRlcmZhY2VzKGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZW52UHJvZHVjdC5wcm9kdWN0X2lkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JDb2RlID09IFwiU1VDQ0VTU1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmVudlByb2R1Y3QuaW50ZXJmYWNlcyA9IHJlc3BvbnNlLnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYlR5cGVzID0gVERNU2VydmljZS5nZXREQlR5cGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfLmVhY2goZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LmludGVyZmFjZXMsIGZ1bmN0aW9uIChpbnRlcmZhY2UxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRiX3R5cGUgPSBfLmZpbmQoZGJUeXBlcywge2RiX3R5cGVfaWQ6IGludGVyZmFjZTEuaW50ZXJmYWNlX3R5cGVfaWR9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlcmZhY2UxLmludGVyZmFjZV90eXBlX25hbWUgPSBkYl90eXBlLmRiX3R5cGVfbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZ2V0VGFibGVEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmR0SW5zdGFuY2UuY2hhbmdlRGF0YShlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmdldFRhYmxlRGF0YSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5EQkludGVyZmFjZXNUYWJsZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiU3lzdGVtICMgXCIgKyBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmVudlByb2R1Y3QucHJvZHVjdF9pZCwgXCJmYWlsZWQgdG8gZ2V0IGludGVyZmFjZXNcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvZHVjdCA9IF8uZmluZChlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLm5ld0VudlByb2R1Y3RzLHtwcm9kdWN0X2lkOiBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmVudlByb2R1Y3QucHJvZHVjdF9pZH0pO1xuICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0KXtcbiAgICAgICAgICAgICAgICAgICAgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC52ZXJzaW9ucyA9IHByb2R1Y3QucHJvZHVjdF92ZXJzaW9ucy5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLkRCSW50ZXJmYWNlc1RhYmxlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwubG9hZGluZ1RhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZHRJbnN0YW5jZSA9IHt9O1xuICAgICAgICAgICAgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5kdENvbHVtbnMgPSBbXTtcbiAgICAgICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZHRDb2x1bW5EZWZzID0gW107XG4gICAgICAgICAgICBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmhlYWRlcnMgPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW46ICdpbnRlcmZhY2VfbmFtZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdOYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW46ICdpbnRlcmZhY2VfdHlwZV9uYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ0ludGVyZmFjZSBUeXBlJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW46ICdkYl9zY2hlbWEnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnU2NoZW1hJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnZGJfcG9ydCcsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnUG9ydCcsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdkYl91c2VyJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdVc2VyJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2RiX3Bhc3N3b3JkJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdQYXNzd29yZCcsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZGF0ZSdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2RiX2hvc3QnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ0hvc3QnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGUgOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnZGJfY29ubmVjdGlvbl9zdHJpbmcnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ0Nvbm5lY3Rpb24gU3RyaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdkYXRlJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAndXBkYXRlX2RiX2ludGVyZmFjZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnVXBkYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogdHJ1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIHZhciB1cGRhdGVDZWxsID0gZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwsIG1ldGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxpbWcgc3JjPVwiaWNvbnMvZWRpdC5zdmdcIiBhbHQ9XCJlZGl0XCIgbmctY2xpY2s9XCJlbnZOZXdQcm9kdWN0Q3RybC5vcGVuREJJbnRlcmZhY2VNb2RhbChcXCcnICsgZnVsbC5pbnRlcmZhY2VfaWQgKyAnXFwnKVwiPic7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuaGVhZGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmhlYWRlcnNbaV0uY29sdW1uID09ICd1cGRhdGVfZGJfaW50ZXJmYWNlJyl7XG4gICAgICAgICAgICAgICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZHRDb2x1bW5zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmhlYWRlcnNbaV0uY29sdW1uKS53aXRoVGl0bGUoZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5oZWFkZXJzW2ldLm5hbWUpLnJlbmRlcldpdGgodXBkYXRlQ2VsbCkubm90U29ydGFibGUoKS53aXRoT3B0aW9uKCdkZWZhdWx0Q29udGVudCcsICcgJykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5kdENvbHVtbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuaGVhZGVyc1tpXS5jb2x1bW4pLndpdGhUaXRsZShlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmhlYWRlcnNbaV0ubmFtZSkud2l0aE9wdGlvbignZGVmYXVsdENvbnRlbnQnLCAnICcpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZ2V0VGFibGVEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmVudlByb2R1Y3QuaW50ZXJmYWNlcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmR0T3B0aW9ucyA9IERUT3B0aW9uc0J1aWxkZXIuZnJvbUZuUHJvbWlzZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmdldFRhYmxlRGF0YSgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLndpdGhET00oJzxcImh0bWw1YnV0dG9uc1wiQj5sVGZnaXRwJylcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignY3JlYXRlZFJvdycsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVjb21waWxpbmcgc28gd2UgY2FuIGJpbmQgQW5ndWxhciBkaXJlY3RpdmUgdG8gdGhlIERUXG4gICAgICAgICAgICAgICAgICAgICRjb21waWxlKGFuZ3VsYXIuZWxlbWVudChyb3cpLmNvbnRlbnRzKCkpKCRzY29wZSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignc2Nyb2xsWCcsIGZhbHNlKVxuICAgICAgICAgICAgICAgIC53aXRoQnV0dG9ucyhbXSk7XG5cbiAgICAgICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZHRJbnN0YW5jZUNhbGxiYWNrID0gZnVuY3Rpb24gKGR0SW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0Z1bmN0aW9uKGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZHRJbnN0YW5jZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5kdEluc3RhbmNlKGR0SW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5ndWxhci5pc0RlZmluZWQoZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5kdEluc3RhbmNlKSkge1xuICAgICAgICAgICAgICAgICAgICBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmR0SW5zdGFuY2UgPSBkdEluc3RhbmNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5kdEluc3RhbmNlLmNoYW5nZURhdGEgIT0gbnVsbClcbiAgICAgICAgICAgICAgICBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmR0SW5zdGFuY2UuY2hhbmdlRGF0YShlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmdldFRhYmxlRGF0YSgpKTtcblxuICAgICAgICAgICAgICAgICR0aW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5sb2FkaW5nVGFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuXG5cbiAgICAgICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwub3BlbkRCSW50ZXJmYWNlTW9kYWwgPSBmdW5jdGlvbihkYl9pbnRlcmZhY2VfaWQpe1xuXG4gICAgICAgICAgICAgICAgdmFyIGludGVyZmFjZUluZGV4ID0gXy5maW5kSW5kZXgoZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LmludGVyZmFjZXMse2ludGVyZmFjZV9pZCA6IGRiX2ludGVyZmFjZV9pZH0pO1xuICAgICAgICAgICAgICAgIGlmIChpbnRlcmZhY2VJbmRleCA8IDApe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGRiSW50ZXJmYWNlTW9kYWxJbnN0YW5jZSA9ICR1aWJNb2RhbC5vcGVuKHtcblxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2Vudmlyb25tZW50cy9wcm9kdWN0cy9kYkludGVyZmFjZU1vZGFsLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGJJbnRlcmZhY2UgOiBlbnZpcm9ubWVudE5ld1Byb2R1Y3RDdHJsLmVudlByb2R1Y3QuaW50ZXJmYWNlc1tpbnRlcmZhY2VJbmRleF1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gKCRzY29wZSwgJHVpYk1vZGFsSW5zdGFuY2UsZGJJbnRlcmZhY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYkludGVyZmFjZUN0cmwgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGJJbnRlcmZhY2VDdHJsLmRiSW50ZXJmYWNlRGF0YSA9IGRiSW50ZXJmYWNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGJJbnRlcmZhY2VDdHJsLmNvbm5lY3Rpb25UeXBlID0gdHJ1ZTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRiSW50ZXJmYWNlQ3RybC5zYXZlREJJbnRlcmZhY2UgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR1aWJNb2RhbEluc3RhbmNlLmNsb3NlKGRiSW50ZXJmYWNlQ3RybC5kYkludGVyZmFjZURhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGJJbnRlcmZhY2VDdHJsLnRlc3REQkludGVyZmFjZUNvbm4gPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRiSW50ZXJmYWNlQ3RybC50ZXN0REJJbnRlcmZhY2VDb25uUmVzdWx0ID0gXCJTdWNjZXNzXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUZXN0IGRvbmUuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGJJbnRlcmZhY2VDdHJsLmNsb3NlID0gZnVuY3Rpb24gKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVpYk1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2RiSW50ZXJmYWNlQ3RybCdcbiAgICAgICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAoaW50ZXJmYWNlRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW50ZXJmYWNlRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW52aXJvbm1lbnROZXdQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LmludGVyZmFjZXNbaW50ZXJmYWNlSW5kZXhdID0gaW50ZXJmYWNlRGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZHRJbnN0YW5jZS5jaGFuZ2VEYXRhKGVudmlyb25tZW50TmV3UHJvZHVjdEN0cmwuZ2V0VGFibGVEYXRhKCkpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cblxuXG4gICAgICAgIEJyZWFkQ3J1bWJzU2VydmljZS5wdXNoKHt9LCAnTkVXX1BST0RVQ1QnLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiBcIkVcIixcbiAgICAgICAgdGVtcGxhdGVVcmw6IHRlbXBsYXRlLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgY29udGVudDogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRyb2xsZXI6IGNvbnRyb2xsZXIsXG4gICAgICAgIGNvbnRyb2xsZXJBczogJ2Vudk5ld1Byb2R1Y3RDdHJsJ1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGVudmlyb25tZW50UHJvZHVjdHNUYWJsZURpcmVjdGl2ZSgpIHtcblxuICAgIHZhciB0ZW1wbGF0ZSA9IFwidmlld3MvZW52aXJvbm1lbnRzL3Byb2R1Y3RzL3Byb2R1Y3RzVGFibGUuaHRtbFwiO1xuXG4gICAgdmFyIGNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoJHNjb3BlLCAkY29tcGlsZSwgVERNU2VydmljZSwgRFRDb2x1bW5CdWlsZGVyLCBEVE9wdGlvbnNCdWlsZGVyLCAkcSxBdXRoU2VydmljZSwgdG9hc3RyKSB7XG4gICAgICAgIHZhciBwcm9kdWN0c1RhYmxlQ3RybCA9IHRoaXM7XG5cbiAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuZW52aXJvbm1lbnRJRCA9ICRzY29wZS5jb250ZW50LmVudmlyb25tZW50SUQ7XG4gICAgICAgIHByb2R1Y3RzVGFibGVDdHJsLmRpc2FibGVDaGFuZ2UgPSAoIUF1dGhTZXJ2aWNlLmF1dGhvcml6ZWRUb0VkaXQoMSkgfHwgISRzY29wZS5jb250ZW50LmlzT3duZXIpO1xuXG4gICAgICAgIFRETVNlcnZpY2UuZ2V0RW52UHJvZHVjdHMocHJvZHVjdHNUYWJsZUN0cmwuZW52aXJvbm1lbnRJRCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvckNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcbiAgICAgICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5wcm9kdWN0cyA9IHJlc3BvbnNlLnJlc3VsdDtcbiAgICAgICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5kdEluc3RhbmNlID0ge307XG4gICAgICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuZHRDb2x1bW5zID0gW107XG4gICAgICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuZHRDb2x1bW5EZWZzID0gW107XG4gICAgICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuaGVhZGVycyA9IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAncHJvZHVjdF9uYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdOYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW46ICdkYXRhX2NlbnRlcl9uYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdEYXRhIENlbnRlciBOYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAncHJvZHVjdF92ZXJzaW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdWZXJzaW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnY3JlYXRlZF9ieScsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnQ3JlYXRlZCBCeScsXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja0FibGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ2NyZWF0aW9uX2RhdGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ0NyZWF0aW9uIERhdGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgOiAnZGF0ZSdcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnbGFzdF91cGRhdGVkX2J5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdVcGRhdGVkIEJ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnbGFzdF91cGRhdGVkX2RhdGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1VwZGF0ZSBEYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlIDogJ2RhdGUnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbjogJ3N0YXR1cycsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnU3RhdHVzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgICAgICB2YXIgY2xpY2tBYmxlQ29sdW1uID0gZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwsIG1ldGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8YSBuZy1jbGljaz1cImVudlByb2R1Y3RzVGFibGVDdHJsLm9wZW5Qcm9kdWN0KCcgKyBmdWxsLnByb2R1Y3RfaWQgKyAnKVwiPicgKyBkYXRhICsgJzwvYT4nO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hhbmdlVG9Mb2NhbERhdGUgPSBmdW5jdGlvbihkYXRhLCB0eXBlLCBmdWxsLCBtZXRhKXtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50KGRhdGEpLmZvcm1hdCgnRCBNTU0gWVlZWSwgaDptbScpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvZHVjdHNUYWJsZUN0cmwuaGVhZGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvZHVjdHNUYWJsZUN0cmwuaGVhZGVyc1tpXS5jbGlja0FibGUgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuZHRDb2x1bW5zLnB1c2goRFRDb2x1bW5CdWlsZGVyLm5ld0NvbHVtbihwcm9kdWN0c1RhYmxlQ3RybC5oZWFkZXJzW2ldLmNvbHVtbikud2l0aFRpdGxlKHByb2R1Y3RzVGFibGVDdHJsLmhlYWRlcnNbaV0ubmFtZSkucmVuZGVyV2l0aChjbGlja0FibGVDb2x1bW4pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChwcm9kdWN0c1RhYmxlQ3RybC5oZWFkZXJzW2ldLnR5cGUgPT0gJ2RhdGUnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzVGFibGVDdHJsLmR0Q29sdW1ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4ocHJvZHVjdHNUYWJsZUN0cmwuaGVhZGVyc1tpXS5jb2x1bW4pLndpdGhUaXRsZShwcm9kdWN0c1RhYmxlQ3RybC5oZWFkZXJzW2ldLm5hbWUpLnJlbmRlcldpdGgoY2hhbmdlVG9Mb2NhbERhdGUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzVGFibGVDdHJsLmR0Q29sdW1ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4ocHJvZHVjdHNUYWJsZUN0cmwuaGVhZGVyc1tpXS5jb2x1bW4pLndpdGhUaXRsZShwcm9kdWN0c1RhYmxlQ3RybC5oZWFkZXJzW2ldLm5hbWUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBnZXRUYWJsZURhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocHJvZHVjdHNUYWJsZUN0cmwucHJvZHVjdHMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwuZHRPcHRpb25zID0gRFRPcHRpb25zQnVpbGRlci5mcm9tRm5Qcm9taXNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFRhYmxlRGF0YSgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC53aXRoRE9NKCc8XCJodG1sNWJ1dHRvbnNcIkI+bFRmZ2l0cCcpXG4gICAgICAgICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdjcmVhdGVkUm93JywgZnVuY3Rpb24gKHJvdykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVjb21waWxpbmcgc28gd2UgY2FuIGJpbmQgQW5ndWxhciBkaXJlY3RpdmUgdG8gdGhlIERUXG4gICAgICAgICAgICAgICAgICAgICAgICAkY29tcGlsZShhbmd1bGFyLmVsZW1lbnQocm93KS5jb250ZW50cygpKSgkc2NvcGUpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAud2l0aE9wdGlvbignc2Nyb2xsWCcsIGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICAud2l0aEJ1dHRvbnMoW10pXG4gICAgICAgICAgICAgICAgICAgIC53aXRoQ29sdW1uRmlsdGVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFvQ29sdW1uczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiUmVnZXg6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJTbWFydDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJSZWdleDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYlNtYXJ0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYlJlZ2V4OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiU21hcnQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJSZWdleDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogXy51bmlxdWUoXy5tYXAocHJvZHVjdHNUYWJsZUN0cmwucHJvZHVjdHMsICdjcmVhdGVkX2J5JykpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYlJlZ2V4OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiU21hcnQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJSZWdleDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogXy51bmlxdWUoXy5tYXAocHJvZHVjdHNUYWJsZUN0cmwucHJvZHVjdHMsICdsYXN0X3VwZGF0ZWRfYnknKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiUmVnZXg6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJTbWFydDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5kdEluc3RhbmNlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZHRJbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0Z1bmN0aW9uKHByb2R1Y3RzVGFibGVDdHJsLmR0SW5zdGFuY2UpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5kdEluc3RhbmNlKGR0SW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHByb2R1Y3RzVGFibGVDdHJsLmR0SW5zdGFuY2UpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5kdEluc3RhbmNlID0gZHRJbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHByb2R1Y3RzVGFibGVDdHJsLmR0SW5zdGFuY2UuY2hhbmdlRGF0YSAhPSBudWxsKVxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0c1RhYmxlQ3RybC5kdEluc3RhbmNlLmNoYW5nZURhdGEoZ2V0VGFibGVEYXRhKCkpO1xuXG4gICAgICAgICAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwubG9hZGluZ1RhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJFbnZpcm9ubWVudCAjIFwiICsgcHJvZHVjdHNUYWJsZUN0cmwuZW52aXJvbm1lbnRJRCwgXCJGYWlsZCB0byBnZXQgcHJvZHVjdHNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHByb2R1Y3RzVGFibGVDdHJsLm9wZW5Qcm9kdWN0ID0gZnVuY3Rpb24gKHByb2R1Y3RJRCkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jb250ZW50Lm9wZW5Qcm9kdWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb2R1Y3REYXRhID0gXy5maW5kKHByb2R1Y3RzVGFibGVDdHJsLnByb2R1Y3RzLCB7cHJvZHVjdF9pZDogcHJvZHVjdElEfSk7XG4gICAgICAgICAgICAgICAgaWYgKHByb2R1Y3REYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jb250ZW50Lm9wZW5Qcm9kdWN0KHByb2R1Y3REYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vVE9ETyBzaG93IGVycm9yID8/XG4gICAgICAgIH07XG5cbiAgICAgICAgcHJvZHVjdHNUYWJsZUN0cmwub3Blbk5ld1Byb2R1Y3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNvbnRlbnQub3Blbk5ld1Byb2R1Y3QpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29udGVudC5vcGVuTmV3UHJvZHVjdCgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vVE9ETyBzaG93IGVycm9yID8/XG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogXCJFXCIsXG4gICAgICAgIHRlbXBsYXRlVXJsOiB0ZW1wbGF0ZSxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGNvbnRlbnQ6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBjb250cm9sbGVyLFxuICAgICAgICBjb250cm9sbGVyQXM6ICdlbnZQcm9kdWN0c1RhYmxlQ3RybCdcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBlbnZpcm9ubWVudFByb2R1Y3REaXJlY3RpdmUoKSB7XG5cbiAgICB2YXIgdGVtcGxhdGUgPSBcInZpZXdzL2Vudmlyb25tZW50cy9wcm9kdWN0cy9wcm9kdWN0Lmh0bWxcIjtcblxuICAgIHZhciBjb250cm9sbGVyID0gZnVuY3Rpb24gKCRzY29wZSwgJGNvbXBpbGUsVERNU2VydmljZSwgQnJlYWRDcnVtYnNTZXJ2aWNlLCB0b2FzdHIsIFN3ZWV0QWxlcnQsQXV0aFNlcnZpY2UsRFRDb2x1bW5CdWlsZGVyLCBEVE9wdGlvbnNCdWlsZGVyLCAkcSwkdWliTW9kYWwsICR0aW1lb3V0KSB7XG4gICAgICAgIHZhciBlbnZpcm9ubWVudFByb2R1Y3RDdHJsID0gdGhpcztcbiAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0ID0gJHNjb3BlLmNvbnRlbnQucHJvZHVjdERhdGE7XG5cbiAgICAgICAgdmFyIGRiVHlwZXMgPSBURE1TZXJ2aWNlLmdldERCVHlwZXMoKTtcbiAgICAgICAgXy5lYWNoKGVudmlyb25tZW50UHJvZHVjdEN0cmwuZW52UHJvZHVjdC5pbnRlcmZhY2VzLCBmdW5jdGlvbiAoaW50ZXJmYWNlMSkge1xuICAgICAgICAgICAgdmFyIGRiX3R5cGUgPSBfLmZpbmQoZGJUeXBlcywge2RiX3R5cGVfaWQ6IGludGVyZmFjZTEuaW50ZXJmYWNlX3R5cGVfaWR9KTtcbiAgICAgICAgICAgIGludGVyZmFjZTEuaW50ZXJmYWNlX3R5cGVfbmFtZSA9IGRiX3R5cGUuZGJfdHlwZV9uYW1lO1xuICAgICAgICB9KTtcblxuICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmVudmlyb25tZW50SUQgPSAkc2NvcGUuY29udGVudC5lbnZpcm9ubWVudElEO1xuXG4gICAgICAgIGVudmlyb25tZW50UHJvZHVjdEN0cmwuZGlzYWJsZUNoYW5nZSA9IChlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmVudlByb2R1Y3Quc3RhdHVzID09ICdJbmFjdGl2ZScgfHwgIUF1dGhTZXJ2aWNlLmF1dGhvcml6ZWRUb0VkaXQoMSkgfHwgISRzY29wZS5jb250ZW50LmlzT3duZXIpO1xuXG4gICAgICAgIFRETVNlcnZpY2UuZ2V0RGF0YUNlbnRlcnMoKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgIGVudmlyb25tZW50UHJvZHVjdEN0cmwuZGF0YUNlbnRlcnMgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoXCJTeXN0ZW0gIyBcIiArIGVudmlyb25tZW50UHJvZHVjdEN0cmwuZW52UHJvZHVjdC5wcm9kdWN0X25hbWUsIFwiZmFpbGVkIHRvIGdldCBkYXRhIGNlbnRlcnNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGVudmlyb25tZW50UHJvZHVjdEN0cmwudmVyc2lvbnMgPSBlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmVudlByb2R1Y3QucHJvZHVjdF92ZXJzaW9ucy5zcGxpdCgnLCcpO1xuXG4gICAgICAgIGVudmlyb25tZW50UHJvZHVjdEN0cmwudXBkYXRlRW52UHJvZHVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIFRETVNlcnZpY2UucHV0RW52UHJvZHVjdChlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmVudmlyb25tZW50SUQsJHNjb3BlLmNvbnRlbnQuZW52aXJvbm1lbnROYW1lLCBlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmVudlByb2R1Y3QpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhcIlN5c3RlbSAjIFwiICsgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LnByb2R1Y3RfbmFtZSwgXCJVcGRhdGVkIFN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnQub3BlblByb2R1Y3RzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDQwMClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIlN5c3RlbSAjIFwiICsgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LnByb2R1Y3RfbmFtZSwgXCJmYWlsZWQgdG8gdXBkYXRlXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGVudmlyb25tZW50UHJvZHVjdEN0cmwuZGVsZXRlRW52UHJvZHVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIFN3ZWV0QWxlcnQuc3dhbCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZW1vdmUgU3lzdGVtIFwiICsgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LnByb2R1Y3RfbmFtZSAsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwid2FybmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6IFwiI0RENkI1NVwiLFxuICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogXCJZZXNcIixcbiAgICAgICAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogXCJOb1wiLFxuICAgICAgICAgICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBcImZhbHNlXCIsXG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUNsYXNzOiBcImFuaW1hdGVkIGZhZGVJblVwXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChpc0NvbmZpcm0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ29uZmlybSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgVERNU2VydmljZS5kZWxldGVFbnZQcm9kdWN0KGVudmlyb25tZW50UHJvZHVjdEN0cmwuZW52aXJvbm1lbnRJRCwkc2NvcGUuY29udGVudC5lbnZpcm9ubWVudE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LnByb2R1Y3RfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yQ29kZSA9PSBcIlNVQ0NFU1NcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhcIlN5c3RlbSAjIFwiICsgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LnByb2R1Y3RfbmFtZSwgXCJkZWxldGVkIFN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnQub3BlblByb2R1Y3RzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDQwMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihcIlN5c3RlbSAjIFwiICsgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LnByb2R1Y3RfbmFtZSwgXCJmYWlsZWQgdG8gZGVsZXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5EQkludGVyZmFjZXNUYWJsZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmxvYWRpbmdUYWJsZSA9IHRydWU7XG4gICAgICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmR0SW5zdGFuY2UgPSB7fTtcbiAgICAgICAgICAgIGVudmlyb25tZW50UHJvZHVjdEN0cmwuZHRDb2x1bW5zID0gW107XG4gICAgICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmR0Q29sdW1uRGVmcyA9IFtdO1xuICAgICAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5oZWFkZXJzID0gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnaW50ZXJmYWNlX25hbWUnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnTmFtZScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnaW50ZXJmYWNlX3R5cGVfbmFtZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdJbnRlcmZhY2UgVHlwZScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAnZGJfc2NoZW1hJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1NjaGVtYScsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2RiX3BvcnQnLFxuICAgICAgICAgICAgICAgICAgICBuYW1lIDogJ1BvcnQnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGUgOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAnZGJfdXNlcicsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnVXNlcicsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdkYl9wYXNzd29yZCcsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnUGFzc3dvcmQnLFxuICAgICAgICAgICAgICAgICAgICBjbGlja0FibGUgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2RhdGUnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA6ICdkYl9ob3N0JyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdIb3N0JyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uIDogJ2RiX2Nvbm5lY3Rpb25fc3RyaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA6ICdDb25uZWN0aW9uIFN0cmluZycsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrQWJsZSA6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZGF0ZSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICBpZiAoIWVudmlyb25tZW50UHJvZHVjdEN0cmwuZGlzYWJsZUNoYW5nZSl7XG4gICAgICAgICAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5oZWFkZXJzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gOiAndXBkYXRlX2RiX2ludGVyZmFjZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiAnVXBkYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tBYmxlIDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdXBkYXRlQ2VsbCA9IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCBmdWxsLCBtZXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICc8aW1nIHNyYz1cImljb25zL2VkaXQuc3ZnXCIgYWx0PVwiZWRpdFwiICBuZy1jbGljaz1cImVudlByb2R1Y3RDdHJsLm9wZW5EQkludGVyZmFjZU1vZGFsKFxcJycgKyBmdWxsLmludGVyZmFjZV9pZCArICdcXCcpXCI+JztcbiAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmhlYWRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5oZWFkZXJzW2ldLmNvbHVtbiA9PSAndXBkYXRlX2RiX2ludGVyZmFjZScpe1xuICAgICAgICAgICAgICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmR0Q29sdW1ucy5wdXNoKERUQ29sdW1uQnVpbGRlci5uZXdDb2x1bW4oZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5oZWFkZXJzW2ldLmNvbHVtbikud2l0aFRpdGxlKGVudmlyb25tZW50UHJvZHVjdEN0cmwuaGVhZGVyc1tpXS5uYW1lKS5yZW5kZXJXaXRoKHVwZGF0ZUNlbGwpLm5vdFNvcnRhYmxlKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5kdENvbHVtbnMucHVzaChEVENvbHVtbkJ1aWxkZXIubmV3Q29sdW1uKGVudmlyb25tZW50UHJvZHVjdEN0cmwuaGVhZGVyc1tpXS5jb2x1bW4pLndpdGhUaXRsZShlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmhlYWRlcnNbaV0ubmFtZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGdldFRhYmxlRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LmludGVyZmFjZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5kdE9wdGlvbnMgPSBEVE9wdGlvbnNCdWlsZGVyLmZyb21GblByb21pc2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0VGFibGVEYXRhKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAud2l0aERPTSgnPFwiaHRtbDVidXR0b25zXCJCPmxUZmdpdHAnKVxuICAgICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdjcmVhdGVkUm93JywgZnVuY3Rpb24gKHJvdykge1xuICAgICAgICAgICAgICAgICAgICAvLyBSZWNvbXBpbGluZyBzbyB3ZSBjYW4gYmluZCBBbmd1bGFyIGRpcmVjdGl2ZSB0byB0aGUgRFRcbiAgICAgICAgICAgICAgICAgICAgJGNvbXBpbGUoYW5ndWxhci5lbGVtZW50KHJvdykuY29udGVudHMoKSkoJHNjb3BlKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC53aXRoT3B0aW9uKCdzY3JvbGxYJywgZmFsc2UpXG4gICAgICAgICAgICAgICAgLndpdGhCdXR0b25zKFtdKTtcblxuICAgICAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5kdEluc3RhbmNlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZHRJbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24oZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5kdEluc3RhbmNlKSkge1xuICAgICAgICAgICAgICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmR0SW5zdGFuY2UoZHRJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhbmd1bGFyLmlzRGVmaW5lZChlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmR0SW5zdGFuY2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVudmlyb25tZW50UHJvZHVjdEN0cmwuZHRJbnN0YW5jZSA9IGR0SW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmR0SW5zdGFuY2UuY2hhbmdlRGF0YSAhPSBudWxsKVxuICAgICAgICAgICAgICAgIGVudmlyb25tZW50UHJvZHVjdEN0cmwuZHRJbnN0YW5jZS5jaGFuZ2VEYXRhKGdldFRhYmxlRGF0YSgpKTtcblxuICAgICAgICAgICAgICAgICR0aW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5sb2FkaW5nVGFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICBlbnZpcm9ubWVudFByb2R1Y3RDdHJsLm9wZW5EQkludGVyZmFjZU1vZGFsID0gZnVuY3Rpb24oZGJfaW50ZXJmYWNlX2lkKXtcblxuICAgICAgICAgICAgICAgIHZhciBpbnRlcmZhY2VJbmRleCA9IF8uZmluZEluZGV4KGVudmlyb25tZW50UHJvZHVjdEN0cmwuZW52UHJvZHVjdC5pbnRlcmZhY2VzLHtpbnRlcmZhY2VfaWQgOiBkYl9pbnRlcmZhY2VfaWR9KTtcbiAgICAgICAgICAgICAgICBpZiAoaW50ZXJmYWNlSW5kZXggPCAwKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBkYkludGVyZmFjZU1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG5cbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9lbnZpcm9ubWVudHMvcHJvZHVjdHMvZGJJbnRlcmZhY2VNb2RhbC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRiSW50ZXJmYWNlIDogZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LmludGVyZmFjZXNbaW50ZXJmYWNlSW5kZXhdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uICgkc2NvcGUsICR1aWJNb2RhbEluc3RhbmNlLGRiSW50ZXJmYWNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGJJbnRlcmZhY2VDdHJsID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRiSW50ZXJmYWNlQ3RybC5kYkludGVyZmFjZURhdGEgPSBkYkludGVyZmFjZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRiSW50ZXJmYWNlQ3RybC5jb25uZWN0aW9uVHlwZSA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRiSW50ZXJmYWNlQ3RybC5zYXZlREJJbnRlcmZhY2UgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR1aWJNb2RhbEluc3RhbmNlLmNsb3NlKGRiSW50ZXJmYWNlQ3RybC5kYkludGVyZmFjZURhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGJJbnRlcmZhY2VDdHJsLnRlc3REQkludGVyZmFjZUNvbm4gPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRiSW50ZXJmYWNlQ3RybC50ZXN0REJJbnRlcmZhY2VDb25uUmVzdWx0ID0gXCJTdWNjZXNzXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUZXN0IGRvbmUuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGJJbnRlcmZhY2VDdHJsLmNsb3NlID0gZnVuY3Rpb24gKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVpYk1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2RiSW50ZXJmYWNlQ3RybCdcbiAgICAgICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAoaW50ZXJmYWNlMSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW50ZXJmYWNlMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LmludGVyZmFjZXNbaW50ZXJmYWNlSW5kZXhdID0gaW50ZXJmYWNlMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudmlyb25tZW50UHJvZHVjdEN0cmwuZHRJbnN0YW5jZS5jaGFuZ2VEYXRhKGdldFRhYmxlRGF0YSgpKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgQnJlYWRDcnVtYnNTZXJ2aWNlLnB1c2goe3Byb2R1Y3RJRDogZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5lbnZQcm9kdWN0LnByb2R1Y3RfbmFtZX0sICdQUk9EVUNUX0JSRUFEQ1JVTUInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuY29udGVudC5vcGVuUHJvZHVjdChlbnZpcm9ubWVudFByb2R1Y3RDdHJsLmVudlByb2R1Y3QpO1xuICAgICAgICB9KTtcbiAgICAgICAgZW52aXJvbm1lbnRQcm9kdWN0Q3RybC5EQkludGVyZmFjZXNUYWJsZSgpO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogXCJFXCIsXG4gICAgICAgIHRlbXBsYXRlVXJsOiB0ZW1wbGF0ZSxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGNvbnRlbnQ6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBjb250cm9sbGVyLFxuICAgICAgICBjb250cm9sbGVyQXM6ICdlbnZQcm9kdWN0Q3RybCdcbiAgICB9O1xufVxuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnVERNLUZFJylcbiAgICAuZGlyZWN0aXZlKCdlbnZpcm9ubWVudFByb2R1Y3RzRGlyZWN0aXZlJywgZW52aXJvbm1lbnRQcm9kdWN0c0RpcmVjdGl2ZSlcbiAgICAuZGlyZWN0aXZlKCdlbnZpcm9ubWVudFByb2R1Y3RzVGFibGVEaXJlY3RpdmUnLCBlbnZpcm9ubWVudFByb2R1Y3RzVGFibGVEaXJlY3RpdmUpXG4gICAgLmRpcmVjdGl2ZSgnZW52aXJvbm1lbnROZXdQcm9kdWN0RGlyZWN0aXZlJywgZW52aXJvbm1lbnROZXdQcm9kdWN0RGlyZWN0aXZlKVxuICAgIC5kaXJlY3RpdmUoJ2Vudmlyb25tZW50UHJvZHVjdERpcmVjdGl2ZScsIGVudmlyb25tZW50UHJvZHVjdERpcmVjdGl2ZSk7Il19
