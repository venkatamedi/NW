/*!
 * Column visibility buttons for Buttons and DataTables.
 * 2016 SpryMedia Ltd - datatables.net/license
 */
!function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],(function($){return factory($,window,document)})):"object"==typeof exports?module.exports=function(root,$){return root||(root=window),$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),$.fn.dataTable.Buttons||require("datatables.net-buttons")(root,$),factory($,root,root.document)}:factory(jQuery,window,document)}((function($,window,document,undefined){"use strict";var DataTable=$.fn.dataTable;return $.extend(DataTable.ext.buttons,{colvis:function(dt,conf){return{extend:"collection",text:function(dt){return dt.i18n("buttons.colvis","Column visibility")},className:"buttons-colvis",buttons:[{extend:"columnsToggle",columns:conf.columns,callback:conf.callback}]}},columnsToggle:function(dt,conf){return dt.columns(conf.columns).indexes().map((function(idx){return{extend:"columnToggle",columns:idx,callback:conf.callback}})).toArray()},columnToggle:function(dt,conf){return{extend:"columnVisibility",columns:conf.columns,callback:conf.callback}},columnsVisibility:function(dt,conf){return dt.columns(conf.columns).indexes().map((function(idx){return{extend:"columnVisibility",columns:idx,visibility:conf.visibility,callback:conf.callback}})).toArray()},columnVisibility:{columns:undefined,text:function(dt,button,conf){return conf._columnText(dt,conf.columns)},className:"buttons-columnVisibility",action:function(e,dt,button,conf){var col=dt.columns(conf.columns),curr=col.visible();conf.callback(col[0][0],conf.visibility!==undefined?conf.visibility:!(curr.length&&curr[0])),col.visible(conf.visibility!==undefined?conf.visibility:!(curr.length&&curr[0]))},init:function(dt,button,conf){var that=this;dt.on("column-visibility.dt"+conf.namespace,(function(e,settings){settings.bDestroying||that.active(dt.column(conf.columns).visible())})).on("column-reorder.dt"+conf.namespace,(function(e,settings,details){if(1===dt.columns(conf.columns).count()){"number"==typeof conf.columns&&(conf.columns=details.mapping[conf.columns]);var col=dt.column(conf.columns);that.text(conf._columnText(dt,conf.columns)),that.active(col.visible())}})),this.active(dt.column(conf.columns).visible())},destroy:function(dt,button,conf){dt.off("column-visibility.dt"+conf.namespace).off("column-reorder.dt"+conf.namespace)},_columnText:function(dt,col){var idx=dt.column(col).index();return dt.settings()[0].aoColumns[idx].sTitle.replace(/\n/g," ").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,"")}},colvisRestore:{className:"buttons-colvisRestore",text:function(dt){return dt.i18n("buttons.colvisRestore","Restore visibility")},init:function(dt,button,conf){conf._visOriginal=dt.columns().indexes().map((function(idx){return dt.column(idx).visible()})).toArray()},action:function(e,dt,button,conf){dt.columns().every((function(i){var idx=dt.colReorder&&dt.colReorder.transpose?dt.colReorder.transpose(i,"toOriginal"):i;this.visible(conf._visOriginal[idx])}))}},colvisGroup:{className:"buttons-colvisGroup",action:function(e,dt,button,conf){dt.columns(conf.show).visible(!0,!1),dt.columns(conf.hide).visible(!1,!1),dt.columns.adjust()},show:[],hide:[]}}),DataTable.Buttons}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBsdWdpbnMvZGF0YVRhYmxlcy9idXR0b25zLmNvbHZpcy5qcyJdLCJuYW1lcyI6WyJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwiJCIsIndpbmRvdyIsImRvY3VtZW50IiwiZXhwb3J0cyIsIm1vZHVsZSIsInJvb3QiLCJmbiIsImRhdGFUYWJsZSIsInJlcXVpcmUiLCJCdXR0b25zIiwialF1ZXJ5IiwidW5kZWZpbmVkIiwiRGF0YVRhYmxlIiwiZXh0ZW5kIiwiZXh0IiwiYnV0dG9ucyIsImNvbHZpcyIsImR0IiwiY29uZiIsInRleHQiLCJpMThuIiwiY2xhc3NOYW1lIiwiY29sdW1ucyIsImNhbGxiYWNrIiwiY29sdW1uc1RvZ2dsZSIsImluZGV4ZXMiLCJtYXAiLCJpZHgiLCJ0b0FycmF5IiwiY29sdW1uVG9nZ2xlIiwiY29sdW1uc1Zpc2liaWxpdHkiLCJ2aXNpYmlsaXR5IiwiY29sdW1uVmlzaWJpbGl0eSIsImJ1dHRvbiIsIl9jb2x1bW5UZXh0IiwiYWN0aW9uIiwiZSIsImNvbCIsImN1cnIiLCJ2aXNpYmxlIiwibGVuZ3RoIiwiaW5pdCIsInRoYXQiLCJ0aGlzIiwib24iLCJuYW1lc3BhY2UiLCJzZXR0aW5ncyIsImJEZXN0cm95aW5nIiwiYWN0aXZlIiwiY29sdW1uIiwiZGV0YWlscyIsImNvdW50IiwibWFwcGluZyIsImRlc3Ryb3kiLCJvZmYiLCJpbmRleCIsImFvQ29sdW1ucyIsInNUaXRsZSIsInJlcGxhY2UiLCJjb2x2aXNSZXN0b3JlIiwiX3Zpc09yaWdpbmFsIiwiZXZlcnkiLCJpIiwiY29sUmVvcmRlciIsInRyYW5zcG9zZSIsImNvbHZpc0dyb3VwIiwic2hvdyIsImhpZGUiLCJhZGp1c3QiXSwibWFwcGluZ3MiOiI7Ozs7Q0FLQyxTQUFVQSxTQUNnQixtQkFBWEMsUUFBeUJBLE9BQU9DLElBRXhDRCxPQUFRLENBQUMsU0FBVSxpQkFBa0IsMkJBQTJCLFNBQVdFLEdBQ3ZFLE9BQU9ILFFBQVNHLEVBQUdDLE9BQVFDLGFBR04saUJBQVpD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QUNqQ1MsSUFBSyxvQkFBb0JwQyxLQUFLMkIsWUFHdkNYLFlBQWEsU0FBV2pCLEdBQUlvQixLQUt4QixJQUFJVixJQUFNVixHQUFHZ0MsT0FBUVosS0FBTWtCLFFBQzNCLE9BQU90QyxHQUFHNkIsV0FBVyxHQUFHVSxVQUFXN0IsS0FBTThCLE9BQ3BDQyxRQUFRLE1BQU0sS0FDZEEsUUFBUyxTQUFVLElBQ25CQSxRQUFRLGFBQWEsTUFLbENDLGNBQWUsQ0FDWHRDLFVBQVcsd0JBRVhGLEtBQU0sU0FBV0YsSUFDYixPQUFPQSxHQUFHRyxLQUFNLHdCQUF5Qix1QkFHN0NxQixLQUFNLFNBQVd4QixHQUFJZ0IsT0FBUWYsTUFDekJBLEtBQUswQyxhQUFlM0MsR0FBR0ssVUFBVUcsVUFBVUMsS0FBSyxTQUFXQyxLQUN2RCxPQUFPVixHQUFHZ0MsT0FBUXRCLEtBQU1ZLGFBQ3hCWCxXQUdSTyxPQUFRLFNBQVdDLEVBQUduQixHQUFJZ0IsT0FBUWYsTUFDOUJELEdBQUdLLFVBQVV1QyxPQUFPLFNBQVdDLEdBRzNCLElBQUluQyxJQUFNVixHQUFHOEMsWUFBYzlDLEdBQUc4QyxXQUFXQyxVQUNyQy9DLEdBQUc4QyxXQUFXQyxVQUFXRixFQUFHLGNBQzVCQSxFQUVKbkIsS0FBS0osUUFBU3JCLEtBQUswQyxhQUFjakMsV0FNN0NzQyxZQUFhLENBQ1Q1QyxVQUFXLHNCQUVYYyxPQUFRLFNBQVdDLEVBQUduQixHQUFJZ0IsT0FBUWYsTUFDOUJELEdBQUdLLFFBQVNKLEtBQUtnRCxNQUFPM0IsU0FBUyxHQUFNLEdBQ3ZDdEIsR0FBR0ssUUFBU0osS0FBS2lELE1BQU81QixTQUFTLEdBQU8sR0FFeEN0QixHQUFHSyxRQUFROEMsVUFHZkYsS0FBTSxHQUVOQyxLQUFNLE1BS1B2RCxVQUFVSCIsImZpbGUiOiJwbHVnaW5zL2RhdGFUYWJsZXMvYnV0dG9ucy5jb2x2aXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIENvbHVtbiB2aXNpYmlsaXR5IGJ1dHRvbnMgZm9yIEJ1dHRvbnMgYW5kIERhdGFUYWJsZXMuXG4gKiAyMDE2IFNwcnlNZWRpYSBMdGQgLSBkYXRhdGFibGVzLm5ldC9saWNlbnNlXG4gKi9cblxuKGZ1bmN0aW9uKCBmYWN0b3J5ICl7XG4gICAgaWYgKCB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7XG4gICAgICAgIC8vIEFNRFxuICAgICAgICBkZWZpbmUoIFsnanF1ZXJ5JywgJ2RhdGF0YWJsZXMubmV0JywgJ2RhdGF0YWJsZXMubmV0LWJ1dHRvbnMnXSwgZnVuY3Rpb24gKCAkICkge1xuICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkoICQsIHdpbmRvdywgZG9jdW1lbnQgKTtcbiAgICAgICAgfSApO1xuICAgIH1cbiAgICBlbHNlIGlmICggdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICkge1xuICAgICAgICAvLyBDb21tb25KU1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChyb290LCAkKSB7XG4gICAgICAgICAgICBpZiAoICEgcm9vdCApIHtcbiAgICAgICAgICAgICAgICByb290ID0gd2luZG93O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoICEgJCB8fCAhICQuZm4uZGF0YVRhYmxlICkge1xuICAgICAgICAgICAgICAgICQgPSByZXF1aXJlKCdkYXRhdGFibGVzLm5ldCcpKHJvb3QsICQpLiQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICggISAkLmZuLmRhdGFUYWJsZS5CdXR0b25zICkge1xuICAgICAgICAgICAgICAgIHJlcXVpcmUoJ2RhdGF0YWJsZXMubmV0LWJ1dHRvbnMnKShyb290LCAkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkoICQsIHJvb3QsIHJvb3QuZG9jdW1lbnQgKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vIEJyb3dzZXJcbiAgICAgICAgZmFjdG9yeSggalF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50ICk7XG4gICAgfVxufShmdW5jdGlvbiggJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkICkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgRGF0YVRhYmxlID0gJC5mbi5kYXRhVGFibGU7XG5cblxuICAgICQuZXh0ZW5kKCBEYXRhVGFibGUuZXh0LmJ1dHRvbnMsIHtcbiAgICAgICAgLy8gQSBjb2xsZWN0aW9uIG9mIGNvbHVtbiB2aXNpYmlsaXR5IGJ1dHRvbnNcbiAgICAgICAgY29sdmlzOiBmdW5jdGlvbiAoIGR0LCBjb25mICkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBleHRlbmQ6ICdjb2xsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICB0ZXh0OiBmdW5jdGlvbiAoIGR0ICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHQuaTE4biggJ2J1dHRvbnMuY29sdmlzJywgJ0NvbHVtbiB2aXNpYmlsaXR5JyApO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnYnV0dG9ucy1jb2x2aXMnLFxuICAgICAgICAgICAgICAgIGJ1dHRvbnM6IFsge1xuICAgICAgICAgICAgICAgICAgICBleHRlbmQ6ICdjb2x1bW5zVG9nZ2xlJyxcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogY29uZi5jb2x1bW5zLFxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayA6IGNvbmYuY2FsbGJhY2tcbiAgICAgICAgICAgICAgICB9IF1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gU2VsZWN0ZWQgY29sdW1ucyB3aXRoIGluZGl2aWR1YWwgYnV0dG9ucyAtIHRvZ2dsZSBjb2x1bW4gdmlzaWJpbGl0eVxuICAgICAgICBjb2x1bW5zVG9nZ2xlOiBmdW5jdGlvbiAoIGR0LCBjb25mICkge1xuICAgICAgICAgICAgdmFyIGNvbHVtbnMgPSBkdC5jb2x1bW5zKCBjb25mLmNvbHVtbnMgKS5pbmRleGVzKCkubWFwKCBmdW5jdGlvbiAoIGlkeCApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBleHRlbmQ6ICdjb2x1bW5Ub2dnbGUnLFxuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiBpZHgsXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrIDogY29uZi5jYWxsYmFja1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9ICkudG9BcnJheSgpO1xuXG4gICAgICAgICAgICByZXR1cm4gY29sdW1ucztcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBTaW5nbGUgYnV0dG9uIHRvIHRvZ2dsZSBjb2x1bW4gdmlzaWJpbGl0eVxuICAgICAgICBjb2x1bW5Ub2dnbGU6IGZ1bmN0aW9uICggZHQsIGNvbmYgKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGV4dGVuZDogJ2NvbHVtblZpc2liaWxpdHknLFxuICAgICAgICAgICAgICAgIGNvbHVtbnM6IGNvbmYuY29sdW1ucyxcbiAgICAgICAgICAgICAgICBjYWxsYmFjayA6IGNvbmYuY2FsbGJhY2tcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gU2VsZWN0ZWQgY29sdW1ucyB3aXRoIGluZGl2aWR1YWwgYnV0dG9ucyAtIHNldCBjb2x1bW4gdmlzaWJpbGl0eVxuICAgICAgICBjb2x1bW5zVmlzaWJpbGl0eTogZnVuY3Rpb24gKCBkdCwgY29uZiApIHtcbiAgICAgICAgICAgIHZhciBjb2x1bW5zID0gZHQuY29sdW1ucyggY29uZi5jb2x1bW5zICkuaW5kZXhlcygpLm1hcCggZnVuY3Rpb24gKCBpZHggKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5kOiAnY29sdW1uVmlzaWJpbGl0eScsXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IGlkeCxcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogY29uZi52aXNpYmlsaXR5LFxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayA6IGNvbmYuY2FsbGJhY2tcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSApLnRvQXJyYXkoKTtcblxuICAgICAgICAgICAgcmV0dXJuIGNvbHVtbnM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gU2luZ2xlIGJ1dHRvbiB0byBzZXQgY29sdW1uIHZpc2liaWxpdHlcbiAgICAgICAgY29sdW1uVmlzaWJpbGl0eToge1xuICAgICAgICAgICAgY29sdW1uczogdW5kZWZpbmVkLCAvLyBjb2x1bW4gc2VsZWN0b3JcbiAgICAgICAgICAgIHRleHQ6IGZ1bmN0aW9uICggZHQsIGJ1dHRvbiwgY29uZiApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uZi5fY29sdW1uVGV4dCggZHQsIGNvbmYuY29sdW1ucyApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2J1dHRvbnMtY29sdW1uVmlzaWJpbGl0eScsXG4gICAgICAgICAgICBhY3Rpb246IGZ1bmN0aW9uICggZSwgZHQsIGJ1dHRvbiwgY29uZiApIHtcbiAgICAgICAgICAgICAgICB2YXIgY29sID0gZHQuY29sdW1ucyggY29uZi5jb2x1bW5zICk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnIgPSBjb2wudmlzaWJsZSgpO1xuXG4gICAgICAgICAgICAgICAgY29uZi5jYWxsYmFjayhjb2xbMF1bMF0sY29uZi52aXNpYmlsaXR5ICE9PSB1bmRlZmluZWQgP1xuICAgICAgICAgICAgICAgICAgICBjb25mLnZpc2liaWxpdHkgOlxuICAgICAgICAgICAgICAgICAgICAhIChjdXJyLmxlbmd0aCA/IGN1cnJbMF0gOiBmYWxzZSApKTtcblxuICAgICAgICAgICAgICAgIGNvbC52aXNpYmxlKCBjb25mLnZpc2liaWxpdHkgIT09IHVuZGVmaW5lZCA/XG4gICAgICAgICAgICAgICAgICAgIGNvbmYudmlzaWJpbGl0eSA6XG4gICAgICAgICAgICAgICAgICAgICEgKGN1cnIubGVuZ3RoID8gY3VyclswXSA6IGZhbHNlIClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uICggZHQsIGJ1dHRvbiwgY29uZiApIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBkdFxuICAgICAgICAgICAgICAgICAgICAub24oICdjb2x1bW4tdmlzaWJpbGl0eS5kdCcrY29uZi5uYW1lc3BhY2UsIGZ1bmN0aW9uIChlLCBzZXR0aW5ncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhIHNldHRpbmdzLmJEZXN0cm95aW5nICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuYWN0aXZlKCBkdC5jb2x1bW4oIGNvbmYuY29sdW1ucyApLnZpc2libGUoKSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IClcbiAgICAgICAgICAgICAgICAgICAgLm9uKCAnY29sdW1uLXJlb3JkZXIuZHQnK2NvbmYubmFtZXNwYWNlLCBmdW5jdGlvbiAoZSwgc2V0dGluZ3MsIGRldGFpbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvbid0IHJlbmFtZSBidXR0b25zIGJhc2VkIG9uIGNvbHVtbiBuYW1lIGlmIHRoZSBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnRyb2xzIG1vcmUgdGhhbiBvbmUgY29sdW1uIVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBkdC5jb2x1bW5zKCBjb25mLmNvbHVtbnMgKS5jb3VudCgpICE9PSAxICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0eXBlb2YgY29uZi5jb2x1bW5zID09PSAnbnVtYmVyJyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25mLmNvbHVtbnMgPSBkZXRhaWxzLm1hcHBpbmdbIGNvbmYuY29sdW1ucyBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sID0gZHQuY29sdW1uKCBjb25mLmNvbHVtbnMgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC50ZXh0KCBjb25mLl9jb2x1bW5UZXh0KCBkdCwgY29uZi5jb2x1bW5zICkgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuYWN0aXZlKCBjb2wudmlzaWJsZSgpICk7XG4gICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlKCBkdC5jb2x1bW4oIGNvbmYuY29sdW1ucyApLnZpc2libGUoKSApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uICggZHQsIGJ1dHRvbiwgY29uZiApIHtcbiAgICAgICAgICAgICAgICBkdFxuICAgICAgICAgICAgICAgICAgICAub2ZmKCAnY29sdW1uLXZpc2liaWxpdHkuZHQnK2NvbmYubmFtZXNwYWNlIClcbiAgICAgICAgICAgICAgICAgICAgLm9mZiggJ2NvbHVtbi1yZW9yZGVyLmR0Jytjb25mLm5hbWVzcGFjZSApO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgX2NvbHVtblRleHQ6IGZ1bmN0aW9uICggZHQsIGNvbCApIHtcbiAgICAgICAgICAgICAgICAvLyBVc2UgRGF0YVRhYmxlcycgaW50ZXJuYWwgZGF0YSBzdHJ1Y3R1cmUgdW50aWwgdGhpcyBpcyBwcmVzZW50ZWRcbiAgICAgICAgICAgICAgICAvLyBpcyBhIHB1YmxpYyBBUEkuIFRoZSBvdGhlciBvcHRpb24gaXMgdG8gdXNlXG4gICAgICAgICAgICAgICAgLy8gYCQoIGNvbHVtbihjb2wpLm5vZGUoKSApLnRleHQoKWAgYnV0IHRoZSBub2RlIG1pZ2h0IG5vdCBoYXZlIGJlZW5cbiAgICAgICAgICAgICAgICAvLyBwb3B1bGF0ZWQgd2hlbiBCdXR0b25zIGlzIGNvbnN0cnVjdGVkLlxuICAgICAgICAgICAgICAgIHZhciBpZHggPSBkdC5jb2x1bW4oIGNvbCApLmluZGV4KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGR0LnNldHRpbmdzKClbMF0uYW9Db2x1bW5zWyBpZHggXS5zVGl0bGVcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcbi9nLFwiIFwiKSAgICAgICAgLy8gcmVtb3ZlIG5ldyBsaW5lc1xuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSggLzwuKj8+L2csIFwiXCIgKSAgIC8vIHN0cmlwIEhUTUxcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL15cXHMrfFxccyskL2csXCJcIik7IC8vIHRyaW1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuXG4gICAgICAgIGNvbHZpc1Jlc3RvcmU6IHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2J1dHRvbnMtY29sdmlzUmVzdG9yZScsXG5cbiAgICAgICAgICAgIHRleHQ6IGZ1bmN0aW9uICggZHQgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGR0LmkxOG4oICdidXR0b25zLmNvbHZpc1Jlc3RvcmUnLCAnUmVzdG9yZSB2aXNpYmlsaXR5JyApO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24gKCBkdCwgYnV0dG9uLCBjb25mICkge1xuICAgICAgICAgICAgICAgIGNvbmYuX3Zpc09yaWdpbmFsID0gZHQuY29sdW1ucygpLmluZGV4ZXMoKS5tYXAoIGZ1bmN0aW9uICggaWR4ICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHQuY29sdW1uKCBpZHggKS52aXNpYmxlKCk7XG4gICAgICAgICAgICAgICAgfSApLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGFjdGlvbjogZnVuY3Rpb24gKCBlLCBkdCwgYnV0dG9uLCBjb25mICkge1xuICAgICAgICAgICAgICAgIGR0LmNvbHVtbnMoKS5ldmVyeSggZnVuY3Rpb24gKCBpICkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUYWtlIGludG8gYWNjb3VudCB0aGF0IENvbFJlb3JkZXIgbWlnaHQgaGF2ZSBkaXNydXB0ZWQgb3VyXG4gICAgICAgICAgICAgICAgICAgIC8vIGluZGV4ZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IGR0LmNvbFJlb3JkZXIgJiYgZHQuY29sUmVvcmRlci50cmFuc3Bvc2UgP1xuICAgICAgICAgICAgICAgICAgICAgICAgZHQuY29sUmVvcmRlci50cmFuc3Bvc2UoIGksICd0b09yaWdpbmFsJyApIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aXNpYmxlKCBjb25mLl92aXNPcmlnaW5hbFsgaWR4IF0gKTtcbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cblxuICAgICAgICBjb2x2aXNHcm91cDoge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiAnYnV0dG9ucy1jb2x2aXNHcm91cCcsXG5cbiAgICAgICAgICAgIGFjdGlvbjogZnVuY3Rpb24gKCBlLCBkdCwgYnV0dG9uLCBjb25mICkge1xuICAgICAgICAgICAgICAgIGR0LmNvbHVtbnMoIGNvbmYuc2hvdyApLnZpc2libGUoIHRydWUsIGZhbHNlICk7XG4gICAgICAgICAgICAgICAgZHQuY29sdW1ucyggY29uZi5oaWRlICkudmlzaWJsZSggZmFsc2UsIGZhbHNlICk7XG5cbiAgICAgICAgICAgICAgICBkdC5jb2x1bW5zLmFkanVzdCgpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgc2hvdzogW10sXG5cbiAgICAgICAgICAgIGhpZGU6IFtdXG4gICAgICAgIH1cbiAgICB9ICk7XG5cblxuICAgIHJldHVybiBEYXRhVGFibGUuQnV0dG9ucztcbn0pKTsiXX0=
